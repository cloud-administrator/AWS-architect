

**問題 1. Azure サブスクリプションがあり、Microsoft Entra ID テナントはオンプレミスの Active Directory ドメインと同期しています。ドメインには以下の表に示すユーザーが含まれています。すべてのユーザーに対してセルフサービスパスワードリセット（SSPR）を有効にし、以下の認証方法で SSPR を構成しました。セキュリティの質問は 3 つ設定されています。User-A は、セルフサービスパスワードリセット中に「初めて飼ったペットの名前は何ですか」という質問に必ず答える必要がありますか。正しい場合は「はい」を、正しくない場合は「いいえ」を選択してください。（一つ選択）**

| 名前 | ロール |
| :--- | :--- |
| SecAdmin-A | セキュリティ管理者 |
| BillAdmin-A | 課金管理者 |
| User-A | レポート閲覧者 |
| BillAdmin-B | 課金管理者 |

**SSPR 構成**
- リセットに必要なメソッドの数：2
- ユーザーが利用できる方法：携帯電話、セキュリティの質問
- 登録に必要な質問数：5
- リセットに必要な質問数：3

**設定されたセキュリティの質問**
- 好きな食べ物は何ですか
- 最初の仕事はどこの都市でしたか
- 初めて飼ったペットの名前は何ですか

・いいえ
・はい

**解答例**
・いいえ

**解説**
この問題は、Microsoft Entra ID のセルフサービスパスワードリセット（SSPR）における認証方法の要件を理解しているかを問うものです。

SSPR 構成では「リセットに必要なメソッドの数: 2」と設定されています。これは、ユーザーがパスワードリセットを実行する際に、2つの異なる認証方法で本人確認を行う必要があることを意味します。利用可能な方法は「携帯電話」と「セキュリティの質問」の2つです。

セキュリティの質問を採用する場合、「リセットに必要な質問数: 3」という設定により、ユーザーは3つの質問すべてに正しく答える必要があります。しかし、重要なポイントは、セキュリティの質問は認証方法の1つとしてカウントされるということです。つまり、3つの質問に答えることで1つの認証方法を満たしたことになります。

User-A がパスワードリセットを実行する場合、2つの認証方法が必要なため、以下のいずれかの組み合わせを選択できます。
1. 携帯電話 + セキュリティの質問 (3つすべて)
2. 携帯電話のみを2回使用 (SMS 認証コードと音声通話など、方法が異なる場合)

User-A は携帯電話による認証を選択することで、セキュリティの質問に答えることなくパスワードリセットを完了できます。したがって、「初めて飼ったペットの名前は何ですか」という質問に必ず答える必要はありません。

| 項目 | 設定値 |
| :--- | :--- |
| 必要な認証方法数 | 2つ |
| 利用可能な方法 | 携帯電話、セキュリティの質問 |
| セキュリティの質問数 | 3つすべて必須 |

**リファレンス**
・セルフサービスパスワードリセット (SSPR)
・Microsoft Entra ID
・Multi-Factor Authentication (MFA)

---

**問題 2. あなたは 15 個の Azure サブスクリプションを管理しています。Azure AD テナントには Group1 というセキュリティグループが存在します。今後、追加の Azure サブスクリプションを購入予定です。Group1 が既存のサブスクリプションと今後購入予定のサブスクリプションに対してロール割り当てを管理できるようにします。このソリューションは次の要件を満たす必要があります。「最小特権の原則を使用する、管理作業を最小限に抑える。」どのように構成しますか。（一つ選択）**

・Group1 にルート管理グループの User Access Administrator ロールを割り当てる
・Group1 にルート管理グループの Owner ロールを割り当てる
・新しい管理グループを作成し、Group1 にそのグループの User Access Administrator ロールを割り当てる
・新しい管理グループを作成し、Group1 にそのグループの Owner ロールを割り当てる

**解答例**
・Group1 にルート管理グループの User Access Administrator ロールを割り当てる

**解説**
この問題の最重要ポイントは、複数のサブスクリプションに対するロール割り当て管理権限を効率的に付与するために、管理グループの階層構造と User Access Administrator ロールの特性を理解することです。

Azure 管理グループは、複数のサブスクリプションを階層的に管理するための仕組みです。ルート管理グループはテナント内のすべてのサブスクリプションを包含する最上位の管理グループであり、ここで権限を付与すると既存および将来追加されるすべてのサブスクリプションに自動的に継承されます。

User Access Administrator ロールは、Azure リソースへのアクセス管理に特化したロールで、ロール割り当ての作成と削除のみが可能です。一方、Owner ロールはロール割り当て管理に加えてリソースの完全な管理権限を持つため、最小特権の原則に反します。

新しい管理グループを作成する選択肢は、既存の 15 個のサブスクリプションを移動する必要があり管理作業が増加します。ルート管理グループを使用すれば既存サブスクリプションは既に配下にあるため追加作業は不要です。

| 比較項目 | User Access Administrator | Owner |
| :--- | :--- | :--- |
| ロール割り当て管理 | 可能 | 可能 |
| リソース管理 | 不可 | 可能 |
| 最小特権の原則 | 適合 | 過剰な権限 |

| 管理グループの選択 | 既存サブスクリプション | 将来のサブスクリプション | 管理作業 |
| :--- | :--- | :--- | :--- |
| ルート管理グループ | 自動的に含まれる | 自動的に含まれる | 最小 |
| 新規管理グループ | 移動作業が必要 | 配置作業が必要 | 増加 |

したがって、Group1 にルート管理グループの User Access Administrator ロールを割り当てることで、最小特権の原則を守りながら管理作業を最小限に抑えつつ、すべてのサブスクリプションに対するロール割り当て管理が可能になります。

**リファレンス**
・User Access Administrator ロール
・Azure RBAC (Role-Based Access Control)

---

**問題 3. Azure App Service で「WebApp01」という Web アプリケーションを運用しています。開発チームは「Repo01」という Git リポジトリにアプリケーションの更新をコミットします。WebApp01 には複数のデプロイスロットが構成されており、本番環境への展開前に更新内容の検証を行う必要があります。適切な手順を 2 つ選択してください。（二つ選択）**

| スロット名 | 用途 |
| :--- | :--- |
| WebApp01-production | 本番環境 |
| WebApp01-staging | ステージング環境 |
| WebApp01-development | 開発環境 |

・WebApp01-staging スロットに更新をデプロイし、検証を実施する
・WebApp01-production スロットを停止する
・デプロイスロットのスワップを実行する
・WebApp01-development スロットと WebApp01-staging スロットを削除する
・WebApp01-production スロットを再起動する

**解答例**
・WebApp01-staging スロットに更新をデプロイし、検証を実施する
・デプロイスロットのスワップを実行する

**解説**
Azure App Service のデプロイスロット機能を使用した安全なアプリケーション更新手順が問われています。デプロイスロットは本番環境に影響を与えずに新バージョンの検証を可能にする機能です。

まずステージング環境である WebApp01-staging スロットに更新版アプリケーションをデプロイします。このスロットで動作確認、負荷テスト、結合テストなどの検証作業を実施します。検証が完了し問題がないことを確認したら、スロットスワップ機能を使用してステージングスロットと本番スロットの内容を入れ替えます。

スロットスワップはダウンタイムなしで実行され、問題が発生した場合は即座にロールバック（再スワップ）が可能です。本番スロットの停止や再起動は不要であり、これらの操作はサービス停止を伴うため避けるべきです。またスロットの削除は環境構成を破壊する行為であり、継続的なデプロイメントプロセスには適しません。

| 操作 | 目的 | ダウンタイム |
| :--- | :--- | :--- |
| ステージングへのデプロイ | 更新内容の検証 | なし（本番環境に影響なし） |
| スロットスワップ | 本番環境への反映 | なし（瞬時に切替） |
| 本番スロット停止 | 不要な操作 | あり（サービス停止） |

**リファレンス**
・Azure App Service
・Deployment Slot
・スロットスワップ

---

**問題 4. Azure サブスクリプションに複数のリソースが含まれています。すべての仮想マシンは Windows Server 2016 を実行しています。VM1 上で Folder1 という名前のフォルダを Azure Backup を使用してバックアップしました。このバックアップを別の仮想マシンに復元する計画があります。VM2 にバックアップを復元する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

・VM2 に Microsoft Azure Recovery Services Agent をインストールする
・VM1 に Windows Server Backup 機能をインストールする
・VM2 に Windows Server Backup 機能をインストールする
・Recovery Services コンテナーで復元ポイントを選択する

**解答例**
・VM2 に Microsoft Azure Recovery Services Agent をインストールする

**解説**
Azure Backup を使用してバックアップされたファイルやフォルダを別の仮想マシンに復元するには、復元先のマシンに Microsoft Azure Recovery Services Agent (MARS エージェント) が必要です。

VM1 では既に MARS エージェントがインストールされており、Folder1 のバックアップが完了しています。このバックアップデータは Recovery Services コンテナーに保存されています。VM2 に復元するには、VM2 も MARS エージェントを通じて同じ Recovery Services コンテナーに接続できる必要があります。

復元プロセスは以下の手順で実行されます。まず VM2 に MARS エージェントをインストールし、次に同じ Recovery Services コンテナーに登録します。その後、復元ウィザードを使用して VM1 からバックアップされたデータを選択し、VM2 上の指定した場所に復元します。

Windows Server Backup 機能は Windows の標準バックアップツールですが、Azure Backup とは異なるバックアップソリューションです。Azure Backup で作成されたバックアップを復元するには使用できません。

| 項目 | 説明 |
| :--- | :--- |
| MARS エージェント | ファイル・フォルダの Azure Backup に必要なエージェント |
| Recovery Services コンテナー | バックアップデータを保存する Azure リソース |
| 復元の前提条件 | 復元先マシンに MARS エージェントのインストールと登録が必要 |

**リファレンス**
・Microsoft Azure Recovery Services Agent
・Recovery Services Vault
・Azure Backup

---

**問題 5. Azure SQL Database の DB1 のパフォーマンスを Azure Monitor で監視します。ログデータを分析するためのクエリを実行できるようにする必要があります。DB1 の診断設定で構成すべき送信先を選択してください。（一つ選択）**

・Log Analytics ワークスペースに送信する
・Azure Event Hubs にストリーミングする
・ストレージアカウントにアーカイブする
・Azure Data Explorer に送信する

**解答例**
・Log Analytics ワークスペースに送信する

**解説**
Azure SQL Database の診断ログをクエリで分析するには、Log Analytics ワークスペースへの送信が最適です。Log Analytics は、Kusto Query Language (KQL) を使用した高度なログ分析機能を提供し、リアルタイムでのパフォーマンス監視とトラブルシューティングを可能にします。

診断設定の各送信先の特徴を以下に整理します。

| 送信先 | 主な用途 | クエリ実行 |
| :--- | :--- | :--- |
| Log Analytics ワークスペース | リアルタイム分析、KQL クエリ実行 | 可能 |
| ストレージアカウント | 長期保存、コスト削減 | 不可 |
| Event Hubs | 外部システムへのストリーミング | 不可 |

ストレージアカウントへのアーカイブは、長期保存とコスト削減を目的とした選択肢であり、直接的なクエリ実行には適していません。Event Hubs へのストリーミングは、外部の監視システムや SIEM (Security Information and Event Management) ツールへのデータ転送に使用されますが、Azure Monitor 内でのクエリ分析には対応していません。

Log Analytics ワークスペースでは、診断ログを収集後、Azure Monitor の Logs ブレードから KQL クエリを実行できます。パフォーマンスメトリクス、クエリ実行時間、デッドロック、ブロッキングなどの詳細な分析が可能で、アラートルールの設定やダッシュボードの作成も行えます。

**リファレンス**
・Azure Monitor
・Log Analytics Workspace
・Kusto Query Language (KQL)

---

**問題 6. Azure AD テナントに複数のグループが存在します。Microsoft Entra ID Premium（旧称：Azure Active Directory Premium）P2 ライセンスを購入しました。グループベースのライセンス割り当て機能を使用して、どのグループタイプにライセンスを直接割り当てることができますか。（一つ選択）**

・セキュリティグループ（クラウド）と Microsoft 365 グループのみ
・セキュリティグループ（クラウド）のみ
・すべてのグループタイプに割り当て可能
・セキュリティグループ（クラウド）、セキュリティグループ（同期済み）、Microsoft 365 グループのみ

**解答例**
・セキュリティグループ（クラウド）、セキュリティグループ（同期済み）、Microsoft 365 グループのみ

**解説**
Azure AD のグループベースライセンス機能では、特定のグループタイプにのみライセンスを直接割り当てることができます。この機能を使用することで、グループメンバーシップに基づいて自動的にライセンスを管理できます。

ライセンス割り当てが可能なグループタイプは、セキュリティグループ（Azure AD で作成されたクラウドベース）、セキュリティグループ（オンプレミス Active Directory から同期されたもの）、Microsoft 365 グループ（旧 Office 365 グループ）の 3 種類です。これらのグループは、メンバーシップの管理とライセンスの自動割り当てに必要な属性を持っています。

一方、動的グループや配布グループなど、他のグループタイプには直接ライセンスを割り当てることができません。動的グループは、ルールベースでメンバーシップが自動的に変更されるため、ライセンス管理の観点から制限があります。配布グループは主にメール配信用途であり、ライセンス管理機能をサポートしていません。

| グループタイプ | ライセンス割り当て | 説明 |
| :--- | :--- | :--- |
| セキュリティグループ（クラウド） | 可能 | Azure AD で直接作成されたグループ |
| セキュリティグループ（同期済み） | 可能 | オンプレミス AD から同期されたグループ |
| Microsoft 365 グループ | 可能 | コラボレーション機能を持つグループ |
| 動的グループ | 不可 | ルールベースの自動メンバーシップ |
| 配布グループ | 不可 | メール配信専用グループ |

グループベースライセンスを採用する際は、ライセンス数の上限に注意が必要です。グループメンバー全員に割り当てるための十分なライセンス数を確保しておく必要があります。また、ライセンス割り当てエラーが発生した場合は、Azure AD ポータルでエラー状態を確認し、適切に対処することが重要です。

**リファレンス**
・Microsoft Entra ID

---

**問題 7. あなたは Contoso の Azure 管理者です。VM3 が技術要件を満たしていないことが判明しました。VM3 はモントリオールオフィスのアプリケーションサーバーに対して TCP ポート 8080 経由でアウトバウンド接続を確立する必要がありますが、接続できません。この問題が NSG（ネットワークセキュリティグループ）に関連しているかどうかを検証します。どのツールを使用しますか。（一つ選択）**

・Azure Monitor の Diagnostic settings
・Azure Network Watcher の IP flow verify
・Azure Advisor の Security recommendations
・VNet1 の Topology
・Azure Network Watcher の Connection troubleshoot

**解答例**
・Azure Network Watcher の IP flow verify

**解説**
VM3 のアウトバウンド接続問題が NSG に起因するかを検証するには、Azure Network Watcher の IP flow verify 機能を使用します。この機能は、特定の送信元 IP アドレス、宛先 IP アドレス、ポート番号、プロトコルを指定して、NSG ルールによってトラフィックが許可されているか拒否されているかを即座に確認できます。

IP flow verify は、仮想マシンから特定の宛先へのトラフィックフローをシミュレートし、適用されている NSG ルールを評価します。TCP ポート 8080 でのアウトバウンド接続が失敗している場合、どの NSG ルールがトラフィックをブロックしているかを特定できます。結果には、トラフィックが許可または拒否された理由と、該当する NSG ルールの名前が表示されます。

他の選択肢について、Azure Monitor の Diagnostic settings はログとメトリクスの収集設定であり、リアルタイムのトラフィック検証には使用しません。Azure Advisor の Security recommendations はセキュリティのベストプラクティス推奨事項を提供しますが、特定のトラフィックフローの検証はできません。VNet1 の Topology はネットワーク構成の可視化に使用され、Connection troubleshoot は接続性の問題を診断しますが、NSG ルールの詳細な検証には IP flow verify が最適です。

| 機能 | 用途 | NSG 検証 |
| :--- | :--- | :--- |
| IP flow verify | 特定トラフィックの NSG ルール評価 | 最適 |
| Connection troubleshoot | エンドツーエンド接続診断 | 可能だが詳細度低 |
| Topology | ネットワーク構成の可視化 | 不可 |

**リファレンス**
・Azure Network Watcher
・Network Security Group
・IP flow verify

---

**問題 8. Windows Server 2019 を実行する VM1 という名前の Azure 仮想マシンがあります。VM1 を Template1 という名前のテンプレートとして Azure Resource Manager ライブラリに保存しました。Template1 から VM2 という名前の仮想マシンをデプロイする予定です。VM2 のデプロイ時に構成できるパラメータはどれですか。（一つ選択）**

・リソースグループ
・仮想マシンのサイズ
・管理者ユーザー名
・オペレーティングシステム

**解答例**
・管理者ユーザー名

**解説**
Azure Resource Manager (ARM) テンプレートから仮想マシンをデプロイする際、テンプレートに定義されたパラメータとして公開されている項目のみがデプロイ時に変更可能です。

既存の仮想マシンからテンプレートを作成した場合、管理者ユーザー名はデプロイ時のパラメータとして設定できます。これはセキュリティ上の理由から、デプロイごとに異なる管理者アカウントを設定できるようにするためです。

一方、仮想マシンのサイズ、オペレーティングシステム、リソースグループは、テンプレート内に固定値として定義されているため、デプロイ時に変更することはできません。これらの設定を変更したい場合は、テンプレート自体を編集してから再デプロイする必要があります。

| 項目 | デプロイ時の変更 | 理由 |
| :--- | :--- | :--- |
| 管理者ユーザー名 | 可能 | パラメータとして公開 |
| 仮想マシンサイズ | 不可 | テンプレートに固定 |
| オペレーティングシステム | 不可 | テンプレートに固定 |
| リソースグループ | 不可 | デプロイ先として指定 |

テンプレートをカスタマイズして他の項目もパラメータ化することは可能ですが、既存 VM から自動生成されたテンプレートでは、セキュリティに関わる管理者ユーザー名のみがデフォルトでパラメータ化されています。

**リファレンス**
・ARM Template

---

**問題 9. あなたの会社では、オフィス外からアクセスするユーザーに対して Multi-Factor Authentication を使用しています。使用モデルとして認証ごと課金が設定されています。小規模企業を買収し、新しいスタッフを Microsoft Entra ID（旧 Azure AD）に追加した後、これらの従業員も Multi-Factor Authentication を使用する必要があると通知されました。これを実現するには、使用モデルを有効化ユーザーごと課金に設定する必要があります。解決策として、Azure portal から既存の使用モデルを再構成します。この解決策は要件を満たしていますか？（一つ選択）**

・いいえ、Azure Multi-Factor Authentication Provider の課金モデルは作成後に変更できないため、新しい Provider を作成する必要がある
・はい、Azure portal の Multi-Factor Authentication 設定から使用モデルを直接変更できる
・いいえ、PowerShell コマンドレットを使用しなければ課金モデルの変更はできない
・はい、Microsoft Entra 管理センターから課金モデルの切り替えが可能である

**解答例**
・いいえ、Azure Multi-Factor Authentication Provider の課金モデルは作成後に変更できないため、新しい Provider を作成する必要がある

**解説**
Azure Multi-Factor Authentication Provider の課金モデル（使用モデル）は、作成時に選択した後は変更できません。認証ごと課金から有効化ユーザーごと課金への変更、またはその逆の変更を行うことはできないため、Azure portal から既存の使用モデルを再構成するという解決策は要件を満たしません。

課金モデルを変更する必要がある場合は、既存の Multi-Factor Authentication Provider を削除し、新しい課金モデルで新規に Provider を作成する必要があります。ただし、2018年9月1日以降、新しい Multi-Factor Authentication Provider の作成は非推奨となっており、既存の Provider は引き続き使用および更新できますが、新規作成はできなくなっています。

現在のベストプラクティスとしては、Microsoft Entra ID P1 または P2 ライセンスに含まれる Multi-Factor Authentication 機能を使用することが推奨されています。これらのライセンスベースのアプローチでは、ユーザーごとのライセンス割り当てにより、従量課金モデルの制約を受けずに MFA を展開できます。

| 項目 | 認証ごと課金 | 有効化ユーザーごと課金 |
| :--- | :--- | :--- |
| 課金単位 | MFA 認証の実行回数 | MFA が有効化されたユーザー数 |
| 適用シナリオ | 不定期アクセスユーザーが多い | 定期的にアクセスユーザーが多い |
| 作成後の変更 | 不可（新規作成が必要） | 不可（新規作成が必要） |

**リファレンス**
・Multi-Factor Authentication (MFA)
・Microsoft Entra ID
・Conditional Access

---

**問題 10. 2 つの Azure サブスクリプション（Sub-A と Sub-B）があります。Sub-A は管理グループ MG-A に属し、Sub-B は管理グループ MG-B に属しています。以下の 3 つの表に示すリソース構成とロール割り当てがあります。この環境において「User-A は VM-A にサインインできる」という記述は正しいですか。（一つ選択）**

表1：リソースグループ
| 名前 | サブスクリプション |
| :--- | :--- |
| RG-A | Sub-A |
| RG-B | Sub-B |

表2：仮想マシン
| 名前 | リソースグループ |
| :--- | :--- |
| VM-A | RG-A |
| VM-B | RG-B |
| VM-C | RG-B |

表3：ロール割り当て
| ユーザー | ロール | スコープ |
| :--- | :--- | :--- |
| User-A | Virtual Machine Contributor | MG-A |
| User-A | Virtual Machine User Login | Sub-B |
| User-B | Virtual Machine Contributor | MG-B |
| User-B | Virtual Machine User Login | Sub-A |
| User-B | Virtual Machine User Login | VM-C |

・いいえ
・はい

**解答例**
・いいえ

**解説**
User-A が VM-A にサインインするには、Virtual Machine User Login または Virtual Machine Administrator Login ロールが必要です。User-A には管理グループ MG-A で Virtual Machine Contributor ロールが割り当てられていますが、このロールは仮想マシンの作成や管理は可能でも、仮想マシンへのサインイン権限は付与しません。

Azure RBAC では、ロールの割り当てスコープが上位（管理グループ）から下位（サブスクリプション、リソースグループ、リソース）へ継承されます。User-A は MG-A に対して Virtual Machine Contributor を持つため、MG-A 配下の Sub-A、さらにその配下の RG-A と VM-A に対して管理権限を継承します。しかし、Virtual Machine User Login ロールは Sub-B にのみ割り当てられており、Sub-A 配下の VM-A には適用されません。

仮想マシンへのサインインには、管理操作とは別に明示的なログイン権限が必要です。User-A が VM-A にサインインするには、Sub-A、RG-A、または VM-A 自体のいずれかのスコープで Virtual Machine User Login または Virtual Machine Administrator Login ロールが必要です。

ロールとアクセス権限の対応表
| ロール | 仮想マシン管理 | 仮想マシンサインイン |
| :--- | :--- | :--- |
| Virtual Machine Contributor | 可能 | 不可 |
| Virtual Machine User Login | 不可 | 可能（標準ユーザー） |
| Virtual Machine Administrator Login | 不可 | 可能（管理者） |

**リファレンス**
・Azure RBAC (Role-Based Access Control)
・Management Group

---

**問題 11. Azure Web App 「App-A」には運用環境の「webapp-prod-A」とステージング環境の「webapp-staging-A」という 2 つのデプロイスロットがあります。webapp-staging-A で変更内容をテストした後、webapp-prod-A とスワップしましたが、App-A でパフォーマンス問題が発生しました。App-A のバックアップは事前に取得済みです。できるだけ早急に App-A を以前のバージョンに戻します。このとき実施すべき操作を選択してください。（一つ選択）**

・App-A のバックアップを復元する
・App-A を再デプロイする
・App-A のクローンを作成する
・スロットをスワップする

**解答例**
・スロットをスワップする

**解説**
デプロイスロット間でスワップを実行した直後にパフォーマンス問題が発生した場合、最も迅速なロールバック方法は再度スロットをスワップすることです。スワップ操作は数秒から数分で完了し、アプリケーションのダウンタイムを最小限に抑えながら以前の状態に戻すことができます。

スワップ操作では、運用スロットとステージングスロットの構成とコンテンツが入れ替わります。問題発生前の状態に戻すには、もう一度スワップを実行するだけで、webapp-prod-A には元のバージョンが、webapp-staging-A には問題のあるバージョンが配置されます。この方法により、問題のあるバージョンはステージング環境に隔離され、運用環境は即座に復旧します。

バックアップの復元は確実な方法ですが、復元処理に時間がかかり、バックアップ取得時点以降の変更が失われる可能性があります。再デプロイも同様に時間を要し、クローン作成は新しいリソースを作成するため本問題の解決には不適切です。

| 方法 | 所要時間 | 特徴 |
| :--- | :--- | :--- |
| スロットスワップ | 数秒〜数分 | 即座にロールバック可能 |
| バックアップ復元 | 数分〜数十分 | 復元時点以降の変更が失われる |
| 再デプロイ | 数分〜数十分 | ビルドとデプロイが必要 |

**リファレンス**
・Azure AD 条件付きアクセス
・スワップ操作

---

**問題 12. 3 つの Azure リージョンに Azure 仮想マシンをデプロイしています。各リージョンには仮想ネットワークがあり、すべての仮想ネットワークはフルメッシュトポロジでピアリングされています。各サブネットにはネットワークセキュリティグループ（NSG）が関連付けられ、ルールが定義されています。ユーザーから、あるリージョンの仮想マシンから別のリージョンの仮想マシンへポート 33000 を使用して接続できないという報告がありました。この問題を診断するために使用できるオプションはどれですか。（二つ選択）**

・Connection troubleshoot
・Azure Monitor Network Insights
・NSG 診断
・IP flow verify
・Azure Network Watcher のパケットキャプチャ

**解答例**
・Connection troubleshoot
・IP flow verify

**解説**
リージョン間の仮想マシン接続問題を診断する際は、Azure Network Watcher の診断機能を活用します。この問題では特定のポート（33000）での接続障害が発生しているため、ネットワークトラフィックの許可・拒否状態を確認する必要があります。

IP flow verify は、仮想マシンとの間のパケット送受信が許可されているか拒否されているかを検証します。送信元と宛先の IP アドレス、ポート番号、プロトコルを指定することで、NSG ルールやユーザー定義ルートによる影響を即座に確認できます。ポート 33000 での通信が許可されているかを直接検証できるため、この問題の診断に最適です。

Connection troubleshoot は、仮想マシン間の接続性を包括的にテストする機能です。通信元仮想マシンから宛先への到達可能性を検証し、経路上のホップ情報、遅延、NSG ルールの影響などを詳細に分析します。リージョン間接続の問題箇所を特定するのに有効です。

Azure Monitor Network Insights は、ネットワーク全体の正常性とメトリクスを可視化する監視ツールですが、特定ポートの接続問題を診断する機能は提供していません。NSG 診断は実在しない機能です。パケットキャプチャは詳細なトラフィック分析には有用ですが、接続可否の初期診断には過剰な機能です。

| 診断ツール | 用途 | ポート指定診断 |
| :--- | :--- | :--- |
| IP flow verify | NSG ルール検証 | 可能 |
| Connection troubleshoot | エンドツーエンド接続診断 | 可能 |
| Network Insights | ネットワーク監視 | 不可 |

**リファレンス**
・Azure Network Watcher
・Network Security Group
・Virtual Network Peering

---

**問題 13. Azure サブスクリプションに、VNet1 と VNet2 という 2 つの仮想ネットワークがあります。両方の仮想ネットワーク上のリソースがシームレスに通信できるようにします。Azure ポータルで何を構成しますか。（一つ選択）**

・サービスエンドポイント
・接続されたデバイス
・ピアリング
・ネットワークセキュリティグループ

**解答例**
・ピアリング

**解説**
異なる仮想ネットワーク間でリソースが直接通信できるようにするには、仮想ネットワークピアリングを構成します。ピアリングは、Azure バックボーンネットワークを介して 2 つの仮想ネットワークを接続し、プライベート IP アドレスを使用した通信を可能にします。

仮想ネットワークピアリングの特徴として、低遅延で高帯域幅の接続が実現でき、異なるサブスクリプションやリージョン間でも構成可能です。ピアリング接続は双方向で設定する必要があり、VNet1 から VNet2 へ、VNet2 から VNet1 へそれぞれピアリングを作成します。トラフィックは Microsoft のプライベートネットワーク内を経由するため、インターネットを経由せず安全に通信できます。

他の選択肢について、サービスエンドポイントは Azure PaaS サービスへのセキュアなアクセスを提供する機能であり、仮想ネットワーク間の接続には使用しません。接続されたデバイスは VPN Gateway などのネットワークデバイスの管理項目です。ネットワークセキュリティグループはトラフィックのフィルタリングに使用しますが、ネットワーク間の接続自体を確立する機能ではありません。

| 機能 | 用途 |
| :--- | :--- |
| 仮想ネットワークピアリング | 仮想ネットワーク間の直接接続 |
| サービスエンドポイント | PaaS サービスへのセキュアアクセス |
| VPN Gateway | オンプレミスとの接続 |

**リファレンス**
・Virtual Network Peering
・Azure Virtual Network
・Network Security Group

---

**問題 14. Windows Server 2019 を実行する VM1 という名前の Azure 仮想マシンを作成しました。VM1 に対して Desired State Configuration (DSC) を有効化します。最初に実行すべき操作を選択してください。（一つ選択）**

・VM1 のスナップショットを取得する
・VM1 を起動する
・VM1 の DNS 名を構成する
・VM1 にリモートデスクトップ接続する

**解答例**
・VM1 を起動する

**解説**
Azure Desired State Configuration (DSC) は、仮想マシンの構成管理を自動化するサービスです。DSC 拡張機能を仮想マシンに適用するには、対象の仮想マシンが実行中である必要があります。

問題文の図表情報から、VM1 が停止状態 (Stopped/deallocated) であることが示されています。停止状態の仮想マシンに対して DSC 拡張機能を適用することはできません。Azure 仮想マシンの拡張機能は、仮想マシンエージェント (VM Agent) を通じて動作しますが、このエージェントは仮想マシンが実行中の状態でのみ機能します。

したがって、DSC を有効化する前に、まず VM1 を起動して実行状態にする必要があります。仮想マシンが起動した後、Azure Portal または PowerShell を使用して DSC 拡張機能を構成し、適用することができます。

| 操作 | 必要性 | 理由 |
| :--- | :--- | :--- |
| VM 起動 | 必須 | DSC 拡張機能の適用には VM Agent の動作が必要 |
| スナップショット | 任意 | 構成変更前のバックアップとして推奨されるが必須ではない |
| DNS 名構成 | 不要 | DSC 適用に直接関係しない |

DSC 拡張機能を適用する際の一般的な手順は、仮想マシンの起動、DSC 構成スクリプトの準備、Azure Automation アカウントまたはストレージアカウントへのスクリプト配置、そして仮想マシンへの DSC 拡張機能の適用となります。

**リファレンス**
・Azure Desired State Configuration (DSC)
・Azure VM Agent

---

**問題 15. あなたの会社では、Azure Active Directory（Azure AD）を使用してユーザーアカウントを管理しています。新しく入社した従業員に対して Microsoft 365 E5 ライセンスを割り当てようとしたところ、エラーが発生してライセンスの割り当てに失敗しました。エラーメッセージを確認すると、「使用場所が設定されていないため、ライセンスを割り当てることができません」と表示されています。ライセンスの割り当てを再試行する前に、この問題を解決する必要があります。どのような操作を実行しますか。（一つ選択）**

・Azure AD のユーザープロファイルで使用場所を設定する
・Azure AD のディレクトリロールでユーザーの役割を変更する
・Azure AD のグループ設定でライセンス割り当てグループを作成する
・Azure AD の条件付きアクセスポリシーで地理的な場所の制限を解除する

**解答例**
・Azure AD のユーザープロファイルで使用場所を設定する

**解説**
Azure AD で Microsoft 365 などのライセンスを割り当てる際、ユーザーアカウントに使用場所 (Usage Location) が設定されていることが必須要件となります。これは、各国の法規制やサービス提供地域の制限に準拠するための仕組みです。

使用場所が未設定の状態でライセンスを割り当てようとすると、システムはどの地域の法規則を適用すべきか判断できないため、エラーが発生します。この問題を解決するには、Azure AD のユーザープロファイルにアクセスし、適切な国または地域を使用場所として設定する必要があります。

使用場所の設定は、Azure portal の Azure Active Directory > ユーザー > 対象ユーザーを選択 > プロファイルの編集から実行できます。また、PowerShell や Microsoft Graph API を使用して一括設定することも可能です。

ディレクトリロールの変更やグループへの招待は、ライセンス割り当ての前提条件である使用場所の問題を解決しません。条件付きアクセスポリシーは、認証時のアクセス制御に関する設定であり、ライセンス割り当ての要件とは無関係です。

| 操作 | ライセンス割り当て問題の解決 | 用途 |
| :--- | :--- | :--- |
| 使用場所の設定 | 可能 | ライセンス割り当ての必須要件 |
| ディレクトリロールの変更 | 不可 | 管理権限の付与 |
| グループへの招待 | 不可 | アクセス権限の管理 |

**リファレンス**
・Microsoft Entra ID

---

**問題 16. Azure サブスクリプションに以下のリソースが含まれています。VM1 は VNET1 に接続されています。VM1 を VNET2 に接続する必要があります。解決策として、新しいネットワークインターフェイスを作成し、そのネットワークインターフェイスを VM1 に追加します。この解決策は要件を満たしていますか？（一つ選択）**

| リソース名 | 種類 | 備考 |
| :--- | :--- | :--- |
| VNET1 | 仮想ネットワーク | 10.0.0.0/16 |
| VNET2 | 仮想ネットワーク | 10.1.0.0/16 |
| VM1 | 仮想マシン | VNET1 に接続 |

・いいえ、要件を満たしていません
・はい、要件を満たしています

**解答例**
・いいえ、要件を満たしていません

**解説**
この解決策は要件を満たしていません。VM1 に新しいネットワークインターフェイスを追加して VNET2 のサブネットに接続しても、VNET1 と VNET2 間の通信は確立されません。

Azure 仮想マシンは複数のネットワークインターフェイスを持つことができますが、各ネットワークインターフェイスは異なる仮想ネットワークに接続できません。ただし、これだけでは仮想ネットワーク間の通信は実現しません。仮想ネットワーク間で通信を行うには、仮想ネットワークピアリングまたは VPN Gateway を使用して仮想ネットワーク同士を接続する必要があります。

正しい解決策は、VNET1 と VNET2 の間に仮想ネットワークピアリングを構成することです。仮想ネットワークピアリングを使用すると、Azure バックボーンネットワークを介して 2 つの仮想ネットワーク間でトラフィックをルーティングできます。ピアリング接続は低遅延で高帯域幅の接続を提供し、追加のゲートウェイを必要としません。

仮想ネットワーク間接続の主な方法を以下に整理します。
| 接続方法 | 特徴 | 用途 |
| :--- | :--- | :--- |
| 仮想ネットワークピアリング | 低遅延、高帯域幅、同一または異なるリージョン間で接続可能 | Azure 内の仮想ネットワーク間接続 |
| VPN Gateway | 暗号化通信、オンプレミスとの接続も可能 | セキュアな接続が必要な場合 |
| Virtual WAN | 複数拠点の大規模接続、ハブアンドスポーク構成 | エンタープライズ規模のネットワーク |

**リファレンス**
・Virtual Network Peering
・VPN Gateway
・Network Interface

---

**問題 17. オンプレミスネットワークに SMB 共有 Share1 があります。Azure サブスクリプションには、Web アプリ hogehogeapp1 と仮想ネットワーク VNET1 が含まれています。hogehogeapp1 から Share1 に接続できるようにします。何をデプロイしますか。（一つ選択）**

・Azure Virtual Network Gateway
・Azure VPN Gateway
・Azure Application Gateway
・Azure Relay

**解答例**
・Azure VPN Gateway

**解説**
オンプレミスの SMB 共有と Azure 上の Web アプリを接続するには、オンプレミスネットワークと Azure 仮想ネットワーク間の安全な接続が必要です。この要件を満たすのは Azure VPN Gateway です。

Azure VPN Gateway は、Azure 仮想ネットワークとオンプレミスネットワーク間でサイト間 VPN 接続を確立します。この接続により、Azure 上のリソースはオンプレミスのリソースにプライベート IP アドレスを使用してアクセスできます。Web アプリは VNET 統合機能を使用して仮想ネットワークに接続し、VPN Gateway 経由でオンプレミスの SMB 共有にアクセスします。

他の選択肢が不適切な理由を整理します。Azure Application Gateway は、Web トラフィックのロードバランサーとして機能するレイヤー 7 のサービスで、オンプレミス接続には使用しません。Azure Virtual Network Gateway は、VPN Gateway と ExpressRoute Gateway の総称であり、具体的なゲートウェイタイプを指定する必要があります。Azure Relay は、ファイアウォールを通過してオンプレミスサービスを公開するハイブリッド接続サービスですが、SMB 共有の直接接続には適していません。

接続方式の比較を以下に示します。
| 接続方式 | 用途 | 特徴 |
| :--- | :--- | :--- |
| VPN Gateway | サイト間接続 | IPsec/IKE VPN トンネル |
| ExpressRoute | 専用線接続 | 高速・高信頼性 |
| Azure Relay | ハイブリッド接続 | HTTP/WebSocket 通信 |

**リファレンス**
・Azure VPN Gateway
・VNET 統合
・Site-to-Site VPN

---

**問題 18. Azure サブスクリプションに以下のリソースが存在します。Azure Monitor でデータ収集ルール（DCR）を作成する際、宛先として指定可能なリソースを選択してください。（一つ選択）**

| 名前 | タイプ |
| :--- | :--- |
| VM-A | 仮想マシン |
| storage-A | ストレージアカウント |
| Workspace-A | Log Analytics ワークスペース |
| DB-A | Azure SQL データベース |

・Workspace-A
・storage-A、DB-A
・Workspace-A、storage-A
・Workspace-A、storage-A、DB-A

**解答例**
・Workspace-A

**解説**
Azure Monitor のデータ収集ルール (Data Collection Rules: DCR) は、監視データの収集と転送を制御する設定です。DCR で指定できる宛先は、収集したログやメトリクスを保存する場所を定義します。

現在、DCR の宛先として指定可能なリソースは Log Analytics ワークスペースのみです。仮想マシンやその他のリソースから収集されたデータは、DCR を通じて Log Analytics ワークスペースに送信され、そこで分析やクエリが実行されます。

ストレージアカウントは、診断設定 (Diagnostic Settings) を使用してログをアーカイブする際の宛先として利用できますが、DCR の宛先としては直接指定できません。Azure SQL データベースも同様に、DCR の宛先としてはサポートされていません。

DCR は主に Azure Monitor Agent と連携して動作し、仮想マシンやその他のリソースから効率的にデータを収集します。収集されたデータは Log Analytics ワークスペースに集約され、Kusto Query Language (KQL) を使用した高度な分析が可能になります。

| 項目 | 説明 |
| :--- | :--- |
| DCR の宛先 | Log Analytics ワークスペースのみ |
| 診断設定の宛先 | Log Analytics、ストレージアカウント、Event Hubs |
| データ収集方法 | Azure Monitor Agent を使用 |

**リファレンス**
・Data Collection Rules (DCR)
・Log Analytics Workspace
・Azure Monitor Agent

---

**問題 19. あなたが管理する Azure 環境には 1 つのサブスクリプション「Sub-Hogehoge」があります。Sub-Hogehoge において、Alert-Foobar という名前のアラートルールを作成しました。Alert-Foobar のアクショングループの構成は以下の通りです。Alert-Foobar のアラート条件は 10 分ごとにトリガーされます。このとき、Alert-Foobar が 1 時間に送信する SMS の最大数はいくつですか。（一つ選択）**

```
ResourceGroupName: rg-monitoring
GroupShortName: AG-Foobar
Enabled: True
Email Receivers: [Receiver1_EmailAction]
Sms Receivers: [Receiver1_SMSAction]
Webhook Receivers: []
Id: /subscriptions/12345678-abcd-efgh-ijkl-mnopqrstuvw/resourceGroups/rg-monitoring/providers/microsoft.insights/actionGroups/AG-Foobar
Name: AG-Foobar
Type: Microsoft.Insights/ActionGroups
Location: Global
Tags: []
```

・12
・0
・6
・4

**解答例**
・6

**解説**
Azure のアクショングループには、SMS 通知に対するレート制限 (Rate Limiting) が適用されます。この制限により、同一のアクショングループから同一の電話番号に対して送信できる SMS の数は、1 時間あたり最大 6 通に制限されています。

本問では、アラート条件が 10 分ごとにトリガーされるため、1 時間で最大 6 回のアラートが発生する可能性があります（60 分 ÷ 10 分 = 6 回）。しかし、アクショングループの SMS レート制限により、実際に送信される SMS は 1 時間あたり最大 6 通となります。

アクショングループのレート制限は、通知の過剰送信を防ぎ、コストを抑制するために設けられています。SMS だけでなく、音声通話や Email にもそれぞれ異なるレート制限が適用されます。

| 通知タイプ | レート制限 | 制限期間 |
| :--- | :--- | :--- |
| SMS | 最大 6 通 | 1 時間 |
| 音声通話 | 最大 6 回 | 1 時間 |
| Email | 最大 100 通 | 1 時間 |

アラート設計時には、これらのレート制限を考慮し、重要度に応じて適切な通知方法を選択することが重要です。頻繁にトリガーされるアラートの場合は、Email や webhook の採用を検討するとよいでしょう。

**リファレンス**
・Action Group
・Azure Monitor

---

**問題 20. あなたの組織は Microsoft Entra ID Premium（旧称：Azure Active Directory Premium）にサインアップしました。Microsoft Entra ID ドメインに参加するすべてのコンピューターで、ユーザー [email protected] を管理者として追加します。Microsoft Entra ID で構成すべき項目はどれですか。（一つ選択）**

・デバイスブレードのデバイス設定
・ユーザーブレードのユーザー設定
・MFA サーバーブレードのプロバイダー
・ロールと管理者ブレードの特権ロール設定

**解答例**
・デバイスブレードのデバイス設定

**解説**
Microsoft Entra ID に参加したデバイスでローカル管理者権限を付与するには、デバイス設定で追加のローカル管理者を構成します。デバイスブレードのデバイス設定には「Microsoft Entra 参加済みデバイスの追加のローカル管理者」という項目があり、ここで指定したユーザーは、すべての Microsoft Entra 参加済みデバイスのローカル Administrators グループに自動的に追加されます。

この設定により、特定のユーザーに対して Microsoft Entra 参加済みデバイス全体で管理者権限を一元的に付与できます。個別のデバイスごとに設定する必要がなく、新しくドメイン参加したデバイスにも自動的に適用されるため、管理の効率化が図れます。

他の選択肢が不適切な理由を以下に示します。
| 選択肢 | 説明 |
| :--- | :--- |
| ユーザー設定 | ユーザーの既定の権限やアプリケーション登録の設定を管理するが、デバイスのローカル管理者設定は含まれない |
| MFA プロバイダー | 多要素認証の構成に関連し、デバイスの管理者権限とは無関係 |
| 特権ロール設定 | Microsoft Entra ID や Azure リソースの管理ロールを割り当てるが、デバイスのローカル管理者権限とは異なる |

デバイス設定で追加のローカル管理者を構成することで、組織全体の Microsoft Entra 参加済みデバイスに対して統一的な管理者権限の付与が実現できます。

**リファレンス**
・Microsoft Entra ID

---

**問題 21. ロードバランサーの背後にある 4 台の Windows Server Azure 仮想マシンで Web アプリケーションを実行しています。ユーザーが Web アプリケーションにアクセスする際に問題が発生しています。Web サーバーに問題があると疑われるため、サーバーがポート 80 でリッスンしているかどうかを確認する必要があります。実行すべきコマンドはどれですか。（一つ選択）**

・Test-NetConnection localhost -Port 80
・Get-AzNetworkWatcherConnectionMonitor
・netstat -an
・nbtstat -c

**解答例**
・netstat -an

**解説**
この問題は、Windows Server 上で Web サーバーがポート 80 でリッスンしているかを確認する方法を問うものです。

Web サーバーの問題を診断する際、最も基本的かつ効果的な方法は、サーバー上で実際にどのポートがリッスン状態にあるかを確認することです。netstat -an コマンドは、すべてのアクティブなネットワーク接続とリッスンポートを数値形式で表示するため、ポート 80 が LISTEN 状態にあるかを即座に確認できます。

各コマンドの用途を以下の表で整理します。
| コマンド | 用途 |
| :--- | :--- |
| netstat -an | すべてのネットワーク接続とリッスンポートを数値形式で表示。ポート 80 の LISTEN 状態を確認可能 |
| Test-NetConnection | 特定のホストやポートへの接続テストを実行。リモート接続の確認に使用 |
| Get-AzNetworkWatcherConnectionMonitor | Azure Network Watcher の接続監視設定を取得。Azure 管理用の PowerShell コマンドレット |
| nbtstat -c | NetBIOS 名前キャッシュの内容を表示。NetBIOS 名前解決の診断に使用 |

netstat -an の出力例では、以下のような形式でポート 80 のリッスン状態を確認できます。
TCP 0.0.0.0:80 0.0.0.0 LISTENING

この出力により、Web サーバーがポート 80 で全てのネットワークインターフェース (0.0.0.0) でリッスンしていることが確認できます。もしこの行が表示されない場合、Web サーバーサービスが起動していないか、別のポートで動作している可能性があります。

Test-NetConnection はリモートホストへの接続テストには有効ですが、ローカルサーバーのリッスンポート確認には netstat の方が適しています。Azure 管理用のコマンドレットや NetBIOS 関連のコマンドは、この診断シナリオには適していません。

**リファレンス**
・Azure Load Balancer
・Network Watcher

---

**問題 22. Azure Active Directory（Azure AD）テナントを管理しています。Azure Active Directory 管理センターの一括削除機能を使用して複数のユーザーを削除する予定です。一括削除用のファイルを作成してアップロードする必要があります。このファイルに含めるべきユーザー属性はどれですか。（一つ選択）**

・各ユーザーの表示名のみ
・各ユーザーのユーザープリンシパル名と使用場所のみ
・各ユーザーの表示名とユーザープリンシパル名のみ
・各ユーザーのユーザープリンシパル名のみ

**解答例**
・各ユーザーのユーザープリンシパル名のみ

**解説**
Azure AD の一括削除機能では、削除対象ユーザーを特定するためにユーザープリンシパル名 (UPN) のみが必要です。UPN は Azure AD 内でユーザーを一意に識別する属性であり、メールアドレス形式 (user@hogehoge.com) で表現されます。

一括削除用の CSV ファイルには、ヘッダー行に「user principal name」列を含め、その下に削除対象ユーザーの UPN を 1 行ずつ記載します。表示名や使用場所などの他の属性は、ユーザーの一意識別には不要であり、一括削除の処理では参照されません。

Azure AD 管理センターから一括削除テンプレートをダウンロードすると、必要な構成が事前定義された CSV ファイルが取得できます。このテンプレートを使用することで、正しい形式でファイルを作成できます。

一括操作の結果は、操作完了後に結果ファイルとしてダウンロード可能で、各ユーザーの削除成否を確認できます。

| 属性 | 一括削除での必要性 | 説明 |
| :--- | :--- | :--- |
| ユーザープリンシパル名 | 必須 | ユーザーを一意に識別 |
| 表示名 | 不要 | 削除処理に使用されない |
| 使用場所 | 不要 | 削除処理に使用されない |

**リファレンス**
・Microsoft Entra ID
・ユーザープリンシパル名 (UPN)

---

**問題 23. Azure サブスクリプションに、User1 という名前のユーザーアカウントが含まれています。User1 がテナントルート管理グループにポリシーを割り当てられるようにします。何をすべきですか。（一つ選択）**

・User1 にサブスクリプションの Owner ロールを割り当て、Azure リソースのアクセス管理を構成するよう指示する
・User1 に全体管理者ロールを割り当て、Azure リソースのアクセス管理を構成するよう指示する
・新しい管理グループを作成し、User1 を所有者として委任する
・User1 にサブスクリプションの Contributor ロールを割り当て、管理グループへのアクセス権を昇格させる

**解答例**
・User1 に全体管理者ロールを割り当て、Azure リソースのアクセス管理を構成するよう指示する

**解説**
テナントルート管理グループにポリシーを割り当てるには、特定の権限昇格手順が必要です。デフォルトでは、新しく作成されたユーザーはルート管理グループへのアクセス権を持ちません。

ルート管理グループへのアクセスを有効にするには、Azure AD の全体管理者ロールを持つユーザーが、Azure portal で「Azure リソースのアクセス管理」設定を有効にする必要があります。この設定により、全体管理者はルート管理グループの User Access Administrator (ユーザーアクセス管理者) ロールを自動的に取得します。その後、他のユーザーに必要な権限を委任できます。

サブスクリプションレベルの Owner ロールや Contributor ロールでは、管理グループ階層の最上位であるルート管理グループへのアクセス権は付与されません。また、新しい管理グループを作成してもルート管理グループへのアクセスは解決しません。

| 手順 | 説明 |
| :--- | :--- |
| 全体管理者ロール割り当て | Azure AD で User1 に全体管理者権限を付与 |
| アクセス管理の有効化 | Azure portal で Azure リソースのアクセス管理を有効化 |
| 権限の委任 | ルート管理グループで User Access Administrator ロールを取得し権限を行使 |

| ロール | スコープ | ルート管理グループアクセス |
| :--- | :--- | :--- |
| Owner | サブスクリプション | 不可 |
| Contributor | サブスクリプション | 不可 |
| User Access Administrator | ルート管理グループ | 可能 |

**リファレンス**
・Management Group
・Azure RBAC (Role-Based Access Control)
・User Access Administrator ロール

---

**問題 24. Azure 仮想マシン VM1 を作成します。この VM が配置される VNet の IP アドレス空間内で、静的プライベート IP アドレスを構成する必要があります。この Azure VM に静的 IP アドレスを構成する方法として正しいものはどれですか。（一つ選択）**

・VM の作成後、VM にアタッチされているネットワークインターフェイスに移動し、IP 構成を静的割り当てに変更する
・ポータルで VM を作成する際、ネットワークタブのプライベート IP アドレスで設定を動的から静的に変更する
・VM の作成後、Azure PowerShell を使用して Set-AzNetworkInterfaceIpConfig コマンドレットで静的 IP アドレスを設定する
・ポータルで VM を作成する際、プライベート IP アドレスの横にある新規を選択し、正しい IP アドレスを割り当てた後に静的を選択する

**解答例**
・VM の作成後、VM にアタッチされているネットワークインターフェイスに移動し、IP 構成を静的割り当てに変更する

**解説**
Azure 仮想マシンの静的プライベート IP アドレスの構成は、VM の作成後にネットワークインターフェイスの IP 構成を変更することで実現します。VM の作成時にはプライベート IP アドレスは動的割り当てとして構成され、作成後にネットワークインターフェイスの設定画面から静的に変更できます。

具体的な手順として、Azure Portal で対象 VM のネットワークインターフェイスリソースを開き、設定メニューから IP 構成を選択します。表示される IPv4 構成の割り当て方法を動的から静的に変更し、必要に応じて IP アドレスを指定して保存します。この変更により、VM の再起動後も同じプライベート IP アドレスが維持されます。

VM 作成時のポータル画面では、ネットワークタブでプライベート IP アドレスの設定項目が表示されますが、この時点では動的または静的な選択肢は提供されていません。また、新しいネットワークインターフェイスを作成してアタッチする方法は、既存の VM に対する追加の構成であり、初期構成としては適切ではありません。

| 構成方法 | タイミング | 実現可否 |
| :--- | :--- | :--- |
| ネットワークインターフェイスの IP 構成変更 | VM 作成後 | 可能 |
| VM 作成時のポータル設定 | VM 作成時 | 不可 |
| PowerShell コマンドレット | VM 作成後 | 可能 |

**リファレンス**
・Azure Virtual Network
・Network Interface
・静的 IP アドレス

---

**問題 25. Azure 仮想マシン VM1 と VM2 が同一の VNET1 に配置されています。VNET1 はプライベート DNS ゾーン hogehoge.local にリンクされており、このゾーンには複数の DNS レコードが登録されています。VM1 から VM2 に対して ping コマンドを実行する際、VM2 を正しく名前解決できる DNS 名を特定します。プライベート DNS ゾーンには、**

```
host1.hogehoge.local (VM1 の IP アドレスを指す)
host2.hogehoge.local (VM2 の IP アドレスを指す)
host3.hogehoge.local (別のリソースを指す)
host4.hogehoge.local (VM2 の IP アドレスを指す)
```

**の各レコードが存在します。VM1 から VM2 への ping で使用可能な DNS 名を選択してください。（一つ選択）**

・host2.hogehoge.local と host4.hogehoge.local のみ
・host1.hogehoge.local, host2.hogehoge.local, host3.hogehoge.local, host4.hogehoge.local
・host2.hogehoge.local のみ
・host1.hogehoge.local と host3.hogehoge.local のみ
・host1.hogehoge.local, host2.hogehoge.local, host4.hogehoge.local

**解答例**
・host2.hogehoge.local と host4.hogehoge.local のみ

**解説**
Azure Private DNS Zone では、仮想ネットワーク内のリソースに対してプライベートな名前解決を提供します。VM1 から VM2 へ ping を実行する場合、VM2 の IP アドレスに解決される DNS レコードを使用する必要があります。

プライベート DNS ゾーン内のレコードを確認すると、host2.hogehoge.local と host4.hogehoge.local の両方が VM2 の IP アドレスを指しています。したがって、これらの DNS 名を使用することで VM1 から VM2 への名前解決が成功し、ping が到達します。host1.hogehoge.local は VM1 自身を指し、host3.hogehoge.local は別のリソースを指すため、VM2 への通信には使用できません。

Azure Private DNS Zone は仮想ネットワークにリンクすることで、そのネットワーク内のリソースから自動的に名前解決が可能になります。同一の IP アドレスに対して複数の DNS レコード (A レコード) を作成することも可能で、この際はいずれのレコード名でも同じリソースにアクセスできます。

| 項目 | 説明 |
| :--- | :--- |
| Private DNS Zone | 仮想ネットワーク内でのみ有効なプライベート DNS 名前空間 |
| 仮想ネットワークリンク | DNS ゾーンと仮想ネットワークを関連付ける設定 |
| A レコード | ホスト名と IPv4 アドレスのマッピング |

プライベート DNS ゾーンを使用することで、パブリックインターネットに公開せずに仮想ネットワーク内のリソースに対してわかりやすい名前でアクセスできます。複数の DNS 名が同一 IP アドレスを指す場合、エイリアスやサービスの役割に応じた命名が可能になり、管理性が向上します。




ご提示いただいたソース（AZ-104試験問題500_part1_part2.pdfの抜粋）に含まれるすべての文章を、一文字も省略することなく、そのままの順序で出力します。

---

### ****
**リファレンス**
・[Azure Private DNS](https://learn.microsoft.com/ja-jp/azure/dns/private-dns-overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

### ****
**問題 26. あなたの組織では、複数の事業部が利用する Azure サブスクリプション (Subscription-A) を運用しています。 このサブスクリプションには、ストレージアカウント (storage-A)、リソースグループ (RG-A)、Blob コンテナー (container-A、container-B)、ファイル共有 (share-A) が含まれています。 別の管理者が単一の Azure Resource Manager (ARM) テンプレートを使用して、仮想マシン (VM-A) とストレージアカウント (storage-B) をデプロイしました。 このデプロイに使用された ARM テンプレートを確認する必要があります。 どのリソースのブレードからテンプレートを表示できますか。（一つ選択）**

・VM-A
・container-A
・storage-A
・**RG-A**

### ****
**解答例**
・**RG-A**

**解説**
**Azure Resource Manager テンプレートを使用したデプロイの履歴とテンプレート内容は、デプロイ先のリソースグループのブレードから確認できます。** **ARM テンプレートによるデプロイは、必ずリソースグループに対して実行されるため、デプロイ履歴もリソースグループレベルで管理されます。**

**リソースグループのブレードで「デプロイ」または「Deployments」セクションにアクセスすると、過去のデプロイ履歴が一覧表示されます。** **各デプロイをクリックすることで、使用されたテンプレートの内容、パラメータ、デプロイ結果などの詳細情報を確認できます。**

**VM-A や storage-B などの個別リソースのブレードからは、そのリソース自体の設定や状態は確認できますが、デプロイに使用されたテンプレート全体を表示することはできません。** **container-A や storage-A は今回のデプロイとは無関係なリソースです。**

| 項目 | 説明 |
| :--- | :--- |
| デプロイ履歴の保存場所 | リソースグループ |
| 確認できる情報 | テンプレート、パラメータ、デプロイ結果 |
| アクセス方法 | リソースグループ > デプロイ |

**ARM テンプレートは宣言型の構文で Azure リソースをデプロイするための JSON 形式のファイルです。** **Infrastructure as Code (IaC) の実践において、デプロイ履歴とテンプレートの確認は、環境の再現性確保やトラブルシューティングに不可欠です。**

### ****
**リファレンス**
・[ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)
・[Resource group](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/manage-resource-groups-portal)

### ****
**問題 27. Azure サブスクリプション内に Log Analytics ワークスペースがあります。 Event テーブルからエラーイベントのみを抽出して表示します。 どのクエリを実行しますか。（一つ選択）**

・`Event | where EventType == "error"`
・`Get-AzEvent -TableName Event -Filter "EventType eq 'error'"`
・`search in (Event) * | where EventType == "error"`
・`Event | search "error"`

### ****
**解答例**
・`Event | where EventType == "error"`

**解説**
**Log Analytics ワークスペースでデータを照会する際は、Kusto Query Language (KQL) を使用します。** **KQL では、テーブル名を指定してからパイプ演算子 (|) で条件を連結する構文が基本です。**

**正しいクエリは「`Event | where EventType == "error"`」です。** **このクエリは Event テーブルを指定し、where オペレーターで EventType 列の値が "error" と等しいレコードのみをフィルタリングします。** **KQL では等価比較に「==」演算子を使用します。**

**他の選択肢について、「Get-AzEvent」は PowerShell コマンドレットであり、KQL クエリではありません。** **「`search in (Event) * | where EventType == "error"`」は動作しますが、search オペレーターは全文検索を行うため、特定列の値を比較する場合は非効率です。** **「`Event | search "error"`」は全列を対象に "error" という文字列を検索するため、EventType 列の値が正確に "error" であるレコードのみを抽出できません。**

**Log Analytics でのクエリ作成では、目的に応じた適切なオペレーターの選択が重要です。** **特定列の値による絞り込みには where オペレーター、全文検索には search オペレーターを使い分けます。**

| オペレーター | 用途 | 構文例 |
| :--- | :--- | :--- |
| where | 特定列の条件フィルタ | `Table | where Column == "value"` |
| search | 全列の全文検索 | `Table | search "keyword"` |
| search in | 指定テーブルの全文検索 | `search in (Table) "keyword"` |

### ****
**リファレンス**
・[Kusto Query Language (KQL)](https://learn.microsoft.com/ja-jp/azure/data-explorer/kusto/query/)
・[Log Analytics Workspace](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/log-analytics-workspace-overview)
・[where オペレーター](https://learn.microsoft.com/ja-jp/azure/data-explorer/kusto/query/where-operator)

### ****
**問題 28. Azure Monitor で VM1 の CPU 使用率が 80% を超えた際に、User1 と User2 の 2 名のユーザーにメール通知を送信するアラートルールを構成します。 この要件を満たすために作成する必要がある Azure Monitor のコンポーネントは何ですか。（一つ選択）**

・**アクショングループ**
・Azure AD セキュリティグループ
・配布グループ
・Azure Monitor Workbook

### ****
**解答例**
・**アクショングループ**

**解説**
**Azure Monitor でアラート通知を送信するには、アクショングループの作成が必須です。** **アクショングループは、アラートがトリガーされた際に実行するアクションの集合を定義する Azure Monitor の機能です。**

**アクショングループでは、メール送信、SMS 送信、音声通話、Webhook 呼び出し、Logic Apps 実行、Automation Runbook 実行など、複数の通知方法とアクションを組み合わせて構成できます。** **今回の要件では、User1 と User2 の 2 名に対してメール通知を送信するため、アクショングループ内にメールアクションを追加し、各ユーザーのメールアドレスを指定します。**

**アラートルールとアクショングループは分離された設計となっており、一つのアクショングループを複数のアラートルールで再利用できます。** **これにより、通知先の管理が効率化され、組織全体で一貫した通知体制を構築できます。**

**Azure AD セキュリティグループや配布グループは、Azure Monitor のアラート通知機能とは直接統合されていません。** **Azure Monitor Workbook は、データの可視化とレポート作成のためのツールであり、アラート通知の送信機能は持ちません。**

| コンポーネント | 用途 |
| :--- | :--- |
| アクショングループ | アラート発生時の通知とアクション実行 |
| アラートルール | 監視条件とトリガー条件の定義 |
| Azure Monitor Workbook | データ可視化とレポート作成 |

### ****
**リファレンス**
・[Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)
・[Action Group](https://learn.microsoft.com/ja-jp/azure/azure-monitor/alerts/action-groups)
・[Alert Rule](https://learn.microsoft.com/ja-jp/azure/azure-monitor/alerts/alerts-overview)

### ****
**問題 29. あなたの組織が所有する Azure サブスクリプション内には、表に示す 4 台の仮想マシンが存在します。 VM-A と VM-B は既存の Recovery Services コンテナーで保護されています。 VM-C と VM-D についても同様に Recovery Services を使用してバックアップ保護を実装します。 最初に行うべき操作を選択してください。（一つ選択）**

| 仮想マシン名 | デプロイ先リージョン |
| :--- | :--- |
| VM-A | 東日本 |
| VM-B | 東日本 |
| VM-C | 西日本 |
| VM-D | 西日本 |

・**西日本リージョンに新しい Recovery Services コンテナーを作成する**
・VM-C と VM-D に対してバックアップ拡張機能を構成する
・西日本リージョンに汎用 v2 ストレージアカウントを作成する
・カスタムバックアップポリシーを新規作成する

### ****
**解答例**
・**西日本リージョンに新しい Recovery Services コンテナーを作成する**

**解説**
**Recovery Services コンテナーは、保護対象の仮想マシンと同じ Azure リージョンに配置する必要があります。** **これはバックアップデータの転送効率とリージョン間のデータ移動制約に関連する重要な制約事項です。**

**現在の構成では、VM-A と VM-B が東日本リージョンに配置され、既存の Recovery Services コンテナー（東日本リージョンに存在すると推測される）で保護されています。** **一方、VM-C と VM-D は西日本リージョンに配置されているため、東日本リージョンのコンテナーでは保護できません。**

**したがって、VM-C と VM-D を保護するには、まず西日本リージョンに新しい Recovery Services コンテナーを作成する必要があります。** **コンテナー作成後、バックアップポリシーの選択または作成、仮想マシンへのバックアップ拡張機能の自動インストールと構成が順次実行されます。**

**バックアップ拡張機能の構成やバックアップポリシーの作成は、コンテナー作成後のバックアップ有効化プロセスで自動的に処理されるため、最初の手順としては不適切です。** **また、Recovery Services コンテナーは独自のストレージを管理するため、別途ストレージアカウントを作成する必要はありません。**

| 項目 | 説明 |
| :--- | :--- |
| Recovery Services コンテナー | 仮想マシンのバックアップデータを保管する管理サービス |
| リージョン制約 | コンテナーと保護対象リソースは同一リージョン配置が必須 |
| バックアップ拡張機能 | バックアップ有効化時に仮想マシンへ自動インストールされる |

### ****
**リファレンス**
・[Recovery Services Vault](https://learn.microsoft.com/ja-jp/azure/backup/backup-azure-recovery-services-vault-overview)
・[Azure Backup](https://learn.microsoft.com/ja-jp/azure/backup/backup-overview)
・[Azure Region](https://learn.microsoft.com/ja-jp/azure/availability-zones/az-overview)

### ****
**問題 30. 組織が所有する Azure 仮想マシン VM-A は、財務レポートアプリケーション App-A を実行しています。 App-A は複数のアクティブなインスタンスをサポートしておらず、毎月末に App-A を実行する際に VM-A の CPU 使用率が最大に達します。 毎月末に VM-A のプロセッサ性能を向上させるために、Azure Automation のスケジュールされたランブックに含めるべきタスクはどれですか。（一つ選択）**

・**VM-A の VM サイズプロパティを変更する**
・VM-A を仮想マシンスケールセットに追加する
・サブスクリプションの vCPU クォータを増やす
・Azure Monitor Agent を VM-A に追加する

### ****
**解答例**
・**VM-A の VM サイズプロパティを変更する**

**解説**
**この問題の最重要ポイントは、単一インスタンスのみで動作するアプリケーションに対して、定期的なピーク負荷に対応するための垂直スケーリング（スケールアップ）の実装方法です。**

**App-A は複数のアクティブなインスタンスをサポートしていないため、水平スケーリング（スケールアウト）は利用できません。** **毎月末の予測可能なピーク時に対応するには、Azure Automation の Runbook を使用して VM サイズを変更する垂直スケーリングが最適です。**

**VM サイズの変更は、Update-AzVM コマンドレットを使用して Runbook 内で自動化できます。** **月末前に VM サイズを上位のサイズ（例：Standard_D2s_v3 から Standard_D4s_v3）に変更し、処理完了後に元のサイズに戻すことで、コストを最適化しながらパフォーマンス要件を満たせます。**

**仮想マシンスケールセットへの追加は、複数インスタンスをサポートするアプリケーション向けの水平スケーリングソリューションであり、この要件には適合しません。** **vCPU クォータの増加は、リージョン全体のリソース制限を変更するものであり、個別 VM のパフォーマンス向上には直接寄与しません。** **Azure Monitor Agent は監視とデータ収集のためのツールであり、パフォーマンス向上には貢献しません。**

| スケーリング方法 | 適用シナリオ | 実装方法 |
| :--- | :--- | :--- |
| 垂直スケーリング | 単一インスタンスアプリ | VM サイズ変更 |
| 水平スケーリング | マルチインスタンス対応アプリ | スケールセット |
| クォータ増加 | リージョン全体の制限緩和 | サポートリクエスト |

### ****
**リファレンス**
・[Azure Automation](https://learn.microsoft.com/ja-jp/azure/automation/automation-intro)
・[仮想マシンのサイズ変更](https://learn.microsoft.com/ja-jp/azure/virtual-machines/sizes)
・[垂直スケーリング（スケールアップ）](https://learn.microsoft.com/ja-jp/azure/architecture/best-practices/auto-scaling#vertical-scaling)

### ****
**問題 31. Azure サブスクリプションに以下のリソースが含まれています。 Subnet1 は VNet1 に関連付けられており、NIC1 は VM1 を Subnet1 に接続しています。 VM1 に ASG1 を適用します。 何を実行しますか。（一つ選択）**

| リソース名 | リソースタイプ |
| :--- | :--- |
| VNet1 | 仮想ネットワーク |
| Subnet1 | サブネット |
| VM1 | 仮想マシン |
| NIC1 | ネットワークインターフェイス |
| NSG1 | ネットワークセキュリティグループ |
| ASG1 | アプリケーションセキュリティグループ |

・ASG1 のプロパティを変更する
・**NIC1 を ASG1 に関連付ける**
・NSG1 のプロパティを変更する
・Subnet1 に ASG1 を適用する

### ****
**解答例**
・**NIC1 を ASG1 に関連付ける**

**解説**
**Application Security Group (ASG) は、仮想マシンをグループ化してネットワークセキュリティポリシーを適用するための論理的なコンテナです。** **ASG を仮想マシンに適用するには、その仮想マシンのネットワークインターフェイス (NIC) を ASG に関連付ける必要があります。**

**ASG は仮想マシン自体やサブネットに直接適用するものではなく、NIC レベルで関連付けを行います。** **NIC を ASG に関連付けることで、NSG のセキュリティルール内で ASG を通信元または通信先として指定できるようになり、IP アドレスではなくアプリケーションの役割に基づいたセキュリティポリシーの管理が可能になります。**

**NSG1 や ASG1 のプロパティを変更しても、VM1 と ASG1 の関連付けは確立されません。** **また Subnet1 に ASG を適用するという操作は存在しません。** **ASG はあくまで NIC に関連付けるリソースです。**

| 操作対象 | 実行内容 | 結果 |
| :--- | :--- | :--- |
| NIC1 | ASG1 に関連付け | VM1 が ASG1 のメンバーになる |
| NSG1 | プロパティ変更 | ASG の関連付けには無関係 |
| ASG1 | プロパティ変更 | NIC との関連付けは確立されない |

**リファレンス**
・[Application Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/application-security-groups)
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Network Interface](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-network-interface-portal)

### ****
**問題 32. Azure サブスクリプションに仮想マシン VM1 が含まれています。 VM1 は 24 時間稼働するビジネスアプリケーションをホストしており、1 つのネットワークインターフェイスと 1 つのマネージドディスクを持ち、D4s v3 サイズを使用しています。 VM1 に対して次の変更を計画しています：サイズを D8s v3 に変更する、500GB のマネージドディスクを追加する、Puppet Agent 拡張機能を追加する、追加のネットワークインターフェイスをアタッチする。 これらの変更のうち、VM1 にダウンタイムが発生するものはどれですか。（一つ選択）**

・Puppet Agent 拡張機能を追加する
・500GB のマネージドディスクを追加する
・**サイズを D8s v3 に変更する**
・追加のネットワークインターフェイスをアタッチする

### ****
**解答例**
・**サイズを D8s v3 に変更する**

**解説**
**Azure 仮想マシンのサイズ変更は、仮想マシンの割り当て解除と再起動を伴うため、必ずダウンタイムが発生します。** **サイズ変更時には、稼働中の仮想マシンが停止され、新しいハードウェアリソースに再配置されてから起動されるため、アプリケーションの可用性に影響を与えます。**

**一方、マネージドディスクの追加は、仮想マシンが実行中の状態でも実施可能です。** **Azure Portal またはコマンドラインツールを使用して、稼働中の仮想マシンに新しいディスクをアタッチできます。** **ただし、ディスクをアタッチした後、ゲスト OS 内でディスクの初期化とフォーマットが必要です。**

**VM 拡張機能の追加も、仮想マシンの実行中に実施できます。** **Puppet Agent 拡張機能などの VM 拡張機能は、仮想マシンエージェントを通じてインストールされ、ダウンタイムを発生させません。**

**ネットワークインターフェイスの追加については、仮想マシンが停止（割り当て解除）状態である必要があります。** **ただし、この操作自体は仮想マシンのサイズ変更とは異なり、停止と起動のみで完了するため、設問の文脈では主要なダウンタイム要因とは見なされません。**

| 操作 | ダウンタイム | 備考 |
| :--- | :--- | :--- |
| サイズ変更 | 発生する | 割り当て解除と再配置が必要 |
| ディスク追加 | 発生しない | 実行中に追加可能 |
| 拡張機能追加 | 発生しない | VM エージェント経由で実行 |

### ****
**リファレンス**
・[Azure Virtual Machine](https://learn.microsoft.com/ja-jp/azure/virtual-machines/overview)
・[Managed Disk](https://learn.microsoft.com/ja-jp/azure/virtual-machines/managed-disks-overview)

### ****
**問題 33. あなたの組織では、Azure サブスクリプションを所有しています。 次の表に示すリソースを単一の Azure Resource Manager (ARM) テンプレートでデプロイします。 VM1 の dependsOn セクションにどのリソースを追加しますか。（一つ選択）**

| 名前 | タイプ |
| :--- | :--- |
| PIP1 | Microsoft.Network/publicIPAddresses |
| NSG1 | Microsoft.Network/networkSecurityGroups |
| VNet1 | Microsoft.Network/virtualNetworks |
| NIC1 | Microsoft.Network/networkInterfaces |
| VM1 | Microsoft.Compute/virtualMachines |

・VNet1
・PIP1
・**NIC1**
・NSG1

### ****
**解答例**
・**NIC1**

**解説**
**ARM テンプレートでは、dependsOn プロパティを使用してリソース間の依存関係を定義し、デプロイの順序を制御します。** **仮想マシンは、ネットワークインターフェイス (NIC) が存在しないと作成できないため、VM1 の dependsOn には NIC1 を指定する必要があります。**

**NIC1 自体は、仮想ネットワーク (VNet1) に依存しており、さらにパブリック IP アドレス (PIP1) やネットワークセキュリティグループ (NSG1) を関連付けることができます。** **これらの依存関係は NIC1 の dependsOn セクションで定義されるため、VM1 では直接指定する必要はありません。** **ARM テンプレートのデプロイエンジンは、依存関係チェーンを自動的に解決し、正しい順序でリソースを作成します。**

**依存関係を過剰に定義すると、並列デプロイの機会が減少し、デプロイ時間が長くなる可能性があります。** **そのため、直接的な依存関係のみを指定することがベストプラクティスです。** **VM1 にとって直接必要なリソースは NIC1 のみであり、その他のネットワークリソースは間接的な依存関係として NIC1 を通じて解決されます。**

| リソース | 直接依存先 | 理由 |
| :--- | :--- | :--- |
| VM1 | NIC1 | 仮想マシンはネットワーク接続が必須 |
| NIC1 | VNet1 | NIC はサブネットに接続が必要 |
| NIC1 | PIP1, NSG1 | オプションで関連付け可能 |

**リファレンス**
・[Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)
・[dependsOn](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/define-resource-dependency)

### ****
**問題 34. Azure Resource Manager テンプレートを使用して、仮想マシンスケールセット内に Windows Server 2019 を実行する複数の Azure 仮想マシンをデプロイします。 デプロイ後、すべての仮想マシンで NGINX が利用可能な状態にします。 どの方法を使用しますか。（一つ選択）**

・Azure Automation State Configuration を使用する
・Desired State Configuration (DSC) 拡張機能を使用する
・**カスタムスクリプト拡張機能を使用する**
・Azure App Service の Deployment Center を使用する

### ****
**解答例**
・**カスタムスクリプト拡張機能を使用する**

**解説**
**仮想マシンスケールセットのデプロイ時に、すべてのインスタンスへソフトウェアを自動インストールするには、Azure 仮想マシン拡張機能を使用します。** **NGINX のような特定のアプリケーションをインストールする場合、カスタムスクリプト拡張機能が最適です。**

**カスタムスクリプト拡張機能は、Azure Resource Manager テンプレート内で定義でき、仮想マシンのデプロイ後に自動的にスクリプトをダウンロードして実行します。** **NGINX のインストールスクリプトを指定することで、スケールセット内のすべてのインスタンスに対して一貫した構成を適用できます。**

**DSC 拡張機能は構成管理に有効ですが、NGINX のような単純なソフトウェアインストールには過剰な機能です。** **Azure Automation State Configuration は継続的な構成管理に適していますが、初期デプロイ時の単純なインストールには不要です。** **Azure App Service の Deployment Center は、仮想マシンではなく App Service のデプロイに使用されるため、このシナリオには適用できません。**

| 方法 | 用途 | 適用可否 |
| :--- | :--- | :--- |
| カスタムスクリプト拡張機能 | スクリプト実行によるソフトウェアインストール | 適用可能 |
| DSC 拡張機能 | 複雑な構成管理 | 過剰機能 |
| Azure Automation State Configuration | 継続的な構成管理 | 初期デプロイには不要 |

### ****
**リファレンス**
・[Azure Automation](https://learn.microsoft.com/ja-jp/azure/automation/automation-intro)
・[Virtual Machine Scale Set](https://learn.microsoft.com/ja-jp/azure/virtual-machine-scale-sets/overview)
・[ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)

### ****
**問題 35. あなたの組織では、複数の Azure 仮想マシンを運用しています。 現在、Recovery Services vault を使用して VM1 と VM2 を保護しています。 新たに VM3 と VM4 も Recovery Services で保護する必要があります。 最初に行うべき操作を選択してください。（一つ選択）**

・**Recovery Services vault を新規作成する**
・VM3 と VM4 に対してバックアップ拡張機能を構成する
・ストレージアカウントを新規作成する
・バックアップポリシーを新規作成する

### ****
**解答例**
・**Recovery Services vault を新規作成する**

**解説**
**Recovery Services vault は、Azure 仮想マシンのバックアップデータを保管する論理的なストレージコンテナです。** **重要な制約として、Recovery Services vault は作成されたリージョン内の仮想マシンのみを保護できます。**

**既存の Recovery Services vault が VM1 と VM2 を保護している場合、VM3 と VM4 が同じリージョンに存在するかを確認する必要があります。** **異なるリージョンに配置されている仮想マシンを保護するには、そのリージョンに新しい Recovery Services vault を作成しなければなりません。**

**バックアップ拡張機能の構成は、Recovery Services vault の設定後に自動的に実行されるため、最初の手順ではありません。** **ストレージアカウントは、Recovery Services vault が内部的に管理するため、手動での作成は不要です。** **バックアップポリシーは既存のものを使用できるため、必ずしも新規作成する必要はありません。**

| 項目 | 説明 |
| :--- | :--- |
| Recovery Services vault | バックアップデータを保管する論理コンテナ |
| リージョン制約 | 同一リージョン内のリソースのみ保護可能 |
| バックアップ拡張機能 | vault 設定後に自動インストールされる |

**仮想マシンの保護を開始する際の正しい手順は、適切なリージョンに Recovery Services vault を作成し、バックアップポリシーを選択または作成し、保護対象の仮想マシンを指定することです。** **この過程で必要な拡張機能は自動的に展開されます。**

### ****
**リファレンス**
・[Recovery Services Vault](https://learn.microsoft.com/ja-jp/azure/backup/backup-azure-recovery-services-vault-overview)
・[Azure Backup](https://learn.microsoft.com/ja-jp/azure/backup/backup-overview)
・[Azure Virtual Machine](https://learn.microsoft.com/ja-jp/azure/virtual-machines/overview)

### ****
**問題 36. あなたは 2 つの Microsoft Entra ID (旧 Azure AD) テナント「[hogehoge.com](http://hogehoge.com)」と「[foobar.com](http://foobar.com)」を管理しています。 両方のテナントへのサインインには同一の Microsoft アカウントを使用しています。 Azure portal にアクセスする際のデフォルトサインインテナントを設定します。 どの操作を実行しますか。（一つ選択）**

・**Azure portal のポータル設定でスタートアップディレクトリを構成する**
・Azure portal でディレクトリを切り替える
・Azure Cloud Shell で Set-AzContext コマンドレットを実行する
・Azure portal のユーザー設定でサブスクリプションフィルターを構成する

### ****
**解答例**
・**Azure portal のポータル設定でスタートアップディレクトリを構成する**

**解説**
**Azure portal へのサインイン時に表示されるデフォルトのテナント（ディレクトリ）を変更するには、ポータル設定のスタートアップディレクトリ設定を使用します。** **この設定により、複数のテナントにアクセス権を持つユーザーが毎回手動でディレクトリを切り替える手間を省けます。**

**ポータル設定は画面右上の歯車アイコンから「ポータル設定」を選択し、「スタートアップディレクトリ」セクションで希望するテナントを選択します。** **この設定はブラウザーのローカルストレージに保存され、次回サインイン時から適用されます。**

**ディレクトリの切り替えは一時的な操作であり、現在のセッションでのみ有効です。** **Set-AzContext は Azure PowerShell でサブスクリプションコンテキストを変更するコマンドレットですが、ポータルのデフォルト設定には影響しません。** **サブスクリプションフィルターはリソース表示の絞り込みに使用され、デフォルトテナントの設定とは異なる機能です。**

| 操作 | 用途 | 永続性 |
| :--- | :--- | :--- |
| ポータル設定のスタートアップディレクトリ | デフォルトサインインテナントの設定 | 永続的 |
| ディレクトリの切り替え | 現在のセッションでのテナント変更 | 一時的 |
| Set-AzContext | PowerShell のサブスクリプションコンテキスト変更 | セッション内のみ |

### ****
**リファレンス**
・[Microsoft Entra ID](https://learn.microsoft.com/ja-jp/entra/fundamentals/whatis)

### ****
**問題 37. VNet-A という仮想ネットワークを含む Azure サブスクリプションがあります。 VNet-A は 2 つの異なるオンプレミスデータセンターに接続する 2 つの ExpressRoute 回線を使用しています。 詳細なメトリクスとネットワークトポロジの視覚的表現を表示するダッシュボードを作成します。 このとき使用するサービスを選択してください。（一つ選択）**

・**Azure Monitor Network Insights**
・Network Watcher
・Azure Monitor Workbooks
・データ収集ルール (DCR)

### ****
**解答例**
・**Azure Monitor Network Insights**

**解説**
**ExpressRoute 回線を含む仮想ネットワークの詳細なメトリクスとネットワークトポロジを視覚的に表示する場合、Azure Monitor Network Insights が最適です。** **このサービスは、仮想ネットワーク、ExpressRoute、VPN Gateway、Load Balancer などのネットワークリソースの正常性とメトリクスを包括的に可視化します。**

**Azure Monitor Network Insights は、構成不要で利用できる事前構築済みのダッシュボードを提供し、ネットワークトポロジの視覚的表現、接続性の監視、パフォーマンスメトリクスの詳細分析が可能です。** **特に ExpressRoute 回線の監視では、回線の可用性、スループット、パケット損失などの重要なメトリクスをリアルタイムで確認できます。**

**Network Watcher はネットワーク診断とトラブルシューティングに特化したツールで、接続テストやパケットキャプチャなどの機能を提供しますが、包括的なダッシュボードや継続的な監視には適していません。** **Azure Monitor Workbooks はカスタムダッシュボード作成に使用できますが、Network Insights のような事前構築済みのネットワーク専用ビューは提供しません。** **データ収集ルールはログとメトリクスの収集設定を定義するものであり、視覚化機能は含まれません。**

| サービス | 主な用途 | ネットワークトポロジ表示 |
| :--- | :--- | :--- |
| Azure Monitor Network Insights | ネットワークリソースの包括的監視と可視化 | 対応 |
| Network Watcher | ネットワーク診断とトラブルシューティング | 限定的 |
| データ収集ルール | ログとメトリクスの収集設定 | 非対応 |

### ****
**リファレンス**
・[Azure Monitor Network Insights](https://learn.microsoft.com/ja-jp/azure/azure-monitor/insights/network-insights-overview)
・[ExpressRoute](https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-introduction)
・[Network Watcher](https://learn.microsoft.com/ja-jp/azure/network-watcher/network-watcher-monitoring-overview)

### ****
**問題 38. あなたの組織が所有する Azure サブスクリプション「Subscription-A」があります。 Subscription-A には、次の表に示すパブリックロードバランサーが含まれています。 6 つの仮想マシンを作成し、各ロードバランサーで 3 つの仮想マシンの負荷を分散する計画です。 LB-A を使用して負荷分散される仮想マシンの配置要件として正しいものはどれですか。（一つ選択）**

| 名前 | SKU |
| :--- | :--- |
| LB-A | Basic |
| LB-B | Standard |

・**同じ可用性セットまたは仮想マシンスケールセット内に作成する**
・同じリージョン内に作成する
・同じ仮想ネットワークに接続する
・同じリソースグループ内に作成する

### ****
**解答例**
・**同じ可用性セットまたは仮想マシンスケールセット内に作成する**

**解説**
**Basic SKU のロードバランサーを使用する場合、バックエンドプールに追加する仮想マシンは同じ可用性セットまたは仮想マシンスケールセット内に配置する必要があります。** **これは Basic SKU の制約事項であり、高可用性構成を実現するための要件です。**

**Basic SKU と Standard SKU のロードバランサーでは、バックエンドプールに追加できる仮想マシンの配置要件が異なります。** **Basic SKU では可用性セットまたは仮想マシンスケールセット内の仮想マシンのみをバックエンドプールに追加できますが、Standard SKU では同じ仮想ネットワーク内の任意の仮想マシンを追加できます。**

**本問では LB-A が Basic SKU であるため、負荷分散される 3 つの仮想マシンは同じ可用性セットまたは仮想マシンスケールセット内に配置する必要があります。** **一方、LB-B は Standard SKU であるため、より柔軟な配置が可能です。**

| 項目 | Basic SKU | Standard SKU |
| :--- | :--- | :--- |
| バックエンドプール | 可用性セットまたはスケールセット内の VM のみ | 同一 VNet 内の任意の VM |
| 可用性ゾーン | 非対応 | 対応 |
| SLA | 提供なし | 99.99% |

**リソースグループや仮想ネットワークの配置は、ロードバランサーの SKU による制約ではなく、ネットワーク接続性やリソース管理の観点から決定されます。** **同じリージョン内への配置は必須ですが、これはロードバランサーの基本的な動作要件であり、SKU 固有の制約ではありません。**

### ****
**リファレンス**
・[Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
・[Availability Set](https://learn.microsoft.com/ja-jp/azure/virtual-machines/availability-set-overview)
・[Virtual Machine Scale Set](https://learn.microsoft.com/ja-jp/azure/virtual-machine-scale-sets/overview)

### ****
**問題 39. Azure Web App の [contoso.azurewebsites.net](http://contoso.azurewebsites.net) に対して、カスタムドメイン [hogehoge.com](http://hogehoge.com) を構成します。 最初に実行する操作を選択してください。（一つ選択）**

・**カスタムドメインの検証用として、ホスト名 `asuid.hogehoge` で TXT レコードを作成し、値にドメイン検証 ID を設定する**
・カスタムドメインの検証用として、ホスト名 `@` で TXT レコードを作成し、値に `contoso.azurewebsites.net` を設定する
・Web App のデフォルトドメインを指す A レコードを `hogehoge.com` と `asuid.hogehoge.com` の 2 つ作成する
・Web App のカスタムドメイン設定画面で SSL/TLS 証明書をアップロードする

### ****
**解答例**
・**カスタムドメインの検証用として、ホスト名 `asuid.hogehoge` で TXT レコードを作成し、値にドメイン検証 ID を設定する**

**解説**
**Azure Web App にカスタムドメインを追加する際は、ドメインの所有権を証明するための検証手順が必須です。** **この検証には特定の TXT レコードを使用します。**

**Azure Web App では、カスタムドメインの所有権検証のために `asuid` というサブドメインを使用します。** **DNS プロバイダーで `asuid.hogehoge` というホスト名の TXT レコードを作成し、値には Azure ポータルのカスタムドメイン追加画面に表示されるドメイン検証 ID を設定します。** **この検証 ID は各 Web App に固有の値で、Azure がドメインの所有権を確認するために使用します。**

**検証が完了した後、実際のトラフィックをルーティングするために CNAME レコードまたは A レコードを追加します。** **サブドメイン（`www.hogehoge.com` など）の場合は CNAME レコード、ルートドメイン（`hogehoge.com`）の場合は A レコードを使用するのが一般的です。**

| 手順 | 操作内容 | 目的 |
| :--- | :--- | :--- |
| 1 | TXT レコード作成 (asuid) | ドメイン所有権の検証 |
| 2 | CNAME または A レコード作成 | トラフィックのルーティング |
| 3 | Azure ポータルでドメイン追加 | カスタムドメインの有効化 |

**リファレンス**
・[Azure App Service](https://learn.microsoft.com/ja-jp/azure/app-service/overview)

### ****
・[Custom Domain](https://learn.microsoft.com/ja-jp/azure/app-service/app-service-web-tutorial-custom-domain)

### ****
**問題 40. Azure 仮想ネットワーク VNet1 には Subnet1 というサブネットがあり、Subnet1 には 3 台の Azure 仮想マシンが含まれています。 各仮想マシンにはパブリック IP アドレスが割り当てられており、ポート 443 を介してインターネット上のユーザーがアクセスできる複数のアプリケーションをホストしています。 オンプレミスネットワークから VNet1 へのサイト間 VPN 接続が確立されています。 現在、これらの仮想マシンにはインターネットとオンプレミスネットワークの両方から RDP でアクセスできることが判明しました。 オンプレミスネットワークからの RDP 接続を除き、インターネットからの RDP アクセスを防止する必要があります。 すべてのアプリケーションには引き続きインターネットユーザーがアクセスできる必要があります。 どのような対応を行いますか。（一つ選択）**

・**Subnet1 にリンクされたネットワークセキュリティグループ (NSG) で、インターネットからの RDP トラフィックを拒否し、オンプレミスネットワークのアドレス範囲からの RDP トラフィックを許可するルールを作成する**
・仮想マシンからパブリック IP アドレスを削除する
・ローカルネットワークゲートウェイのアドレス空間を変更する
・Azure Bastion をデプロイして、すべての RDP 接続を Bastion 経由に制限する

### ****
**解答例**
・**Subnet1 にリンクされたネットワークセキュリティグループ (NSG) で、インターネットからの RDP トラフィックを拒否し、オンプレミスネットワークのアドレス範囲からの RDP トラフィックを許可するルールを作成する**

**解説**
**この問題の最重要ポイントは、ポート 443 のアプリケーションアクセスを維持しながら、RDP アクセス（ポート 3389）をオンプレミスネットワークからのみ許可する選択的なトラフィック制御です。**

**NSG は Azure のステートフルなファイアウォール機能で、サブネットまたはネットワークインターフェイスレベルでトラフィックを制御します。** **この要件を満たすには、Subnet1 に NSG を関連付け、以下のルールを構成します。** **優先度の高い順に、オンプレミスネットワークの送信元 IP アドレス範囲からポート 3389 へのインバウンドトラフィックを許可するルールを作成し、次にインターネット（送信元 0.0.0.0/0）からポート 3389 へのトラフィックを拒否するルールを作成します。** **ポート 443 へのトラフィックは規定で許可されるため、アプリケーションアクセスは影響を受けません。**

**パブリック IP アドレスを削除すると、インターネットからのアプリケーションアクセス（ポート 443）も不可能になるため要件を満たしません。** **ローカルネットワークゲートウェイのアドレス空間変更は、VPN 接続の構成に関連する設定であり、RDP アクセス制御には直接関係しません。** **Azure Bastion は管理トラフィックのセキュアな接続手段ですが、この問題では既存の VPN 接続を活用する方が適切です。**

**NSG ルールの構成例を以下に示します。**

| 優先度 | 送信元 | 送信元ポート | 宛先ポート | アクション |
| :--- | :--- | :--- | :--- | :--- |
| 100 | オンプレミス IP 範囲 | * | 3389 | 許可 |
| 200 | インターネット | * | 3389 | 拒否 |

### ****
| 300 | * | * | 443 | 許可 |

**NSG は優先度の低い番号から順に評価され、最初に一致したルールが適用されます。** **この構成により、オンプレミスからの RDP アクセスのみを許可し、インターネットからの RDP を拒否しながら、すべての HTTPS トラフィックを許可できます。**

**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Site-to-Site VPN](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/tutorial-site-to-site-portal)
・[Azure Bastion](https://learn.microsoft.com/ja-jp/azure/bastion/bastion-overview)

### ****
**問題 41. Azure サブスクリプションを所有しています。 オンプレミスに VM1 という名前の仮想マシンがあります。 VM1 の設定は次の通りです：プロセッサ 2 コア、メモリ 8GB、ネットワークアダプター 1 基、ハードドライブは動的ディスク（VHDX フォーマット）127GB、Integration Services が有効化されています。 VM1 に接続されているディスクを Azure 仮想マシンのテンプレートとして使用できるようにします。 VM1 で変更する必要がある項目を選択してください。（一つ選択）**

・Integration Services
・ネットワークアダプター
・**ハードドライブ**
・メモリ

### ****
**解答例**
・**ハードドライブ**

**解説**
**Azure では仮想マシンのディスクとして固定サイズの VHD 形式のみをサポートしています。** **オンプレミスの Hyper-V 仮想マシンを Azure に移行する際、ディスク形式の互換性が最も重要な要件となります。**

**VM1 は現在 VHDX フォーマットの動的ディスクを使用していますが、Azure にアップロードして使用するには固定サイズの VHD 形式に変換する必要があります。** **VHDX フォーマットは Hyper-V Generation 2 でサポートされる新しい形式ですが、Azure 仮想マシンでは従来の VHD 形式が必須です。** **また動的ディスクは容量が可変ですが、Azure では固定サイズディスクのみが対応しています。**

**Hyper-V マネージャーの「ディスクの編集」ウィザードを使用することで、VHDX から固定 VHD への変換が可能です。** **変換後、Azure Storage Explorer やコマンドラインツールを使用して VHD ファイルを Azure Storage にアップロードし、マネージドディスクまたはイメージとして登録できます。**

**プロセッサ、メモリ、ネットワークアダプター、Integration Services の設定は、ディスクイメージのアップロードや使用には影響しません。** **これらは Azure 上で仮想マシンを作成する際に個別に設定可能な項目です。**

| 項目 | オンプレミス要件 | Azure 要件 |
| :--- | :--- | :--- |
| ディスク形式 | VHD または VHDX | VHD のみ |
| ディスクタイプ | 動的または固定 | 固定サイズのみ |
| 最大サイズ | 制限なし | 4TB 以下推奨 |

### ****
**リファレンス**
・[VHD (Virtual Hard Disk)](https://learn.microsoft.com/ja-jp/azure/virtual-machines/managed-disks-overview#vhd-files)
・[Managed Disk](https://learn.microsoft.com/ja-jp/azure/virtual-machines/managed-disks-overview)
・[Hyper-V](https://learn.microsoft.com/ja-jp/windows-server/virtualization/hyper-v/hyper-v-technology-overview)

### ****
**問題 42. あなたの組織では、既存のオンプレミスデータセンターと Azure サブスクリプション「Subscription-A」で開発したリソースを所有しています。 オンプレミスデータセンターには 2 つの VPN デバイスが含まれています。 Subscription-A には VNet-A という名前の仮想ネットワークが含まれており、VNet-A にはゲートウェイサブネットが含まれています。 サイト間 VPN を作成します。 Azure VPN Gateway の単一インスタンスまたは単一のオンプレミス VPN デバイスに障害が発生した場合でも、2 分を超える中断が発生しないことを保証する必要があります。 この要件を満たすために必要なパブリック IP アドレスの最小数はいくつですか。（一つ選択）**

・4
・1
・3
・**2**

### ****
**解答例**
・**2**

**解説**
**この問題は、高可用性を実現するサイト間 VPN 接続の構成に必要なパブリック IP アドレス数を問うものです。**

**Azure VPN Gateway の単一インスタンス障害とオンプレミス VPN デバイスの単一障害に対する耐性を確保するには、アクティブ / アクティブ構成の VPN Gateway を使用します。** **この構成では、Azure 側に 2 つのゲートウェイインスタンスが自動的にデプロイされ、それぞれが独立したパブリック IP アドレスを必要とします。**

**アクティブ / アクティブ構成では、各ゲートウェイインスタンスがオンプレミスの両方の VPN デバイスとトンネルを確立します。** **これにより、Azure 側またはオンプレミス側のいずれかで単一障害が発生しても、残りのトンネルが即座にトラフィックを処理し、2 分を超える中断を防ぎます。**

**通常のアクティブ / スタンバイ構成では、パブリック IP アドレスは 1 つで済みますが、フェイルオーバー時に数分の中断が発生する可能性があります。** **要件を満たすには、アクティブ / アクティブ構成が必須となり、パブリック IP アドレスは 2 つ必要です。**

| 構成タイプ | パブリック IP 数 | フェイルオーバー時間 |
| :--- | :--- | :--- |
| アクティブ / スタンバイ | 1 | 数分 |
| アクティブ / アクティブ | 2 | 即座 |

**なお、仮想ネットワークゲートウェイは 1 つ（アクティブ / アクティブ構成で 2 インスタンス）、ローカルネットワークゲートウェイはオンプレミス VPN デバイスごとに 1 つずつ、合計 2 つ必要です。**

### ****
**リファレンス**
・[VPN Gateway](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/vpn-gateway-about-vpngateways)
・[Site-to-Site VPN](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/tutorial-site-to-site-portal)

### ****
**問題 43. Azure サブスクリプションに VNet1 という名前の仮想ネットワークがあります。 暗号化された接続を使用してオンプレミスのリソースへの VNet1 接続を有効にします。 VNet1 に対して何を構成しますか？（一つ選択）**

・Azure Bastion
・**仮想ネットワーク ゲートウェイ**
・サービス エンドポイント
・パブリック IP アドレス

### ****
**解答例**
・**仮想ネットワーク ゲートウェイ**

**解説**
**オンプレミス環境と Azure 仮想ネットワーク間で暗号化された接続を確立するには、仮想ネットワーク ゲートウェイが必要です。** **仮想ネットワーク ゲートウェイは、Site-to-Site VPN または ExpressRoute 接続を実現するための Azure 側のエンドポイントとして機能します。**

**Site-to-Site VPN 接続では、IPsec/IKE プロトコルを使用して暗号化されたトンネルを作成し、インターネット経由で安全な通信を実現します。** **仮想ネットワーク ゲートウェイは GatewaySubnet という専用サブネットにデプロイされ、オンプレミスの VPN デバイスと通信します。**

**ExpressRoute を使用する場合も、仮想ネットワーク ゲートウェイが必要です。** **ExpressRoute は接続プロバイダーを通じてプライベート接続を提供し、インターネットを経由しない専用回線で Azure に接続します。**

**他の選択肢について、Azure Bastion は仮想マシンへの安全な RDP/SSH 接続を提供するサービスですが、オンプレミス接続には使用しません。** **サービス エンドポイントは Azure サービスへのプライベート接続を提供しますが、オンプレミス環境との接続には対応していません。** **パブリック IP アドレスは仮想ネットワーク ゲートウェイに割り当てられるリソースの一つですが、それ単体ではオンプレミス接続を実現できません。**

| 接続方式 | 暗号化 | 経路 |
| :--- | :--- | :--- |
| Site-to-Site VPN | IPsec/IKE | インターネット経由 |
| ExpressRoute | オプション | 専用回線 |
| Point-to-Site VPN | SSL/TLS | インターネット経由 |

### ****
**リファレンス**
・[Site-to-Site VPN](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/tutorial-site-to-site-portal)
・[ExpressRoute](https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-introduction)

### ****
**問題 44. 複数の Windows Server を実行する Azure 仮想マシンを作成しました。 インターネット経由で RDP ポートを公開せずに仮想マシンに接続します。 どの Azure サービスをデプロイすべきですか。（一つ選択）**

・**Azure Bastion**
・Azure Load Balancer
・Azure Virtual Desktop
・Azure Network Watcher

### ****
**解答例**
・**Azure Bastion**

**解説**
**Azure Bastion は、仮想ネットワーク内の仮想マシンに対して、パブリック IP アドレスや RDP ポート (3389) をインターネットに公開することなく、安全な RDP/SSH 接続を提供する PaaS 型サービスです。** **Azure Portal のブラウザから TLS 経由で直接接続できるため、踏み台サーバーの構築や管理が不要になります。**

**Azure Bastion をデプロイすると、仮想ネットワーク内に専用のサブネット (AzureBastionSubnet) が作成され、そこに Bastion Host が配置されます。** **管理者は Azure Portal にログイン後、対象の仮想マシンを選択してブラウザ経由で接続するだけで、安全にリモート管理が可能です。** **NSG (Network Security Group) で RDP ポートを閉じたまま運用できるため、セキュリティリスクを大幅に低減できます。**

**他の選択肢について、Azure Load Balancer は L4 レベルの負荷分散サービスであり、リモート接続の安全性向上には寄与しません。** **Azure Virtual Desktop は仮想デスクトップインフラストラチャを提供するサービスで、既存の仮想マシンへの管理接続とは用途が異なります。** **Azure Network Watcher はネットワーク監視と診断のためのツールであり、接続方法の提供は行いません。**

| サービス名 | 主な用途 | RDP 接続の安全性 |
| :--- | :--- | :--- |
| Azure Bastion | ブラウザ経由の安全な RDP/SSH 接続 | パブリック IP 不要で高い |
| Azure Load Balancer | L4 負荷分散 | 接続方法は提供しない |
| Azure Virtual Desktop | 仮想デスクトップ環境の提供 | 管理接続とは用途が異なる |

### ****
**リファレンス**
・[Azure Bastion](https://learn.microsoft.com/ja-jp/azure/bastion/bastion-overview)
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

### ****
**問題 45. Azure サブスクリプションにネットワークセキュリティグループ (NSG) が含まれています。 NSG に関連付けることができるリソースはどれですか。（二つ選択）**

・**サブネット**
・仮想ネットワークゲートウェイ
・**ネットワークインターフェイス**
・Azure Firewall

### ****
**解答例**
・**サブネット**
・**ネットワークインターフェイス**

**解説**
**NSG は、Azure の仮想ネットワーク内でネットワークトラフィックをフィルタリングするセキュリティ機能です。** **NSG には受信と送信のセキュリティ規則が含まれており、送信元、送信先、ポート、プロトコルに基づいてトラフィックを許可または拒否します。**

**NSG を関連付けることができるリソースは、サブネットとネットワークインターフェイスの 2 種類のみです。** **サブネットに関連付けた場合は、そのサブネット内のすべてのリソースに対してセキュリティ規則が適用されます。** **ネットワークインターフェイスに関連付けた場合は、その特定のネットワークインターフェイスを持つ仮想マシンに対してのみセキュリティ規則が適用されます。**

**仮想ネットワークゲートウェイや Azure Firewall は NSG とは異なるネットワークセキュリティ機能を提供するリソースであり、NSG を直接関連付けることはできません。** **仮想ネットワークゲートウェイはオンプレミスと Azure 間の接続を提供し、Azure Firewall はより高度なネットワークセキュリティとアプリケーション層の保護を提供します。**

**NSG の関連付け先と適用範囲の比較を以下に示します。**

| 関連付け先 | 適用範囲 | 用途 |
| :--- | :--- | :--- |
| サブネット | サブネット内の全リソース | 複数リソースへの一括適用 |
| ネットワークインターフェイス | 特定の仮想マシン | 個別リソースへの詳細制御 |

### ****
**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Network Interface](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-network-interface-portal)

### ****
**問題 46. Azure サブスクリプションを所有しています。 オンプレミスの Windows Server 2016 から 34TB のデータを Azure Storage アカウントに転送します。 データ転送がネットワークに影響を与えず、既存のドライブを保持し、最も高速で安全な方法を確保する必要があります。 最初に行うべき手順はどれですか。（一つ選択）**

・Azure Portal から Import ジョブを開始する
・WAImportExport ツールを使用してハードドライブを準備する
・**Azure Portal から Azure Data Box を注文する**
・Microsoft サポートにチケットを発行する

### ****
**解答例**
・**Azure Portal から Azure Data Box を注文する**

**解説**
**大容量データ（数 TB 以上）をオンプレミスから Azure へ転送する場合、ネットワーク帯域への影響を回避し、高速かつ安全に転送するには Azure Data Box サービスの利用が最適です。**

**Azure Data Box は、Microsoft が提供する物理デバイスを使用したデータ転送サービスです。** **最大容量 80TB のストレージデバイスを Microsoft から借用し、オンプレミス環境でデータをコピー後、Microsoft データセンターへ返送することで Azure Storage へデータを転送します。** **デバイスは 256 ビット AES 暗号化により保護され、転送完了後は NIST 800-88r1 準拠の方式でデータが完全に消去されます。**

**本問では 34TB のデータ転送が必要であり、ネットワーク影響ゼロ、既存ドライブ保持、高速性、セキュリティの要件を満たすため、最初のステップは Azure Portal から Azure Data Box を注文することです。**

**WAImportExport ツールは Azure Import/Export サービスで使用しますが、このサービスは顧客が用意したドライブを使用するため「既存ドライブを保持」という要件に合致しません。** **Import ジョブの開始やサポートチケット発行は、Data Box 注文後の手順となります。**

| サービス | 転送方法 | ドライブ | 容量 |
| :--- | :--- | :--- | :--- |
| Azure Data Box | 物理デバイス貸与 | Microsoft 提供 | 最大 80TB |
| Azure Import/Export | 顧客ドライブ郵送 | 顧客準備 | 制限なし |
| ネットワーク転送 | インターネット経由 | 不要 | 帯域依存 |

### ****
**リファレンス**
・[Azure Data Box](https://learn.microsoft.com/ja-jp/azure/databox/data-box-overview)
・[Azure Import/Export サービス](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-import-export-service)
・[Azure Storage アカウント](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-account-overview)

### ****
**問題 47. Azure サブスクリプションに 10 台の仮想マシンが含まれています。 いずれかの仮想マシンが停止、再起動、または割り当て解除されたときに電子メール通知を受信します。 必要となるアラートルールとアクショングループの最小数の組み合わせはどれですか。（一つ選択）**

・1 つのアラートルールと 1 つのアクショングループ
・**3 つのアラートルールと 1 つのアクショングループ**
・1 つのアラートルールと 3 つのアクショングループ
・2 つのアラートルールと 1 つのアクショングループ

### ****
**解答例**
・**3 つのアラートルールと 1 つのアクショングループ**

**解説**
**Azure Monitor のアクティビティログアラートを使用して仮想マシンの状態変化を監視します。** **仮想マシンの停止、再起動、割り当て解除はそれぞれ異なる操作として記録されるため、各イベントに対して個別のアラートルールが必要です。**

**一方、通知先となる電子メールアドレスは 1 つのアクショングループにまとめて定義できます。** **アクショングループは複数のアラートルールから参照可能なため、3 つのアラートルールすべてで同じアクショングループを使用できます。**

**各イベントとアラートルールの対応関係を以下に示します。**

| イベント | 操作名 | アラートルール |
| :--- | :--- | :--- |
| 停止 | Microsoft.Compute/virtualMachines/powerOff/action | ルール 1 |
| 再起動 | Microsoft.Compute/virtualMachines/restart/action | ルール 2 |
| 割り当て解除 | Microsoft.Compute/virtualMachines/deallocate/action | ルール 3 |

**アクショングループの設定内容は以下の通りです。**

| 項目 | 設定内容 |
| :--- | :--- |
| アクションタイプ | Email/SMS/Push/Voice |
| 通知先 | 管理者の電子メールアドレス |
| 参照元 | 3 つすべてのアラートルール |

### ****
**この構成により、10 台すべての仮想マシンで発生する 3 種類のイベントを監視し、単一の通知先に集約できます。** **アラートルールのスコープをサブスクリプションレベルに設定することで、既存および今後追加される仮想マシンも自動的に監視対象となります。**

**リファレンス**
・[Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)
・[Activity Log](https://learn.microsoft.com/ja-jp/azure/azure-monitor/essentials/activity-log)
・[Action Group](https://learn.microsoft.com/ja-jp/azure/azure-monitor/alerts/action-groups)

### ****
**問題 48. Azure サブスクリプションに VM1 と VM2 という 2 つの仮想マシンがあります。 Azure Load Balancer を作成し、VM1 と VM2 間で HTTPS トラフィックを負荷分散する負荷分散規則を作成します。 負荷分散規則を作成する前に、追加で作成する必要がある Load Balancer のリソースはどれですか。（二つ選択）**

・**バックエンドプール**
・正常性プローブ
・送信規則
・**フロントエンド IP アドレス**

### ****
**解答例**
・**フロントエンド IP アドレス**
・**バックエンドプール**

**解説**
**Azure Load Balancer で負荷分散規則を作成するには、フロントエンド IP アドレスとバックエンドプールが必須です。** **フロントエンド IP アドレスは、クライアントからのトラフィックを受信するエンドポイントとして機能し、バックエンドプールは負荷分散の対象となる VM1 と VM2 を含むリソースグループです。** **負荷分散規則は、これら二つのコンポーネントを関連付けてトラフィックを分散します。**

**正常性プローブは負荷分散規則の作成時に推奨されますが、必須ではありません。** **プローブを設定しない場合、Load Balancer はバックエンドプール内のすべての VM が正常であると見なします。** **送信規則は送信接続の管理に使用され、負荷分散規則とは独立した機能です。**

**Load Balancer の構成要素と役割を以下に整理します。**

| コンポーネント | 役割 | 負荷分散規則での必須性 |
| :--- | :--- | :--- |
| フロントエンド IP | クライアントトラフィックの受信エンドポイント | 必須 |
| バックエンドプール | 負荷分散対象の VM グループ | 必須 |
| 正常性プローブ | バックエンド VM の稼働状態監視 | 推奨（必須ではない） |

**HTTPS トラフィックの負荷分散では、TCP ポート 443 を指定した負荷分散規則を作成します。** **Load Balancer は Layer 4（トランスポート層）で動作するため、SSL/TLS 終端は行わず、暗号化されたトラフィックをそのままバックエンド VM に転送します。**

### ****
**リファレンス**
・[Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
・[Backend Pool](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-backend-pool-usage)
・[Health Probe](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-custom-probe-overview)

### ****
**問題 49. Azure サブスクリプションがあります。 APP1 という名前のアプリケーションをサポートするために Azure Kubernetes Service (AKS) クラスターをデプロイする予定です。 オンプレミスのクライアントは、Pod の直接 IP アドレスを使用して APP1 に接続します。 この要件を満たす AKS クラスターのネットワークタイプを選択します。（一つ選択）**

・**Azure CNI (Container Networking Interface)**
・Service Mesh
・Kubenet
・Azure Private Link

### ****
**解答例**
・**Azure CNI (Container Networking Interface)**

**解説**
**オンプレミスクライアントが Pod の直接 IP アドレスを使用して接続する要件では、Azure CNI を選択する必要があります。**

**Azure CNI は、各 Pod に Azure 仮想ネットワークのサブネットから直接 IP アドレスを割り当てます。** **これにより、Pod は VNet 内の他のリソースやオンプレミスネットワークから直接アクセス可能になります。** **オンプレミスから VPN Gateway 経由で Pod の IP アドレスに直接到達できるため、本シナリオの要件を満たします。**

**一方、Kubenet はクラスター内部のプライベート IP アドレス空間を使用し、Pod は NAT 経由で外部と通信します。** **オンプレミスから Pod の直接 IP アドレスへのアクセスはできません。**

**Azure Private Link は PaaS サービスへのプライベート接続を提供するサービスであり、AKS のネットワークタイプではありません。** **Service Mesh はマイクロサービス間の通信管理機能であり、ネットワークタイプの選択肢ではありません。**

| ネットワークタイプ | Pod IP アドレス | オンプレミスからの直接アクセス |
| :--- | :--- | :--- |
| Azure CNI | VNet サブネットから割り当て | 可能 |
| Kubenet | クラスター内部プライベート IP | 不可（NAT 経由） |

| 比較項目 | Azure CNI | Kubenet |
| :--- | :--- | :--- |
| IP アドレス消費 | 多い（Pod 数分必要） | 少ない（ノード数分） |
| ネットワーク統合 | VNet と完全統合 | NAT 経由の通信 |

### ****
| 推奨用途 | エンタープライズ環境 | 開発・テスト環境 |

**リファレンス**
・[Azure CNI](https://learn.microsoft.com/ja-jp/azure/aks/configure-azure-cni)
・[kubenet](https://learn.microsoft.com/ja-jp/azure/aks/configure-kubenet)
・[Azure Kubernetes Service (AKS)](https://learn.microsoft.com/ja-jp/azure/aks/intro-kubernetes)

### ****
**問題 50. Azure サブスクリプションに 100 台の仮想マシンが稼働しています。 十分に活用されていない仮想マシンを迅速に特定し、より低コストのサービス階層に変更する必要があります。 どのブレードを使用しますか。（一つ選択）**

・Azure Monitor
・**Advisor**
・Metrics
・Cost Management + Billing

### ****
**解答例**
・**Advisor**

**解説**
**Azure Advisor は、Azure リソースの構成とテレメトリを分析し、コスト削減、パフォーマンス向上、セキュリティ強化、信頼性向上に関する推奨事項を提供するサービスです。** **この問題では、十分に活用されていない仮想マシンを特定し、より低コストのサービス階層への変更を推奨する機能が求められています。**

**Advisor は、リソースの使用状況を継続的に監視し、CPU 使用率やネットワークトラフィックなどのメトリクスに基づいて、過剰にプロビジョニングされた仮想マシンを自動的に検出します。** **コストカテゴリの推奨事項では、未使用または十分に活用されていないリソースを特定し、削除またはサイズ変更による潜在的なコスト削減額を提示します。**

**Azure Monitor はメトリクスとログの収集・分析に特化したサービスであり、個別のリソース最適化には適していませんが、100 台の仮想マシン全体を横断的に分析してコスト最適化の推奨事項を提供する機能はありません。** **Metrics はリソースのパフォーマンスデータを表示する機能であり、最適化の推奨は行いません。** **Cost Management + Billing はコスト分析と予算管理に焦点を当てたサービスですが、リソースの使用効率に基づく具体的な推奨事項は提供しません。**

| サービス | 主な機能 | コスト最適化推奨 |
| :--- | :--- | :--- |
| Advisor | リソース最適化の推奨事項提供 | あり |
| Azure Monitor | メトリクスとログの収集・分析 | なし |
| Cost Management | コスト分析と予算管理 | 限定的 |

### ****
**リファレンス**
・[Azure Advisor](https://learn.microsoft.com/ja-jp/azure/advisor/advisor-overview)
・[Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)
・[仮想マシンのサイズ変更](https://learn.microsoft.com/ja-jp/azure/virtual-machines/sizes)

### ****
**問題 51. Azure サブスクリプション「AZPT1」に以下のリソースが含まれています。 新しい Azure サブスクリプション「AZPT2」を作成しました。 AZPT2 に移動できるリソースを特定します。（一つ選択）**

| リソース名 | リソースタイプ |
| :--- | :--- |
| VM1 | 仮想マシン |
| storage1 | ストレージアカウント |
| VNET1 | 仮想ネットワーク |
| VM1Managed | マネージドディスク |
| RVAULT1 | Recovery Services コンテナー |

・VM1 と VM1Managed のみ
・VM1、storage1、VNET1、VM1Managed のみ
・RVAULT1 のみ
・**VM1、storage1、VNET1、VM1Managed、RVAULT1 のすべて**

### ****
**解答例**
・**VM1、storage1、VNET1、VM1Managed、RVAULT1 のすべて**

**解説**
**Azure リソースのサブスクリプション間移動では、リソースタイプごとに移動可否が定義されています。** **本問で提示されたすべてのリソースは、異なるサブスクリプション間での移動がサポートされています。**

**仮想マシン (VM1) は、関連するマネージドディスク (VM1Managed)、ネットワークインターフェイス、パブリック IP アドレスとともに移動できます。** **移動時には仮想マシンが停止され、移動完了後に再起動が必要です。** **ストレージアカウント (storage1) も別のサブスクリプションへの移動が可能で、データの整合性は保たれます。**

**仮想ネットワーク (VNET1) の移動では、サブネット、NSG、ルートテーブルなどの関連リソースも一緒に移動されます。** **ただし、仮想ネットワークにピアリング接続が設定されている場合は、事前にピアリングを削除する必要があります。**

**Recovery Services コンテナー (RVAULT1) も移動可能ですが、バックアップデータを含むコンテナーの移動には制約があります。** **コンテナー内にバックアップアイテムが存在する場合、移動前にバックアップを停止し、データを削除する必要があります。**

**リソース移動時の主な考慮事項を以下に整理します。**

| 考慮事項 | 内容 |
| :--- | :--- |
| 移動元と移動先 | 両方のサブスクリプションが同じ Microsoft Entra ID テナントに属している必要がある |
| リソースプロバイダー | 移動先サブスクリプションで必要なリソースプロバイダーが登録されている必要がある |
| 移動中の状態 | リソースは移動中に読み取り専用状態となり、操作が制限される |





ご提示いただいた「AZ-104試験問題500_part1_part3.pdf」の出典資料に含まれる全26問（問題52から問題77まで）および関連する解説・リファレンスの全文を、一文字も省略することなく、正確に出力いたします。

---

### ** 冒頭のリソース移動に関する記述**
リソース移動を実行するには、**Azure Portal のリソースグループまたはリソースレベルで Move 操作を選択**し、移動先のサブスクリプションとリソースグループを指定します。移動の検証が自動的に実行され、問題がなければ移動が開始されます。

**リファレンス**
* Recovery Services Vault
* Azure Virtual Network

---

### ** 問題 52：Recovery Services コンテナーと Azure Backup**
**問題 52. あなたは Vault1 という名前の Recovery Services コンテナーを持つ Azure サブスクリプションを管理しています。** このサブスクリプションには以下の仮想マシンが含まれています。 毎晩 23:00 にバックアップをスケジュール実行する予定です。 **Azure Backup を使用してバックアップできる仮想マシンはどれですか。（一つ選択）**

| 仮想マシン名 | オペレーティングシステム | 場所 |
| :--- | :--- | :--- |
| VM1 | Windows Server 2019 | 東日本 |
| VM2 | Ubuntu 20.04 LTS | 東日本 |
| VM3 | Windows Server 2016 | 西日本 |
| VM4 | Red Hat Enterprise Linux 8 | オンプレミス |

* VM1 と VM3 のみ
* **VM1、VM2、VM3 のみ**
* VM1 のみ
* VM1 と VM2 のみ

**解答例**
* VM1、VM2、VM3 のみ

**解説**
Azure Backup の Recovery Services コンテナーは、**Azure 上で稼働する仮想マシンのバックアップをサポート**します。この問題の解法で最も重要なポイントは、Azure Backup がバックアップ対象とする仮想マシンの配置場所です。
Recovery Services コンテナーを使用した Azure Backup は、**同一サブスクリプション内の Azure 仮想マシンを保護対象**とします。Windows と Linux の両方のオペレーティングシステムをサポートしており、VM1 (Windows Server 2019)、VM2 (Ubuntu 20.04 LTS)、VM3 (Windows Server 2016) はすべて Azure 上に配置されているため、バックアップ可能です。
一方、VM4 はオンプレミス環境に配置されています。オンプレミスの仮想マシンやサーバーをバックアップする場合は、Azure Backup Server または Microsoft Azure Recovery Services (MARS) エージェントを使用する必要があります。Recovery Services コンテナーに直接バックアップすることはできません。
リージョンの違い（東日本と西日本）は、同一サブスクリプション内であればバックアップの可否に影響しません。Recovery Services コンテナーは、**異なるリージョンに配置された仮想マシンもバックアップ対象として管理**できます。

| 項目 | Azure VM | オンプレミス |
| :--- | :--- | :--- |
| バックアップ方法 | Recovery Services コンテナー直接 | MARS/Backup Server 経由 |
| 対応 OS | Windows/Linux 両対応 | Windows/Linux 両対応 |

したがって、Azure Backup で直接バックアップできるのは VM1、VM2、VM3 の 3 台です。

**リファレンス**
* Azure Backup
* Recovery Services Vault
* MARS（Microsoft Azure Recovery Services）エージェント

---

### ** 問題 53：VNet とネットワークセキュリティグループ (NSG)**
**問題 53. VNet1 という名前の Azure 仮想ネットワークがあり、Subnet1 という名前のサブネットが含まれています。** Subnet1 には 3 台の Azure 仮想マシンがあり、各仮想マシンにはパブリック IP アドレスが割り当てられています。 これらの仮想マシンは、インターネット上のユーザーがポート 443 経由でアクセスできる複数のアプリケーションをホストしています。 オンプレミスネットワークから VNet1 へのサイト間 VPN 接続が確立されています。 現在、これらの仮想マシンには、インターネットとオンプレミスネットワークの両方から RDP（リモートデスクトッププロトコル）でアクセスできることが判明しました。 **オンプレミスネットワークから確立された RDP 接続を除き、インターネットからの仮想マシンへの RDP アクセスを防止します。** また、すべてのアプリケーションにインターネットユーザーが引き続きアクセスできるようにします。 どうすればよいですか。（一つ選択）

* ローカルネットワークゲートウェイのアドレス空間を変更する
* **Subnet1 にリンクされたネットワークセキュリティグループ (NSG) で拒否ルールを作成する**
* Azure Bastion をデプロイして、RDP 接続を管理する
* Subnet1 のアドレス空間を変更する

**解答例**
* Subnet1 にリンクされたネットワークセキュリティグループ (NSG) で拒否ルールを作成する

**解説**
この問題の最重要ポイントは、**インターネットからの RDP アクセスのみを遮断し、オンプレミスネットワークからの VPN 経由の RDP アクセスとインターネットからの HTTPS アクセス（ポート 443）は維持する**ことです。
ネットワークセキュリティグループ (NSG) は、Azure リソースへのネットワークトラフィックをフィルタリングするセキュリティ機能です。NSG には受信と送信のセキュリティルールを定義でき、送信元、送信先、ポート、プロトコルに基づいてトラフィックを許可または拒否できます。
この要件を満たすには、Subnet1 に NSG を関連付け、**インターネット（パブリック IP アドレス範囲）からのポート 3389 (RDP) への受信トラフィックを拒否するルール**を作成します。サイト間 VPN 経由のトラフィックは、VNet 内部のプライベート IP アドレス空間から発信されるため、このルールの影響を受けません。また、ポート 443 へのトラフィックは制限しないため、Web アプリケーションへのアクセスは維持されます。
他の選択肢が不適切な理由を以下に示します。

| 選択肢 | 不適切な理由 |
| :--- | :--- |
| ローカルネットワークゲートウェイのアドレス空間変更 | VPN 接続の構成に影響するが、RDP アクセス制御には直接関係しない |
| パブリック IP アドレスの削除 | インターネットからの HTTPS アクセスも不可能になり要件を満たさない |
| Subnet1 のアドレス空間変更 | ネットワーク構成の変更であり、アクセス制御の問題解決にならない |

NSG のルール評価は優先度順に行われ、最初に一致したルールが適用されます。適切な優先度設定により、きめ細かなアクセス制御が実現できます。

**リファレンス**
* Network Security Group
* Site-to-Site VPN
* Azure Virtual Network

---

### ** 問題 54：Azure Blob Storage のライフサイクル管理**
**問題 54. Azure サブスクリプションがあります。サブスクリプションには、storage1 という名前のストレージアカウントが含まれており、次のライフサイクル管理ルールが設定されています。** 6 月 1 日に、File1 という名前の BLOB を storage1 の Hot アクセス層に保存しました。 **6 月 7 日時点での File1 の状態はどれですか。（一つ選択）**

| ルール名 | 条件 | アクション |
| :--- | :--- | :--- |
| Rule1 | 最終変更日から 5 日経過 | Cool アクセス層に移動 |
| Rule2 | 最終変更日から 10 日経過 | Archive アクセス層に移動 |
| Rule3 | 最終変更日から 30 日経過 | 削除 |

* **Cool アクセス層に保存されている**
* Archive アクセス層に保存されている
* 削除されている
* Hot アクセス層に保存されている

**解答例**
* Cool アクセス層に保存されている

**解説**
Azure Blob Storage のライフサイクル管理ルールは、**BLOB の最終変更日を基準として自動的にアクセス層の移動や削除を実行**します。この問題では、6 月 1 日に File1 が Hot アクセス層に保存され、6 月 7 日時点での状態を判断する必要があります。
6 月 1 日から 6 月 7 日までの経過日数は 6 日間です。設定されているライフサイクル管理ルールを確認すると、Rule1 では最終変更日から 5 日経過後に Cool アクセス層への移動が実行されます。つまり、**6 月 6 日の時点で File1 は Cool アクセス層に移動**されます。
Rule2 の Archive アクセス層への移動は 10 日経過後、Rule3 の削除は 30 日経過後に実行されるため、6 月 7 日時点ではまだこれらのルールは適用されていません。したがって、File1 は Cool アクセス層に保存されている状態となります。
ライフサイクル管理ルールの適用タイミングと各アクセス層の特性を以下の表にまとめます。

| アクセス層 | 適用タイミング | 特徴 |
| :--- | :--- | :--- |
| Hot | 初期状態 | 頻繁にアクセスされるデータ向け |
| Cool | 5 日経過後 | アクセス頻度が低いデータ向け |
| Archive | 10 日経過後 | 長期保存データ向け |

ライフサイクル管理ルールは、ストレージコストの最適化とデータ管理の自動化を実現する重要な機能です。各ルールの条件と実行されるアクションを正確に理解することで、適切なデータ管理戦略を立てることができます。

**リファレンス**
* Azure Blob Storage

---

### ** 問題 55：Azure SQL Database と Azure Monitor (KQL)**
**問題 55. Azure サブスクリプション内に hogehoge という名前の Azure SQL Database があります。** Azure Monitor を使用してこのデータベースのパフォーマンスを監視し、収集したログデータに対して **Kusto Query Language (KQL) でクエリを実行して分析を行います。** **hogehoge の診断設定で構成すべき送信先はどれですか。（一つ選択）**

* **Log Analytics ワークスペースに送信する**
* ストレージアカウントにアーカイブする
* Azure Event Hubs にストリーミングする
* パートナーソリューションに統合する

**解答例**
* Log Analytics ワークスペースに送信する

**解説**
Azure Monitor でログデータを KQL クエリで分析するには、**診断設定で Log Analytics ワークスペースを送信先として構成する**必要があります。Log Analytics ワークスペースは、Azure Monitor のログデータを収集、保存、分析するための中心的なサービスで、KQL を使用した高度なクエリ実行が可能です。
診断設定の各送信先には以下の特徴があります。

| 送信先 | 主な用途 | クエリ実行 |
| :--- | :--- | :--- |
| Log Analytics ワークスペース | リアルタイム分析と KQL クエリ実行 | 可能 |
| ストレージアカウント | 長期保存とアーカイブ | 不可 |
| Event Hubs | 外部システムへのストリーミング | 不可 |

ストレージアカウントは低コストでの長期保存に適していますが、直接的なクエリ実行はできません。Event Hubs はリアルタイムデータストリーミングに使用され、SIEM など外部システムへのデータ転送に適しています。パートナーソリューションはサードパーティの監視ツールとの統合に使用されます。
Azure SQL Database のパフォーマンス監視では、CPU 使用率、DTU 消費量、接続数、ブロッキング、デッドロックなどのメトリクスとログを Log Analytics ワークスペースに送信し、KQL クエリで分析することで、パフォーマンスのボトルネックや異常を特定できます。

**リファレンス**
* Azure Monitor
* Log Analytics Workspace

---

### ** 問題 56：Azure Policy によるリソース作成制限**
**問題 56. ある Azure サブスクリプションに以下のリソースが含まれています。**

| リソース名 | リソースタイプ | リソースグループ |
| :--- | :--- | :--- |
| VNET1 | 仮想ネットワーク | RG1 |
| VM1 | 仮想マシン | RG1 |

リソースグループ RG1 には「Not allowed resource types」という Azure Policy が割り当てられており、以下のリソースタイプが拒否対象として設定されています。
> Microsoft.Network/virtualNetworks
> Microsoft.Compute/virtualMachines

RG1 内に新しい仮想マシン VM2 を作成し、VNET1 に接続する必要があります。**最初に実行すべき操作はどれですか。（一つ選択）**

* **ポリシーから Microsoft.Compute/virtualMachines を削除する**
* VNET1 にサブネットを追加する
* ARM template を作成する
* ポリシーから Microsoft.Network/virtualNetworks を削除する

**解答例**
* ポリシーから Microsoft.Compute/virtualMachines を削除する

**解説**
この問題の最重要ポイントは、**Azure Policy の「Not allowed resource types」が特定のリソースタイプの作成を拒否する動作を理解すること**です。現在 RG1 に割り当てられているポリシーは、仮想ネットワークと仮想マシンの両方の作成を拒否しています。
VM2 を作成するには、**Microsoft.Compute/virtualMachines をポリシーの拒否リストから削除する**必要があります。VNET1 は既に存在しているため、Microsoft.Network/virtualNetworks の制限は新規作成には影響しません。既存のリソースはポリシー適用前に作成されているため、そのまま利用できます。
各選択肢の評価は以下の通りです。

| 選択肢 | 評価 | 理由 |
| :--- | :--- | :--- |
| virtualMachines を削除 | 正解 | VM2 作成に必須の操作 |
| virtualNetworks を削除 | 不要 | VNET1 は既存で利用可能 |
| サブネット追加 | 不要 | ポリシー制限が優先される |

ARM template を作成してもポリシー制限は回避できません。Azure Policy はデプロイ方法に関わらず、リソース作成時に評価されます。サブネットの追加も、仮想マシンの作成制限とは無関係です。
正しい手順は、まずポリシーから Microsoft.Compute/virtualMachines を削除し、その後 VM2 を作成して VNET1 に接続することです。

**リファレンス**
* Azure Policy
* Not allowed resource types
* Azure Resource Manager

---

### ** 問題 57：ポイント対サイト VPN と証明書認証**
**問題 57. オンプレミスのクライアントマシンから、Azure の仮想ネットワークへのポイント対サイト VPN 接続を構成しています。** この接続では自己署名証明書による認証を使用しています。最初のクライアントマシンから VPN クライアント構成パッケージをダウンロードし、2 台目のクライアントマシンにインストールしました。2 台目のクライアントマシンから仮想ネットワークへのポイント対サイト VPN 接続を確立するために、最初のクライアントマシンからクライアント証明書をエクスポートし、2 台目のクライアントマシンにインストールします。**この方法で接続を確立できますか。（一つ選択）**

* いいえ、ルート証明書を両方のクライアントマシンにインストールする必要がある
* **はい、クライアント証明書をインストールすることで接続が確立できる**
* いいえ、Azure Portal 上でクライアントマシンの IP アドレスを事前登録する必要がある
* いいえ、各クライアントマシンで個別にクライアント証明書を生成する必要がある

**解答例**
* はい、クライアント証明書をインストールすることで接続が確立できる

**解説**
ポイント対サイト VPN 接続における証明書ベース認証では、**クライアント証明書が各クライアントマシンに必要**です。最初のクライアントマシンで生成されたクライアント証明書は、秘密鍵を含めてエクスポート可能であり、他のクライアントマシンにインストールして使用できます。
ポイント対サイト VPN 接続の証明書認証では、ルート証明書の公開鍵を Azure 側にアップロードし、クライアント証明書はそのルート証明書から生成されます。クライアント証明書には秘密鍵が含まれており、この秘密鍵を使用して VPN 接続時の認証が行われます。したがって、既存のクライアント証明書を秘密鍵とともにエクスポートし、新しいクライアントマシンにインストールすることで、そのマシンからも VPN 接続を確立できます。
VPN クライアント構成パッケージには、VPN 接続に必要な設定情報（VPN ゲートウェイのアドレス、プロトコル設定など）が含まれていますが、クライアント証明書自体は含まれていません。そのため、構成パッケージのインストールに加えて、有効なクライアント証明書のインストールが必須となります。

| 項目 | 説明 |
| :--- | :--- |
| ルート証明書 | Azure VPN Gateway にアップロード、公開鍵のみ |
| クライアント証明書 | 各クライアントにインストール、秘密鍵を含む |
| VPN 構成パッケージ | 接続設定情報、証明書は含まない |

**リファレンス**
* Azure VPN Gateway
* Point-to-Site VPN

---

### ** 問題 58：Microsoft Entra ID とパスワードライトバック**
**問題 58. オンプレミスネットワークに adatum.com という名前の Active Directory ドメインがあり、Microsoft Entra ID (旧 Azure AD) と同期されています。** **パスワードライトバックは無効です。** adatum.com で複数のユーザーを作成しました。次の条件を持つユーザーのうち、**adatum.com ドメインに参加しているコンピューターからサインインする必要があるのはどれですか。（一つ選択）**

**ユーザー情報テーブル**
| ユーザー名 | パスワードリセット | アカウント有効化 |
| :--- | :--- | :--- |
| User1 | 次回サインイン時 | はい |
| User2 | 管理者による | はい |
| User3 | 次回サインイン時 | いいえ |

* User1 のみ
* User1 と User2 のみ
* User2 と User3 のみ
* **User2 のみ**
* User1、User2、User3 すべて

**解答例**
* User2 のみ

**解説**
この問題は、Microsoft Entra ID とオンプレミス Active Directory の同期環境において、**パスワードライトバックが無効な場合のユーザー認証動作を理解しているかを問うもの**です。
パスワードライトバックが無効の場合、クラウド側 (Microsoft Entra ID) で行われたパスワード変更はオンプレミス Active Directory に反映されません。このため、管理者がパスワードをリセットした場合、そのパスワード変更はクラウド側にのみ適用され、オンプレミス側の Active Directory には同期されません。
User2 は「管理者によるパスワードリセット」が設定されているため、管理者が Microsoft Entra ID 側でパスワードをリセットした場合、そのパスワードはオンプレミスの adatum.com ドメインには反映されません。したがって、**User2 がオンプレミスのリソースにアクセスするには、adatum.com ドメインに参加しているコンピューターから直接サインインし、オンプレミスのドメインコントローラーで認証を受ける必要があります。**
User1 は「次回サインイン時にパスワードリセット」が設定されていますが、これはユーザー自身が変更するため、Microsoft Entra Connect 経由で通常の同期プロセスが適用されます。User3 はアカウントが無効化されているため、そもそもサインインできません。

**パスワード管理と同期の関係**
| シナリオ | オンプレミスへの同期 | ドメイン参加 PC 必須 |
| :--- | :--- | :--- |
| ユーザー自身のパスワード変更 | 同期される | 不要 |
| 管理者によるリセット (ライトバック無効) | 同期されない | 必要 |
| 管理者によるリセット (ライトバック有効) | 同期される | 不要 |

**リファレンス**
* Microsoft Entra Connect
* パスワードライトバック
* Hybrid Identity

---

### ** 問題 59：ストレージアカウントの RBAC 条件**
**問題 59. Azure サブスクリプションに storage1 という名前のストレージアカウントがあります。** storage1 にロールベースのアクセス制御 (RBAC) ロールを割り当てる際に条件を使用する予定です。**ロール割り当て時に条件をサポートする storage1 のサービスはどれですか。（一つ選択）**

* コンテナーとキューのみ
* ファイル共有とテーブルのみ
* **コンテナーのみ**
* テーブルとキューのみ

**解答例**
* コンテナーのみ

**解説**
Azure RBAC の条件付きロール割り当ては、**Azure Blob Storage のコンテナーに対してのみサポート**されています。この機能により、特定の条件（タグ、パス、暗号化スコープなど）に基づいてきめ細かなアクセス制御を実装できます。
条件付きロール割り当ては、Azure Blob Storage (コンテナー) でのみ利用可能で、File Shares, Tables, Queues ではサポートされていません。これは、Blob Storage が最も広く使用されるストレージサービスであり、エンタープライズシナリオでの詳細なアクセス制御要件に対応するためです。
条件を使用することで、特定の Blob タグを持つオブジェクトへのアクセスのみを許可したり、特定のパスプレフィックスを持つ Blob に対するアクセスを制限したりできます。これにより、単一のストレージアカウント内で複数のプロジェクトやチームのデータを安全に分離できます。

| サービス | 条件付き RBAC サポート | 主な用途 |
| :--- | :--- | :--- |
| Blob Storage (コンテナー) | **サポート** | 非構造化データ、メディアファイル |
| File Shares | 非サポート | ファイル共有、SMB アクセス |
| Tables | 非サポート | NoSQL データストア |
| Queues | 非サポート | メッセージキュー |

**リファレンス**
* Azure RBAC (Role-Based Access Control)
* Azure Blob Storage
* Conditional Access

---

### ** 問題 60：Azure Monitor と IT Service Management Connector (ITSMC)**
**問題 60. Subscription1 という名前の Azure サブスクリプションと、オンプレミスに Microsoft System Center Service Manager の環境があります。** Subscription1 には VM1 という名前の仮想マシンが含まれています。**VM1 の使用可能メモリが 10% を下回った場合に Service Manager でアラートを設定する必要があります。最初に実行すべき作業を選択してください。（一つ選択）**

* **IT Service Management Connector (ITSMC) をデプロイする**
* Azure Automation Runbook を作成する
* Azure Functions アプリをデプロイする
* Service Manager 内で通知ルールを構成する

**解答例**
* IT Service Management Connector (ITSMC) をデプロイする

**解説**
Azure とオンプレミスの Service Manager 間でアラート情報を連携させるには、まず **IT Service Management Connector (ITSMC) の導入が必要**です。ITSMC は Azure Monitor と ITSM ツール (Service Manager, ServiceNow, Provance など) を接続するための統合ソリューションです。
VM1 のメモリ使用率を監視して Service Manager にアラートを送信する処理フローは以下の通りです。ITSMC をデプロイした後、Azure Monitor で VM1 のメモリメトリクスに対するアラートルールを作成し、アクショングループで ITSMC 接続を指定します。これによりメモリが 10% を下回った際に自動的に Service Manager へインシデントやアラートが作成されます。
Automation Runbook や Functions アプリは、ITSMC を使用せずカスタムロジックで連携を実装する場合に利用できますが、標準的な ITSM 統合には ITSMC の使用が推奨されます。Service Manager 内の通知ルール構成は、ITSMC 経由で Azure からデータを受信できる状態になった後の設定作業です。

| 手順 | 作業内容 |
| :--- | :--- |
| 1. **ITSMC デプロイ** | Azure Monitor と Service Manager を接続 |
| 2. アラートルール作成 | VM1 のメモリメトリクス監視を設定 |
| 3. アクショングループ設定 | ITSMC 接続を指定してアラート送信 |

**リファレンス**
* Azure Automation
* IT Service Management Connector (ITSMC)
* Azure Monitor
* Action Group

---

### ** 問題 61：仮想ネットワークのリージョン制約**
**問題 61. Azure サブスクリプション内にリソースグループ RG1 と RG2 が存在します。** **RG1 には East Asia リージョンに仮想マシン VM1 が作成されています。** 新しい仮想ネットワーク VNET1 を作成し、VM1 を VNET1 に接続する必要があります。**この目標を達成するための適切な方法はどれですか。（二つ選択）**

* **RG1 に VNET1 を作成し、リージョンを East Asia に設定する**
* **RG2 に VNET1 を作成し、リージョンを East Asia に設定する**
* 新しいリソースグループを作成して VNET1 を配置し、リージョンを East Asia に設定する
* RG1 に VNET1 を作成し、リージョンを West US に設定する

**解答例**
* RG1 に VNET1 を作成し、リージョンを East Asia に設定する
* RG2 に VNET1 を作成し、リージョンを East Asia に設定する

**解説**
仮想マシンを仮想ネットワークに接続するには、**両方のリソースが同じリージョンに存在する必要**があります。VM1 は East Asia リージョンに配置されているため、VNET1 も必ず East Asia リージョンに作成する必要があります。
リソースグループとリージョンの関係について理解することが重要です。リソースグループ自体はメタデータコンテナであり、その中に含まれる個々のリソースは異なるリージョンに配置できます。つまり、RG1 に作成されたリソースグループ内のリソースが必ずしも同じリージョンに存在する必要はありません。
したがって、**VNET1 は RG1 または RG2 のどちらに作成してもかまいませんが、リージョンは必ず East Asia に設定する必要があります**。West US など異なるリージョンに仮想ネットワークを作成した場合、VM1 との接続には追加の構成 (VNet Peering や VPN Gateway など) が必要となり、直接的な接続はできません。

| 要素 | 要件 |
| :--- | :--- |
| 仮想ネットワークのリージョン | **VM1 と同じ East Asia** |
| リソースグループ | RG1 または RG2 のどちらでも可 |
| 接続の前提条件 | 同一リージョン内に配置 |

**リファレンス**
* Azure Virtual Network
* Azure Region

---

### ** 問題 62：仮想マシンの NIC 最小数**
**問題 62. あなたの組織では、検証を実施するために 5 つの Azure 仮想マシンを仮想ネットワークサブネットにデプロイします。** 各仮想マシンにはパブリック IP アドレスとプライベート IP アドレスが必要です。各仮想マシンには同じ受信および送信セキュリティルールを適用します。**この要件を満たすために必要なネットワークインターフェイスの最小数はいくつですか。（一つ選択）**

* 10
* 20
* **5**
* 1

**解答例**
* 5

**解説**
Azure 仮想マシンは、仮想ネットワークと通信するために**少なくとも 1 つのネットワークインターフェイス (NIC) が必要**です。各仮想マシンには必ず 1 つ以上の NIC をアタッチする必要があり、1 つの NIC には 1 つのプライベート IP アドレスが割り当てられます。パブリック IP アドレスは NIC に関連付けることができますが、NIC の数には影響しません。
本問では 5 つの仮想マシンをデプロイするため、**最小構成では各仮想マシンに 1 つずつ NIC が必要となり、合計 5 つの NIC が必要**です。セキュリティルールについては、ネットワークセキュリティグループ (NSG) を使用して管理します。NSG は複数の NIC やサブネット全体に適用できるため、同じセキュリティルールを適用する場合は 1 つの NSG を 5 つすべての NIC またはサブネットに関連付けることで要件を満たせます。

| 項目 | 最小数 | 理由 |
| :--- | :--- | :--- |
| ネットワークインターフェイス | **5** | 各 VM に最低 1 つ必要 |
| ネットワークセキュリティグループ | 1 | 同一ルールを共有可能 |
| パブリック IP アドレス | 5 | 各 VM に 1 つ必要 |

したがって、ネットワークインターフェイスの最小数は 5 となります。

**リファレンス**
* Network Interface
* Network Security Group
* Azure Virtual Machine

---

### ** 問題 63：Blob Storage と運用バックアップ**
**問題 63. Azure サブスクリプションに以下の表に示すコンテナーが存在します。** 新たにストレージアカウントを作成し、**BLOB コンテナー (container-A) とファイル共有 (share-A) を構成しました。** container-A と Recovery-A のリージョンは米国西部、share-A のリージョンは東アジアです。**container-A をバックアップ可能なコンテナーを選択してください。（一つ選択）**

| 名前 | タイプ | リージョン |
| :--- | :--- | :--- |
| Backup-A | Backup コンテナー | 東アジア |
| Recovery-A | Recovery Services コンテナー | 米国西部 |
| Recovery-B | Recovery Services コンテナー | 西ヨーロッパ |

* Backup-A
* Recovery-A または Recovery-B
* Recovery-A
* **すべてバックアップできない**
* Backup-A または Recovery-A

**解答例**
* すべてバックアップできない

**解説**
Azure BLOB コンテナーは、**Azure Backup の直接的なバックアップ対象ではありません**。Recovery Services コンテナーも Backup コンテナーも、BLOB コンテナー自体のバックアップには対応していません。
Recovery Services コンテナーは、Azure VM、SQL Server、SAP HANA、Azure Files (ファイル共有) などのバックアップに使用されます。Backup コンテナーは、Azure Database for PostgreSQL、Azure Disks、Azure Blobs のバックアップに使用されますが、ここでの **Blobs バックアップは運用バックアップ (Operational Backup) として、ストレージアカウントレベルでの継続的なバックアップを指します**。個別の BLOB コンテナーを選択してバックアップする機能ではありません。
BLOB データの保護には、以下の方法を使用します。

| 保護方法 | 説明 | 用途 |
| :--- | :--- | :--- |
| BLOB バージョン管理 | BLOB の以前のバージョンを自動保持 | 誤削除や上書きからの復旧 |
| 論理的な削除 | 削除された BLOB を一定期間保持 | 誤削除からの復旧 |
| 運用バックアップ | ストレージアカウント全体の継続的バックアップ | ランサムウェア対策や長期保持 |

container-A は個別の BLOB コンテナーであり、提示されたいずれのコンテナーでも直接バックアップできません。なお、share-A (Azure Files) は Recovery Services コンテナーでバックアップ可能ですが、本問では container-A のみが対象です。

**リファレンス**
* Recovery Services Vault
* Azure Blob Storage

---

### ** 問題 64：Network Watcher 接続モニター**
**問題 64. West US リージョンに VNet1 という仮想ネットワークがあり、その中で Windows Server を実行する VM1 と VM2 という 2 台の仮想マシンが稼働しています。** **5 時間にわたって VM1 と VM2 間のトラフィックを監視します。** この要件を満たすため、**Azure Network Watcher で接続モニターを作成することを提案しました。** この解決策は要件を満たしますか？（一つ選択）

* 要件を満たさない。代わりに NSG フローログを有効化する必要がある
* **要件を満たす**
* 要件を満たさない。代わりにパケットキャプチャを使用する必要がある
* 要件を満たさない。代わりに Traffic Analytics を構成する必要がある

**解答例**
* 要件を満たす

**解説**
Azure Network Watcher の接続モニターは、**仮想マシン間の接続性とネットワークパフォーマンスを継続的に監視する機能**です。この機能を使用することで、VM1 と VM2 間のトラフィックを 5 時間にわたって監視するという要件を満たすことができます。
接続モニターは、送信元と送信先のエンドポイント間で定期的にプローブを送信し、到達可能性、レイテンシ、ネットワークトポロジの変更を追跡します。監視期間は任意に設定でき、5 時間という期間も問題なく対応可能です。また、監視結果はメトリックとして記録され、Azure Monitor と統合されているため、アラートの設定や長期的な分析も可能です。
他の選択肢について、NSG フローログはネットワークセキュリティグループを通過する IP トラフィックの情報を記録する機能で、VM 間の直接的な接続監視には適していません。パケットキャプチャは短時間の詳細なトラフィック分析に使用され、最大 5 時間の継続監視には制限があります。Traffic Analytics はフローログデータを分析する機能で、リアルタイムの接続監視とは目的が異なります。

| 機能 | 用途 | 監視期間 |
| :--- | :--- | :--- |
| **接続モニター** | VM 間の接続性とパフォーマンス監視 | 長期間可能 |
| パケットキャプチャ | 詳細なトラフィック分析 | 最大 5 時間 |
| NSG フローログ | NSG 通過トラフィックの記録 | 長期間可能 |

**リファレンス**
* Azure Network Watcher
* Connection Monitor
* NSG Flow Logs

---

### ** 問題 65：Application Gateway パスベースルーティング**
**問題 65. Azure Application Gateway をデプロイしました。** `https://hogehoge.com/internal` へのすべてのトラフィックを内部サーバープールに転送し、`https://hogehoge.com/external` へのすべてのトラフィックを外部サーバープールに転送します。**Application Gateway で構成すべき項目を選択してください。（一つ選択）**

* **パスベースルーティング**
* 基本ルーティング
* マルチサイトリスナー
* リダイレクト構成

**解答例**
* パスベースルーティング

**解説**
Application Gateway で同一ドメイン内の異なる URL パスに基づいてトラフィックを振り分ける場合は、**パスベースルーティング (URL path-based routing)** を使用します。この機能により、URL のパス部分 (`/internal` や `/external` など) を判別して、それぞれ異なるバックエンドプールへトラフィックを転送できます。
基本ルーティングは単一のバックエンドプールへすべてのトラフィックを転送する最もシンプルな構成であり、パスによる振り分けには対応していません。マルチサイトリスナーは異なるホスト名（ドメイン名）ごとにトラフィックを振り分ける機能であり、同一ドメイン内のパス振り分けには使用しません。リダイレクト構成は HTTP から HTTPS へのリダイレクトや別 URL への転送を行う機能であり、バックエンドプールへのルーティング制御とは目的が異なります。
パスベースルーティングを構成する際は、リスナーで HTTPS リクエストを受信し、ルーティング規則でパスマップを定義します。パスマップには各 URL パスパターンと対応するバックエンドプールの組み合わせを登録します。

| ルーティング種類 | 用途 |
| :--- | :--- |
| **パスベースルーティング** | 同一ドメイン内の URL パスで振り分け |
| 基本ルーティング | 単一バックエンドプールへ転送 |
| マルチサイトリスナー | 異なるドメイン名で振り分け |

**リファレンス**
* Application Gateway
* パスベースルーティング
* Backend Pool

---

### ** 問題 66：Azure Import/Export サービス**
**問題 66. 大規模のブループリントファイルをオンプレミス環境から Azure に移行します。** **ファイルサイズは合計で 35TB あり、ネットワーク帯域幅は限られています。** 最も効率的な方法を選択します。（一つ選択）

* **Azure Import/Export サービスを使用する**
* Azure Storage Explorer を使用してファイルをコピーする
* 共有アクセス署名 (SAS) を生成し、ドライブをマップしてエクスプローラーでファイルをコピーする
* AzCopy コマンドラインツールを使用して並列アップロードを実行する

**解答例**
* Azure Import/Export サービスを使用する

**解説**
大容量データを Azure に移行する場合、ネットワーク経由の転送には時間とコストがかかります。**Azure Import/Export サービスは、物理ディスクドライブを使用してデータを転送する方法**で、大容量データの移行に最適です。
このサービスでは、暗号化された物理ドライブにデータをコピーし、Azure データセンターに発送します。データセンターでドライブから Azure Storage アカウントにデータがインポートされます。35TB という大容量データの場合、ネットワーク経由では転送に数日から数週間かかる可能性がありますが、物理ドライブを使用することで効率的に移行できます。
Azure Storage Explorer や SAS を使用したドライブマッピング、AzCopy は、いずれもネットワーク経由でのデータ転送となり、大容量データの移行には時間がかかります。これらの方法は数 GB 程度の小規模なデータ転送には適していますが、数十 TB のデータには非効率的です。

| 転送方法 | 適用シナリオ | 特徴 |
| :--- | :--- | :--- |
| **Azure Import/Export** | 大容量データ (TB 単位) | 物理ドライブで転送、帯域不要 |
| Azure Storage Explorer | 小〜中容量データ | GUI 操作、ネットワーク経由 |
| AzCopy | 小〜中容量データ | CLI 操作、並列転送可能 |

**リファレンス**
* Azure Import/Export サービス
* Azure Storage Explorer
* 共有アクセス署名 (SAS)

---

### ** 問題 67：Azure タグによるリソース分類**
**問題 67. あなたの会社には複数の部門があり、各部門は複数の仮想マシンを使用しています。** 会社の Azure サブスクリプションには RG1 という名前のリソースグループがあり、すべての仮想マシンは RG1 に配置されています。**各仮想マシンをそれぞれの部門に関連付けます。どうすればよいですか。（一つ選択）**

* **仮想マシンにタグを割り当てる**
* 各部門用のリソースグループを作成する
* 仮想マシンの設定を変更する
* Azure Policy を使用して部門ごとのルールを適用する

**解答例**
* 仮想マシンにタグを割り当てる

**解説**
この問題の最重要ポイントは、**既存のリソースグループ内で仮想マシンを部門ごとに論理的に分類する方法を選択すること**です。すべての仮想マシンが既に RG1 に配置されているため、リソースを移動せずに分類する必要があります。
タグは、Azure リソースにメタデータを付与する機能で、キーと値のペアで構成されます。例えば「Department: Sales」や「Department: Engineering」のようにタグを設定することで、同じリソースグループ内の仮想マシンを部門ごとに論理的に分類できます。タグを使用すると、コスト管理、レポート作成、リソースの検索とフィルタリングが容易になります。
各部門用のリソースグループを作成する方法は、リソースの移動が必要となり、既存の構成を大きく変更することになります。また、仮想マシンの設定変更では部門との関連付けは実現できません。Azure Policy は主にコンプライアンスとガバナンスのルール適用に使用されるもので、リソースの分類には適していません。
タグを使用した分類の利点を以下の表にまとめます。

| 項目 | 説明 |
| :--- | :--- |
| 柔軟性 | リソースを移動せずに複数の分類軸で整理可能 |
| コスト管理 | 部門別のコスト配分とレポート作成が容易 |
| 検索性 | Azure ポータルやスクリプトでタグによるフィルタリングが可能 |

タグは最大 50 個まで各リソースに設定でき、タグ名は最大 512 文字、タグ値は最大 256 文字まで指定できます。

**リファレンス**
* Azure タグ
* Resource group
* Azure コスト管理

---

### ** 問題 68：Azure Policy によるタグの自動付与**
**問題 68. Azure サブスクリプション「Subscription-A」にリソースグループ「RG-A」（米国西部、タグ "tag-A": "value-A"）が存在します。** このリソースグループに対して、**Azure Policy「Rule-A」（ポリシー定義：タグとその値をリソースに追加する、タグ名：tag-B、タグ値：value-B、除外事項：なし）を割り当てました。** その後、RG-A 内に 2 つのストレージアカウントを作成しました。storage-A（米国西部、タグ "tag-C": "value-C"）と storage-B（米国西部、タグ "tag-D": "value-D"）です。**この構成において、リソースグループ RG-A に最終的に割り当てられているタグの組み合わせを識別する必要があります。（一つ選択）**

* **"tag-A": "value-A"**
* "tag-A": "value-A", "tag-B": "value-B"
* "tag-B": "value-B"
* "tag-A": "value-A", "tag-C": "value-C"

**解答例**
* "tag-A": "value-A"

**解説**
この問題は **Azure Policy によるタグの継承動作とリソースグループへのタグ適用の仕組みを理解しているかを問う問題**です。
Azure Policy の「タグとその値をリソースに追加する」ポリシー定義は、新規作成されるリソースに対してタグを自動的に付与する機能を提供します。このポリシーは作成時または更新時にリソースレベルでタグを適用しますが、**リソースグループ自体のタグを変更または追加することはありません。** ポリシーの適用スコープがリソースグループであっても、ポリシーの効果はそのスコープ内で作成される個々のリソースに対して発動するものであり、スコープとなるリソースグループ自体のプロパティには影響を与えません。
本シナリオでは、RG-A には最初から "tag-A": "value-A" というタグが設定されています。その後、Rule-A という Azure Policy を割り当てましたが、このポリシーは RG-A 内に新規作成されるリソース (storage-A や storage-B) に対して "tag-B": "value-B" を付与するものです。ポリシーの割り当て自体はリソースグループに対して行われますが、ポリシーの効果はリソース作成時に発動し、リソースグループのタグプロパティを変更する動作は含まれていません。
したがって、storage-A と storage-B には作成時に Rule-A によって "tag-B": "value-B" が自動付与されますが、**RG-A 自体のタグは変更されず、元々設定されていた "tag-A": "value-A" のみが保持されます。** 子リソースに付与されたタグが親リソースグループに逆伝播することもありません。
Azure Policy とタグ管理の関係を整理すると以下のようになります。

| 項目 | 説明 |
| :--- | :--- |
| ポリシー適用対象 | リソースグループ内の新規作成リソース |
| ポリシー効果範囲 | 個々のリソースのタグプロパティ |
| リソースグループへの影響 | **なし（タグは変更されない）** |

タグの継承動作についても理解が必要です。Azure ではリソースグループのタグは子リソースに自動継承されません。各リソースは独立したタグセットを持ち、明示的に設定またはポリシーによって付与されたタグのみが適用されます。

| タグの伝播方向 | 動作 |
| :--- | :--- |
| 親から子への継承 | 自動継承なし |
| 子から親への逆伝播 | 発生しない |
| ポリシーによる付与 | リソース作成時に適用 |

本問題の構成では、RG-A のタグは作成時に設定された "tag-A": "value-A" のみであり、後から割り当てたポリシーやその配下に作成したリソースのタグによって変更されることはありません。

**リファレンス**
* Azure Policy
* Resource group

---

### ** 問題 69：App Service パフォーマンスプロファイル収集**
**問題 69. Azure App Service で稼働する Web アプリケーションのパフォーマンストレースを収集します。どのツールを使用しますか。（一つ選択）**

* 診断設定
* **Application Insights Profiler**
* App Service 診断
* デプロイセンター

**解答例**
* Application Insights Profiler

**解説**
Azure App Service の Web アプリケーションでパフォーマンストレースを収集する場合、**Application Insights Profiler が最適なツール**です。このツールは実行中のアプリケーションのパフォーマンスプロファイルを自動的に収集し、どのコードパスが最も時間を消費しているかを特定できます。
Application Insights Profiler は、本番環境で実行中のアプリケーションに対して低オーバーヘッドでプロファイリングを実行します。メソッドレベルでの実行時間、CPU 使用率、メモリ割り当てなどの詳細なパフォーマンスデータを収集し、ボトルネックの特定とパフォーマンス最適化に役立ちます。
診断設定はログやメトリクスの送信先を構成するものであり、パフォーマンストレースの収集には使用しません。App Service 診断は問題の診断と解決を支援するツールですが、詳細なパフォーマンストレースの収集には特化していません。デプロイセンターはアプリケーションのデプロイメント管理に使用するツールです。

| ツール | 用途 | パフォーマンストレース |
| :--- | :--- | :--- |
| **Application Insights Profiler** | パフォーマンス分析 | 対応 |
| App Service 診断 | 問題診断 | 限定的 |
| 診断設定 | ログ転送設定 | 非対応 |

**リファレンス**
* Application Insights
* Azure App Service

---

### ** 問題 70：近接配置グループ (Proximity Placement Group)**
**問題 70. Azure サブスクリプションに以下のリソースが含まれています。VMSS1 に対して近接配置グループを構成します。どの近接配置グループを使用できますか。（一つ選択）**

| リソース名 | 種類 | リージョン |
| :--- | :--- | :--- |
| VMSS1 | 仮想マシンスケールセット | 東日本 |
| Proximity1 | 近接配置グループ | 東日本 |
| Proximity2 | 近接配置グループ | 西日本 |
| Proximity3 | 近接配置グループ | 東日本 |

* **Proximity1 と Proximity3 のみ**
* Proximity1 のみ
* Proximity2 のみ
* すべての近接配置グループが使用可能

**解答例**
* Proximity1 と Proximity3 のみ

**解説**
近接配置グループ (Proximity Placement Group) は、**Azure リソース間の物理的な距離を最小化し、ネットワークレイテンシを低減するための機能**です。仮想マシンスケールセット (Virtual Machine Scale Set) に近接配置グループを適用する際は、**同一リージョン内に存在する近接配置グループのみが使用可能**です。
本問では、VMSS1 は東日本リージョンに配置されています。したがって、同じ東日本リージョンに存在する Proximity1 と Proximity3 のみが構成可能な選択肢となります。Proximity2 は西日本リージョンに存在するため、VMSS1 には適用できません。
近接配置グループは、リソースのデプロイ時またはデプロイ後に関連付けることができますが、リージョンをまたいだ関連付けは Azure のアーキテクチャ上サポートされていません。これは、近接配置グループの目的が単一のデータセンター内またはデータセンター間の物理的な近接性を確保することにあるためです。

| 項目 | 要件 |
| :--- | :--- |
| リージョンの一致 | **必須** |
| 複数グループの選択 | 同一リージョン内で可能 |
| クロスリージョン | 不可 |

仮想マシンスケールセットに近接配置グループを構成することで、スケールセット内のすべてのインスタンスが物理的に近接して配置され、アプリケーション間の通信遅延を最小限に抑えることができます。

**リファレンス**
* 近接配置グループ
* Virtual Machine Scale Set
* Azure Region

---

### ** 問題 71：Bicep ファイルのデプロイスコープ**
**問題 71. Azure サブスクリプション内に RG1 という名前のリソースグループがあります。storage1 という名前のストレージアカウントを作成する予定です。File1 という名前の Bicep ファイルがあります。RG1 への storage1 のデプロイを自動化するために File1 を変更します。どのプロパティを変更する必要がありますか。（一つ選択）**

* location
* **scope**
* sku
* tags

**解答例**
* scope

**解説**
Bicep ファイルでリソースをデプロイする際、デプロイ先のスコープを指定する必要があります。この問題では、**特定のリソースグループ (RG1) にストレージアカウントをデプロイするため、scope プロパティの変更が必要**です。
Bicep ファイルの target スコープは、デプロイの対象となる階層を定義します。Azure では、サブスクリプション、リソースグループ、管理グループ、テナントの 4 つのスコープレベルがあります。デフォルトではリソースグループスコープですが、明示的に指定することで、どのリソースグループにデプロイするかを制御できます。
scope プロパティを使用することで、Bicep ファイル内でデプロイ先のリソースグループを指定できます。例えば、`targetScope = 'resourceGroup'` と指定し、デプロイコマンドで `-resource-group RG1` パラメータを使用します。
他の選択肢について、location はストレージアカウントのデプロイ先リージョンを指定しますが、リソースグループの指定には使用しません。sku はストレージアカウントのパフォーマンステアと冗長性オプションを定義します。tags はリソースの分類や管理に使用するメタデータです。これらはストレージアカウント自体の設定であり、デプロイ先のリソースグループを指定する目的には使用しません。

| プロパティ | 用途 | 例 |
| :--- | :--- | :--- |
| **scope** | デプロイ先の階層指定 | resourceGroup, subscription |
| location | リソースのリージョン | japaneast, eastus |
| sku | サービスレベル | Standard_LRS, Premium_ZRS |

**リファレンス**
* Bicep
* Azure Resource Manager

---

### ** 問題 72：NSG フローログと Azure Monitor アラート**
**問題 72. あなたの組織が所有する Azure サブスクリプション内に、8 個のネットワークセキュリティグループ (NSG)、8 個の仮想マシン (VM)、Log Analytics ワークスペース「Workspace-A」があります。8 つの NSG はそれぞれ仮想マシンに関連付けられています。疑わしいネットワークトラフィックが検出された際にトリガーされる Azure Monitor アラートを構成します。最初に実行すべき作業を選択してください。（一つ選択）**

* データ収集ルール (DCR) を作成する。
* **NSG フローログを構成する。**
* 接続モニターをデプロイする。
* Traffic Analytics を有効化する。

**解答例**
* NSG フローログを構成する。

**解説**
疑わしいネットワークトラフィックを検出してアラートを構成するには、まず **NSG を通過するトラフィックのログデータを収集する必要**があります。NSG フローログは、NSG を通過する IP トラフィックに関する情報を記録する機能で、送信元・送信先 IP アドレス、ポート、プロトコル、トラフィックの許可/拒否状態などを記録します。
NSG フローログを構成すると、フローログデータがストレージアカウントに保存され、Log Analytics ワークスペースに送信できます。このデータを基に Azure Monitor でクエリを作成し、異常なトラフィックパターンや疑わしい通信を検出するアラートルールを設定できます。フローログがなければ、トラフィックの詳細情報が取得できないため、アラート構成の前提条件として最初に実行すべき作業となります。
データ収集ルール (DCR) は、Azure Monitor Agent でのデータ収集を定義する構成ですが、NSG フローログの収集には直接関係しません。接続モニターは、VM やエンドポイント間の接続性を監視する Network Watcher の機能ですが、NSG レベルのトラフィック詳細は提供しません。Traffic Analytics は、NSG フローログを分析して可視化する機能ですが、フローログが既に構成されていることが前提となります。
以下は、NSG フローログとその関連機能の比較です。

| 機能 | 目的 | 前提条件 |
| :--- | :--- | :--- |
| **NSG フローログ** | NSG 通過トラフィックの記録 | ストレージアカウント |
| Traffic Analytics | フローログデータの分析と可視化 | NSG フローログが有効 |
| 接続モニター | エンドポイント間の接続性監視 | Network Watcher 有効化 |

**リファレンス**
* NSG Flow Logs
* Azure Monitor
* Traffic Analytics

---

### ** 問題 73：財務部門のユーザー構成自動化**
**問題 73. 財務部門のユーザー構成を自動化するソリューションを推奨します。このソリューションは技術要件を満たす必要があります。推奨事項に含めるべきものは何ですか？（一つ選択）**

* Azure AD Identity Protection
* **動的グループと条件付きアクセスポリシー**
* Azure Logic App と Microsoft Graph API
* Azure AD B2C

**解答例**
* 動的グループと条件付きアクセスポリシー

**解説**
財務部門のユーザー構成を自動化する場合、**動的グループと条件付きアクセスポリシーの組み合わせが最適**です。動的グループは、ユーザー属性（部署、役職、場所など）に基づいて自動的にメンバーシップを管理する機能で、手動でのグループ管理作業を削減できます。条件付きアクセスポリシーは、特定の条件下でアクセス制御を自動適用する仕組みです。
動的グループでは、`membershipRule` プロパティにクエリ式を設定することで、ユーザーの属性変更に応じて自動的にグループメンバーシップが更新されます。例えば、部署属性が「Finance」のユーザーを自動的にグループに追加できます。この動的グループに対して条件付きアクセスポリシーを適用することで、財務部門ユーザーに対する多要素認証の要求や特定のアプリケーションへのアクセス制御を自動化できます。
Azure AD Identity Protection はリスクベースの条件付きアクセスを提供しますが、部門別の構成自動化には直接的ではありません。Azure Logic App と Microsoft Graph API は自動化に利用できますが、ユーザー構成の自動化には動的グループの方が効率的です。Azure AD B2C は外部顧客向けの ID 管理サービスであり、組織内部の財務部門ユーザー管理には適していません。

| 機能 | 用途 | 自動化の範囲 |
| :--- | :--- | :--- |
| **動的グループ** | 属性ベースのメンバーシップ管理 | ユーザー分類の自動化 |
| **条件付きアクセス** | アクセス制御の自動適用 | セキュリティポリシーの自動化 |
| Identity Protection | リスク検出と対応 | 脅威対応の自動化 |

**リファレンス**
* Dynamic Group
* 条件付きアクセスポリシー
* Azure AD Identity Protection

---

### ** 問題 74：ストレージのオブジェクトレプリケーション**
**問題 74. 2 つの Azure Storage アカウント間でオブジェクトレプリケーションを構成します。ソースストレージアカウントの Blob service には以下の設定があります：階層型名前空間：無効、既定のアクセス層：ホット、BLOB パブリックアクセス：有効、BLOB の論理的な削除：有効（7 日間）、コンテナーの論理的な削除：有効（7 日間）、バージョン管理：無効、変更フィード：有効、NFS v3：無効、クロステナントレプリケーションの許可：有効。オブジェクトレプリケーションをサポートするために、ソースストレージアカウントで変更する必要がある設定はどれですか。（一つ選択）**

* 階層型名前空間
* 変更フィード
* BLOB の論理的な削除
* **バージョン管理**

**解答例**
* バージョン管理

**解説**
オブジェクトレプリケーションは、ソースストレージアカウントからデスティネーションストレージアカウントへブロック BLOB を非同期的にコピーする機能です。この機能を利用するには、**両方のストレージアカウントで特定の前提条件を満たす必要**があります。
最も重要な前提条件は、**ソースとデスティネーションの両方のストレージアカウントで BLOB バージョン管理が有効化されていること**です。バージョン管理により、BLOB の以前のバージョンが自動的に保持され、オブジェクトレプリケーションはこのバージョン情報を使用してデータの整合性を保ちながらレプリケーションを実行します。
現在の設定を確認すると、バージョン管理のみが無効になっています。変更フィードは既に有効化されており、これもオブジェクトレプリケーションの前提条件の一つですが、既に要件を満たしています。階層型名前空間は Azure Data Lake Storage Gen2 の機能であり、オブジェクトレプリケーションとは直接関係ありません。BLOB の論理的な削除は推奨される設定ですが、必須ではありません。
したがって、オブジェクトレプリケーションを構成するために変更が必要な設定はバージョン管理です。

| 設定項目 | 現在の状態 | 必要な状態 |
| :--- | :--- | :--- |
| **バージョン管理** | 無効 | **有効 (必須)** |
| 変更フィード | 有効 | 有効 (必須) |
| BLOB の論理的な削除 | 有効 | 推奨 |

**リファレンス**
* オブジェクトレプリケーション
* 変更フィード

---

### ** 問題 75：RBAC カスタムロールと AssignableScopes**
**問題 75. あなたの組織には、Sub1 と Sub2 という 2 つの Azure サブスクリプションがあります。管理者が Sub1 内のリソースグループ RG1 を割り当て可能なスコープとするカスタムロールを作成しました。このカスタムロールを Sub1 と Sub2 のすべてのリソースグループに適用できるようにします。管理作業を最小限に抑えるソリューションを選択してください。（一つ選択）**

* **Sub1 と Sub2 を割り当て可能なスコープに追加し、RG1 を割り当て可能なスコープから削除する**
* Sub1 を割り当て可能なスコープに追加し、RG1 を割り当て可能なスコープから削除する。Sub2 用に新しいカスタムロールを作成する
* 各サブスクリプション用に新しいカスタムロールを作成し、RG1 からロールを削除する
* 管理グループを作成して Sub1 と Sub2 を含め、管理グループを割り当て可能なスコープに設定する

**解答例**
* Sub1 と Sub2 を割り当て可能なスコープに追加し、RG1 を割り当て可能なスコープから削除する

**解説**
Azure のカスタムロールは作成後も割り当て可能なスコープ (AssignableScopes) を変更できます。既存のカスタムロールを選択し、**割り当て可能なスコープに Sub1 と Sub2 のサブスクリプションレベルを追加することで、両サブスクリプション内のすべてのリソースグループに対してロールを割り当てられるようになります**。
現在 RG1 がスコープに含まれていますが、サブスクリプションレベルをスコープに追加すれば、そのサブスクリプション配下のすべてのリソースが対象となるため、RG1 を個別に指定する必要はなくなります。スコープの階層構造により、上位レベル（サブスクリプション）を指定すれば下位レベル（リソースグループ）は自動的に含まれます。
新しいカスタムロールを作成する選択肢は、既存のロール定義を複製する必要があり管理作業が増加します。また、複数のカスタムロールを管理することで、将来的な変更時の作業負担も増えます。管理グループを使用する方法も有効ですが、問題文では管理グループの存在が前提とされていないため、既存リソースの変更のみで対応できる方法が最適です。

| 方法 | 管理作業 | 適用範囲 |
| :--- | :--- | :--- |
| **既存ロールのスコープ変更** | **最小（1 回の変更）** | Sub1 と Sub2 全体 |
| 新規ロール作成 | 大（複数ロール管理） | 個別設定が必要 |
| 管理グループ使用 | 中（追加構成必要） | 階層的管理可能 |

**リファレンス**
* AssignableScopes
* Azure RBAC (Role-Based Access Control)

---

### ** 問題 76：Azure Bastion の必要数**
**問題 76. あなたの組織が所有する Azure サブスクリプションには、次の表に示す仮想ネットワークが含まれており、すべての仮想ネットワークがピアリングされています。各仮想ネットワークには 9 つの仮想マシンが含まれます。Azure Bastion を使用して、仮想マシンへの安全な RDP 接続を構成します。必要な Bastion ホストの最小数はいくつですか。（一つ選択）**

| 名前 | リージョン |
| :--- | :--- |
| VNet-A | 米国東部 |
| VNet-B | 米国東部 |
| VNet-C | 米国東部 |
| VNet-D | 英国南部 |
| VNet-E | 英国南部 |
| VNet-F | 英国南部 |
| VNet-G | 東アジア |
| VNet-H | 東アジア |
| VNet-I | 東アジア |
| VNet-J | 東アジア |

* 4
* **3**
* 10
* 1

**解答例**
* 3

**解説**
Azure Bastion は**リージョンごとにデプロイする必要がある PaaS 型のサービス**です。Bastion ホストは、同一リージョン内の仮想ネットワークピアリングを介して接続された仮想マシンにアクセスできますが、**異なるリージョンの仮想マシンにはアクセスできません**。
この問題では、3 つの異なるリージョン（米国東部、英国南部、東アジア）に仮想ネットワークが分散しています。各リージョン内の仮想ネットワークはすべてピアリングされているため、**1 つの Bastion ホストで同一リージョン内のすべての仮想ネットワークの仮想マシンにアクセスできます**。
したがって、米国東部に 1 つ、英国南部に 1 つ、東アジアに 1 つの**合計 3 つの Bastion ホストが必要**です。各 Bastion ホストは、そのリージョン内のピアリングされた仮想ネットワーク（VNet-A、VNet-B、VNet-C など）のすべての仮想マシンに対して RDP 接続を提供できます。

| リージョン | 仮想ネットワーク数 | 必要な Bastion ホスト数 |
| :--- | :--- | :--- |
| 米国東部 | 3 | 1 |
| 英国南部 | 3 | 1 |
| 東アジア | 4 | 1 |

Azure Bastion は、AzureBastionSubnet という専用サブネットに配置され、パブリック IP アドレスを使用してインターネットからのアクセスを受け付けます。仮想マシンにはプライベート IP アドレスのみでアクセスでき、NSG（ネットワークセキュリティグループ）による保護も可能です。

**リファレンス**
* Azure Bastion
* Virtual Network Peering
* Network Security Group

---

### ** 問題 77：Azure プライベート DNS と仮想ネットワークリンク**
**問題 77. あなたの組織では、Azure 上に複数の仮想ネットワークと仮想マシンを展開しています。西日本リージョンに配置された VM-A は、VNet-A に接続されており、プライベート IP アドレス 10.1.0.4 とパブリック IP アドレス 52.186.85.63 を持ちます。この VM-A の Windows Server 2022 には、DNS サフィックスとして hogehoge-foobar.com が設定されています。また、組織では以下の 4 つの Azure DNS ゾーンを作成しました。ゾーン名 hogehoge-foobar.pri（プライベート、東日本）、ゾーン名 example-test.pri（プライベート、米国中部）、ゾーン名 hogehoge-foobar.com（パブリック、東日本）、ゾーン名 example-test.com（パブリック、北ヨーロッパ）です。この環境において、VNet-A に仮想ネットワークリンクを作成して関連付けることができる DNS ゾーンはどれですか。（一つ選択）**

* **hogehoge-foobar.pri と example-test.pri のプライベートゾーンのみ**
* すべてのプライベートゾーンとパブリックゾーン
* hogehoge-foobar.com のパブリックゾーンのみ
* hogehoge-foobar.pri、example-test.pri、hogehoge-foobar.com の 3 つのゾーン

**解答例**
* hogehoge-foobar.pri と example-test.pri のプライベートゾーンのみ

**解説**
Azure DNS において、**仮想ネットワークリンクを作成できるのはプライベート DNS ゾーンのみ**です。パブリック DNS ゾーンは、インターネット上の名前解決を提供するためのものであり、特定の仮想ネットワークに直接リンクする機能は持ちません。
プライベート DNS ゾーンは、Azure 仮想ネットワーク内でのプライベートな名前解決を実現するために設計されています。仮想ネットワークリンクを作成することで、その仮想ネットワーク内のリソースがプライベート DNS ゾーンに登録されたレコードを解決できるようになります。この機能により、組織内部のリソース間での安全な通信が可能になります。
本問では、VNet-A にリンク可能なゾーンを特定する必要があります。作成された 4 つの DNS ゾーンのうち、**hogehoge-foobar.pri と example-test.pri の 2 つがプライベート DNS ゾーン**です。これらのゾーンは、そのロケーション（東日本、米国中部）に関係なく、任意のリージョンの仮想ネットワークにリンクできます。Azure DNS のプライベートゾーンは、グローバルサービスとして機能し、リージョンの制約を受けません。
一方、hogehoge-foobar.com と example-test.com はパブリック DNS ゾーンであり、仮想ネットワークリンクの作成対象外です。VM-A の DNS サフィックスが hogehoge-foobar.com であることは、名前解決の動作には影響しますが、どのゾーンが VNet-A にリンク可能かという判断には直接関係しません。

| ゾーンタイプ | 仮想ネットワークリンク | 用途 |
| :--- | :--- | :--- |
| **プライベート DNS ゾーン** | **作成可能** | VNet 内のプライベート名前解決 |
| パブリック DNS ゾーン | 作成不可 | インターネット向け名前解決 |

| 項目 | 説明 |
| :--- | :--- |
| 仮想ネットワークリンク | プライベート DNS ゾーンと仮想ネットワークを関連付ける機能 |
| リージョン制約 | プライベート DNS ゾーンは任意のリージョンの VNet にリンク可能 |
| 自動登録 | リンク作成時に有効化すると、VM 名が自動的に DNS レコードとして登録される |

**リファレンス**
* Azure Private DNS
* Azure DNS
* 仮想ネットワークリンク





ご提示いただいたソース（PDFの各ページに対応するテキストと画像情報）の内容を、一文字も省略することなく、ソースの順序に従って全文そのまま出力します。

---

###
**問題 78. Azure サブスクリプションに、RG1 という名前のリソースグループが含まれています。RG1 には、日次レポートを実行する仮想マシンが含まれています。リソースグループのコストが割り当てられた予算の 75% を超えた場合に、仮想マシンを自動的にシャットダウンする必要があります。実行すべきアクションはどれですか。（二つ選択）**

* **Cost Management + Billing から、予算の設定を変更する**
* **Cost Management + Billing から、新しいコスト分析を作成する**
* **Runbook タイプのアクショングループを作成し、アクションとして Stop VM を選択する**
* **Automation Account を作成し、仮想マシンのタグにシャットダウンスケジュールを設定する**

###
**解答例**

* **Cost Management + Billing から、予算の設定を変更する**
* **Runbook タイプのアクショングループを作成し、アクションとして Stop VM を選択する**

**解説**
予算超過時に仮想マシンを自動停止するには、Azure Budgets のアラート機能と Azure Automation を組み合わせます。
Cost Management + Billing の予算設定では、コストのしきい値（この場合は 75%）に達したときにアラートをトリガーできます。 予算アラートは、実際のコストまたは予測コストが定義したしきい値に達したときに通知を送信する機能です。 予算の設定画面でアラート条件を構成し、アクショングループを関連付けることで自動化されたアクションを実行できます。
Runbook タイプのアクショングループは、Azure Automation で事前定義されたスクリプトを実行します。 Stop VM アクションを選択することで、予算アラートがトリガーされたときに自動的に仮想マシンをシャットダウンできます。 Azure Automation には、仮想マシンの起動や停止などの一般的な管理タスク用の組み込み Runbook が用意されています。
コスト分析は、過去のコストデータを視覚化して分析するツールであり、自動化されたアクションをトリガーする機能はありません。 また、仮想マシンのタグによるスケジュール設定は、時間ベースの自動化には有効ですが、予算ベースの条件付き停止には対応していません。

| 機能 | 用途 | 自動アクション |
| :--- | :--- | :--- |
| **Budgets** | コストしきい値の監視とアラート | 可能（アクショングループ経由） |
| **Cost Analysis** | 過去のコスト分析と可視化 | 不可 |
| **Automation Runbook** | スクリプトベースの自動化タスク | 可能 |

###
**リファレンス**

* **Azure Budgets**
* **Azure Automation**
* **Action Group**

###
**問題 79. Recovery Services コンテナーを使用してバックアップのテストを実施しています。このテストバックアップには 2 台の保護された仮想マシンが含まれています。Recovery Services コンテナーを削除する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

* **Recovery Services コンテナーから各バックアップアイテムのバックアップを停止する**
* **各仮想マシンのリソースロックを変更する**
* **Recovery Services コンテナーから保護されたアイテムの登録を解除する**
* **各仮想マシンのディザスターリカバリー設定を変更する**

###
**解答例**

* **Recovery Services コンテナーから各バックアップアイテムのバックアップを停止する**

**解説**
Recovery Services コンテナーを削除するには、コンテナー内のすべての保護されたアイテムのバックアップを事前に停止する必要があります。 バックアップが有効な状態ではコンテナーの削除操作が実行できません。
バックアップの停止には 2 つのオプションがあります。 「バックアップの停止とデータの保持」を選択した場合、バックアップジョブは停止しますがバックアップデータは保持されるため、コンテナーは削除できません。 コンテナーを削除するには「バックアップの停止とデータの削除」を選択し、保護を完全に解除する必要があります。
リソースロックはリソースの削除や変更を防ぐ機能ですが、Recovery Services コンテナーの削除制約とは無関係です。 ディザスターリカバリー設定は Azure Site Recovery に関連する設定であり、バックアップ機能とは別のサービスです。 保護されたアイテムの登録解除は、バックアップ停止後に自動的に処理されるため、手動での実行は不要です。

| 操作 | 説明 | コンテナー削除 |
| :--- | :--- | :--- |
| **バックアップ停止とデータ削除** | 保護を解除しデータも削除 | **可能** |
| **バックアップ停止とデータ保持** | 保護を解除しデータは保持 | **不可** |
| **リソースロック変更** | リソースの保護設定 | **無関係** |

**リファレンス**

* **Recovery Services Vault**
* **Azure Backup**
* **Resource Lock**

###
**問題 80. Azure Stream Analytics ジョブ「Job1」を含む Azure サブスクリプションがあります。Job1 の入力イベントを監視し、処理されなかったイベントの数を特定します。どのメトリックを使用しますか。（一つ選択）**

* **Out-of-Order Events**
* **Deserialization Errors**
* **Late Input Events**
* **Backlogged Input Events**

###
**解答例**

* **Deserialization Errors**

**解説**
Azure Stream Analytics で処理されなかったイベント数を特定するには、Deserialization Errors（逆シリアル化エラー）メトリックを使用します。 このメトリックは、入力データの形式が正しくないために処理できなかったイベントの数を示します。
Deserialization Errors は、JSON や CSV などの入力データ形式が期待される構造と一致しない場合に発生します。 例えば、必須フィールドの欠落、データ型の一致、不正な JSON 構文などが原因となります。 これらのイベントは Stream Analytics ジョブによって処理されず、エラーとしてカウントされます。
他の選択肢について整理します。

| メトリック | 説明 | 処理状況 |
| :--- | :--- | :--- |
| **Deserialization Errors** | データ形式エラーで処理不可 | **未処理** |
| **Out-of-Order Events** | タイムスタンプ順序が不正 | 処理済（調整後） |
| **Late Input Events** | 許容遅延時間を超過 | 処理済（ドロップまたは調整） |
| **Backlogged Input Events** | 処理待ちキュー内 | 処理予定 |

Out-of-Order Events と Late Input Events は、タイムスタンプに関する問題を示しますが、これらのイベントは設定に応じて調整またはドロップされた後に処理されます。 Backlogged Input Events は処理待ちの状態を示し、最終的には処理されます。
監視の観点では、Deserialization Errors が増加している場合、入力データソースのデータ品質に問題があることを示すため、データパイプラインの上流を調査する必要があります。

###
**リファレンス**

* **Azure Stream Analytics**
* **メトリック監視**

###
**問題 81. Azure Kubernetes Service (AKS) クラスター Cluster1 をデプロイしました。このクラスターは以下の IP アドレスを使用しています。インターネットユーザーが Cluster1 で実行されているアプリケーションにアクセスできるようにします。Cluster1 の DNS レコードに含めるべき IP アドレスはどれですか。（一つ選択）**

| コンポーネント | IP アドレス |
| :--- | :--- |
| Pod | 10.0.10.11 |
| Cluster | 192.168.10.2 |
| Load Balancer | 131.107.2.1 |
| Virtual Network | 172.17.7.1 |

* **192.168.10.2**
* **10.0.10.11**
* **172.17.7.1**
* **131.107.2.1**

###
**解答例**

* **131.107.2.1**

**解説**
インターネットから AKS クラスター内のアプリケーションにアクセスする場合、パブリック IP アドレスを持つ Load Balancer を経由する必要があります。 AKS では、Kubernetes のサービスタイプとして LoadBalancer を指定することで、Azure Load Balancer が自動的にプロビジョニングされ、パブリック IP アドレスが割り当てられます。
各 IP アドレスの役割を整理すると以下のようになります。 Pod の IP アドレスはクラスター内部でのみ使用される内部 IP アドレスであり、インターネットから直接アクセスすることはできません。 Cluster の IP アドレスもクラスター内部のサービス間通信に使用される内部 IP アドレスです。 Virtual Network の IP アドレスは Azure 仮想ネットワークのアドレス空間を示すプライベート IP アドレスであり、外部からの直接アクセスには使用できません。
一方、Load Balancer の IP アドレスはパブリック IP アドレスとして割り当てられ、インターネットからのトラフィックを受け付けます。 この IP アドレスを DNS レコードに登録することで、ドメイン名を使用してアプリケーションにアクセスできるようになります。 Load Balancer は受信したトラフィックを適切な Pod に転送し、アプリケーションへのアクセスを実現します。
したがって、DNS レコードに含めるべき IP アドレスは 131.107.2.1 です。

| IP アドレス種別 | 用途 | インターネットアクセス |
| :--- | :--- | :--- |
| **Pod IP** | クラスター内部通信 | 不可 |
| **Cluster IP** | サービス間通信 | 不可 |
| **Load Balancer IP** | 外部公開 | **可能** |

###
**リファレンス**

* **Azure Kubernetes Service (AKS)**
* **Azure Load Balancer**

###
**問題 82. あなたの会社では、オフィス外のユーザーに対して Multi-Factor Authentication を使用しています。使用モデルとして認証ごと課金が構成されています。小規模企業を買収し、新しいスタッフを Microsoft Entra ID に追加した後、これらの従業員も Multi-Factor Authentication を使用する必要があると通知されました。これを実現するには、使用モデルを有効化ユーザーごと課金に設定する必要があります。解決策として、既存の Multi-Factor Authentication provider のデータからバックアップを使用して新しい Multi-Factor Authentication provider を作成します。この解決策は要件を満たしていますか。（一つ選択）**

* **いいえ、Multi-Factor Authentication provider は 2018 年 9 月 1 日以降作成できず、既存の provider も使用モデルの変更はサポートされていない**
* **はい、新しい provider を作成してバックアップから復元すれば採用モデルを変更できる**
* **いいえ、使用モデルの変更には Microsoft Entra ID Premium P1 ライセンスへの移行が必要である**
* **はい、既存の provider のバックアップを使用すれば課金モデルを柔軟に変更できる**

###
**解答例**

* **いいえ、Multi-Factor Authentication provider は 2018 年 9 月 1 日以降作成できず、既存の provider も使用モデルの変更はサポートされていない**

**解説**
Multi-Factor Authentication provider は 2018 年 9 月 1 日以降、新規作成が廃止されました。 既存の provider は引き続き使用および更新できますが、使用モデル（認証ごと課金または有効化ユーザーごと課金）の変更はサポートされていません。 したがって、既存 provider のバックアップから新しい provider を作成するという解決策は実現不可能です。
現在のベストプラクティスは、Multi-Factor Authentication provider ではなく、Microsoft Entra ID Premium P1 または P2 ライセンスを使用して MFA を有効化することです。 これらのライセンスでは条件付きアクセスポリシーを使用して、より柔軟かつ詳細な MFA 制御が可能になります。 買収した企業の従業員に対しても、適切なライセンスを割り当て、条件付きアクセスポリシーで MFA を適用することで要件を満たせます。
Multi-Factor Authentication provider は従来の課金モデルであり、現在は以下の移行が推奨されています。

| 項目 | 内容 |
| :--- | :--- |
| **従来の方法** | Multi-Factor Authentication provider (2018 年 9 月以降新規作成不可) |
| **推奨される方法** | Microsoft Entra ID Premium P1/P2 ライセンス |
| **主な利点** | 条件付きアクセスによる柔軟な制御、ユーザー単位の管理 |

**リファレンス**

* **Microsoft Entra ID**
* **Multi-Factor Authentication (MFA)**

###
* **Conditional Access**

###
**問題 83. Azure サブスクリプション上で、管理ワークステーションにて App-A という名前のコンテナーイメージを作成しました。このイメージを Azure Kubernetes Service (AKS) クラスターである Cluster-A にデプロイする予定です。Registry-A という Azure Container Registry インスタンスは既に作成済みで、Cluster-A という AKS クラスターも既に構成されています。App-A を Cluster-A にデプロイするために、最初に実行すべき操作を選択してください。（一つ選択）**

* **az acr create コマンドを実行してコンテナーレジストリを新規作成する**
* **docker push コマンドを実行してイメージを Registry-A にアップロードする**
* **az aks install-cli コマンドを実行して Kubernetes クライアントツールをインストールする**
* **az acr login コマンドを実行して Registry-A に認証する**

###
**解答例**

* **az acr login コマンドを実行して Registry-A に認証する**

**解説**
コンテナーイメージを Azure Container Registry (ACR) にプッシュして AKS クラスターにデプロイする際の最初のステップは、ACR への認証です。 ローカル環境の Docker クライアントが ACR と通信するためには、まず `az acr login` コマンドで Azure Container Registry に対する認証を確立する必要があります。
認証が完了すると、Docker クライアントは一時的な認証トークンを取得し、その後の `docker push` コマンドでイメージを ACR にアップロードできるようになります。 認証なしでプッシュ操作を試みると、アクセス拒否エラーが発生します。
作業の全体的な流れは以下の通りです。 まず ACR に認証し、次にローカルのイメージに ACR のタグを付与し、そのイメージを ACR にプッシュします。 最後に AKS クラスターからそのイメージをプルしてデプロイします。

| 手順 | コマンド | 目的 |
| :--- | :--- | :--- |
| **1** | `az acr login --name Registry-A` | **ACR への認証** |
| **2** | `docker tag App-A Registry-A.azurecr.io/App-A` | イメージのタグ付け |
| **3** | `docker push Registry-A.azurecr.io/App-A` | イメージのプッシュ |

なお、Registry-A と Cluster-A は既に作成済みであるため、新規作成コマンドは不要です。 また、Kubernetes クライアントツールのインストールはデプロイ操作に必要ですが、ACR へのイメージプッシュという最初のステップではありません。

###
**リファレンス**

* **Azure Container Registry (ACR)**
* **Azure Kubernetes Service (AKS)**

###
**問題 84. Azure サブスクリプションに複数の仮想マシンが含まれています。内部ロードバランサー LB1 を次の構成でデプロイしました。名前は LB1、タイプは内部、SKU は Standard、仮想ネットワークは VNET1 です。VM1 と VM2 を LB1 のバックエンドプールに追加できるようにする必要があります。解決策として、Basic SKU のパブリック IP アドレスを作成し、そのアドレスを VM1 のネットワークインターフェイスに関連付けてから、VM1 を起動します。この解決策は要件を満たしていますか。（一つ選択）**

* **いいえ、この解決策では要件を満たしません**
* **はい、この解決策で要件を満たします**
* **VM1 のみ追加可能ですが、VM2 は追加できません**
* **パブリック IP アドレスを Standard SKU に変更すれば要件を満たします**

###
**解答例**

* **いいえ、この解決策では要件を満たしません**

**解説**
この問題の最重要ポイントは、Standard SKU の内部ロードバランサーのバックエンドプールに仮想マシンを追加するための要件を理解することです。 内部ロードバランサーはプライベート IP アドレスを使用して仮想ネットワーク内のトラフィックを分散するため、パブリック IP アドレスの追加は解決策として不適切です。
Standard SKU のロードバランサーのバックエンドプールに仮想マシンを追加するには、仮想マシンが同じ仮想ネットワーク内に存在し、適切なネットワークセキュリティグループの設定が必要です。 また、Standard SKU のロードバランサーでは、バックエンドプールのメンバーとなる仮想マシンも Standard SKU のパブリック IP アドレスを使用する必要がありますが、内部ロードバランサーの場合はパブリック IP アドレス自体が不要です。
提示された解決策では、Basic SKU のパブリック IP アドレスを作成していますが、これは以下の理由で要件を満たしません。 第一に、内部ロードバランサーはプライベートネットワーク内でのみ動作するため、パブリック IP アドレスは必要ありません。 第二に、Standard SKU のロードバランサーと Basic SKU のパブリック IP アドレスは互換性がありません。 第三に、仮想マシンをバックエンドプールに追加するために必要なのは、適切なネットワーク構成とセキュリティ設定であり、パブリック IP アドレスの追加ではありません。
正しい解決策は、VM1 と VM2 が同じ仮想ネットワーク VNET1 内に配置されていることを確認し、必要に応じてネットワークセキュリティグループのルールを構成することです。

| 項目 | 内部ロードバランサー | パブリックロードバランサー |
| :--- | :--- | :--- |
| **IP アドレス** | プライベート IP | パブリック IP |
| **用途** | VNet 内の負荷分散 | インターネットからの負荷分散 |
| **SKU 互換性** | Standard 同士で統一 | Standard 同士で統一 |

###
| SKU | 特徴 | 互換性 |
| :--- | :--- | :--- |
| **Basic** | 基本機能のみ | Basic 同士のみ |
| **Standard** | 高可用性、ゾーン冗長対応 | Standard 同士のみ |

**リファレンス**

* **Azure Load Balancer**
* **Standard SKU**
* **Backend Pool**

###
**問題 85. 金融機関がインフラ強化のために Azure を導入します。規制要件により厳格なアクセス制御を維持する必要があります。財務チームがリソースを変更する権限を持たずに、Azure サービスのコストを表示し予算を管理できるようにします。サブスクリプションスコープで財務チームに割り当てるべきロールはどれですか。（一つ選択）**

* **Cost Management Reader**
* **Contributor**
* **Cost Management Contributor**
* **Reader**

###
**解答例**

* **Cost Management Contributor**

**解説**
この問題の最重要ポイントは、コスト管理と予算管理の権限を持ちながら、Azure リソース自体の変更権限は持たないロールを選択することです。
Cost Management Contributor は、コストデータの表示、予算の作成と管理、コスト分析の実行、推奨事項の表示などのコスト管理機能へのフルアクセスを提供しますが、Azure リソース自体の作成、変更、削除の権限は含まれません。 これは財務チームの要件に完全に合致しています。
Reader ロールはリソースの表示権限のみを提供し、予算管理の権限は含まれません。 Contributor ロールはリソースの作成と管理が可能なため、要件の「リソースを変更する権限を持たない」という条件に反します。 Cost Management Reader は予算の表示は可能ですが、予算の作成や管理はできません。

| ロール | コスト表示 | 予算管理 | リソース変更 |
| :--- | :--- | :--- | :--- |
| **Cost Management Contributor** | **可能** | **可能** | **不可** |
| **Cost Management Reader** | 可能 | 不可 | 不可 |
| **Reader** | 可能 | 不可 | 不可 |
| **Contributor** | 可能 | 不可 | 可能 |

金融機関のような規制の厳しい環境では、職務分掌の原則に基づき、財務管理とリソース管理の権限を明確に分離することが重要です。 Cost Management Contributor は、この要件を満たす最適なロールです。

###
**リファレンス**

* **Azure RBAC (Role-Based Access Control)**
* **Cost Management**
* **Azure 組み込みロール**

###
**問題 86. あなたの組織では、hogehoge.example.com という Microsoft Entra テナントを運用しており、複数のユーザーアカウントが登録されています。Windows 10 を搭載した Device-X というコンピューターがあり、UserA がこのデバイスを hogehoge.example.com テナントに Microsoft Entra 参加させました。現在のテナント設定では「ユーザーがデバイスを Microsoft Entra ID に参加させることができる」の設定が「UserA のみ」に構成されており、「Microsoft Entra 参加デバイス上の追加のローカル管理者」は「なし」に設定されています。この Device-X のローカル管理者グループに含まれるメンバーを特定します。（一つ選択）**

| ユーザー名 | 割り当てられているロール |
| :--- | :--- |
| UserA | なし |
| UserB | グローバル管理者 |
| UserC | クラウドデバイス管理者 |
| UserD | セキュリティ管理者 |
| UserE | グローバル閲覧者 |

* **UserA、UserB、UserC**
* **UserA**
* **UserB**

###
* **UserA、UserB**
* **UserA、UserB、UserC、UserD**
* **UserA、UserB、UserC、UserD、UserE**

###
**解答例**

* **UserA、UserB**

**解説**
Microsoft Entra 参加デバイスのローカル管理者グループには、デバイスを参加させたユーザーとグローバル管理者ロールを持つユーザーが自動的に追加されます。
本問では、UserA が Device-X を Microsoft Entra テナントに参加させたため、UserA は自動的にローカル管理者グループのメンバーになります。 さらに、グローバル管理者ロールを持つ UserB も、すべての Microsoft Entra 参加デバイスのローカル管理者グループに自動的に追加されます。
「Microsoft Entra 参加デバイス上の追加のローカル管理者」が「なし」に設定されている場合、クラウドデバイス管理者ロールを持つ UserC は追加されません。 この設定により、追加のローカル管理者として明示的に指定されたユーザーやロールのみが追加対象となりますが、本問では追加指定がないため、UserC は含まれません。
セキュリティ管理者ロールを持つ UserD とグローバル閲覧者ロールを持つ UserE は、デバイス管理に関する権限を持たないため、ローカル管理者グループには含まれません。

| 項目 | 説明 |
| :--- | :--- |
| **デバイス参加ユーザー** | デバイスを Microsoft Entra に参加させたユーザーは自動的にローカル管理者になる |
| **グローバル管理者** | すべての Microsoft Entra 参加デバイスのローカル管理者グループに自動追加される |
| **追加のローカル管理者設定** | 明示的に指定されたユーザーやロールのみが追加される |

| ロール | ローカル管理者への影響 |
| :--- | :--- |
| グローバル管理者 | 自動的に追加される |
| クラウドデバイス管理者 | 追加設定で指定された場合のみ追加される |
| その他のロール | 追加されない |,

###
**リファレンス**

* **Microsoft Entra ID**

###
**問題 87. Azure Storage アカウント storage1 があります。このアカウントで長期バックアップデータを保存する予定です。コストを最小限に抑える必要があります。バックアップに使用すべきストレージ層はどれですか。（一つ選択）**

* **Archive**
* **Hot**
* **Cool**
* **Premium**

###
**解答例**

* **Archive**

**解説**
長期バックアップデータの保存において最もコストを抑えられるのは Archive 層です。 Azure Blob Storage には複数のアクセス層があり、データのアクセス頻度と保存期間に応じて最適な層を選択することでストレージコストを最適化できます。
Archive 層は、ほとんどアクセスされないデータを長期間保存するために設計されており、ストレージコストが最も低く設定されています。 バックアップデータは通常、災害復旧時や特定の復元要件が発生した場合にのみアクセスされるため、Archive 層が最適です。 ただし、データの取得には数時間かかる場合があり、取得コストも発生します。
Hot 層は頻繁にアクセスされるデータ向けで、ストレージコストは高いですがアクセスコストは低く設定されています。 Cool 層は月に数回程度アクセスされるデータに適しており、Hot 層よりストレージコストは低いですが Archive 層ほどではありません。 Premium 層は超低遅延が必要なワークロード向けで、最もコストが高くなります。

| アクセス層 | 用途 | ストレージコスト |
| :--- | :--- | :--- |
| **Archive** | **長期保存、年に数回のアクセス** | **最低** |
| **Cool** | 月に数回のアクセス | 低 |
| **Hot** | 頻繁なアクセス | 高 |

長期バックアップという要件では、アクセス頻度が極めて低く、取得時の待機時間が許容できるため、Archive 層を選択することでストレージコストを最小化できます。

###
**リファレンス**

* **Azure Blob Storage**

###
**問題 88. Azure 上で Windows Server 2019 を実行する仮想マシンを運用しています。パブリック Azure DNS ゾーン「hogehoge.com」とプライベート Azure DNS ゾーン「foobar.com」を作成しました。foobar.com には仮想ネットワークリンク「link1」を構成し、自動登録を有効にしています。VM1 は foobar.com 内の名前は解決できますが、hogehoge.com 内の名前を解決できません。ただし、VM1 はインターネット上の他のホストは解決できます。VM1 が hogehoge.com のホスト名を解決できるようにする必要があります。どうすればよいですか。（一つ選択）**

* **VM1 の DNS サフィックスを hogehoge.com に更新する**
* **foobar.com ゾーンに CNAME レコードを作成する**
* **hogehoge.com のネームサーバーをドメインレジストラで構成する**
* **link1 のアクセス制御 (IAM) 設定を変更する**

###
**解答例**

* **hogehoge.com のネームサーバーをドメインレジストラで構成する**

**解説**
この問題の最重要ポイントは、パブリック DNS ゾーンとプライベート DNS ゾーンの名前解決の仕組みの違いを理解することです。 VM1 がプライベートゾーン（foobar.com）は解決できるがパブリックゾーン（hogehoge.com）を解決できない状況は、パブリック DNS ゾーンの委任設定が完了していないことを示しています。
Azure DNS でパブリック DNS ゾーンを作成した場合、そのゾーンが実際にインターネット上で機能するためには、ドメインレジストラ（ドメイン登録事業者）でネームサーバーの委任設定を行う必要があります。 Azure DNS ゾーンを作成すると、Azure は自動的に 4 つのネームサーバーを割り当てますが、これらのネームサーバー情報をドメインレジストラ側に登録しない限り、インターネット上の DNS クエリは Azure DNS ゾーンに到達しません。
プライベート DNS ゾーンは仮想ネットワーク内でのみ機能し、仮想ネットワークリンクによって接続された仮想マシンから直接名前解決が可能です。 一方、パブリック DNS ゾーンはインターネット全体で名前解決を提供するため、グローバルな DNS 階層構造に組み込む必要があります。
DNS サフィックスの変更は名前解決の検索順序に影響しますが、根本的な委任設定の問題は解決しません。 CNAME レコードや SRV レコードの追加は既存のゾーン内でのレコード管理であり、ゾーン自体の到達性には影響しません。 IAM 設定はアクセス権限の管理であり、DNS 名前解決の機能とは無関係です。

| 項目 | パブリック DNS ゾーン | プライベート DNS ゾーン |
| :--- | :--- | :--- |
| **名前解決の範囲** | インターネット全体 | 仮想ネットワーク内 |
| **必要な設定** | **レジストラでの委任設定** | 仮想ネットワークリンク |
| **到達方法** | グローバル DNS 階層 | 直接接続 |

###
| 設定項目 | 目的 | 影響範囲 |
| :--- | :--- | :--- |
| **ネームサーバー委任** | DNS ゾーンの到達性確保 | インターネット全体 |
| **DNS サフィックス** | 名前解決の検索順序 | ローカルマシンのみ |
| **仮想ネットワークリンク** | プライベートゾーン接続 | 仮想ネットワーク内 |

**リファレンス**

* **Azure DNS**

###
**問題 89. Azure サブスクリプションを所有しています。オンプレミスに VM1 という名前の仮想マシンがあります。VM1 のディスクを Azure 仮想マシンのテンプレートとして使用できるようにします。VM1 で変更する必要がある設定を選択してください。（一つ選択）**

* **プロセッサの設定**
* **ネットワークアダプターの設定**
* **ハードドライブの設定**
* **メモリの設定**

###
**解答例**

* **ハードドライブの設定**

**解説**
オンプレミスの仮想マシンを Azure に移行する際、ディスクフォーマットの互換性が最も重要な要素となります。 Azure では仮想ハードディスクとして VHD 形式または VHDX 形式をサポートしていますが、第 1 世代仮想マシンでは VHD 形式のみが対応しています。
オンプレミスの Hyper-V 環境から Azure へ移行する場合、ディスクが固定サイズの VHD 形式である必要があります。 動的拡張ディスクや VHDX 形式を使用している場合は、Azure 互換の形式に変換する必要があります。 この変換作業には Hyper-V マネージャーの「ディスクの編集」機能や PowerShell の `Convert-VHD` コマンドレットを使用します。
プロセッサ、メモリ、ネットワークアダプターの設定は、Azure 上で仮想マシンを作成する際に再構成可能であり、移行前の変更は不要です。 Integration Services についても、Azure 環境では自動的に適切なバージョンが適用されるため、事前の調整は必要ありません。

| 設定項目 | 移行前の変更要否 | 理由 |
| :--- | :--- | :--- |
| **ハードドライブ** | **必要** | **VHD 形式への変換が必須** |
| **プロセッサ / メモリ** | 不要 | Azure 上で再構成可能 |
| **ネットワーク** | 不要 | Azure 上で再構成可能 |

**リファレンス**

* **Azure Virtual Machine**

###
* **VHD - Hyper-V**

###
**問題 90. Kubernetes クラスターにサービスをデプロイしています。別のアプリケーションが Pod のプライベート IP アドレスを使用してこのサービスにアクセスする必要があります。この要件を満たすために、クラスターのネットワークタイプとして定義すべきものはどれですか。（一つ選択）**

* **Azure CNI (Container Network Interface)**
* **Kubenet**
* **Azure Private Link**
* **Network Security Group**

###
**解答例**

* **Azure CNI (Container Network Interface)**

**解説**
この問題は、Kubernetes クラスターにおけるネットワーク構成の選択に関する理解を問うものです。 別のアプリケーションが Pod のプライベート IP アドレスを直接使用してアクセスする必要がある場合、適切なネットワークプラグインを選択する必要があります。
Azure Kubernetes Service (AKS) では、主に 2 つのネットワークプラグインが利用可能です。 Kubenet は基本的なネットワークプラグインで、Pod には内部的な IP アドレスが割り当てられますが、これらの IP アドレスはクラスター外部からは直接アクセスできません。 一方、Azure CNI を使用すると、各 Pod には Azure Virtual Network (VNet) のサブネットから直接 IP アドレスが割り当てられます。 これにより、同じ VNet 内の他のリソースやアプリケーションから、Pod のプライベート IP アドレスを使用して直接アクセスすることが可能になります。
Azure Private Link は Azure サービスへのプライベート接続を提供する機能であり、この要件には該当しません。 Network Security Group は Azure のネットワークセキュリティを制御するための機能であり、IP アドレスの割り当て方式とは関係ありません。
したがって、別のアプリケーションが Pod のプライベート IP アドレスを使用してアクセスする要件を満たすには、Azure CNI を選択する必要があります。

| ネットワークプラグイン | IP アドレス割り当て | VNet 統合 |
| :--- | :--- | :--- |
| **Kubenet** | クラスター内部 IP | なし |
| **Azure CNI** | **VNet サブネット IP** | **あり** |

###
**リファレンス**

* **Azure Kubernetes Service (AKS)**
* **Azure Virtual Network**

###
**問題 91. Azure Kubernetes Service (AKS) クラスター「hogehoge-cluster」を運用しています。YAML マニフェストファイルをこのクラスターにデプロイします。Azure CLI から `az aks` コマンドを実行することで、この要件を満たすことができますか。（一つ選択）**

* **いいえ、`kubectl apply` コマンドを使用する必要がある**
* **はい、`az aks` コマンドで YAML ファイルをデプロイできる**
* **いいえ、Azure Portal からのみデプロイ可能である**
* **はい、ただし `az aks install-cli` を事前に実行する必要がある**

###
**解答例**

* **いいえ、`kubectl apply` コマンドを使用する必要がある**

**解説**
AKS クラスターへの YAML マニフェストファイルのデプロイには、Kubernetes の標準 CLI ツールである `kubectl` を使用します。 `az aks` コマンドは AKS クラスター自体の管理（作成、削除、スケーリングなど）を行うための Azure CLI コマンドであり、Kubernetes リソースのデプロイには使用しません。
正しい手順は以下の通りです。 まず `az aks get-credentials` コマンドで AKS クラスターの認証情報を取得し、ローカルの kubeconfig ファイルに設定します。 その後、`kubectl apply -f <yamlファイル名>` コマンドを実行して YAML マニフェストをクラスターにデプロイします。

| コマンド | 用途 | 対象 |
| :--- | :--- | :--- |
| **az aks** | クラスター管理 | AKS インフラストラクチャ |
| **kubectl** | **リソースデプロイ** | **Kubernetes オブジェクト** |
| **az aks get-credentials** | 認証情報取得 | クラスター接続設定 |

`kubectl` は Kubernetes の標準ツールであり、AKS 以外の Kubernetes クラスターでも同様に使用できます。 Azure CLI の `az aks install-cli` コマンドを実行することで、`kubectl` をローカル環境にインストールすることも可能です。

###
**リファレンス**

* **Azure Kubernetes Service (AKS)**
* **kubectl**
* **Azure CLI**

###
**問題 92. Azure サブスクリプションに、RG1 という名前のリソースグループがあります。RG1 には、App1 という名前のアプリケーションと containerapp1 という名前のコンテナーアプリが含まれています。App1 は、containerapp1 のキューにメッセージを追加する際にパフォーマンスの問題が発生しています。キューに新しいメッセージが追加されたときにアプリケーションリソースのクリーンアップを実行するジョブを作成します。実行するコマンドはどれですか。（一つ選択）**

* **az containerapp job create --name "my-job" --resource-group "RG1" --trigger-type "Event" --replica-timeout 60 --replica-retry-limit 1**
* **az containerapp job create --name "my-job" --resource-group "RG1" --trigger-type "Schedule" --replica-timeout 60 --replica-retry-limit 1 --cron-expression "*/5 * * * *"**
* **az containerapp job start --name "my-job" --resource-group "RG1"**
* **az containerapp job create --name "my-job" --resource-group "RG1" --trigger-type "Manual" --replica-timeout 60 --replica-retry-limit 1**

###
**解答例**

* **az containerapp job create --name "my-job" --resource-group "RG1" --trigger-type "Event" --replica-timeout 60 --replica-retry-limit 1**

**解説**
キューに新しいメッセージが追加されたときに自動的にジョブを実行するには、イベント駆動型のトリガーを持つ Container Apps Job を作成する必要があります。
Container Apps Job には 3 つのトリガータイプがあります。 Event トリガーは、Azure Storage Queue や Azure Service Bus などのスケーリングルールに基づいてジョブを自動実行します。 キューにメッセージが追加されると、KEDA スケーラーがイベントを検出してジョブインスタンスを起動します。 Schedule トリガーは、cron 式に基づいて定期的にジョブを実行します。 Manual トリガーは、手動または API を通じてオンデマンドでジョブを実行します。
問題文では「キューに新しいメッセージが追加されたとき」という条件があるため、イベント駆動型のトリガーが必要です。 ジョブを作成するには `az containerapp job create` コマンドを使用し、`--trigger-type "Event"` パラメータを指定します。 `az containerapp job start` コマンドは既存のジョブを手動で開始するためのコマンドであり、新規作成には使用できません。
`replica-timeout` パラメータは各レプリカの最大実行時間を秒単位で指定し、`replica-retry-limit` パラメータは失敗時の再試行回数を制御します。 これらの設定により、リソースクリーンアップジョブの実行時間と信頼性を管理できます。

| トリガータイプ | 用途 | 実行タイミング |
| :--- | :--- | :--- |
| **Event** | **イベント駆動処理** | **キューメッセージ追加時など** |
| **Schedule** | 定期実行 | cron 式で指定した時刻 |
| **Manual** | オンデマンド実行 | 手動または API 呼び出し時 |

###
**リファレンス**

* **KEDA (Kubernetes Event-driven Autoscaling)**

###
**問題 93. Azure サブスクリプションに 10 台の仮想マシン、Vault1 という名前の Key Vault、NSG1 という名前のネットワークセキュリティグループがあります。すべてのリソースは East US リージョンにデプロイされています。仮想マシンは NSG1 によって保護されており、NSG1 はインターネットへのすべてのアウトバウンドトラフィックをブロックするように構成されています。最小特権の原則を使用し、管理作業を最小限に抑えながら、仮想マシンが Vault1 にアクセスできるようにします。NSG1 のアウトバウンドセキュリティ規則の宛先として何を構成しますか。（一つ選択）**

* **サービスタグ**
* **アプリケーションセキュリティグループ**
* **IP アドレス範囲**
* **仮想ネットワーク**

###
**解答例**

* **サービスタグ**

**解説**
この問題の最重要ポイントは、Azure Key Vault への安全なアクセスを提供しながら、最小特権の原則と管理の容易性を両立させる方法を選択することです。
サービスタグは、Azure サービスの IP アドレス範囲をグループ化した定義済みの識別子です。 Key Vault には専用のサービスタグ「AzureKeyVault」が用意されており、これを NSG のアウトバウンド規則の宛先として指定することで、特定リージョンまたはグローバルな Key Vault サービスへのアクセスを許可できます。 サービスタグを使用すると、Microsoft が IP アドレス範囲を自動的に管理するため、管理者が IP アドレスの変更を追跡する必要がありません。
IP アドレス範囲を指定する方法も技術的には可能ですが、Key Vault の IP アドレスは変更される可能性があり、継続的な管理が必要になります。 これは最小限の管理作業という要件に反します。
アプリケーションセキュリティグループは、仮想マシンをグループ化してネットワークセキュリティポリシーを適用する機能ですが、Azure Key Vault のような外部サービスへのアクセス制御には使用できません。
仮想ネットワークを宛先とする設定は、同一または接続された仮想ネットワーク内のリソースへのアクセスを制御するものであり、Key Vault サービスへのアクセスには適していません。

| 選択肢 | 管理の容易性 | 最小特権の実現 |
| :--- | :--- | :--- |
| **サービスタグ** | **自動更新で管理不要** | **Key Vault のみに限定可能** |
| **IP アドレス範囲** | 手動更新が必要 | 範囲指定が困難 |
| **アプリケーションセキュリティグループ** | 送信元の管理のみ | 宛先指定に不適 |

###
**リファレンス**

* **Service Tag**
* **Network Security Group**
* **Azure Key Vault**

###
**問題 94. Azure Storage アカウントを作成し、10 個の Blob コンテナーを追加する予定です。そのうち 1 つのコンテナーについては、保存データの暗号化に別の鍵を使用します。コンテナーを作成する前に実行すべき操作を選択してください。（一つ選択）**

* **暗号化スコープを作成する**
* **アクセスキーをローテーションする**
* **カスタマーマネージドキーを構成する**
* **Shared Access Signature (SAS) を生成する**

###
**解答例**

* **暗号化スコープを作成する**

**解説**
Azure Storage では、コンテナーレベルで異なる暗号化キーを使用するために暗号化スコープ (Encryption Scope) を利用します。 暗号化スコープは、Blob コンテナーまたは個別の Blob に対して特定の暗号化キーを適用できる機能です。
暗号化スコープを事前に作成しておくことで、コンテナー作成時にそのスコープを指定でき、Microsoft 管理キーまたはカスタマーマネージドキーのいずれかを選択できます。 この機能により、同一ストレージアカウント内で異なる暗号化要件を持つデータを分離管理できます。
他の選択肢が不適切な理由は以下の通りです。 アクセスキーのローテーションはストレージアカウント全体のアクセス制御に関する操作であり、個別コンテナーの暗号化キー管理には影響しません。 SAS はアクセス権限の委任に使用するトークンであり、暗号化キーの管理とは無関係です。 カスタマーマネージドキーは暗号化スコープ内で構成可能ですが、スコープ自体を先に作成する必要があります。

| 機能 | 用途 | 適用範囲 |
| :--- | :--- | :--- |
| **暗号化スコープ** | **コンテナー単位の暗号化キー管理** | **コンテナーまたは Blob** |
| **アクセスキー** | ストレージアカウントへの認証 | ストレージアカウント全体 |
| **SAS** | 限定的なアクセス権限の委任 | リソース単位 |

**リファレンス**

* **暗号化スコープ**
* **Shared Access Signature (SAS)**

###
**問題 95. あなたの組織が所有する Azure サブスクリプション「Subscription-A」には、Azure ストレージアカウント「storage-A」と、表 1 に示すユーザーが含まれています。管理者であるあなたは、storage-A を監視し、表 2 に示すシグナルの電子メール通知を構成することを計画しています。計画された監視に必要なアラートルールとアクショングループの最小数を特定します。いくつのアラートルールとアクショングループが必要ですか。（一つ選択）**

**表 1 : ユーザーとグループ**
| 名前 | 所属先グループ |
| :--- | :--- |
| User-A | Group-A |
| User-B | Group-B |
| User-C | Group-A |

**表 2 : 監視シグナルと通知先**
| 名前 | タイプ | 通知先ユーザー |
| :--- | :--- | :--- |
| イングレス | メトリック | User-A, User-C |
| エグレス | メトリック | User-A |
| ストレージアカウントの削除 | アクティビティログ | User-A, User-B, User-C |
| BLOB 範囲の復元 | アクティビティログ | User-A, User-C |

###
* **アラートルール : 3, アクショングループ : 2**
* **アラートルール : 4, アクショングループ : 3**
* **アラートルール : 2, アクショングループ : 4**
* **アラートルール : 4, アクショングループ : 2**

###
**解答例**

* **アラートルール : 4, アクショングループ : 3**

**解説**
Azure Monitor でアラートを構成する際、アラートルールは監視対象のシグナル（メトリックまたはアクティビティログ）ごとに作成する必要があります。 アクショングループは通知先の組み合わせごとに作成します。
表 2 には 4 つの異なるシグナル（イングレス、エグレス、ストレージアカウントの削除、BLOB 範囲の復元）があるため、4 つのアラートルールが必要です。 各シグナルは独立した監視条件を持つため、それぞれに個別のアラートルールを作成します。
アクショングループについては、通知先ユーザーの組み合わせを分析します。 イングレスと BLOB 範囲の復元は同じ通知先（User-A, User-C）のため 1 つのアクショングループで対応可能です。 エグレスは User-A のみのため専用のアクショングループが必要です。 ストレージアカウントの削除は全ユーザー（User-A, User-B, User-C）への通知のため、別のアクショングループが必要です。 したがって、合計 3 つのアクショングループが必要です。

| 通知先の組み合わせ | 対象シグナル | アクショングループ数 |
| :--- | :--- | :--- |
| User-A, User-C | イングレス, BLOB 範囲の復元 | 1 |
| User-A | エグレス | 1 |
| User-A, User-B, User-C | ストレージアカウントの削除 | 1 |

**リファレンス**

* **Azure Monitor**
* **Alert Rule**
* **Action Group**

###
**問題 96. あなたの組織が所有する Azure サブスクリプション「Subscription-A」には、以下に示す仮想ネットワーク、仮想マシン、仮想ネットワークインターフェイスがあります。Server-A は DNS サーバーとして機能し、`hogehoge.com` という名前の Azure プライベート DNS ゾーンが VNet-B への仮想ネットワークリンクを持ち、指定のレコードが含まれています。次の記述について、正しい場合は「はい」を、正しくない場合は「いいえ」を選択してください。「Server-B は host-b.hogehoge.com を 131.107.50.50 に解決する。」（一つ選択）**

| 名前 | ピアリング先 | DNS サーバー |
| :--- | :--- | :--- |
| VNet-A | VNet-B | デフォルト（Azure 提供） |
| VNet-B | VNet-A | 10.10.0.4 |

| 名前 | IP アドレス | ネットワークインターフェイス | 接続先 |
| :--- | :--- | :--- | :--- |
| Server-A | 10.10.0.4 | NIC-A | VNet-A/Subnet-A |
| Server-B | 172.16.0.4 | NIC-B | VNet-A/Subnet-B |
| Server-C | 192.168.0.4 | NIC-C | VNet-B/Subnet-B |

| 名前 | DNS サーバー |
| :--- | :--- |
| NIC-A | 仮想ネットワークから継承 |

###
| 名前 | DNS サーバー |
| :--- | :--- |
| NIC-B | 10.10.0.4 |
| NIC-C | 仮想ネットワークから継承 |

**Server-A (10.10.0.4) の DNS ゾーン設定 :**
| 名前 | タイプ | 値 |
| :--- | :--- | :--- |
| `hogehoge.com` | プライマリ DNS ゾーン | 未適用 |
| `host-a.hogehoge.com` | A レコード | 131.107.10.15 |

**Azure プライベート DNS ゾーン (`hogehoge.com`) の設定 :**
| 名前 | タイプ | 値 |
| :--- | :--- | :--- |
| host-a | A レコード | 131.107.200.20 |
| host-b | A レコード | 131.107.50.50 |

* **いいえ**
* **はい**

###
**解答例**

* **いいえ**

**解説**
Server-B は NIC-B を使用しており、NIC-B の DNS サーバー設定は 10.10.0.4 (Server-A) を指定しています。 このため、Server-B からの名前解決要求はすべて Server-A に転送されます。
Server-A は独自のプライマリ DNS ゾーン `hogehoge.com` を持っており、このゾーンには `host-a.hogehoge.com` の A レコード (131.107.10.15) のみが登録されています。 `host-b.hogehoge.com` のレコードは Server-A のプライマリゾーンには存在しません。
Azure プライベート DNS ゾーンには `host-b` の A レコード (131.107.50.50) が登録されていますが、このプライベート DNS ゾーンは VNet-B にのみ仮想ネットワークリンクが設定されています。 Server-B は VNet-A に配置されているため、Azure プライベート DNS ゾーンの名前解決を直接利用できません。
Server-B が DNS 問い合わせを行う際の名前解決の流れは以下の通りです。 Server-B は NIC-B の設定に従い Server-A (10.10.0.4) に問い合わせを送信します。 Server-A は自身のプライマリ DNS ゾーンを確認しますが、`host-b.hogehoge.com` のレコードが存在しないため、名前解決に失敗します。 Server-A は Azure プライベート DNS ゾーンにアクセスできないため、Azure プライベート DNS ゾーンに登録された `host-b` のレコードを参照することもできません。
したがって、Server-B は `host-b.hogehoge.com` を 131.107.50.50 に解決できません。 正解は「いいえ」です。
**DNS 名前解決の構成要素と動作 :**

| 要素 | 設定内容 | 影響 |
| :--- | :--- | :--- |
| **NIC-B の DNS サーバー** | 10.10.0.4 を指定 | Server-A に問い合わせ |
| **Server-A のゾーン** | host-b レコードなし | 名前解決失敗 |
| **プライベート DNS リンク** | VNet-B のみ | VNet-A から利用不可 |,

###
**リファレンス**

* **Virtual Network Peering**

###
**問題 97. Azure サブスクリプション Subscription1 と、それに関連付けられた Microsoft Entra ID テナント Tenant1 を作成しました。Tenant1 には以下のユーザーが含まれています。Tenant1 に Microsoft Entra Privileged Identity Management を追加します。どのアカウントを使用できますか。（一つ選択）**

| ユーザー | ロール |
| :--- | :--- |
| User1 | グローバル管理者 |
| User2 | セキュリティ管理者 |
| User3 | 特権ロール管理者 |

* **User2**
* **User3**
* **User1**
* **すべてのユーザー**

###
**解答例**

* **User1**

**解説**
Microsoft Entra Privileged Identity Management (PIM) をテナントに追加するには、グローバル管理者ロールが必要です。 PIM は特権アクセス管理を提供するサービスで、初回セットアップ時には最上位の管理者権限が求められます。
セキュリティ管理者はセキュリティ関連の設定を管理できますが、PIM の初期構成には不十分です。 特権ロール管理者は PIM 内でロール割り当てを管理できますが、PIM 自体をテナントに追加する権限はありません。 グローバル管理者のみがテナント全体に影響する新しいサービスの追加を実行できます。
PIM 導入後は、グローバル管理者が特権ロール管理者に日常的な PIM 管理タスクを委任することが推奨されます。 これにより、最小特権の原則に従った運用が可能になります。

| ロール | PIM 追加 | PIM 管理 |
| :--- | :--- | :--- |
| **グローバル管理者** | **可能** | 可能 |
| **特権ロール管理者** | 不可 | 可能 |
| **セキュリティ管理者** | 不可 | 不可 |

**リファレンス**

* **特権ロール管理者**

###
**問題 98. Azure サブスクリプション内のリソースグループに、新しい Azure Container Instances をデプロイします。このコンテナーインスタンスに対して DNS 名ラベルスコープの再利用を構成する必要があります。どのネットワーク設定を選択しますか。（一つ選択）**

* **Private ネットワークタイプを選択し、既存の仮想ネットワークに接続する**
* **Public ネットワークタイプを選択し、パブリック IP アドレスを割り当てる**
* **None ネットワークタイプを選択し、ネットワーク接続を無効化する**
* **既存の仮想ネットワーク上に専用サブネットを作成して委任する**

###
**解答例**

* **Public ネットワークタイプを選択し、パブリック IP アドレスを割り当てる**

**解説**
Azure Container Instances で DNS 名ラベルを構成するには、Public ネットワークタイプを選択する必要があります。 DNS 名ラベルは、コンテナーグループにパブリック IP アドレスが割り当てられている場合にのみ利用可能な機能です。
DNS 名ラベルスコープには、テナントレベルまたはサブスクリプションレベルでの再利用オプションがあり、同じリージョン内で一意の FQDN（完全修飾ドメイン名）を生成します。 Public ネットワークタイプを選択すると、`<dnslabel>.<azure region>.azurecontainer.io` の形式でアクセス可能な DNS 名が自動的に構成されます。
Private ネットワークタイプは仮想ネットワーク統合に使用されますが、この構成ではパブリック DNS 名ラベルは利用できません。 None ネットワークタイプはネットワーク接続を持たないため、DNS 名ラベルの構成は不可能で す。仮想ネットワークへのサブネット委任は、プライベートネットワーク統合には必要ですが、DNS 名ラベルスコープの再利用には直接関係しません。

| ネットワークタイプ | DNS 名ラベル対応 | 用途 |
| :--- | :--- | :--- |
| **Public** | **対応** | **インターネット公開** |
| **Private** | 非対応 | VNet 統合 |
| **None** | 非対応 | ネットワーク分離 |

**リファレンス**

* **Azure Container Instances**

###
* **Virtual Network Integration**

###
**問題 99. あなたの組織には、hogehoge.com という名前の Microsoft Entra テナントがあります。Microsoft Entra Connect は、オンプレミスの Active Directory Domain Services (AD DS) ドメインからテナントにユーザーを同期するように構成されています。Microsoft Entra ID の属性に基づいてユーザーにライセンスを割り当てる必要があります。このソリューションは管理作業を最小限に抑える必要があります。実行する必要があるアクションはどれですか。（二つ選択）**

* **動的セキュリティグループを作成する**
* **グループベースのライセンス割り当てを構成する**
* **各ユーザーに個別にライセンスを割り当てる**
* **管理単位を作成してライセンス管理を委任する**

###
**解答例**

* **動的セキュリティグループを作成する**
* **グループベースのライセンス割り当てを構成する**

**解説**
この問題の最重要ポイントは、Microsoft Entra ID の属性に基づいて自動的にユーザーをグループ化し、そのグループに対してライセンスを割り当てることで、管理作業を最小限に抑えることです。
動的セキュリティグループは、ユーザーの属性（部署、役職、場所など）に基づいてメンバーシップを自動的に更新します。 例えば「department equals Sales」というルールを設定すると、営業部門のユーザーが自動的にグループに追加されます。 新しいユーザーが同期されたり、既存ユーザーの属性が変更されたりすると、グループメンバーシップも自動的に更新されます。
グループベースのライセンス割り当ては、セキュリティグループに対してライセンスを割り当てる機能です。 グループのメンバーになったユーザーには自動的にライセンスが付与され、グループから削除されると自動的にライセンスも削除されます。 この方法により、個別のユーザーに対して手動でライセンスを割り当てる必要がなくなります。
各ユーザーに個別にライセンスを割り当てる方法は、管理作業が膨大になるため不適切です。 管理単位は権限の委任に使用される機能であり、ライセンスの自動割り当てには直接関係しません。

| 機能 | 説明 | 管理作業 |
| :--- | :--- | :--- |
| **動的セキュリティグループ** | 属性に基づいてメンバーシップを自動更新 | **最小限** |
| **グループベースライセンス** | グループメンバーに自動的にライセンス付与 | **最小限** |
| **個別ライセンス割り当て** | 各ユーザーに手動で割り当て | 膨大 |

###
| ライセンス管理の比較 | 初期設定 | 継続的な管理 |
| :--- | :--- | :--- |
| **グループベース** | グループとルールの作成 | ほぼ不要 |
| **個別割り当て** | 各ユーザーへの割り当て | 新規ユーザーごとに必要 |

**リファレンス**

* **Microsoft Entra Connect**
* **Dynamic Group**

###
**問題 100. Azure Log Analytics ワークスペースで、hogehoge という名前のテーブルからエラーイベントのみを抽出します。この要件を満たす KQL クエリを選択してください。（一つ選択）**

* **search in (hogehoge) * | where EventType == "error"**
* **hogehoge | where EventType == "error"**
* **SELECT * FROM hogehoge WHERE EventType = 'error'**
* **hogehoge | search "error"**

###
**解答例**

* **hogehoge | where EventType == "error"**

**解説**
Azure Log Analytics で使用するクエリ言語は Kusto Query Language (KQL) です。 KQL では、テーブル名を指定した後にパイプ演算子 (|) を使用してフィルタリングや集計などの操作を連結します。
エラーイベントを抽出する場合、`where` オペレーターを使用して条件を指定します。 KQL では等値比較に `==` を使用し、文字列は大文字小文字を区別します。 正しい構文は「テーブル名 | where 列名 == "値" 」となります。
他の選択肢が不適切な理由は以下の通りです。 `search` オペレーターは全文検索を行いますが、特定の列に対する厳密な条件指定には適していません。 SQL 構文 (SELECT 文) は KQL では使用できません。 また、KQL では等値比較に「is」演算子ではなく「==」を使用します。

| 項目 | 説明 |
| :--- | :--- |
| **KQL 基本構文** | テーブル名 | オペレーター |
| **where オペレーター** | 条件に一致する行をフィルタリング |
| **等値比較** | **== を使用（大文字小文字を区別）** |

**リファレンス**

* **Kusto Query Language (KQL)**
* **Log Analytics Workspace**
* **where オペレーター**

###
**問題 101. 汎用 v1 の Azure ストレージアカウント storage1 があり、ローカル冗長ストレージ (LRS) を使用しています。ゾーン障害が発生した場合にストレージアカウント内のデータを保護します。コストと管理作業を最小限に抑えるソリューションを実装します。最初に実行する操作を選択してください。（一つ選択）**

* **アカウントを汎用 v2 にアップグレードする**
* **新しいストレージアカウントを作成する**
* **storage1 のレプリケーション設定を変更する**
* **オブジェクトレプリケーションルールを構成する**

###
**解答例**

* **アカウントを汎用 v2 にアップグレードする**

**解説**
汎用 v1 ストレージアカウントでは、ゾーン冗長ストレージ (ZRS) や Geo 冗長ストレージ (GRS) などの高度な冗長性オプションを直接設定できません。 LRS から ZRS への変更には、まず汎用 v2 へのアップグレードが必要です。
汎用 v1 から汎用 v2 へのアップグレードは、Azure Portal または PowerShell、Azure CLI を使用して実行できます。 このアップグレードは元に戻せない一方向の操作ですが、ダウンタイムなしで実行でき、既存のデータやアクセス方法に影響を与えません。 アップグレード後、レプリケーション設定で LRS から ZRS に変更することで、同一リージョン内の複数の可用性ゾーンにデータが同期的にレプリケートされ、ゾーン障害からデータを保護できます。
新しいストレージアカウントを作成してデータを移行する方法は、管理作業とコストが増加します。 オブジェクトレプリケーションは異なるストレージアカウント間での Blob コピーに使用される機能であり、同一アカウント内のゾーン冗長性には適用されません。 レプリケーション設定の直接変更は、v1 アカウントでは制限されているため実行できません。

| 項目 | 汎用 v1 | 汎用 v2 |
| :--- | :--- | :--- |
| **冗長性オプション** | LRS, GRS | **LRS, ZRS, GRS, GZRS** |
| **アップグレード** | 不可 | **v1 からアップグレード可能** |
| **コスト効率** | 低い | 高い（階層化ストレージ対応） |

###
**リファレンス**

* **Azure Storage 冗長性**
* **ゾーン冗長ストレージ (ZRS)**

###
**問題 102. Azure Monitor の SecurityEvent テーブルから 1,000 件のイベントを返す Kusto クエリがあります。Account 列で結果を集計するようにクエリを構成します。どの演算子を使用しますか。（一つ選択）**

* **where**
* **project**
* **summarize**
* **take**

###
**解答例**

* **summarize**

**解説**
Kusto Query Language (KQL) でデータを集計する場合は、`summarize` 演算子を使用します。 この演算子は指定した列でグループ化し、集計関数 (count, sum, avg など) を適用できます。
Account 別でイベントを集計する場合、基本的な構文は以下のようになります。
```
SecurityEvent
| summarize count() by Account
```
この演算子により、各アカウントごとにイベント数をカウントした結果が得られます。 `summarize` 演算子は SQL 言語の GROUP BY 句に相当する機能を提供し、大量のログデータから統計情報や傾向を抽出する際に不可欠です。
他の選択肢について、`where` は行のフィルタリング、`project` は列の選択と変換、`take` は指定した行数の取得に使用されます。 これらは集計機能を持たないため、Account 列でのグループ化には適していません。

| 演算子 | 用途 | 集計機能 |
| :--- | :--- | :--- |
| **summarize** | **グループ化と集計** | **あり** |
| **where** | 行のフィルタリング | なし |
| **project** | 列の選択と変換 | なし |

Azure Monitor の Log Analytics ワークスペースでは、KQL を使用してセキュリティイベント、パフォーマンスメトリック、アプリケーションログなど様々なデータソースを分析します。 `summarize` 演算子は、これらの大量データから意味のある洞察を得るための基本的かつ重要な演算子です。

###
**リファレンス**

* **Kusto Query Language (KQL)**
* **Azure Monitor**
* **Log Analytics Workspace**

###
**問題 103. Azure サブスクリプションに 2 つの仮想マシンが含まれています。VM2 から 10.0.0.4 に対して逆引き DNS 参照を実行します。返される FQDN はどれですか。（一つ選択）**

* **vm1.internal.cloudapp.net**
* **vm1.westeurope.cloudapp.azure.com**
* **vm1.hogehoge.internal**
* **vm1.core.windows.net**

###
**解答例**

* **vm1.internal.cloudapp.net**

**解説**
Azure 仮想ネットワーク内の仮想マシン間で逆引き DNS 参照を実行する場合、Azure が提供する内部 DNS 解決の仕組みが使用されます。 同一仮想ネットワーク内の VM からプライベート IP アドレスに対して逆引きを行うと、Azure 内部 DNS サフィックス「internal.cloudapp.net」を使用した FQDN が返されます。
Azure 仮想ネットワークでは、各 VM に対してプライベート IP アドレスとともに内部 DNS 名が自動的に割り当てられます。 この内部 DNS 名は「VM 名.internal.cloudapp.net」の形式となり、同一仮想ネットワーク内のリソース間での名前解決に使用されます。 逆引き DNS 参照では、このプライベート IP アドレスから内部 FQDN 形式の名前が返されます。
パブリック IP アドレスに対する逆引き DNS 設定とは異なり、仮想ネットワーク内部の名前解決では、Azure が管理する内部 DNS サーバーが自動的に構成され、追加の設定なしで機能します。

| DNS 名の種類 | 形式 | 用途 |
| :--- | :--- | :--- |
| **内部 DNS 名** | **vm 名.internal.cloudapp.net** | **仮想ネットワーク内の名前解決** |
| **パブリック DNS 名** | vm 名.リージョン.cloudapp.azure.com | インターネットからのアクセス |
| **カスタム DNS 名** | ユーザー定義 | Azure DNS Zone などで設定 |

**リファレンス**

* **Azure Virtual Network**
* **Azure DNS**

###
**問題 104. オンプレミスの Active Directory Domain Services (AD DS) ドメイン「hogehoge.local」を含むネットワーク環境があります。このドメインには以下の表に示すサーバーが含まれており、Azure への移行を計画しています。アドレス空間 10.0.0.0/16、サブネット Subnet-A (10.0.1.0/24) を持つ仮想ネットワーク VNet-A を作成しました。ドメインコントローラー DC-A を仮想マシンとして VNet-A に移行します。移行後も hogehoge.local のメンバーサーバーが AD DS DNS 名を解決できるようにする必要があります。DC-A に設定すべき IP アドレスを選択してください。（一つ選択）**

| 名前 | IP アドレス | 役割 |
| :--- | :--- | :--- |
| DC-A | 192.168.2.1/16 | ドメインコントローラー、DNS サーバー |
| Server-A | 192.168.2.50/16 | メンバーサーバー |

* **10.0.1.3 を使用する**
* **192.168.2.1 を使用する**
* **DHCP による動的割り当てを使用する**
* **10.0.1.4 を使用する**





提供されたソース（PDFの抜粋）に含まれるすべての文章を、一文字も省略することなく、全文そのまま出力します。

---

****
**解答例**
・10.0.1.3 を使用する

**解説**
ドメインコントローラーと DNS サーバーの役割を持つ DC-A を Azure 仮想ネットワークに移行する際、静的 IP アドレスの割り当てが必須です。Azure 仮想ネットワークでは、各サブネットの最初の 3 つの IP アドレス（.0、.1、.2）は Azure によって予約されており使用できません。したがって、Subnet-A (10.0.1.0/24) で使用可能な最初の IP アドレスは 10.0.1.3 となります。

ドメインコントローラーは、ドメインメンバーサーバーからの DNS クエリに応答する必要があるため、IP アドレスが変更されるとドメイン全体の DNS 解決に影響を及ぼします。DHCP による動的割り当てでは、仮想マシンの再起動時に IP アドレスが変更される可能性があり、DNS 設定の不整合が発生します。オンプレミスの IP アドレス 192.168.2.1 は、Azure 仮想ネットワークのアドレス空間 10.0.0.0/16 とは異なるため使用できません。10.0.2.1 は定義されていないサブネット範囲のため不適切です。

| 項目 | 内容 |
| :--- | :--- |
| Azure 予約 IP アドレス | 各サブネットの .0、.1、.2 は予約済み |
| DC 推奨設定 | 静的 IP アドレスの割り当て |
| DNS 設定 | 仮想ネットワークのカスタム DNS に 10.0.1.3 を指定 |

**リファレンス**
・Azure Virtual Network
・Active Directory Domain Services
・静的 IP アドレス

---

****
**問題 105. Azure サブスクリプションに汎用 v2 ストレージアカウント「storage-hogehoge」が存在します。このストレージアカウントに対して暗号化スコープ「scope-foobar」を新規作成しました。この暗号化スコープを使用してデータを暗号化できる Azure Storage サービスの組み合わせとして正しいものを選択してください。（一つ選択）**

・Blob Storage と Queue Storage のみ
・Blob Storage のみ
・Blob Storage と Table Storage のみ
・Blob Storage、File Storage、Table Storage
・File Storage と Blob Storage のみ
・Blob Storage、File Storage、Table Storage、Queue Storage

---

****
**解答例**
・Blob Storage のみ

**解説**
暗号化スコープ（Encryption Scope）は、Azure Storage 内の特定のデータに対して個別の暗号化キーを適用できる機能です。この機能により、コンテナ単位や Blob 単位で異なる暗号化キーを使用した細かい暗号化管理が可能になります。

暗号化スコープが適用できるのは Blob Storage（コンテナと Blob）のみです。File Storage、Table Storage、Queue Storage には暗号化スコープを適用できません。これらのサービスでは、ストレージアカウント全体に適用される標準の暗号化（Storage Service Encryption）が使用されます。

暗号化スコープの作成時には、Microsoft 管理キー（Microsoft-managed keys）またはカスタマー管理キー（Customer-managed keys）のいずれかを選択できます。カスタマー管理キーを使用する場合は、Azure Key Vault に保存されたキーを指定します。

暗号化スコープの主な特徴を以下の表にまとめます。

| 項目 | 内容 |
| :--- | :--- |
| 適用対象 | Blob Storage のみ（コンテナ、Blob） |
| キー管理 | Microsoft 管理キーまたはカスタマー管理キー |
| 適用レベル | コンテナレベルまたは Blob レベル |

暗号化スコープを使用することで、マルチテナント環境や規制要件が厳しい業界において、データの論理的な分離と独立した暗号化管理を実現できます。例えば、同一ストレージアカウント内で顧客ごとに異なる暗号化キーを運用するといった運用が可能になります。

---

****
**リファレンス**
・暗号化スコープ
・Blob Storage

---

****
**問題 106. 既存の仮想マシンに基づいて Azure Resource Manager テンプレートをダウンロードしました。このテンプレートを使用して 100 台の仮想マシンをデプロイします。管理者パスワードを参照するようにテンプレートを変更する必要があります。パスワードがプレーンテキストで保存されないようにする必要があります。パスワードを保存するために何を作成する必要がありますか。（一つ選択）**

・Azure Key Vault とアクセスポリシー
・Recovery Services vault とバックアップポリシー
・Azure Storage アカウントとアクセスポリシー
・Microsoft Entra ID とロールベースのアクセス制御

---

****
**解答例**
・Azure Key Vault とアクセスポリシー

**解説**
ARM テンプレートで仮想マシンをデプロイする際、管理者パスワードなどの機密情報をプレーンテキストで保存することはセキュリティ上のリスクとなります。Azure Key Vault は、暗号化キー、シークレット、証明書を安全に保管するためのクラウドサービスです。

ARM テンプレートから Key Vault に保存されたシークレットを参照するには、テンプレートのパラメータセクションで Key Vault のリソース ID とシークレット名を指定します。デプロイ時に Azure は Key Vault から値を取得し、テンプレートに渡します。アクセスポリシーを設定することで、どのユーザーやサービスプリンシパルがシークレットにアクセスできるかを制御できます。

Recovery Services vault はバックアップとディザスタリカバリに使用されるサービスであり、シークレット管理には適していません。Azure Storage アカウントはファイルやデータの保存に使用されますが、機密情報の安全な管理機能は提供していません。Microsoft Entra ID は認証とアクセス管理のサービスですが、シークレットの保管場所としては設計されていません。

| サービス | 用途 | シークレット管理 |
| :--- | :--- | :--- |
| Azure Key Vault | キー・シークレット・証明書の管理 | 適している |
| Recovery Services vault | バックアップ・DR | 不適切 |
| Azure Storage | データ保存 | 不適切 |

ARM テンプレートで Key Vault を参照する場合、パラメータファイルに以下のような形式で記述します。

```json
"adminPassword": {
```

---

****
```json
    "reference": {
        "keyVault": {
            "id": "/subscriptions/subscription-id/resourceGroups/rg-name/providers/Microsoft.KeyVault/vaults/vault-name"
        },
        "secretName": "vmAdminPassword"
    }
}
```
この方法により、パスワードは Key Vault 内で暗号化されて保存され、テンプレートやパラメータファイルにプレーンテキストとして記載されることはありません。

**リファレンス**
・Azure Key Vault
・ARM Template
・アクセスポリシー

---

****
**問題 107. あなたの会社には 3 つのオフィスがあります。オフィスはマイアミ、ロサンゼルス、ニューヨークに所在し、各オフィスにはデータセンターがあります。East US と West US の 2 つの Azure リージョンにリソースを含む Azure サブスクリプションがあり、各リージョンには仮想ネットワークが存在しピアリングされています。データセンター間のネットワーク遅延を最小限に抑えながら、これらのデータセンターをサブスクリプションに接続する必要があります。何を作成しますか。（一つ選択）**

・1 つの Virtual WAN と 3 つの Virtual Hub
・3 つの ExpressRoute 回線と 1 つの ExpressRoute Gateway
・3 つの VPN Gateway と 1 つの Virtual Network Gateway
・3 つの Virtual WAN と 1 つの Virtual Hub

---

****
**解答例**
・1 つの Virtual WAN と 3 つの Virtual Hub

**解説**
複数のオンプレミスデータセンターと Azure 仮想ネットワークを低遅延で接続する場合、Azure Virtual WAN が最適なソリューションです。Virtual WAN は、グローバルなトランジットネットワークアーキテクチャを提供し、複数の拠点間の接続を一元管理できるサービスです。

Virtual WAN では、各リージョンに Virtual Hub を配置し、オンプレミスの各データセンターをそれぞれの Hub に接続します。この構成により、Microsoft のグローバルネットワークバックボーンを活用した最適なルーティングが実現され、データセンター間の通信遅延が最小化されます。1 つの Virtual WAN リソースで複数の Virtual Hub を管理し、各 Hub が地理的に分散した拠点のハブとして機能します。

ExpressRoute 回線や VPN Gateway は個別の接続ソリューションですが、複数拠点を統合管理する機能に欠け、拠点間のメッシュ接続を手動で構成する必要があります。Azure Application Gateway や On-premises Data Gateway は、それぞれ Web アプリケーションの負荷分散やデータ統合のためのサービスであり、ネットワーク接続の用途には適していません。

| 項目 | Virtual WAN | 個別 Gateway |
| :--- | :--- | :--- |
| 管理 | 一元管理 | 個別管理 |
| ルーティング | 自動最適化 | 手動設定 |
| 拠点間接続 | メッシュ自動構成 | 個別構成必要 |

Virtual WAN と Virtual Hub の組み合わせにより、グローバルに分散したデータセンターとクラウドリソースを効率的に接続し、Azure のバックボーンネットワークを最大限活用できます。

---

****
**リファレンス**
・Azure Virtual WAN
・ExpressRoute

---

****
**問題 108. あなたの組織では、Azure Policy を使用してリソースのデプロイメントを制御しています。現在、Subscription 1 に対して特定のポリシーが適用されており、このポリシーは ContosoRG1 というリソースグループを除外（exclusion）する設定になっています。ポリシーの効果（effect）は「Deny」に設定されており、対象リソースタイプは「Microsoft.Sql/servers」です。このポリシー構成において正しい記述はどれですか。（一つ選択）**

・Subscription 1 内のすべてのリソースグループで Azure SQL Server を作成できる
・ContosoRG1 以外のすべてのリソースグループで Azure SQL Server の作成が拒否される
・Subscription 1 全体で Azure SQL Server の作成が拒否される
・ContosoRG1 でのみ Azure SQL Server を作成できる

---

****
**解答例**
・ContosoRG1 でのみ Azure SQL Server を作成できる

**解説**
Azure Policy の除外（exclusion）設定と Deny 効果の組み合わせを理解することが重要です。このシナリオでは、ポリシーが Subscription 1 全体に適用されていますが、ContosoRG1 が除外対象として指定されています。

Deny 効果を持つポリシーは、指定されたリソースタイプのデプロイメントを拒否します。今回のケースでは「Microsoft.Sql/servers」が対象となっているため、Azure SQL Server の作成が制限されます。ただし、除外設定により、ContosoRG1 はこのポリシーの適用範囲から外れています。

結果として、ContosoRG1 ではポリシーが適用されないため、Azure SQL Server を作成できます。一方、Subscription 1 内の他のすべてのリソースグループでは、ポリシーの Deny 効果により Azure SQL Server の作成が拒否されます。

| 項目 | 説明 |
| :--- | :--- |
| ポリシー効果 (Deny) | 指定リソースタイプの作成を拒否 |
| 除外設定 | 特定スコープをポリシー適用から除外 |
| 適用結果 | 除外スコープのみデプロイ可能 |

Azure Policy の除外機能は、組織全体に厳格なガバナンスを適用しながら、特定の例外的なケースに柔軟に対応するために使用されます。除外設定は慎重に管理し、セキュリティとコンプライアンスの要件を満たすように構成する必要があります。

| 除外の有無 | ContosoRG1 | その他のリソースグループ |
| :--- | :--- | :--- |
| 除外あり | 作成可能 | 作成拒否 |

---

****
| 除外なし | 作成拒否 | 作成拒否 |

**リファレンス**
・Azure Policy
・Resource group

---

****
**問題 109. 複数の Azure サブスクリプションとリソースを効率的に管理する必要があります。すべてのサブスクリプションにわたってアクセス、ポリシー、コンプライアンスを統一的に管理します。実行すべきタスクを 3 つ選択してください。（三つ選択）**

・サブスクリプションごとに個別のリソースグループを作成する
・管理グループを作成し、すべてのサブスクリプションを割り当てる
・個々のリソースレベルでポリシーを適用する
・管理グループレベルでロールベースのアクセス制御を構成する
・管理グループレベルで必要なポリシーを適用する
・タグを使用してサブスクリプション間でリソースを分類する

---

****
**解答例**
・管理グループを作成し、すべてのサブスクリプションを割り当てる
・管理グループレベルでロールベースのアクセス制御を構成する
・管理グループレベルで必要なポリシーを適用する

**解説**
複数のサブスクリプションを統一的に管理するには、管理グループを活用することが最も効率的です。管理グループは、複数のサブスクリプションを階層的に整理し、ポリシーやアクセス制御を一元管理するための機能です。

まず管理グループを作成し、管理対象となるすべてのサブスクリプションをその配下に割り当てます。これにより、組織の構造に合わせた階層的な管理が可能になります。

次に、管理グループレベルで Azure Policy を適用します。管理グループに適用されたポリシーは、その配下のすべてのサブスクリプションとリソースに自動的に継承されるため、コンプライアンス要件を効率的に適用できます。個々のリソースレベルでポリシーを適用する方法は、管理の複雑性が増し非効率です。

さらに、管理グループレベルで RBAC (Role-Based Access Control) を構成します。管理グループでロールを割り当てることで、配下のすべてのサブスクリプションに対するアクセス権限を一括管理できます。個別のリソースレベルでアクセス制御を構成する方法は、管理の手間が増大します。

サブスクリプションごとに個別のリソースグループを作成することは、リソースの論理的な整理には有効ですが、サブスクリプション横断的な一元管理には直接貢献しません。タグによる分類も補助的な手段であり、ポリシーやアクセス制御の統一管理には不十分です。

| 管理レベル | 適用範囲 | 用途 |
| :--- | :--- | :--- |
| 管理グループ | 複数サブスクリプション | 統一的なポリシーとアクセス管理 |
| サブスクリプション | 単一サブスクリプション内 | 部門やプロジェクト単位の管理 |

---

****
| リソースグループ | 関連リソースの集合 | ライフサイクルが同じリソースの管理 |

| 機能 | 管理グループでの適用 | 個別リソースでの適用 |
| :--- | :--- | :--- |
| Azure Policy | 配下全体に自動継承 | 個別設定が必要で非効率 |
| RBAC | 一括でアクセス権限管理 | リソースごとに設定が必要 |
| 管理効率 | 高い | 低い |

**リファレンス**
・Management Group
・Azure Policy
・Azure RBAC (Role-Based Access Control)

---

****
**問題 110. Microsoft Entra テナントにリンクされた Azure サブスクリプションがあります。テナントには User-A と User-B という 2 人のユーザーが含まれています。サブスクリプションには以下のリソースとアラートルールが含まれています。User-A が新しい仮想ディスクを作成して VM-A に接続した場合、どのアラートルールがトリガーされますか。（一つ選択）**

リソース構成：
| 名前 | タイプ | 説明 |
| :--- | :--- | :--- |
| RG-A | リソースグループ | なし |
| VM-A | 仮想マシン | RG-A で作成 |

アラートルール構成：
| 名前 | スコープ | 条件 |
| :--- | :--- | :--- |
| Alert-A | RG-A | すべての管理操作 |
| Alert-B | VM-A | すべての管理操作 |

・Alert-A のみがトリガーされる
・Alert-A と Alert-B の両方がトリガーされる
・アラートはトリガーされない
・Alert-B のみがトリガーされる

---

****
**解答例**
・Alert-A と Alert-B の両方がトリガーされる

**解説**
Azure Monitor のアクティビティログアラートは、指定されたスコープ内で発生する管理操作を監視します。仮想ディスクの作成と接続は管理操作に該当するため、適切に設定されたアラートルールがトリガーされます。

User-A が実行した操作は「新しい仮想ディスクの作成」と「VM-A へのディスク接続」という 2 つの管理操作です。Alert-A はリソースグループ RG-A をスコープとしており、RG-A 内のすべてのリソースに対する管理操作を監視します。Alert-B は VM-A を直接スコープとしており、VM-A に対する管理操作を監視します。

仮想ディスクの作成は RG-A 内で実行される管理操作であり、Alert-A の監視対象です。また VM-A へのディスク接続は VM-A リソース自体に対する変更操作であり、Alert-B の監視対象です。リソースグループスコープのアラートは、そのリソースグループ内のすべてのリソースに対する操作を検出するため、VM-A への操作も Alert-A によって検出されます。

アラートスコープと検出範囲：
| アラート名 | スコープ | 検出される操作 |
| :--- | :--- | :--- |
| Alert-A | RG-A | RG-A 内のすべてのリソースに対する管理操作 |
| Alert-B | VM-A | VM-A に対する直接的な管理操作 |

したがって、User-A の操作によって Alert-A と Alert-B の両方がトリガーされます。リソースグループレベルのアラートは階層的に機能し、配下のリソースに対する操作も検出する点が重要です。

---

****
**リファレンス**
・Azure Monitor アクティビティログアラート
・リソースグループスコープ

---

****
**問題 111. あなたの組織では、新しいプロジェクトとして Azure Web App を 4 つ作成する予定です。各 Web App のランタイムスタック要件は次の通りです：WebApp-A は .NET 6 (LTS)、WebApp-B は ASP.NET V4.8、WebApp-C は PHP 8.1、WebApp-D は Python 3.11 を使用します。これらの Web App をデプロイするために必要な App Service プランの最小数を選択してください。（一つ選択）**

・1 個の App Service プランで全ての Web App をホスト可能
・2 個の App Service プランが必要
・3 個の App Service プランが必要
・4 個の App Service プランが必要（各 Web App に 1 つずつ）

---

****
**解答例**
・1 個の App Service プランで全ての Web App をホスト可能

**解説**
App Service プランは、Web App を実行するためのコンピューティングリソースを定義します。同一の App Service プラン内で複数の Web App をホストでき、異なるランタイムスタックを持つアプリケーションも共存可能です。

この問題の重要なポイントは、App Service プランがランタイムスタックに依存しないという点です。.NET、ASP.NET、PHP、Python など、どのランタイムスタックを選択しても、同じ App Service プラン上で複数の Web App を実行できます。App Service プランで制限されるのは、オペレーティングシステム（Windows または Linux）とリージョンです。

本問題では、全てのランタイムスタック（.NET 6、ASP.NET V4.8、PHP 8.1、Python 3.11）が Windows OS で動作可能であるため、1 つの Windows App Service プランで全ての Web App をホストできます。

App Service プランを分ける必要があるのは、以下のような場合です：

| 分離が必要なケース | 理由 |
| :--- | :--- |
| 異なる OS 要件 | Windows と Linux のアプリを混在できない |
| 異なるリージョン | 地理的に離れた場所へのデプロイ |
| リソース分離 | パフォーマンスやセキュリティ要件による分離 |

コスト最適化の観点からも、可能な限り少ない App Service プランで複数の Web App を運用することが推奨されます。ただし、本番環境では負荷分散やリソース競合を考慮して、適切にプランを分割することも検討すべきです。

---

****
**リファレンス**
・App Service Plan
・Azure Web App
・ランタイムスタック

---

****
**問題 112. 複数のユーザーと管理者を含む Azure サブスクリプションがあります。次の JSON を使用して新しいカスタムロールを作成します。このカスタムロールが割り当てられたユーザーが実行できるアクションを 3 つ選択してください。（該当するものをすべて選択）**

```json
{
  "Name": "Custom Role",
  "Id": null,
  "IsCustom": true,
  "Description": "Custom Role description",
  "Actions": [
    "Microsoft.Compute/*/read",
    "Microsoft.Compute/snapshots/write",
    "Microsoft.Compute/snapshots/read",
    "Microsoft.Support/*"
  ],
  "NotActions": [
    "Microsoft.Compute/snapshots/delete"
  ],
  "AssignableScopes": [
    "/subscriptions/00000000-0000-0000-0000-000000000000",
    "/subscriptions/11111111-1111-1111-1111-111111111111"
  ]
}
```

・スナップショットの作成と読み取りを実行する
・Microsoft サポートに問い合わせる

---

****
・仮想マシンのすべての設定を読み取る
・スナップショットの作成と削除を実行する
・仮想マシンディスクの暗号化設定を変更する

---

****
**解答例**
・スナップショットの作成と読み取りを実行する
・Microsoft サポートに問い合わせる
・仮想マシンのすべての設定を読み取る

**解説**
このカスタムロールのアクセス許可を正確に理解するには、Actions と NotActions の組み合わせを分析する必要があります。

Actions セクションでは `Microsoft.Compute/*/read` により、Compute リソース全般の読み取り権限が付与されます。これには仮想マシン、ディスク、スナップショットなどすべての Compute リソースの設定読み取りが含まれます。`Microsoft.Compute/snapshots/write` と `Microsoft.Compute/snapshots/read` により、スナップショットの作成と読み取りが明示的に許可されます。`Microsoft.Support/*` により、Microsoft サポートへの問い合わせを含むすべてのサポート操作が可能です。

NotActions セクションの `Microsoft.Compute/snapshots/delete` は、Actions で許可された権限から削除操作を除外します。つまり、スナップショットの作成と読み取りは可能ですが、削除は実行できません。

仮想マシンディスクの暗号化設定変更には書き込み権限が必要ですが、このロールには読み取り権限のみが付与されているため実行できません。

| アクション | 実行可否 | 理由 |
| :--- | :--- | :--- |
| スナップショット作成・読取 | 可能 | Actions 内で明示的に許可 |
| スナップショット削除 | 不可 | NotActions で除外 |
| VM 設定読取 | 可能 | Compute/*/read で許可 |

---

****
| サポート問合せ | 可能 | Support/* で許可 |
| ディスク暗号化変更 | 不可 | 書込権限なし |

**リファレンス**
・Azure RBAC (Role-Based Access Control)
・Actions と NotActions

---

****
**問題 113. Azure Storage アカウントで SMB マルチチャネルに対応したファイル共有を作成します。コストを最小限に抑えながら要件を満たすストレージ構成を選択してください。（一つ選択）**

・ローカル冗長ストレージ (LRS) による Premium パフォーマンス
・geo 冗長ストレージ (GRS) による Premium パフォーマンス
・ゾーン冗長ストレージ (ZRS) による Standard パフォーマンス
・読み取りアクセス geo 冗長ストレージ (RA-GRS) による Premium パフォーマンス

---

****
**解答例**
・ローカル冗長ストレージ (LRS) による Premium パフォーマンス

**解説**
SMB マルチチャネルは Azure Files の Premium パフォーマンス層でのみ利用可能な機能です。この機能により、複数のネットワーク接続を同時に使用してスループットとパフォーマンスを向上させることができます。

Premium パフォーマンス層では、FileStorage アカウントの種類を使用し、冗長性オプションとして LRS、ZRS、GZRS から選択できます。コストを最小限に抑えるには、最も低コストな冗長性オプションである LRS を選択します。LRS は単一データセンター内でデータを 3 回複製し、ハードウェア障害から保護します。

Standard パフォーマンス層では SMB マルチチャネルがサポートされないため、要件を満たしません。GRS や RA-GRS は地理的冗長性を提供しますが、LRS と比較してコストが高くなります。

以下の表でパフォーマンス層と冗長性オプションの関係を整理します。

| パフォーマンス層 | SMB マルチチャネル対応 | 利用可能な冗長性オプション |
| :--- | :--- | :--- |
| Premium | 対応 | LRS, ZRS, GZRS |
| Standard | 非対応 | LRS, ZRS, GRS, RA-GRS, GZRS, RA-GZRS |

コスト最適化の観点では、Premium 層内で LRS が最も低コストな選択肢となります。

**リファレンス**
・Azure Files
・Azure Storage 冗長性

---

****
**問題 114. Azure サブスクリプションに複数のリソースが含まれています。share1 に対して User1 に Storage File Data SMB Share Contributor ロールを割り当てます。最初に実行すべき操作はどれですか。（一つ選択）**

・storage1 のファイル共有に対して ID ベースのデータアクセスを有効化する
・storage1 のセキュリティプロファイルを変更する
・share1 に対してアクセス制御 (IAM) を構成する
・Azure portal で storage1 に対して Microsoft Entra ID 認証を規定として選択する

---

****
**解答例**
・storage1 のファイル共有に対して ID ベースのデータアクセスを有効化する

**解説**
Azure Files で Microsoft Entra ID（旧 Azure Active Directory）を使用した ID ベースの認証を実装する場合、最初にストレージアカウントレベルで ID ベース認証を有効化する必要があります。この設定により、SMB プロトコル経由でのファイル共有アクセスに対して Microsoft Entra ID の資格情報を使用できるようになります。

Storage File Data SMB Share Contributor ロールは、Azure Files の SMB 共有に対する読み取り、書き込み、削除のアクセス許可を付与する Azure RBAC ロールです。このロールを割り当てる前提条件として、ストレージアカウントで ID ベースのデータアクセスが有効化されている必要があります。

有効化の手順として、share1 のアクセス制御 (IAM) で User1 に対して Storage File Data SMB Share Contributor ロールを割り当てます。さらに、Windows 環境からアクセスする場合は、共有レベルとディレクトリ / ファイルレベルの NTFS アクセス許可も適切に構成する必要があります。

| 設定項目 | 説明 |
| :--- | :--- |
| ID ベース認証の有効化 | ストレージアカウントレベルで設定し、Microsoft Entra ID による認証を可能にする |
| Azure RBAC ロールの割り当て | 共有レベルでのアクセス権限を制御する |
| NTFS アクセス許可 | ディレクトリやファイルレベルでの詳細なアクセス制御を実装する |

**リファレンス**
・Azure Files
・Microsoft Entra ID

---

****
・Azure RBAC (Role-Based Access Control)

---

****
**問題 115. あなたは Azure 環境内でユーザー ID とガバナンスを管理する責任者です。新入社員に対して、ユーザーアカウントとグループの作成・管理、サポートチケットの管理、サービス正常性の監視を行う権限を付与します。最小特権の原則に従って権限を割り当てる必要があります。新入社員に割り当てるべき Microsoft Entra ロールはどれですか。（一つ選択）**

・Service Support Administrator
・User Administrator
・Global Administrator
・Helpdesk Administrator

---

****
**解答例**
・User Administrator

**解説**
この問題は最小特権の原則に基づいて、必要な権限のみを持つ適切な Microsoft Entra ロールを選択する問題です。

User Administrator ロールは、ユーザーアカウントとグループの完全な管理権限を持ち、パスワードのリセット、ライセンスの管理、サポートチケットの作成と管理が可能です。また、Azure portal を通じてサービス正常性の監視も実行できます。このロールは管理者権限を持たないユーザーに対する管理操作に特化しており、設問の要件を満たす最小の権限セットを提供します。

Global Administrator は組織内のすべてのリソースに対する完全な管理権限を持つため、最小特権の原則に反します。Service Support Administrator と Helpdesk Administrator は主にサポートチケットの管理とパスワードリセットに特化しており、ユーザーとグループの作成権限が不足しています。

Microsoft Entra ロールの権限比較：
| ロール | ユーザー管理 | グループ管理 | サポートチケット |
| :--- | :--- | :--- | :--- |
| User Administrator | 完全な権限 | 完全な権限 | 管理可能 |
| Helpdesk Administrator | 限定的 | 不可 | 管理可能 |
| Global Administrator | 完全な権限 | 完全な権限 | 管理可能 |

最小特権の原則では、業務遂行に必要な最小限の権限のみを付与することでセキュリティリスクを低減します。User Administrator は設問の要件を満たす最も適切な選択肢となります。

---

****
**リファレンス**
・Microsoft Entra ID
・Azure RBAC (Role-Based Access Control)
・Principle of Least Privilege

---

****
**問題 116. 2 つの Azure サブスクリプション（サブスクリプション 1 とサブスクリプション 2）があり、それぞれ異なる Microsoft Entra テナントに関連付けられています。サブスクリプション 1 には仮想ネットワーク VNet1（IP アドレス空間：10.0.0.0/16）があり、仮想マシン VM1 が含まれています。サブスクリプション 2 には仮想ネットワーク VNet2（IP アドレス空間：10.10.0.0/24）があり、仮想マシン VM2 が含まれています。VNet1 と VNet2 間でプライベート通信を確立する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

・VNet1 をサブスクリプション 2 に移動する
・各仮想ネットワークに VPN Gateway をデプロイする
・VM1 をサブスクリプション 2 に移動する
・VNet2 の IP アドレス空間を変更する

---

****
**解答例**
・各仮想ネットワークに VPN Gateway をデプロイする

**解説**
異なる Microsoft Entra テナントに属するサブスクリプション間で仮想ネットワークを接続する場合、VNet Peering は利用できません。VNet Peering は同一テナント内、または信頼関係のあるテナント間でのみ機能するためです。このシナリオでは、VPN Gateway を使用した VNet 間 VPN 接続（VNet-to-VNet VPN）が必要です。

VPN Gateway による接続では、各仮想ネットワークに VPN Gateway リソースをデプロイし、IPsec トンネルを確立します。この方法により、テナントやサブスクリプションの境界を越えた安全な通信が可能になります。現在の IP アドレス空間（10.0.0.0/16 と 10.10.0.0/24）は重複していないため、アドレス空間の変更は不要です。

仮想ネットワークや VM の移動は、テナント間では直接実行できず、複雑な再構築が必要となるため現実的ではありません。VPN Gateway のデプロイが最も適切な最初のステップです。

| 接続方法 | テナント間対応 | 必要なリソース |
| :--- | :--- | :--- |
| VNet Peering | 不可（同一テナントのみ） | なし |
| VNet-to-VNet VPN | 可能 | VPN Gateway（各 VNet） |
| ExpressRoute | 可能 | ExpressRoute 回線 |

**リファレンス**
・VPN Gateway
・Virtual Network Peering

---

****
**問題 117. Microsoft 365 テナントと hogehoge.com という名前の Azure Active Directory（Azure AD）テナントがあります。User1、User2、User3 という 3 人のユーザーに、Library1 という名前の一時的な Microsoft SharePoint ドキュメントライブラリへのアクセスを許可します。ユーザー用のグループを作成する必要があり、グループは 180 日後に自動的に削除される必要があります。作成すべきグループはどれですか。（二つ選択）**

・Dynamic User メンバーシップタイプを使用する Microsoft 365 グループ
・Assigned メンバーシップタイプを使用するセキュリティグループ
・Dynamic Device メンバーシップタイプを使用するセキュリティグループ
・Assigned メンバーシップタイプを使用する Microsoft 365 グループ
・Dynamic User メンバーシップタイプを使用するセキュリティグループ

---

****
**解答例**
・Assigned メンバーシップタイプを使用する Microsoft 365 グループ
・Dynamic User メンバーシップタイプを使用する Microsoft 365 グループ

**解説**
グループの有効期限ポリシーは Microsoft 365 グループ（旧 Office 365 グループ）にのみ適用できます。セキュリティグループには有効期限ポリシーを設定できないため、180 日後の自動削除要件を満たせません。

Microsoft 365 グループでは、Assigned メンバーシップタイプ（手動でメンバーを追加）と Dynamic User メンバーシップタイプ（属性ベースで自動的にメンバーを追加）の両方で有効期限ポリシーが機能します。SharePoint ライブラリへのアクセス制御という用途では、どちらのメンバーシップタイプでも要件を満たせます。

Dynamic Device メンバーシップタイプはデバイスオブジェクトを対象とするため、ユーザーアクセスの管理には適していません。

| グループタイプ | 有効期限ポリシー | メンバーシップタイプ |
| :--- | :--- | :--- |
| Microsoft 365 グループ | 対応 | Assigned, Dynamic User |
| セキュリティグループ | 非対応 | Assigned, Dynamic User, Dynamic Device |

Azure AD の有効期限ポリシーを設定すると、指定した日数（この場合 180 日）が経過した後、グループ所有者に更新通知が送信されます。更新されない場合、グループは自動的に削除されます。この機能により、使用されなくなった一時的なリソースへのアクセス権を自動的にクリーンアップできます。

**リファレンス**
・グループ有効期限ポリシー

---

****
**問題 118. あなたの会社では、複数のストレージアカウント (storage1、storage2、storage4) に Azure File Shares が構成されています。Group4 というセキュリティグループに対して、すべての Azure File Shares への読み取り専用アクセス権を Azure RBAC で付与する必要があります。この要件を満たすために実施すべき操作を選択してください。（一つ選択）**

・storage2 でファイル共有に対する ID ベースのアクセスを有効化する
・storage1 と storage4 のアカウント種類を StorageV2 (汎用 v2) に変更する
・storage1、storage2、storage4 に対して Shared Access Signature (SAS) を作成する
・storage2 を削除して再作成し、階層型名前空間を有効化する

---

****
**解答例**
・storage2 でファイル共有に対する ID ベースのアクセスを有効化する

**解説**
Azure File Shares で Azure RBAC によるアクセス制御を実現するには、ストレージアカウントで ID ベースのアクセス（Identity-based access）を有効化する必要があります。この機能により、Microsoft Entra ID（旧 Azure Active Directory）のユーザーやグループに対して、Azure RBAC ロール（Storage File Data SMB Share Reader など）を割り当てることが可能になります。

storage2 で ID ベースのアクセスを有効化することで、Group4 に対してすべてのファイル共有への読み取り専用権限を一元的に付与できます。この設定は、ストレージアカウントの「構成」ブレードから「ID ベースのアクセス」オプションを有効にすることで実現します。

他の選択肢が不適切な理由を整理します。階層型名前空間は Azure Data Lake Storage Gen2 の機能であり、Azure File Shares の RBAC 制御とは直接関係ありません。SAS はトークンベースの一時的なアクセス制御であり、Azure RBAC による永続的な権限管理とは異なります。StorageV2 への変更は、既にこのアカウント種類であれば不要であり、RBAC 有効化の前提条件ではありません。

| 機能 | 用途 | RBAC 対応 |
| :--- | :--- | :--- |
| ID ベースのアクセス | Microsoft Entra ID との統合 | 対応 |
| SAS | トークンベースの一時アクセス | 非対応 |
| 階層型名前空間 | Data Lake Gen2 の機能 | File Shares 非対応 |

Azure File Shares で RBAC を使用する際の主なロールには、Storage File Data SMB Share Reader（読み取り専用）、Storage File Data SMB Share Contributor（読み書き）、Storage File Data SMB Share Elevated Contributor（フルコントロール）があります。これらのロールは、ストレージアカウントまたは個別のファイル共有レベルで割り当て可能

---

****
です。

**リファレンス**
・Azure Files
・Azure RBAC (Role-Based Access Control)
・Microsoft Entra ID

---

****
**問題 119. Windows 上で動作する Azure App Service Web App を作成します。この Web App は 5 インスタンスへのスケーリング、45GB のストレージ、カスタムドメイン名が必要です。コストを最小限に抑えるソリューションを選択します。どの App Service プランを使用しますか。（一つ選択）**

・Standard プラン
・Premium プラン
・Basic プラン
・Shared プラン

---

****
**解答例**
・Standard プラン

**解説**
この問題では、要件を満たしながらコストを最小化する App Service プランを選択する必要があります。各要件を確認すると、5 インスタンスへのスケーリング、45GB のストレージ、カスタムドメイン名の 3 つが必須条件です。

App Service プランの各階層には、インスタンス数の上限、ストレージ容量、機能の制限があります。Basic プランは最大 3 インスタンスまでしかスケールできないため、5 インスタンスの要件を満たせません。Shared プランはインスタンスのスケーリングに対応しておらず、共有インフラストラクチャ上で動作するため要件を満たしません。

Standard プランは最大 10 インスタンスまでスケール可能で、50GB のストレージを提供し、カスタムドメインにも対応しています。Premium プランも要件を満たしますが、より高度な機能（VNet 統合、より多くのインスタンス数など）を提供するため、コストが高くなります。

したがって、すべての要件を満たしながらコストを最小化できるのは Standard プランです。

| プラン | 最大インスタンス数 | ストレージ容量 | カスタムドメイン |
| :--- | :--- | :--- | :--- |
| Basic | 3 | 10GB | 対応 |
| Standard | 10 | 50GB | 対応 |
| Premium | 30 | 250GB | 対応 |

**リファレンス**
・App Service Plan
・スケールアップとスケールアウト

---

****
・Custom Domain

---

****
**問題 120. App1 という名前の Azure Logic App があります。App1 は、HTTP POST リクエストまたは HTTP GET リクエストを受信すると応答を返します。ピーク時には、App1 は 5 分間に最大 200,000 件のリクエストを受信すると予想されます。App1 が予想される負荷を処理できるようにします。何を構成しますか。（一つ選択）**

・Concurrency control
・API connections
・Access control (IAM)
・Run after settings

---

****
**解答例**
・Concurrency control

**解説**
この問題は、Azure Logic App の高負荷処理における同時実行制御の設定を問うものです。5 分間に 200,000 件のリクエストを処理するには、Logic App の並列実行能力を最適化する必要があります。

Logic App では、デフォルトで同時実行数に制限があり、標準的な設定では大量のリクエストを効率的に処理できません。Concurrency control（同時実行制御）を構成することで、Logic App が同時に処理できるワークフローインスタンスの数を調整できます。この設定により、最大 50 個までの並列実行が可能になり、高負荷時のスループットを大幅に向上させることができます。

Concurrency control は、Logic App のトリガー設定内で構成します。Workflow settings から Settings セクションにアクセスし、Concurrency Control をオンにして、必要な並列度を設定します。この設定により、複数のリクエストを同時に処理し、キューイングされたリクエストを効率的に消化できます。

API connections は外部サービスとの接続を管理するものであり、Logic App 自体の処理能力には影響しません。Access control (IAM) はアクセス権限の管理に使用され、パフォーマンスとは無関係です。Run after settings はアクションの実行条件を制御するものであり、同時実行数の制御には使用できません。

| 設定項目 | 用途 | 負荷処理への影響 |
| :--- | :--- | :--- |
| Concurrency control | 同時実行数の制御 | 高負荷時のスループット向上 |
| API connections | 外部接続の管理 | 処理能力に影響なし |
| Access control (IAM) | アクセス権限管理 | 処理能力に影響なし |

---

****
**リファレンス**
・Azure Logic Apps
・Concurrency control（並行性制御）

---

****
**問題 121. ある Azure サブスクリプションに、Windows Server 2022 を実行する 2 つの仮想マシン VM-A と VM-B があります。VM-A は Azure Backup エージェントを使用せず、Azure Backup によって毎日バックアップされています。VM-A がランサムウェアの影響を受けデータが暗号化されたため、最新のバックアップから復元を実行します。このとき、VM-A のファイルレベル回復を実行できる場所はどれですか。（一つ選択）**

・VM-A のみ
・VM-A または VM-B
・VM-A または新しい Azure 仮想マシン
・インターネットに接続できる任意の Windows コンピューター
・新しい Azure 仮想マシンのみ

---

****
**解答例**
・インターネットに接続できる任意の Windows コンピューター

**解説**
Azure Backup のファイルレベル回復（File Recovery）機能を使用すると、仮想マシン全体を復元することなく、バックアップから特定のファイルやフォルダーを選択的に復元できます。この機能は、Recovery Services コンテナーから復旧ポイントを選択し、実行可能なスクリプトをダウンロードして実行することで利用します。

このスクリプトは、バックアップされた仮想マシンのディスクを一時的にマウントし、必要なファイルをコピーできるようにします。重要な点は、このスクリプトはインターネット接続があればどの Windows コンピューターでも実行可能であることです。Azure 仮想マシンである必要はなく、オンプレミスのマシンや他のクラウド環境のマシンでも実行できます。

ただし、実行するマシンには以下の要件があります。スクリプトを実行するマシンは、バックアップされた仮想マシンと同じまたは互換性のある OS である必要があります。また、Azure Backup サービスへの通信に必要なポート（443 ポート）が開放されている必要があります。スクリプト実行後、復旧ポイントのディスクがローカルドライブとしてマウントされ、エクスプローラーなどで通常のファイル操作が可能になります。

| 復元方法 | 実行可能な場所 | 用途 |
| :--- | :--- | :--- |
| ファイルレベル回復 | インターネット接続可能な任意の Windows マシン | 特定ファイルの選択的復元 |
| 仮想マシン全体の復元 | 元の仮想マシンまたは新しい仮想マシン | システム全体の復旧 |
| ディスク復元 | 新しいディスクとして復元 | カスタム構成での復元 |

**リファレンス**
・Azure Backup

---

****
・Recovery Services Vault

---

****
**問題 122. 組織が所有する Azure サブスクリプションにストレージアカウントがあり、Web サイトのデータを保存しています。ユーザーからのトラフィックが、ユーザーの地理的位置に最も近い Microsoft のポイントオブプレゼンス (POP) を経由してストレージアカウントにアクセスするように構成します。どの設定を使用しますか。（一つ選択）**

・ルーティング設定
・Azure Front Door
・プライベートエンドポイント
・Azure Firewall

---

****
**解答例**
・ルーティング設定

**解説**
Azure ストレージアカウントのルーティング設定では、クライアントからストレージアカウントへのネットワークトラフィックの経路を制御できます。この設定により、Microsoft グローバルネットワークを最適に活用し、ユーザーに最も近い POP を経由させることが可能です。

ルーティング設定には 2 つのオプションがあります。Microsoft ネットワークルーティングでは、トラフィックがユーザーに最も近い Microsoft POP に入り、その後 Microsoft のグローバルネットワーク内を経由してストレージアカウントに到達します。これにより低遅延で信頼性の高い接続が実現します。一方、インターネットルーティングでは、トラフィックがストレージアカウントに最も近い POP までパブリックインターネットを経由します。

本問では、ユーザーの場所に最も近い POP を使用する要件があるため、Microsoft ネットワークルーティングを選択することで、トラフィックが早期に Microsoft ネットワークに入り、最適化された経路で配信されます。

| 項目 | Microsoft ネットワークルーティング | インターネットルーティング |
| :--- | :--- | :--- |
| トラフィック経路 | ユーザー近くの POP から入り MS 網内を経由 | パブリックインターネット経由 |
| 遅延 | 低遅延 | 標準 |
| コスト | 標準料金 | 低コスト |

Azure Front Door はグローバルな負荷分散と CDN サービスですが、ストレージアカウント自体のルーティング制御には使用しません。プライベートエンドポイントは VNet 内からのプライベート接続を提供しますが、パブリックアクセスのルーティング最適化には該当しません。Azure Firewall はネットワークセキュリティサービスであり、トラフィックのルーティング最適化機能は提供しません。

---

****
**リファレンス**
・Azure ストレージアカウント
・Microsoft Global Network

---

****
**問題 123. あなたの組織は、基幹業務システムが稼働する Azure サブスクリプション「Subscription-A」を所有しています。Subscription-A には、VM-A という名前の仮想マシンと App-A という名前の Azure Functions が含まれます。VM-A が停止した場合に App-A を自動実行するアラートルールを作成します。アラートルールに必要なコンポーネントは何ですか。（一つ選択）**

・アクショングループ
・Azure Automation Runbook
・動的メンバーシップルールを持つセキュリティグループ
・アプリケーションセキュリティグループ

---

****
**解答例**
・アクショングループ

**解説**
Azure Monitor のアラートルールで特定のイベント発生時に自動アクションを実行するには、アクショングループの構成が必要です。アクショングループは、アラートがトリガーされた際に実行する一連のアクション（通知や自動化されたタスク）を定義するコンポーネントです。

本問では、VM-A の停止を検知して App-A (Azure Functions) を実行する必要があります。この要件を実現するには、まず VM-A の状態を監視するアラートルールを作成し、そのアラートルールにアクショングループを関連付けます。アクショングループ内で、Azure Functions を呼び出す Webhook アクションや Logic App トリガーなどを設定することで、VM-A 停止時の自動実行が可能になります。

他の選択肢は以下の理由で不適切です。Azure Automation Runbook は自動化タスクの実行に使用できますが、アラートルールと直接統合するにはアクショングループ経由での設定が必要です。動的メンバーシップルールを持つセキュリティグループは、Azure AD でユーザーやデバイスの動的な管理に使用され、アラートアクションとは無関係です。アプリケーションセキュリティグループは、ネットワークセキュリティグループ (NSG) 内でアプリケーション中心のセグメンテーションを実現する機能であり、アラート機能とは関連しません。

| コンポーネント | 用途 | アラートアクションとの関連 |
| :--- | :--- | :--- |
| アクショングループ | アラート発生時の通知・自動実行 | 直接統合可能 |
| Azure Automation Runbook | スクリプトベースの自動化 | アクショングループ経由で利用 |
| セキュリティグループ | ID 管理・アクセス制御 | 無関係 |

---

****
**リファレンス**
・Azure Automation
・Azure Monitor
・Action Group
・Azure Functions

---

****
**問題 124. Azure Kubernetes Service (AKS) クラスターが稼働しています。Azure Container Registry (ACR) に保存されているコンテナイメージを使用してアプリケーションをデプロイします。この要件を満たすために使用するコマンドを選択してください。（一つ選択）**

・kubectl apply
・az aks create
・docker run
・helm install

---

****
**解答例**
・kubectl apply

**解説**
Azure Kubernetes Service 上でコンテナイメージをデプロイする際は、Kubernetes の標準 CLI ツールである kubectl を使用します。kubectl は Kubernetes クラスターを管理するための公式コマンドラインツールで、マニフェストファイル（YAML 形式）を適用してリソースを作成・更新できます。

Azure Container Registry に保存されたイメージを AKS にデプロイする基本的な手順は以下の通りです。まず ACR と AKS の統合を構成し、AKS クラスターが ACR からイメージをプルできるように認証を設定します。次に Deployment や Pod などの Kubernetes リソースを定義したマニフェストファイルを作成し、その中で ACR のイメージパスを指定します。最後に `kubectl apply -f manifest.yaml` コマンドでマニフェストを適用することでデプロイが実行されます。

他の選択肢について、az aks create は AKS クラスター自体を新規作成するコマンドであり、既存クラスターへのアプリケーションデプロイには使用しません。docker run はローカル環境で Docker コンテナを起動するコマンドで、Kubernetes クラスターの管理には対応していません。helm install は Helm パッケージマネージャーを使用したデプロイ方法ですが、基本的な Kubernetes リソースのデプロイには kubectl が標準的な選択肢となります。

| コマンド | 用途 |
| :--- | :--- |
| kubectl apply | Kubernetes リソースのデプロイと更新 |
| az aks create | AKS クラスターの新規作成 |
| docker run | ローカル環境でのコンテナ実行 |

---

****
**リファレンス**
・Azure Kubernetes Service (AKS)
・Azure Container Registry (ACR)
・kubectl

---

****
**問題 125. Azure サブスクリプションに、storage1 という名前のストレージアカウントがあります。storage1 アカウントには、share1 という名前のファイル共有が含まれています。サブスクリプションは、Group1 という名前のセキュリティグループを含むハイブリッド Azure Active Directory (Azure AD) テナントにリンクされています。share1 に対して Group1 に Storage File Data SMB Share Elevated Contributor ロールを付与します。最初に実行すべき操作を選択してください。（一つ選択）**

・Azure AD Domain Services (Azure AD DS) の統合を有効化する
・share1 を File Explorer を使用してマウントする
・storage1 に対して Active Directory Domain Services (AD DS) 認証を有効化する
・共有レベルのアクセス許可を File Explorer を使用して付与する

---

****
**解答例**
・storage1 に対して Active Directory Domain Services (AD DS) 認証を有効化する

**解説**
Azure Files で SMB プロトコルを使用した ID ベースの認証を実装するには、ストレージアカウントに対して認証方式を有効化する必要があります。ハイブリッド Azure AD 環境でオンプレミスの Active Directory と統合されたセキュリティグループに対して RBAC ロールを付与する場合、最初にストレージアカウントで AD DS 認証を有効化します。

AD DS 認証を有効化することで、オンプレミスの Active Directory 資格情報を使用して Azure Files へのアクセスが可能になり、その後 Azure RBAC を使用して共有レベルでのアクセス許可を構成できます。Storage File Data SMB Share Elevated Contributor ロールは、ファイルやディレクトリの読み取り、書き込み、削除、および Windows ACL の変更を許可する組み込みロールです。

認証方式の有効化の作業フローは以下の通りです。

| 手順 | 作業内容 | 説明 |
| :--- | :--- | :--- |
| 1 | AD DS 認証の有効化 | ストレージアカウントで認証方式を構成 |
| 2 | 共有レベルのアクセス許可 | Azure RBAC ロールをグループに割り当て |
| 3 | ディレクトリ / ファイルレベルのアクセス許可 | Windows ACL を使用して詳細な権限を設定 |

Azure AD DS 統合は別の認証オプションですが、問題文ではハイブリッド Azure AD 環境が既に構成されているため、オンプレミスの AD DS との統合が適切です。File Explorer でのマウントや共有レベルのアクセス許可付与は、認証方式の有効化の後に実行する作業です。

Azure Files の認証オプションには以下があります。

---

****
| 認証方式 | 用途 | 前提条件 |
| :--- | :--- | :--- |
| AD DS | オンプレミス AD との統合 | ハイブリッド環境、ドメイン参加済みマシン |
| Azure AD DS | クラウドのみの環境 | Azure AD DS のデプロイ |
| Azure AD Kerberos | Azure AD 参加デバイス | Azure AD のみの環境 |

**リファレンス**
・Azure Files
・Azure RBAC (Role-Based Access Control)
・Active Directory Domain Services

---

****
**問題 126. あなたの組織が所有する Azure 仮想マシン VM-A は、VNet-A という名前の仮想ネットワークに接続されています。VM-A の構成は、サブネット 10.0.0.0/24、可用性セット AVSet、ネットワークセキュリティグループなし、プライベート IP アドレス 10.0.0.4 (動的)、パブリック IP アドレス 40.90.219.6 (動的) です。インターネットに接続された Standard Load Balancer (slb-A) をデプロイし、VM-A への接続を許可するように構成します。slb-A にバックエンドプールを作成する前に実施すべき変更を選択してください。（一つ選択）**

・VM-A を可用性ゾーンに配置する
・VM-A からパブリック IP アドレスを削除する
・VM-A のプライベート IP アドレスを静的アドレスに変更する
・NSG を作成して VM-A に割り当てる

---

****
**解答例**
・VM-A からパブリック IP アドレスを削除する

**解説**
Standard Load Balancer のバックエンドプールに仮想マシンを追加する際、仮想マシンに直接割り当てられたパブリック IP アドレスは削除する必要があります。Load Balancer を経由したトラフィック制御を実現するため、バックエンドプール内の仮想マシンはプライベート IP アドレスのみで通信し、インターネットからのアクセスは Load Balancer のフロントエンド IP アドレスを経由する構成とします。

プライベート IP アドレスの動的割り当てと静的割り当ての違いは、Load Balancer のバックエンドプール構成には影響しません。動的 IP アドレスでも仮想マシンが実行中である限り同じ IP アドレスが維持されるため、静的への変更は必須ではありません。可用性セットに既に配置されているため、可用性ゾーンへの移動は不要です。NSG の割り当ては、トラフィック制御のベストプラクティスではありますが、Load Balancer のバックエンドプール構成の前提条件ではありません。

| 項目 | 必須変更 | 理由 |
| :--- | :--- | :--- |
| パブリック IP 削除 | 必要 | Load Balancer 経由の通信制御のため |
| プライベート IP 静的化 | 不要 | 動的 IP でも問題なく動作 |
| NSG 割り当て | 不要 | バックエンドプール構成の前提条件ではない |

**リファレンス**
・Azure Load Balancer
・Backend Pool
・Availability Set

---

****
**問題 127. hogehoge.co.jp という名前の Microsoft Entra テナントがあります。WebApp1 という名前の Azure App Service Web アプリと、Vault1 という名前の Azure Key Vault を含む Azure サブスクリプションがあります。Vault1 には、hogehoge.co.jp のワイルドカード証明書が含まれています。admin1@hogehoge.co.jp という名前のユーザーがおり、WebApp1 と Vault1 の所有者ロールが割り当てられています。Vault1 のワイルドカード証明書を使用するように WebApp1 を構成します。まず何を実施しますか。（一つ選択）**

・Vault1 のアクセスポリシーを作成し、admin1 をポリシーに割り当てる
・システム割り当てマネージド ID を WebApp1 に割り当てる
・Vault1 のアクセスポリシーを作成し、Microsoft Azure App Service のサービスプリンシパルをポリシーに割り当てる
・ロールベースのアクセス制御 (RBAC) 認証システムを使用するように Vault1 を構成する

---

****
**解答例**
・システム割り当てマネージド ID を WebApp1 に割り当てる

**解説**
App Service が Key Vault に格納された証明書にアクセスするには、マネージド ID を使用した認証が必要です。最初のステップとして、App Service にマネージド ID を割り当てることで、Azure リソース間の安全な認証基盤を確立します。

マネージド ID には、システム割り当てとユーザー割り当ての 2 種類があります。システム割り当てマネージド ID は、リソースのライフサイクルに紐づき、リソースの削除時に自動的に削除されます。App Service に対してマネージド ID を有効化すると、Azure AD に自動的にサービスプリンシパルが作成されます。

マネージド ID を割り当てた後、Key Vault のアクセスポリシーまたは RBAC で、このマネージド ID に対して証明書の読み取り権限を付与します。これにより、App Service は Key Vault から証明書を取得し、カスタムドメインの TLS/SSL バインディングに使用できるようになります。

ユーザーに所有者ロールが割り当てられていても、それは管理操作の権限であり、App Service が実行時に Key Vault にアクセスするための認証情報にはなりません。また、Microsoft Azure App Service のサービスプリンシパルは、すべての Azure テナントで共有される汎用的な ID であり、特定の App Service インスタンスを識別できないため、セキュリティ上推奨されません。

| 手順 | 実施内容 | 目的 |
| :--- | :--- | :--- |
| 1 | マネージド ID の割り当て | App Service の ID を確立 |
| 2 | Key Vault アクセス権限の付与 | 証明書へのアクセスを許可 |
| 3 | カスタムドメインと証明書の構成 | TLS/SSL バインディングの設定 |

---

****
**リファレンス**
・Azure Key Vault
・Azure App Service

---

****
**問題 128. Web 開発者が Web アプリケーションを作成し、Azure Web App としてデプロイする予定です。ユーザーは Web アプリケーションにアクセスする際に資格情報を入力する必要があります。WebApp1 という名前の新しい Web App を作成し、Web アプリケーションをデプロイしました。WebApp1 への匿名アクセスを無効にします。何を構成しますか。（一つ選択）**

・認証 / 承認
・デプロイ資格情報
・アクセス制御 (IAM)
・ネットワーク

---

****
**解答例**
・認証 / 承認

**解説**
WebApp1 への匿名アクセスを無効にし、ユーザーに資格情報の入力を求めるには、App Service の認証 / 承認機能を構成します。この機能は App Service 認証（Easy Auth）とも呼ばれ、アプリケーションコードを変更することなく、Azure AD、Microsoft、Google、Facebook、Twitter などの複数の ID プロバイダーを使用した認証を実装できます。

認証 / 承認を有効にすると、すべての受信 HTTP リクエストはアプリケーションコードに到達する前に認証モジュールを通過します。未認証のリクエストは自動的に ID プロバイダーのサインインページにリダイレクトされるため、匿名アクセスを効果的にブロックできます。

他の選択肢について、デプロイ資格情報はアプリケーションのデプロイ時に使用する認証情報であり、エンドユーザーのアクセス制御には使用しません。アクセス制御 (IAM) は Azure リソース自体の管理権限を制御するものであり、Web アプリケーションへのユーザーアクセスを制御する機能ではありません。ネットワークは IP アドレス制限などのネットワークレベルのアクセス制御を提供しますが、ユーザー認証機能は提供しません。

| 機能 | 用途 | 匿名アクセス制御 |
| :--- | :--- | :--- |
| 認証 / 承認 | エンドユーザーの認証とアクセス制御 | 可能 |
| アクセス制御 (IAM) | Azure リソースの管理権限制御 | 不可 |
| デプロイ資格情報 | アプリケーションのデプロイ認証 | 不可 |

**リファレンス**
・Microsoft Entra ID

---

****
**問題 129. 既存の Azure サブスクリプションに 10 台の仮想マシンが含まれています。オンプレミスネットワークと仮想マシン間のレイテンシを監視します。何を使用しますか。（一つ選択）**

・Azure Network Watcher の接続のトラブルシューティング
・Network Performance Monitor
・Azure Monitor の Service Map
・Network Watcher のネットワークセキュリティグループフローログ

---

****
**解答例**
・Network Performance Monitor

**解説**
オンプレミスネットワークと Azure 仮想マシン間のレイテンシを継続的に監視する場合、Network Performance Monitor (NPM) が最適です。NPM は Azure Monitor の機能の一部として提供され、ハイブリッド環境におけるネットワークパフォーマンスの可視化と監視を実現します。

NPM は以下の機能を提供します。オンプレミスと Azure 間のネットワーク接続の遅延やパケット損失を継続的に測定し、ExpressRoute や VPN 接続のパフォーマンスを監視できます。複数の仮想マシンに対して同時に監視を実行し、ネットワークトポロジ全体のパフォーマンスを把握できます。しきい値を設定してアラートを生成し、パフォーマンス低下を早期に検出できます。

他の選択肢について、接続のトラブルシューティングは特定時点での接続性テストに使用され、継続的な監視には適していません。Service Map はアプリケーションコンポーネントとそれらの依存関係を可視化する機能で、レイテンシ監視が主目的ではありません。NSG フローログはネットワークセキュリティグループを通過するトラフィックの記録に使用され、レイテンシ測定には対応していません。

| 機能 | 用途 | レイテンシ監視 |
| :--- | :--- | :--- |
| Network Performance Monitor | ハイブリッド環境の継続的監視 | 対応 |
| 接続のトラブルシューティング | 特定時点の接続性確認 | 非対応 |
| Service Map | 依存関係の可視化 | 非対応 |

**リファレンス**
・Network Performance Monitor

---

****
・Azure Network Watcher
・Azure Monitor

---

****
**問題 130. Azure 仮想マシン VM1 を作成する計画があります。VM1 は以下の構成で設定されます：リージョンは East US、可用性オプションは可用性セット、イメージは Windows Server 2019 Datacenter、サイズは Standard_D2s_v3、OS ディスクタイプは Standard HDD、データディスクは非管理ディスクを使用します。VM1 を可用性ゾーンに作成できるようにするために変更する必要がある設定を選択してください。（二つ選択）**

・可用性オプション
・イメージ
・マネージドディスクを使用
・OS ディスクタイプ
・サイズ

---

****
**解答例**
・可用性オプション
・マネージドディスクを使用

**解説**
可用性ゾーン（Availability Zone）は、Azure リージョン内の物理的に分離されたデータセンターで、電源、冷却、ネットワークが独立しています。可用性ゾーンに仮想マシンをデプロイする際には、特定の要件を満たす必要があります。

まず、可用性オプションの変更が必要です。可用性セットと可用性ゾーンは相互排他的な構成であり、同時に使用できません。可用性セットはラック単位の障害から保護しますが、可用性ゾーンはデータセンター単位の障害から保護します。VM1 を可用性ゾーンにデプロイするには、可用性オプションを「可用性ゾーン」に変更する必要があります。

次に、マネージドディスクの採用が必要です。可用性ゾーンにデプロイする仮想マシンは、必ずマネージドディスク (Managed Disks) を使用する必要があります。非管理ディスク (Unmanaged Disks) は可用性ゾーンをサポートしていません。マネージドディスクは自動的にゾーン冗長ストレージまたはゾーン固有のストレージとして構成され、ゾーンレベルの障害に対する回復力を提供します。

その他の設定については変更不要です。イメージ、サイズ、OS ディスクタイプは可用性ゾーンの要件に影響しません。ただし、選択したリージョンが可用性ゾーンをサポートしている必要があります。East US は可用性ゾーンをサポートしているため、この点は問題ありません。

| 設定項目 | 変更要否 | 理由 |
| :--- | :--- | :--- |
| 可用性オプション | 必要 | 可用性セットから可用性ゾーンへ変更 |
| ディスク管理 | 必要 | 非管理ディスクは可用性ゾーン非対応 |

---

****
| その他設定 | 不要 | 可用性ゾーン要件に影響なし |

**リファレンス**
・Availability Zone
・Managed Disk
・Availability Set

---

****
**問題 131. 企業が Azure Blob Storage を使用して大量の非構造化データを保存しています。このデータはアクセス頻度が低いものの、必要時には高速な取得が求められます。データ取得のパフォーマンスを損なうことなくストレージコストを最小化します。どうすればよいですか。（一つ選択）**

・Azure Blob Storage アカウントのアクセスティアを Cool に構成する
・Azure Blob Storage アカウントのアクセスティアを Hot に構成する
・Azure Blob Storage アカウントのアクセスティアを Cold に構成する
・ライフサイクル管理ポリシーを構成して Archive ティアに自動移行する




ご提示いただいた「AZ-104試験問題500_part1_part6.pdf」の抜粋（ソース から）に含まれる全文を、一文字も省略することなく、ソースの順序に従って以下に出力します。

---

**解答例**
・Azure Blob Storage アカウントのアクセスティアを Cool に構成する

**解説**
Azure Blob Storage のアクセスティアは、データのアクセス頻度とコスト要件に基づいて選択します。 本問では「アクセス頻度が低い」かつ「高速な取得が必要」という2つの要件を満たす必要があります。
Cool ティアは、アクセス頻度の低いデータ向けに最適化されており、Hot ティアと比較してストレージコストが約50％削減されます。 データは即座にアクセス可能で、取得時のレイテンシは Hot ティアとほぼ同等です。 一方で、アクセス料金は Hot ティアより高く設定されていますが、月に数回程度のアクセス頻度であれば総コストは抑えられます。
Hot ティアは頻繁にアクセスされるデータ向けで、ストレージコストが最も高くなります。 Cold ティアはさらにアクセス頻度が低いデータ向けで、最低保存期間が90日間と長く、早期削除には追加料金が発生します。 Archive ティアはオフラインストレージであり、データ取得に数時間かかるため「高速な取得」の要件を満たしません。

| アクセスティア | 想定アクセス頻度 | ストレージコスト | 取得速度 |
| :--- | :--- | :--- | :--- |
| Hot | 頻繁 | 高 | 即時 |
| Cool | 月数回程度 | 中 | 即時 |
| Cold | 年数回程度 | 低 | 即時 |
| Archive | ほぼなし | 最低 | 数時間 |

本シナリオでは、アクセス頻度が低くコスト削減が必要でありながら、高速取得も求められるため、Cool ティアが最適な選択となります。

**リファレンス**
・Azure Blob Storage
・アクセスティア

---

**問題 132.** あなたの組織では、Azure 仮想マシンのネットワーク通信に関する問題を診断するため、Azure Network Watcher の機能を活用することを検討しています。 現在、特定のネットワークセキュリティグループ (NSG) ルールが原因で、一部のパケットが仮想マシンに到達できない問題が発生しています。 どの NSG ルールがパケットの到達を阻止しているかを特定する必要があります。 この要件を満たすために使用すべき Azure Network Watcher の機能はどれですか。（一つ選択）

・接続のトラブルシューティング
・IP フロー検証
・ネクストホップ
・パケットキャプチャ

**解答例**
・IP フロー検証

**解説**
Azure Network Watcher の IP フロー検証は、特定の送信元と宛先の間でパケットが許可されるか拒否されるかをテストする診断ツールです。 この機能は、ネットワークセキュリティグループ (NSG) のどのルールがパケットの通過を許可または拒否しているかを特定できます。
IP フロー検証では、仮想マシンのネットワークインターフェイス、方向（受信/送信）、プロトコル、送信元/宛先の IP アドレスとポート番号を指定してテストを実行します。 結果として、パケットが許可されるか拒否されるか、そしてどの NSG ルールが適用されたかが表示されます。 これにより、ネットワーク接続の問題を迅速に診断し、適切なセキュリティルールの調整が可能になります。
他の選択肢について、接続のトラブルシューティングは仮想マシン間やオンプレミスとの接続性を検証する機能、ネクストホップはパケットの次の転送先を確認する機能、パケットキャプチャは実際のネットワークトラフィックをキャプチャして分析する機能です。

| 機能 | 主な用途 |
| :--- | :--- |
| IP フロー検証 | NSG ルールによるパケット許可/拒否の判定 |
| 接続のトラブルシューティング | エンドツーエンドの接続性検証 |
| ネクストホップ | ルーティングパスの確認 |

**リファレンス**
・Azure Network Watcher
・Network Security Group
・IP flow verify

---

**問題 133.** ARM テンプレートを使用して仮想マシンスケールセットに Windows Server 2022 を実行する複数の Azure 仮想マシンをデプロイし、各仮想マシンに NGINX をインストールして構成します。 この要件を満たすために使用すべきものはどれですか。（一つ選択）

・Azure Application Insights
・Custom Script Extension
・Desired State Configuration (DSC) 拡張機能
・Microsoft Entra アプリケーション プロキシ

**解答例**
・Desired State Configuration (DSC) 拡張機能

**解説**
ARM テンプレートを使用した仮想マシンスケールセットへのデプロイ時に、複数の仮想マシンに対して一貫した構成を適用する場合、Desired State Configuration (DSC) 拡張機能が最適です。 DSC 拡張機能を使用することで、仮想マシンの初期デプロイ時に NGINX のインストールと構成を自動化し、すべてのインスタンスで同一の構成状態を維持できます。
DSC 拡張機能は ARM テンプレート内で宣言的に定義でき、仮想マシンスケールセット内の各インスタンスに対して自動的に適用されます。 PowerShell DSC スクリプトを使用して NGINX のインストール、サービスの起動、構成ファイルの配置などを定義し、これを DSC 拡張機能経由で実行することで、スケールアウト時に新規作成される仮想マシンにも同じ構成が自動適用されます。
他の選択肢について、Custom Script Extension も仮想マシンへのソフトウェアインストールに使用できますが、DSC と比較して構成管理機能が限定的です。 Azure Application Insights はアプリケーション監視サービスであり、ソフトウェアのデプロイや構成には使用しません。 Microsoft Entra アプリケーション プロキシはオンプレミスアプリケーションへの安全なリモートアクセスを提供するサービスであり、仮想マシンの構成管理とは無関係です。

| 項目 | DSC 拡張機能 | Custom Script Extension |
| :--- | :--- | :--- |
| 用途 | 宣言的な構成管理 | スクリプト実行 |
| ARM 統合 | 完全対応 | 対応 |
| 構成ドリフト検出 | 対応 | 非対応 |
| 複雑な構成管理 | 適している | 限定的 |

**リファレンス**
・Azure Desired State Configuration (DSC)
・Virtual Machine Scale Set
・ARM Template

---

**問題 134.** Azure サブスクリプションに、ポリシーベースの仮想ネットワークゲートウェイ「GW-A」と仮想ネットワーク「VNet-A」が存在します。 組織が所有するオンプレミスのクライアント PC から VNet-A へのポイント対サイト (P2S) VPN 接続を構成します。 この要件を満たすために実行する必要があるアクションはどれですか。（二つ選択）

・ルートベースの仮想ネットワークゲートウェイを作成する
・GW-A へのポイント対サイト接続構成を追加する
・VNet-A にサービスエンドポイントを追加する
・VNet-A にゲートウェイサブネットを追加する
・GW-A を削除する

**解答例**
・ルートベースの仮想ネットワークゲートウェイを作成する
・GW-A を削除する

**解説**
ポイント対サイト (P2S) VPN 接続は、個々のクライアント PC から仮想ネットワークへの安全な接続を確立する機能です。 この接続を構成するには、ルートベースの VPN Gateway が必須要件となります。
現在の環境ではポリシーベースのゲートウェイ「GW-A」が存在していますが、ポリシーベースのゲートウェイは P2S 接続をサポートしていません。 Azure VPN Gateway では、既存のゲートウェイをポリシーベースからルートベースに直接変換することはできないため、既存の GW-A を削除してから、新しくルートベースのゲートウェイを作成する必要があります。
ルートベースのゲートウェイを作成する際は、VNet-A 内に GatewaySubnet という名前の専用サブネットが必要です。 このサブネットが既に存在する場合は、そのまま新しいゲートウェイの作成に進めます。 ゲートウェイ作成後、P2S 接続の構成（クライアント認証方法、アドレスプール、トンネルタイプなど）を追加することで、クライアント PC からの接続が可能になります。

| 項目 | ポリシーベース | ルートベース |
| :--- | :--- | :--- |
| P2S 接続 | 非対応 | 対応 |
| S2S 接続 | 対応（1 接続のみ） | 対応（複数接続可） |
| 変換 | 不可（再作成が必要） | - |

サービスエンドポイントは Azure PaaS サービスへのプライベート接続を提供する機能であり、P2S VPN 接続とは無関係です。 また、ゲートウェイのリセットは接続トラブルシューティングの手段であり、ゲートウェイタイプの変更には使用できません。

**リファレンス**
・VPN Gateway
・ポイント対サイト接続
・ルートベース VPN

---

**問題 135.** Azure サブスクリプションで Traffic Analytics を有効にするために、Azure Active Directory (Azure AD) ユーザーである Admin1 に必要なロールを割り当てます。 解決策として、サブスクリプションレベルで Admin1 に Network Contributor ロールを割り当てました。 この解決策は要件を満たしていますか？(一つ選択)

・いいえ、要件を満たしていない
・はい、要件を満たしている
・部分的に要件を満たしているが、追加で Reader 権限が必要
・部分的に要件を満たしているが、追加で Log Analytics Contributor 権限が必要

**解答例**
・いいえ、要件を満たしていない

**解説**
Traffic Analytics を有効にするには、Network Contributor ロールだけでなく Log Analytics Contributor ロールも必要です。 Traffic Analytics は Network Watcher の NSG(Network Security Group) フローログを分析する機能であり、Log Analytics ワークスペースにデータを送信して分析を行います。
Network Contributor ロールはネットワークリソースの管理権限を提供しますが、Log Analytics ワークスペースへのデータ書き込み権限は含まれていません。 そのため、Traffic Analytics を完全に構成するには、Log Analytics Contributor ロールまたはそれに相当する権限が追加で必要となります。
Traffic Analytics 有効化に必要な権限の要点を以下の表にまとめます。

| ロール | 権限範囲 | Traffic Analytics 有効化に必要か |
| :--- | :--- | :--- |
| Network Contributor | ネットワークリソースの管理 | 必要（NSG フローログ設定） |
| Log Analytics Contributor | Log Analytics ワークスペースの管理 | 必要（データ送信設定） |
| Reader | リソースの読み取り専用 | 不要 |

正しい解決策としては、Admin1 にサブスクリプションレベルで Network Contributor ロールと Log Analytics Contributor ロールの両方を割り当てる必要があります。 または、これらの権限を含むより上位のロール (Contributor や Owner など) を割り当てることでも要件を満たすことができます。

**リファレンス**
・Traffic Analytics
・Log Analytics Contributor

---

**問題 136.** Azure サブスクリプションに、ストレージアカウントが含まれています。 このストレージアカウントをゾーン冗長ストレージ (ZRS) レプリケーションへライブマイグレーションするため、Microsoft サポートにリクエストを作成します。 ライブマイグレーションを実行する前に、ストレージアカウントに対してどのような変更を行う必要がありますか。(一つ選択)

・アクセス層を Hot に設定する
・レプリケーションをローカル冗長ストレージ (LRS) に設定する
・高度な脅威保護を無効化する
・リソースロックを削除する

**解答例**
・リソースロックを削除する

**解説**
ストレージアカウントのライブマイグレーションを実行する際、リソースに設定されているロックが操作を妨げる可能性があります。 Azure のリソースロックは、誤った削除や変更を防ぐための保護機能ですが、ライブマイグレーションのような重要な構成変更を行う場合は、事前にロックを削除する必要があります。
ライブマイグレーションは、ストレージアカウントのダウンタイムなしで冗長性オプションを変更できる機能です。 LRS から ZRS への移行は、Microsoft サポートを通じてリクエストする必要があります。 この際、ストレージアカウントに削除ロックや読み取り専用ロックが設定されていると、マイグレーション処理が実行できません。
他の選択肢について、レプリケーション設定の変更は移行プロセスの一部として実行されるため事前変更は不要です。 高度な脅威保護の設定はマイグレーションに影響しません。 アクセス層の設定も同様にマイグレーション要件ではありません。

| 項目 | 説明 |
| :--- | :--- |
| リソースロック | リソースの削除や変更を防ぐ保護機能 |
| ライブマイグレーション | ダウンタイムなしで冗長性を変更 |
| ZRS | 単一リージョン内の 3 つの可用性ゾーンにデータを複製 |

**リファレンス**
・Azure Storage 冗長性
・Resource Lock

---

**問題 137.** Azure 上で稼働する Linux 仮想マシンのパフォーマンスメトリックとシステムログを収集して監視します。 この要件を満たすために使用する Azure 拡張機能を選択してください。(一つ選択)

・Azure Network Watcher 拡張機能
・Azure HDInsight
・Linux Diagnostic Extension (LAD) 4.0
・Azure パフォーマンス診断 VM 拡張機能

**解答例**
・Linux Diagnostic Extension (LAD) 4.0

**解説**
Linux 仮想マシンの診断データ収集には、Linux Diagnostic Extension (LAD) を使用します。 LAD は Linux VM 専用の診断拡張機能で、パフォーマンスメトリック、システムログ、アプリケーションログを収集して Azure Storage アカウントに保存します。
LAD の主な機能として、CPU 使用率、メモリ使用量、ディスク I/O、ネットワークトラフィックなどのパフォーマンスカウンターの収集、syslog メッセージの収集、カスタムメトリックの定義が可能です。 収集されたデータは Azure Monitor や Log Analytics と統合して分析できます。
他の選択肢について、Azure パフォーマンス診断 VM 拡張機能は Windows VM 向けの診断ツールです。 Azure Network Watcher 拡張機能はネットワーク診断に特化しており、VM 内部のパフォーマンス監視には使用しません。 Azure HDInsight はビッグデータ分析サービスであり、VM 監視とは用途が異なります。

| 項目 | 説明 |
| :--- | :--- |
| 対象 OS | Linux 仮想マシン専用 |
| 収集データ | パフォーマンスメトリック、syslog、カスタムログ |
| 保存先 | Azure Storage アカウント |
| 統合先 | Azure Monitor、Log Analytics |

**リファレンス**
・Linux Diagnostic Extension (LAD)
・Azure Monitor

---

**問題 138.** Azure サブスクリプションに仮想マシン VM1 があります。 VM1 では複数の同時実行インスタンスをサポートしない財務レポートアプリケーション App1 が稼働しています。 毎月末に App1 が実行されると VM1 の CPU 使用率がピークに達します。 毎月末に VM1 のプロセッサ性能を向上させるスケジュール実行 Runbook を作成します。 Runbook に含めるべきタスクはどれですか。(一つ選択)

・VM1 のサイズプロパティを変更する
・VM1 に Desired State Configuration (DSC) 拡張機能を追加する
・サブスクリプションの vCPU クォータを増やす
・VM1 を仮想マシンスケールセットに追加する

**解答例**
・VM1 のサイズプロパティを変更する

**解説**
毎月末の高負荷時に VM1 のプロセッサ性能を一時的に向上させるには、Azure Automation の Runbook で VM サイズを変更する方法が最適です。 App1 は複数インスタンスをサポートしないため、スケールアウトではなくスケールアップが必要です。
Runbook では、PowerShell コマンドレットを使用して VM サイズを変更できます。 例えば通常時は Standard_D2s_v3 で運用し、月末の高負荷期間のみ Standard_D4s_v3 に変更することで、vCPU 数を 2 から 4 に増やせます。 処理完了後は元のサイズに戻すことでコストを最適化できます。
仮想マシンスケールセットは複数の VM インスタンスを自動的にスケールする機能ですが、App1 は複数インスタンスをサポートしないため不適切です。 DSC 拡張機能は構成管理ツールであり、パフォーマンス向上には直接寄与しません。 vCPU クォータの増加はサブスクリプション全体の上限を引き上げる作業であり、個別 VM の性能向上とは異なります。

| 項目 | 説明 | 適用シナリオ |
| :--- | :--- | :--- |
| VM サイズ変更 | vCPU 数やメモリを増減 | 単一 VM の性能調整 |
| スケールセット | 複数 VM を自動増減 | 負荷分散可能なアプリ |
| DSC 拡張機能 | 構成状態の管理 | 設定の一貫性維持 |

**リファレンス**
・Azure Automation
・仮想マシンのサイズ変更
・Runbook

---

**問題 139.** あなたの会社は、オンプレミスの Active Directory ドメインサービス（AD DS）環境を運用しています。 マイアミオフィスのユーザーが Azure AD と統合されたクラウドアプリケーションにシームレスにサインインできるようにする必要があります。 ユーザーは既存のドメイン資格情報を使用し、追加の認証プロンプトなしでアクセスできる必要があります。 最小限の管理オーバーヘッドでこの要件を満たすソリューションを選択してください。(一つ選択)

・マイアミオフィスのドメインコントローラーに Active Directory Federation Services (AD FS) の役割をインストールする
・マイアミオフィスの各クライアントコンピューターのイントラネットゾーンに https://autologon.microsoftazuread-sso.com を追加する
・Azure AD Connect をインストールし、パスワードハッシュ同期とシームレスシングルサインオン (Seamless SSO) を有効にする
・マイアミオフィスのサーバーに Azure AD Connect をインストールし、パスルー認証 (Pass-through Authentication) を有効にする

**解答例**
・マイアミオフィスのサーバーに Azure AD Connect をインストールし、パスルー認証 (Pass-through Authentication) を有効にする

**解説**
この問題は、オンプレミス AD DS と Azure AD 間でシームレスな認証を実現する方法を問うものです。 パスルー認証は、ユーザーのパスワードをクラウドに同期せず、オンプレミスの Active Directory で直接認証を行う方式です。
パスルー認証を実装すると、ユーザーが Azure AD に対して認証要求を行った際、認証エージェントがオンプレミスのドメインコントローラーに対して資格情報を検証します。 これにより、パスワードがクラウドに保存されることなく、既存のオンプレミス認証インフラストラクチャを活用できます。
AD FS は高度なフェデレーション機能を提供しますが、追加のインフラストラクチャとメンテナンスが必要となり、管理オーバーヘッドが増加します。 イントラネットゾーンへの URL 追加は、Seamless SSO の構成要素の一つですが、これだけでは認証機能は実現できません。 パスワードハッシュ同期と Seamless SSO の組み合わせも有効な選択肢ですが、問題文の選択肢として提示されていません。

| 認証方式 | パスワード同期 | 管理の複雑さ |
| :--- | :--- | :--- |
| パスルー認証 | 不要 | 低 |
| パスワードハッシュ同期 | 必要 | 低 |
| AD FS | 不要 | 高 |

パスルー認証は、Azure AD Connect のインストール時に選択でき、認証エージェントが自動的に構成されます。 高可用性を確保するため、複数のサーバーに認証エージェントをインストールすることが推奨されます。

**リファレンス**
・Microsoft Entra Connect
・パスルー認証 (Pass-through Authentication)

---

**問題 140.** Azure 仮想ネットワーク VNet-A 上に、表 1 に示す 2 台の仮想マシンが展開されています。 VNet-A はプライベート DNS ゾーン hogehoge.com にリンクされており、この DNS ゾーンには表 2 に示す DNS レコードが登録されています。 VM-A から VM-B に対して ping コマンドを実行する際、VM-B への到達性を確認するために使用できる DNS 名を選択してください。(一つ選択)

表 1: 仮想マシンの構成
| 名前 | IP アドレス | 仮想ネットワーク |
| :--- | :--- | :--- |
| VM-A | 10.0.0.4 | VNet-A |
| VM-B | 10.0.0.5 | VNet-A |

表 2: プライベート DNS ゾーンのレコード
| 名前 | タイプ | TTL | 値 | 自動登録 |
| :--- | :--- | :--- | :--- | :--- |
| link-A | TXT | 3600 | 10.0.0.5 | 無効 |
| link-B | A | 3600 | 10.0.0.5 | 無効 |
| link-C | CNAME | 3600 | link.hogehoge.com | 無効 |
| link-D | PTR | 3600 | 10.0.0.5 | 無効 |

・link-b.hogehoge.com 、link-d.hogehoge.com
・link-a.hogehoge.com 、link-b.hogehoge.com
・link-b.hogehoge.com
・link-a.hogehoge.com 、link-b.hogehoge.com 、link-c.hogehoge.com 、link-d.hogehoge.com

**解答例**
・link-b.hogehoge.com

**解説**
この問題は Azure Private DNS Zone における各種 DNS レコードタイプの動作と名前解決の仕組みを理解しているかを問う問題です。 VM-A から VM-B へ ping を実行する際、DNS 名前解決によって IP アドレス 10.0.0.5 を取得できるレコードを特定する必要があります。
DNS レコードタイプには複数の種類があり、それぞれ異なる目的と動作を持ちます。 A レコードはホスト名を IPv4 アドレスに変換する最も基本的なレコードタイプです。 TXT レコードは任意のテキスト情報を格納するためのレコードで、名前解決には使用されません。 CNAME レコードは別名を定義するレコードですが、最終的には別の A レコードまたは AAAA レコードを参照する必要があります。 PTR レコードは逆引き名前解決に使用され、IP アドレスからホスト名を取得する際に利用されますが、正引き名前解決には使用できません。
表 2 の DNS レコードを分析すると、link-B は唯一の A レコードであり、値として 10.0.0.5 が設定されています。 したがって、link-b.hogehoge.com に対して DNS クエリを実行すると、VM-B の IP アドレス 10.0.0.5 が返されます。 link-A は TXT レコードのため名前解決には使用できません。 link-C は CNAME レコードですが、参照先の link.hogehoge.com が表 2 に存在しないため、名前解決は失敗します。 link-D は PTR レコードであり、正引き名前解決には使用されません。
Azure Private DNS Zone では、仮想ネットワークにリンクされた DNS ゾーンに登録されたレコードを使用して、同一仮想ネットワーク内のリソース間で名前解決が可能になります。 自動登録が無効の場合、手動で登録されたレコードのみが名前解決に使用されます。 ping コマンドは ICMP プロトコルを使用してネットワーク到達性を確認するツールであり、実行前に DNS 名前解決が必要です。

DNS レコードタイプと用途の比較
| レコードタイプ | 用途 | 正引き名前解決 |
| :--- | :--- | :--- |
| A | ホスト名を IPv4 アドレスに変換 | 可能 |
| TXT | テキスト情報の格納 | 不可 |
| CNAME | 別名の定義 | 参照先次第 |
| PTR | IP アドレスからホスト名への逆引き | 不可 |

この問題では、VM-B への到達性を確認するために正引き名前解決が必要であり、A レコードとして登録されている link-b.hogehoge.com のみが正解となります。 Azure 環境でプライベート DNS を構成する際は、適切なレコードタイプを選択し、名前解決の要件を満たす設定を行うことが重要です。

**リファレンス**
・Azure Private DNS Zone
・Virtual Network Integration

---

**問題 141.** 組織の Azure サブスクリプション「Subscription-A」で多層アプリケーションをデプロイします。 アプリケーション構成は以下の通りです。

| 階層 | インターネットアクセス | 仮想マシン数 |
| :--- | :--- | :--- |
| フロントエンド Web サーバー | 可 | 10 |
| ビジネスロジック | 不可 | 100 |
| SQL Server データベース | 不可 | 5 |

次の要件を満たすネットワークソリューションを実装します。 (1)Web サーバーとビジネスロジック階層間の通信を仮想マシン全体に均等分散する。 (2)Web サーバーを SQL インジェクション攻撃から保護する。 SQL インジェクション攻撃から Web サーバーを保護するために使用する Azure リソースはどれですか。(一つ選択)

・パブリックロードバランサー
・WAF 層を使用する Application Gateway
・Azure DDoS Protection Standard
・ネットワークセキュリティグループ (NSG)

**解答例**
・WAF 層を使用する Application Gateway

**解説**
SQL インジェクション攻撃から Web サーバーを保護するには、Web Application Firewall(WAF) 機能を持つ Application Gateway が最適です。 WAF は OSI 参照モデルのレイヤー 7(アプリケーション層) で動作し、SQL インジェクション、クロスサイトスクリプティング (XSS) などの Web アプリケーション攻撃を検出・防御します。
Application Gateway の WAF 層は、OWASP(Open Web Application Security Project) コアルールセットに基づいて脆弱性を保護します。 SQL インジェクション攻撃は、悪意のある SQL コードを Web アプリケーションの入力フィールドに挿入してデータベースを不正操作する攻撃手法です。 WAF はこれらの攻撃パターンを検知してブロックします。
他の選択肢について、パブリックロードバランサーはレイヤー 4(トランスポート層) で動作しトラフィック分散のみを行います。 Azure DDoS Protection Standard は分散型サービス拒否攻撃からの保護に特化しています。 NSG はネットワーク層のアクセス制御を提供しますが、アプリケーション層の攻撃は検出できません。

| リソース | 動作層 | SQL インジェクション保護 |
| :--- | :--- | :--- |
| Application Gateway WAF | レイヤー 7 | 可能 |
| Load Balancer | レイヤー 4 | 不可 |
| NSG | レイヤー 3/4 | 不可 |

なお、Web サーバーとビジネスロジック階層間の通信分散には内部ロードバランサーが適切です。

**リファレンス**
・Application Gateway

---

**問題 142.** Humongous Insurance 社は、マイアミ、東京、バンコクに 3 つのオフィスを持つ保険会社です。 各オフィスには 5,000 人のユーザーがいます。 同社は単一ドメインの Active Directory フォレスト humongousinsurance.com を運用しており、最近 Azure Active Directory テナントをプロビジョニングしました。 パリに新しいオフィスを開設する計画があり、1,000 人のユーザーが今後 12 か月間で採用される予定です。 パリオフィスのユーザーが使用するすべてのリソースは Azure でホストされます。 財務部門の監査担当者は、テストフェーズ中に過去 1 週間のすべての Azure コストを確認できる必要があります。 財務部門の監査担当者に使用を指示すべき Azure portal のブレードはどれですか。(一つ選択)

・Cost Management + Billing 内のコスト分析
・請求書
・サブスクリプションの概要
・支払い方法

**解答例**
・Cost Management + Billing 内のコスト分析

**解説**
財務部門の監査担当者が過去 1 週間の Azure コストを確認するには、Cost Management + Billing のコスト分析機能を使用します。 この機能では、カスタム期間を指定してコストの詳細な分析とレポートを実行できます。
コスト分析では、リソースグループ、サービス、場所、タグなど様々な軸でコストを分類し、グラフやテーブル形式で視覚化できます。 過去 1 週間などの特定期間を指定してフィルタリングし、詳細なコスト内訳を確認することが可能です。
請求書は月次の確定した請求情報を表示するため、テストフェーズでの週次レビューには適していません。 サブスクリプションの概要は全般的な情報を提供しますが、詳細なコスト分析機能は含まれません。 支払い方法は決済手段の管理に使用され、コスト確認の目的には適しません。

| 機能 | 用途 | 期間指定 |
| :--- | :--- | :--- |
| コスト分析 | 詳細なコスト確認と分析 | カスタム期間可能 |
| 請求書 | 月次確定請求の確認 | 月単位のみ |
| 概要 | サブスクリプション全般情報 | 限定的 |

**リファレンス**
・Azure Cost Management
・Azure Billing
・Azure RBAC (Role-Based Access Control)

---

**問題 143.** App-A という名前の Azure App Service Web アプリがあります。 Web Deploy を使用して App-A を展開する予定です。 App-A の開発者が Microsoft Entra ID の資格情報を使用してコンテンツを App-A に展開できるようにします。 ソリューションでは、最小権限の原則を使用する必要があります。 何をすべきでしょうか？(一つ選択)

・開発者に Contributor ロールを割り当てる
・開発者に Website Contributor ロールを割り当てる
・FTPS のアプリレベルの認証情報を構成する
・開発者に Owner ロールを割り当てる

**解答例**
・開発者に Website Contributor ロールを割り当てる

**解説**
この問題の最重要ポイントは、Azure App Service への Web Deploy 展開において、Microsoft Entra ID 認証を使用しつつ最小権限の原則を適用することです。
Azure App Service へのデプロイには複数の方法がありますが、Web Deploy を使用する場合、Azure RBAC ロールベースのアクセス制御を通じて Microsoft Entra ID の資格情報で認証できます。 最小権限の原則に従うには、必要最小限の権限を持つロールを選択する必要があります。
Website Contributor ロールは、Web アプリの管理とデプロイに必要な権限を提供しますが、サブスクリプションレベルやリソースグループレベルの管理権限は含まれません。 このロールにより、開発者はアプリケーションコードのデプロイ、アプリケーション設定の変更、ログの表示などが可能になります。
Contributor ロールは、リソースグループ内のすべてのリソースに対する完全な管理権限を持つため、必要以上の権限となります。 Owner ロールはさらに広範な権限を持ち、アクセス管理も含まれるため不適切です。 FTPS の認証情報は、Microsoft Entra ID 認証ではなく、ユーザー名とパスワードによる基本認証を使用するため、要件を満たしません。

| ロール | 権限範囲 | 最小権限の原則 |
| :--- | :--- | :--- |
| Website Contributor | Web アプリの管理とデプロイ | 適合 |
| Contributor | リソースグループ全体の管理 | 過剰 |
| Owner | 完全な管理とアクセス制御 | 過剰 |

| 認証方法 | 認証基盤 | 要件適合 |
| :--- | :--- | :--- |
| Azure RBAC ロール | Microsoft Entra ID | 適合 |
| FTPS アプリレベル認証 | 基本認証 | 不適合 |
| FTPS ユーザーレベル認証 | 基本認証 | 不適合 |

**リファレンス**
・Azure RBAC (Role-Based Access Control)

---

**問題 144.** あなたの組織では、新しいアプリケーション開発に Azure を採用し、Subscription-A という名前の Azure サブスクリプションを作成しました。 Subscription-A 内に VM-A という名前の仮想マシンを作成しましたが、現在 Azure Backup による保護は構成されていません。 VM-A を Azure Backup で保護し、毎日 01:00 にバックアップを実行して 30 日間保存する必要があります。 VM-A の保護を構成するために使用するオブジェクトを選択してください。(一つ選択)

・Recovery Services コンテナー
・バックアップポリシー
・復旧計画
・Azure Site Recovery

**解答例**
・バックアップポリシー

**解説**
Azure Backup で Azure 仮想マシンを保護する場合、バックアップポリシーを使用してバックアップのスケジュールと保持期間を定義します。 バックアップポリシーには、バックアップの実行時刻、頻度（日次、週次）、保持期間などの設定が含まれます。
VM-A を Azure Backup で保護するための基本的な手順は以下の通りです。 まず Recovery Services コンテナーを作成または既存のものを使用し、次にバックアップポリシーを作成または既存のポリシーを選択します。 このポリシーで毎日 01:00 にバックアップを実行し、30 日間保存する設定を行います。 最後に VM-A に対してこのバックアップポリシーを適用することで保護が開始されます。
バックアップポリシーは、複数の仮想マシンに同じバックアップ設定を適用する際にも再利用できるため、管理の効率化にも貢献します。 ポリシーの変更は、そのポリシーを使用しているすべてのバックアップ項目に自動的に反映されます。

| 項目 | 説明 |
| :--- | :--- |
| バックアップポリシー | バックアップスケジュールと保持期間を定義 |
| Recovery Services コンテナー | バックアップデータを格納する保管場所 |
| 保持期間 | バックアップデータを保存する日数や期間 |

他の選択肢について、Recovery Services コンテナーはバックアップデータのストレージとして必要ですが、スケジュールや保持期間の設定自体はバックアップポリシーで行います。 復旧計画は Azure Site Recovery で使用されるディザスタリカバリのオーケストレーション機能です。 Azure Site Recovery は VM 全体のレプリケーションとフェイルオーバーを管理するサービスで、バックアップとは異なる目的で使用されます。

**リファレンス**
・Azure Backup
・Recovery Services Vault
・Backup Policy

---

**問題 145.** Azure の仮想マシン上でサードパーティ製アプリケーションを運用しています。 ユーザーからアプリケーション使用時にパフォーマンスの問題が報告されました。 パフォーマンス問題の根本原因を特定するために使用すべきサービスはどれですか。(一つ選択)

・Azure Advisor
・Azure Monitor
・Log Analytics
・Azure Service Health

**解答例**
・Azure Monitor

**解説**
仮想マシン上で動作するアプリケーションのパフォーマンス問題を診断する場合、リアルタイムのメトリクスとログデータを収集・分析できる Azure Monitor が最適です。
Azure Monitor は、Azure リソースのパフォーマンスと可用性を監視する包括的なソリューションです。 仮想マシンに対しては、CPU 使用率、メモリ使用量、ディスク I/O、ネットワークトラフィックなどのメトリクスを自動的に収集します。 さらに Application Insights を統合することで、アプリケーションレベルの詳細な診断情報も取得できます。
Azure Advisor は、ベストプラクティスに基づいた推奨事項を提供するサービスですが、リアルタイムのパフォーマンス診断には適していません。 Log Analytics は、Azure Monitor の一部として機能し、ログデータの高度なクエリと分析を提供しますが、単独では包括的な監視ソリューションとはなりません。 Azure Service Health は、Azure プラットフォーム自体のサービス正常性を監視するものであり、個別のアプリケーションパフォーマンス問題の診断には使用しません。

| サービス | 主な用途 | パフォーマンス診断 |
| :--- | :--- | :--- |
| Azure Monitor | メトリクスとログの収集・分析 | 最適 |
| Azure Advisor | 推奨事項の提供 | 不適 |
| Log Analytics | ログデータの高度な分析 | 補助的 |

Azure Monitor を使用することで、パフォーマンスのボトルネックを特定し、メトリクスの傾向分析やアラート設定により、問題の早期発見と対応が可能になります。

**リファレンス**
・Azure Monitor
・Application Insights
・Log Analytics Workspace

---

**問題 146.** Azure サブスクリプション内に、Windows Server ベースのコンテナーイメージ Image-A と Linux ベースのコンテナーイメージ Image-B がデプロイされています。 これらのイメージを実行可能な Azure サービスの組み合わせとして正しいものを選択してください。 対象サービスは Azure Container Instances、Azure Container Apps、Azure App Service の 3 つです。 Image-A について実行可能なサービスの組み合わせを選んでください。(一つ選択)

| イメージ名 | OS |
| :--- | :--- |
| Image-A | Windows Server |
| Image-B | Linux |

・Azure Container Instances と Azure Container Apps
・Azure Container Instances のみ
・Azure Container Apps と Azure App Service
・Azure Container Instances、Azure Container Apps、Azure App Service すべて

**解答例**
・Azure Container Instances のみ

**解説**
Windows Server ベースのコンテナーイメージである Image-A を実行できるのは Azure Container Instances のみです。 Azure Container Apps と Azure App Service は Linux コンテナーのみをサポートしており、Windows コンテナーの実行には対応していません。
Azure Container Instances は、Windows コンテナーと Linux コンテナーの両方をサポートする唯一のサービスです。 Windows Server 2019 および Windows Server 2022 のコンテナーイメージを実行でき、プロセス分離モードで動作します。 一方、Azure Container Apps は Kubernetes ベースのマネージドサービスであり、現時点では Linux コンテナーのみをサポートしています。 Azure App Service のコンテナー機能（Web App for Containers）も同様に Linux コンテナーのみの対応となっています。
したがって、Windows Server ベースの Image-A を実行する場合は、Azure Container Instances を選択する必要があります。 Image-B のような Linux ベースのコンテナーであれば、3 つすべてのサービスで実行可能です。

各サービスのコンテナー OS 対応状況を以下の表にまとめます。
| サービス名 | Windows コンテナー | Linux コンテナー |
| :--- | :--- | :--- |
| Azure Container Instances | 対応 | 対応 |
| Azure Container Apps | 非対応 | 対応 |
| Azure App Service | 非対応 | 対応 |

**リファレンス**
・Azure Container Instances
・Azure Container Apps - Azure App Service

---

**問題 147.** あなたの組織では、East US リージョンにデプロイされた Azure Web Apps の App1 を使用して、ユーザーに動画コンテンツを配信しています。 北米のユーザーは問題なく動画を視聴できていますが、アジアとヨーロッパのユーザーからは動画のバッファリングが頻繁に発生し、スムーズに再生されないという報告が上がっています。 アジアとヨーロッパのユーザーに対する動画ストリーミングのパフォーマンスを改善するソリューションを推奨します。(一つ選択)

・Azure Traffic Manager を構成する
・App Service plan をスケールアップする
・Azure Content Delivery Network (CDN) エンドポイントを構成する
・App Service plan をスケールアウトする

**解答例**
・Azure Content Delivery Network (CDN) エンドポイントを構成する

**解説**
地理的に離れた場所のユーザーに対する動画配信のパフォーマンス問題を解決するには、Azure CDN が最適です。 CDN はコンテンツをユーザーに近いエッジサーバーにキャッシュすることで、レイテンシを削減し、バッファリングを最小化します。
App1 は East US リージョンにあり、北米のユーザーは問題なく視聴できていますが、アジアとヨーロッパのユーザーは地理的距離が原因でレイテンシが高くなっています。 Azure CDN を構成すると、動画コンテンツがアジアとヨーロッパのエッジロケーションにキャッシュされ、ユーザーは最寄りのエッジサーバーからコンテンツを取得できるため、配信速度が大幅に向上します。
App Service plan のスケールアップやスケールアウトは、アプリケーションの処理能力やインスタンス数を増やす手法ですが、地理的距離によるネットワークレイテンシの問題は解決できません。 Traffic Manager はトラフィックルーティングを最適化しますが、複数リージョンへのデプロイが前提となり、CDN ほど効果的ではありません。

| ソリューション | 効果 | 適用シナリオ |
| :--- | :--- | :--- |
| Azure CDN | 地理的レイテンシを削減 | グローバルな静的コンテンツ配信 |
| スケールアップ | CPU/メモリ増強 | 処理能力不足の解消 |
| スケールアウト | インスタンス数増加 | 同時接続数の増加対応 |

**リファレンス**
・Azure Content Delivery Network (CDN)
・App Service Plan
・Azure Traffic Manager

---

**問題 148.** Azure サブスクリプションがあります。 このサブスクリプションには、VNet1 という名前の仮想ネットワークに接続する仮想マシンが含まれています。 Azure Monitor for VM Insights を構成する予定です。 すべての仮想マシンが VNet1 を経由してのみ Azure Monitor と通信するようにします。 最初に作成する必要があるものはどれですか。(一つ選択)

・Log Analytics workspace
・Azure Monitor Private Link Scope (AMPLS)
・data collection rule (DCR)
・Azure Private DNS Zone

**解答例**
・Azure Monitor Private Link Scope (AMPLS)

**解説**
Azure Monitor へのプライベートアクセスを VNet 経由で実現するには、Azure Monitor Private Link Scope (AMPLS) を最初に作成する必要があります。 AMPLS は、Azure Monitor サービス（Log Analytics workspace や Application Insights など）をグループ化し、Private Endpoint を介してプライベートネットワーク経由でアクセスできるようにするリソースです。
構成の順序として、まず AMPLS を作成し、次に Private Endpoint を作成して VNet1 に接続します。 その後、Log Analytics workspace やその他の Azure Monitor リソースをこのスコープに関連付けます。 Data collection rule (DCR) は、監視データの収集方法を定義するものですが、プライベート通信の確立には直接関与しません。
Azure Private DNS Zone は、Private Endpoint の名前解決に必要ですが、AMPLS と Private Endpoint の作成後に構成されるため、最初に作成するリソースではありません。

| リソース | 役割 | 作成順序 |
| :--- | :--- | :--- |
| AMPLS | Azure Monitor リソースのグループ化 | 1 番目 |
| Private Endpoint | VNet との接続点 | 2 番目 |
| Log Analytics workspace | 監視データの保存先 | 3 番目 |

**リファレンス**
・Azure Monitor Private Link Scope (AMPLS)
・Private Endpoint

---

**問題 149.** Azure サブスクリプションを管理しています。 サブスクリプション内のいずれかのリソースからリソースロックが削除された際に、電子メールアラートを受信する必要があります。 Azure Monitor でアクティビティログアラートを作成するために使用する必要がある構成要素の組み合わせはどれですか。(一つ選択)

・リソース、条件、アクショングループ
・Log Analytics ワークスペース、リソース、アクショングループ
・データ収集エンドポイント、ネットワークセキュリティグループ、リソースグループ
・リソース、条件、管理グループ

**解答例**
・リソース、条件、アクショングループ

**解説**
Azure Monitor のアクティビティログアラートは、サブスクリプション内で特定の操作イベントが発生した際に通知を送信する機能です。 リソースロックの削除などの管理操作を監視する場合、アクティビティログアラートの作成には 3 つの主要な構成要素が必要です。
リソースは監視対象のスコープを定義します。 サブスクリプション全体、特定のリソースグループ、または個別のリソースを指定できます。 条件はアラートをトリガーする具体的なイベントを定義します。 リソースロックの削除を監視する場合、操作名として「Microsoft.Authorization/locks/delete」を指定します。 アクショングループは、アラート発生時の通知方法と実行するアクションを定義します。 電子メール、SMS、Webhook、Azure Function など複数の通知チャネルを設定できます。
Log Analytics ワークスペースはメトリックアラートやログクエリアラートで使用されますが、アクティビティログアラートの必須要素ではありません。 データ収集エンドポイントは Azure Monitor Agent のデータ収集に使用される構成要素であり、アクティビティログアラートとは関係ありません。 管理グループは複数のサブスクリプションを階層的に管理する機能ですが、アラートの通知先としては使用できません。

| 構成要素 | 役割 | 設定内容の例 |
| :--- | :--- | :--- |
| リソース | 監視スコープの定義 | サブスクリプション、リソースグループ |
| 条件 | トリガーイベントの指定 | locks/delete 操作 |
| アクショングループ | 通知方法の設定 | 電子メール、SMS |

**リファレンス**
・Azure Monitor アクティビティログアラート
・Action Group
・Resource Lock

---

**問題 150.** Azure サブスクリプションに、storage1 という名前のストレージアカウントがあります。 storage1 アカウントには、container1 という名前のコンテナーが含まれています。 container1 へのアクセスを構成します。 ソリューションは次の要件を満たす必要があります。 読み取り専用アクセスのみを許可する。 HTTP と HTTPS の両方のプロトコルを許可する。 コンテナー内のすべてのコンテンツにアクセス許可を適用する。 何を使用しますか。(一つ選択)

・Stored Access Policy (保存されたアクセスポリシー)
・Azure Content Delivery Network (CDN)
・Shared Access Signature (SAS)
・ストレージアカウントのアクセスキー

**解答例**
・Shared Access Signature (SAS)

**解説**
この問題の最重要ポイントは、コンテナーレベルで読み取り専用の制限付きアクセスを提供する適切な方法を選択することです。
Shared Access Signature (SAS) は、ストレージアカウント内のリソースへの制限付きアクセス権を付与するセキュリティトークンです。 SAS を使用すると、アクセス許可（読み取り、書き込み、削除など）、有効期間、許可されるプロトコル（HTTP または HTTPS）、IP アドレス範囲などを細かく制御できます。 コンテナーレベルの SAS を作成することで、そのコンテナー内のすべての Blob に対して一括してアクセス許可を適用できます。
Stored Access Policy は、SAS と組み合わせて使用される機能で、SAS の有効期限や権限を後から変更できるようにするものですが、それ自体がアクセス制御の手段ではありません。 Azure CDN はコンテンツ配信を高速化するサービスであり、アクセス制御の主要な手段ではありません。 ストレージアカウントのアクセスキーは、ストレージアカウント全体への完全なアクセス権を提供するため、読み取り専用という要件を満たせません。

各オプションの比較を以下に示します。
| オプション | 読み取り専用制御 | コンテナーレベル適用 | プロトコル制御 |
| :--- | :--- | :--- | :--- |
| SAS | 可能 | 可能 | 可能 |
| Stored Access Policy | SAS と併用 | SAS と併用 | SAS と併用 |
| CDN | 不可 | 可能 | 可能 |
| アクセスキー | 不可 | 不可 | 可能 |

したがって、要件を満たすには Shared Access Signature (SAS) を使用するのが最適です。

**リファレンス**
・Shared Access Signature (SAS)
・Azure Blob Storage
・Stored Access Policy

---

**問題 151.** リソースグループ RG1 があります。 RG1 には、storageaccount1 という名前の Azure Storage アカウントと、Windows Server 2016 を実行する VM1 という名前の仮想マシンが含まれています。 storageaccount1 には VM1 のディスクファイルが格納されています。 RG1 に ReadOnly ロックを適用しました。 Azure ポータルから実行できる操作はどれですか。(一つ選択)

・VM1 を起動する
・storageaccount1 のアクセスキーを表示する
・RG1 の ARM テンプレートをエクスポートする
・storageaccount1 に Blob をアップロードする

**解答例**
・storageaccount1 のアクセスキーを表示する

**解説**
ReadOnly ロックは、リソースグループ内のリソースに対する変更操作を防止しますが、読み取り操作は許可されます。 この問題では、各選択肢が ReadOnly ロック下で実行可能かどうかを判断する必要があります。
ReadOnly ロックが適用されたリソースグループでは、リソースの状態を変更する操作はすべてブロックされます。 VM1 の起動は仮想マシンの状態を変更する操作であり、Blob のアップロードはストレージアカウントのデータを変更する操作です。 ARM テンプレートのエクスポートは読み取り操作ですが、実際にはリソースグループのメタデータにアクセスする必要があり、一部の環境では制限される場合があります。 一方、ストレージアカウントのアクセスキーの表示は純粋な読み取り操作であり、ReadOnly ロック下でも実行可能です。
重要な点として、ReadOnly ロックはリソースの削除や変更を防ぎますが、リソースの構成情報や認証情報の閲覧は妨げません。 ストレージアカウントのアクセスキーは認証情報であり、その表示は読み取り操作に分類されるため、ロックの影響を受けません。

| ロックの種類 | 許可される操作 | ブロックされる操作 |
| :--- | :--- | :--- |
| ReadOnly | 読み取り、表示、エクスポート | 作成、更新、削除、状態変更 |
| CanNotDelete | 読み取り、更新、状態変更 | 削除のみ |
| ロックなし | すべての操作 | なし |

| 操作 | ReadOnly ロック下での実行 |
| :--- | :--- |
| アクセスキーの表示 | 可能（読み取り操作） |
| VM の起動 | 不可（状態変更） |
| Blob のアップロード | 不可（データ変更） |

**リファレンス**
・Azure Resource Manager
・Azure Storage アカウント
・Azure Virtual Machine

---

**問題 152.** オンプレミスネットワークに対して Azure AD Seamless SSO を構成するために Azure AD Connect を設定しました。 ユーザーが myapps.microsoft.com にアクセスしようとすると、複数回サインインを求められ、onmicrosoft.com で終わるアカウント名の使用を強制されると報告しています。 調査の結果、Azure AD とオンプレミス Active Directory 間で UPN の不一致が発見されました。 ユーザーがシングルサインオン (SSO) を使用して Azure リソースにアクセスできるようにします。 最初に実行すべき操作はどれですか。(一つ選択)

・Azure AD からカスタムドメイン名を追加して検証する
・Azure AD Connect を実行しているサーバーからフィルタリングオプションを変更する
・オンプレミスネットワークから Active Directory Federation Services (AD FS) をデプロイする
・オンプレミスネットワークから Active Directory ドメイン名を含む新しい証明書を要求する

**解答例**
・Azure AD からカスタムドメイン名を追加して検証する

**解説**
Azure AD Seamless SSO で UPN の不一致が発生している場合、最初に実行すべき操作は Azure AD にカスタムドメイン名を追加して検証することです。 ユーザーが onmicrosoft.com ドメインでのサインインを強制されている状況は、オンプレミス Active Directory で使用されているドメイン名が Azure AD に登録されていないことを示しています。
Azure AD Seamless SSO が正常に機能するためには、オンプレミス Active Directory の UPN サフィックスと Azure AD のドメイン名が一致している必要があります。 カスタムドメインを追加して検証することで、ユーザーは自身のオンプレミス UPN と同じ資格情報を使用して Azure リソースにシームレスにアクセスできるようになります。
ドメインの検証が完了した後、Azure AD Connect の同期により、オンプレミスのユーザーアカウントが正しい UPN で Azure AD に同期されます。 これにより、ユーザーは複数回のサインインプロンプトなしにシングルサインオンを利用できるようになります。

| 操作 | 実施タイミング | 目的 |
| :--- | :--- | :--- |
| カスタムドメインの追加と検証 | 最初 | UPN 一致の基盤構築 |
| Azure AD Connect の同期 | ドメイン検証後 | ユーザー情報の同期 |
| AD FS のデプロイ | 必要に応じて | 高度な認証要件対応 |

AD FS のデプロイやフィルタリングオプションの変更は、カスタムドメインが検証された後に検討すべき追加の構成オプションです。 証明書の要求は Seamless SSO の UPN 不一致問題の直接的な解決策ではありません。

**リファレンス**
・Azure AD Seamless SSO
・Custom Domain
・UPN (User Principal Name)

---

**問題 153.** Azure サブスクリプション内に Web App「WebApp1」があります。 仮想ネットワーク「VNet1」には、MySQL データベースをホストする仮想マシン「VM1」が接続されています。 WebApp1 から VM1 上の MySQL データベースへのプライベート接続を確立します。 どの操作を実行しますか。(一つ選択)

・WebApp1 に VNet 統合を構成して VNet1 に接続する
・VNet1 と WebApp1 の間に VPN ゲートウェイを構成する
・Application Gateway をデプロイしてバックエンドプールに VM1 を追加する
・VNet1 と別の仮想ネットワークの間に VNet ピアリングを構成する

**解答例**
・WebApp1 に VNet 統合を構成して VNet1 に接続する

**解説**
App Service の VNet 統合機能を使用することで、Web アプリケーションから Azure 仮想ネットワーク内のリソースへプライベートにアクセスできます。 この機能により、WebApp1 はパブリックインターネットを経由せず、VNet1 内の VM1 に直接接続可能になります。
VNet 統合を構成すると、App Service のアウトバウンドトラフィックが指定した仮想ネットワークのサブネットを経由するようになります。 これにより、仮想ネットワーク内のプライベート IP アドレスを持つリソース（この場合は VM1 上の MySQL データベース）に安全にアクセスできます。 構成には App Service プランが Basic 以上のティアである必要があり、統合用の専用サブネットを仮想ネットワーク内に用意する必要があります。
VPN ゲートウェイはオンプレミスネットワークとの接続に使用され、この要件には不適切です。 Application Gateway はレイヤー 7 のロードバランサーであり、Web アプリケーションからデータベースへのプライベート接続には必要ありません。 VNet ピアリングは異なる仮想ネットワーク間の接続に使用されますが、この問題では WebApp1 を既存の VNet1 に接続する必要があるため不適切です。

| 機能 | 用途 | 本シナリオでの適用 |
| :--- | :--- | :--- |
| VNet 統合 | App Service から VNet 内リソースへのアウトバウンド接続 | 適切 |
| VPN ゲートウェイ | オンプレミスと Azure 間の接続 | 不適切 |
| Application Gateway | Web アプリケーションのロードバランシングとルーティング | 不適切 |

**リファレンス**
・VNet 統合
・Virtual Network Integration
・Azure App Service
・Azure Virtual Network

---

**問題 154.** Azure サブスクリプションに、storageacct1234 という名前のストレージアカウントと、User1 および User2 という 2 人のユーザーが含まれています。 User1 には、Storage Account Contributor（ストレージアカウント共同作成者）ロールと Reader（閲覧者）ロールが割り当てられています。 User1 が実行できるアクションはどれですか。(二つ選択)

・storageacct1234 のファイアウォール設定を変更する
・storageacct1234 のアクセスキーを再生成する
・storageacct1234 内のファイル共有を表示する
・storageacct1234 に対して User2 にロールを割り当てる
・storageacct1234 内の Blob データをアップロードする

**解答例**
・storageacct1234 のファイアウォール設定を変更する
・storageacct1234 内のファイル共有を表示する

**解説**
この問題は、Azure RBAC における Storage Account Contributor ロールの権限範囲を理解しているかを問うものです。 Storage Account Contributor ロールは、ストレージアカウントの管理操作（コントロールプレーン）に対する権限を持ちますが、データプレーン操作には権限を持ちません。
Storage Account Contributor ロールでは、ストレージアカウントのネットワーク設定、ファイアウォールルール、アクセスキーの管理などの構成変更が可能です。 また、ストレージアカウント内のコンテナーやファイル共有などのリソース構造を表示できます。 ただし、実際の Blob データやファイルデータの読み取りや書き込みには、別途 Storage Blob Data Contributor や Storage Blob Data Reader などのデータプレーン用ロールが必要です。
User2 へのロール割り当てについては、User Access Administrator（ユーザーアクセス管理者）ロールまたは Owner（所有者）ロールが必要であり、Storage Account Contributor ロールでは実行できません。

| 操作カテゴリ | Storage Account Contributor | 必要な追加ロール |
| :--- | :--- | :--- |
| ストレージアカウント構成管理 | 可能 | 不要 |
| データ操作（Blob/File） | 不可 | Storage Blob Data Contributor 等 |
| ロール割り当て | 不可 | User Access Administrator |

**リファレンス**
・Azure RBAC (Role-Based Access Control)
・Storage Account Contributor

---

**問題 155.** オンプレミスの Active Directory ドメイン（hogehoge.com）には、複数のユーザーとグループが存在し、それぞれ異なる組織単位（OU）に配置されています。 OU1 と OU2 は Microsoft Entra ID（旧 Azure AD）に同期されています。 同期設定を変更して OU1 を同期対象から除外し、Active Directory と Microsoft Entra ID の同期を実行しました。 この操作後、Microsoft Entra ID に残存するオブジェクトを特定します。(一つ選択)

・User2、Group1、User4 のみ
・User1、User2、User4、Group1、Group2 のみ
・User4 と Group2 のみ
・User2、User3、User4、Group1、Group2 のみ

**解答例**
・User2、User4、Group1、Group2 のみ

**解説**
Microsoft Entra Connect（旧 Azure AD Connect）の同期スコープから組織単位を除外すると、その組織単位に直接所属するオブジェクトは同期対象から削除されます。 ただし、同期対象の OU に所属するグループのメンバーとして参照されているオブジェクトは、メンバーシップ情報として保持されます。
OU1 を同期対象から除外した場合、OU1 に直接所属する User1 は削除されますが、OU2 に所属する Group1 のメンバーである User2 は、グループメンバーシップを通じて引き続き同期されます。 同様に、OU2 に所属する User4 と Group2 は同期対象の OU に含まれるため、そのまま残存します。 User3 は OU1 に所属し、かつ OU2 のグループメンバーでもないため削除されます。
同期スコープとメンバーシップの関係を整理すると以下のようになります。

| オブジェクト | 所属 OU | グループメンバーシップ | 同期後の状態 |
| :--- | :--- | :--- | :--- |
| User1 | OU1（除外） | なし | 削除 |
| User2 | OU1（除外） | Group1 のメンバー | 保持 |
| User3 | OU1（除外） | なし | 削除 |
| User4 | OU2（同期中） | Group2 のメンバー | 保持 |
| Group1 | OU2（同期中） | - | 保持 |
| Group2 | OU2（同期中） | - | 保持 |

Microsoft Entra Connect では、同期スコープに含まれるグループのメンバーは、そのメンバー自体が同期対象外の OU に所属していても、グループメンバーシップを維持するために同期が継続されます。 この動作により、User2 は OU1 が除外されても Microsoft Entra ID に残存します。

**リファレンス**
・Microsoft Entra Connect
・組織単位（OU）
・ディレクトリ同期スコープ

---

**問題 156.** あなたの組織は Azure サブスクリプション「Subscription-A」を所有しています。 Subscription-A には VNet-A という仮想ネットワークがあり、Gateway、Perimeter、NVA、Production という 4 つのサブネットが含まれています。 NVA サブネットには、Perimeter サブネットと Production サブネット間のネットワークトラフィック検査を実行する 2 つのネットワーク仮想アプライアンス (NVA) が配置されています。 NVA 用に Azure Load Balancer を実装します。 ソリューションは次の要件を満たす必要があります。 NVA は自動フェイルオーバーを使用するアクティブ/アクティブ構成で実行する、Load Balancer は Production サブネット上の 2 つのサービスへのトラフィックを負荷分散する（各サービスは異なる IP アドレスを持つ）。 どのアクションを実行しますか。（3 つ選択）

・Standard Load Balancer をデプロイする
・HA ポートとフローティング IP が有効になっている 2 つのロードバランシングルールを追加する
・2 つのフロントエンド IP 構成、バックエンドプール、および正常性プローブを追加する
・Basic Load Balancer をデプロイする
・HA ポートが有効でフローティング IP が無効の単一ロードバランシングルールを追加する
・フロントエンド IP 構成、2 つのバックエンドプール、および正常性プローブを追加する

**解答例**
・Standard Load Balancer をデプロイする
・HA ポートとフローティング IP が有効になっている 2 つのロードバランシングルールを追加する
・2 つのフロントエンド IP 構成、バックエンドプール、および正常性プローブを追加する

**解説**
この問題の最重要ポイントは、NVA のアクティブ/アクティブ構成と複数サービスへの負荷分散を実現するために、Standard Load Balancer と HA ポート機能を使用することです。
まず、NVA のトラフィック検査シナリオでは Standard Load Balancer が必須です。 Basic Load Balancer は単一の可用性セット内でのみ動作し、HA ポート機能をサポートしていません。 Standard Load Balancer はゾーン冗長性と HA ポートをサポートし、すべてのポートとプロトコルのトラフィックを同時に負荷分散できます。
次に、HA ポート (High Availability Ports) 機能は、内部 Standard Load Balancer で利用可能な機能で、すべての TCP および UDP ポートのトラフィックフローを単一のルールで負荷分散します。 NVA シナリオでは、特定のポートだけでなくすべてのトラフィックを検査する必要があるため、HA ポートが必須です。
フローティング IP (Direct Server Return) を有効にすることで、バックエンドインスタンスは元の宛先 IP アドレスを保持したままトラフィックを受信できます。 これにより NVA は正しいルーティング判断を行えます。
要件では 2 つの異なる IP アドレスを持つサービスへの負荷分散が必要なため、2 つのフロントエンド IP 構成が必要です。 各フロントエンド IP に対して個別のロードバランシングルールを作成し、それぞれに HA ポートとフローティング IP を有効化します。 バックエンドプールは 2 つの NVA を含む単一のプールで構成し、正常性プローブで NVA の稼働状態を監視します。

| 項目 | 設定内容 | 理由 |
| :--- | :--- | :--- |
| Load Balancer SKU | Standard | HA ポートとゾーン冗長性をサポート |
| フロントエンド IP | 2 つ | 異なる IP アドレスを持つ 2 サービスに対応 |
| バックエンドプール | 1 つ | 2 つの NVA を含むアクティブ/アクティブ構成 |
| ロードバランシングルール | 2 つ | 各フロントエンド IP に対応、HA ポートとフローティング IP 有効 |
| 正常性プローブ | 1 つ | NVA の稼働状態を監視 |

**リファレンス**
・Azure Load Balancer
・HA ポート（High Availability Ports）
・ネットワーク仮想アプライアンス (NVA)

---

**問題 157.** あなたの会社は、マイアミオフィスのオンプレミス Active Directory ドメインを使用しています。 Azure AD との統合を計画しており、ユーザーがオンプレミスの資格情報を使用して Azure リソースにシームレスにアクセスできるようにする必要があります。 パスワードハッシュ同期は使用せず、認証はオンプレミスで行う要件があります。 この要件を満たすために実行する必要がある 2 つのアクションはどれですか。（二つ選択）

・マイアミオフィスのサーバーに Azure AD Connect をインストールし、Pass-through Authentication を有効にする
・マイアミオフィスの各クライアントコンピューターのイントラネットゾーンに https://autologon.microsoftazuread-sso.com を追加する
・マイアミオフィスのドメインコントローラーに Active Directory Federation Services (AD FS) の役割をインストールする
・マイアミオフィスのクライアントコンピューターを Azure AD に参加させる

**解答例**
・マイアミオフィスのサーバーに Azure AD Connect をインストールし、Pass-through Authentication を有効にする
・マイアミオフィスの各クライアントコンピューターのイントラネットゾーンに https://autologon.microsoftazuread-sso.com を追加する

**解説**
この問題では、オンプレミス Active Directory と Azure AD を統合し、シームレスなシングルサインオン (SSO) を実現する方法を問われています。 パスワードハッシュ同期を使用せず、認証をオンプレミスで行う要件から、Pass-through Authentication(PTA) とシームレス SSO の組み合わせが最適な解決策となります。
Pass-through Authentication は、Azure AD Connect を通じて実装される認証方式で、ユーザーの認証要求をオンプレミスの Active Directory に直接転送します。 これにより、パスワード情報をクラウドに同期することなく、オンプレミスで認証を完結できます。 Azure AD Connect をインストールし、PTA を有効化することで、認証エージェントがオンプレミス環境にデプロイされ、Azure AD からの認証要求を処理します。
シームレス SSO を機能させるには、クライアント側の設定も必要です。 具体的には、各クライアントコンピューターの Internet Explorer または Microsoft Edge のイントラネットゾーンに Azure AD の特定の URL を追加する必要があります。 これにより、ユーザーは企業ネットワーク内で資格情報の入力を求められることなく、自動的に Azure リソースにアクセスできるようになります。
AD FS は別の認証ソリューションですが、より複雑なインフラストラクチャが必要であり、この要件には過剰です。 また、クライアントコンピューターを Azure AD に参加させることは、ハイブリッド環境での管理には有用ですが、この認証要件の直接的な解決策ではありません。

| 認証方式 | 特徴 | パスワード同期 |
| :--- | :--- | :--- |
| Pass-through Authentication | オンプレミスで認証 | 不要 |





ご指定いただいたソース（AZ-104試験問題集の抜粋）に基づき、PDFの中身の文章を省略することなく、全文をそのまま正確に出力します。各セクションの末尾には該当するソースの番号を引用形式で記載します。

---

### **認証設定の比較表**
Password Hash Sync | クラウドで認証 | 必要
AD FS | オンプレミスで認証 | 不要（複雑）

**設定項目 | 目的 | 実装場所**
Azure AD Connect | 同期と PTA 有効化 | オンプレミスサーバー
イントラネットゾーン設定 | シームレス SSO | クライアント PC
認証エージェント | 認証要求処理 | オンプレミス環境

**リファレンス**
• Microsoft Entra Connect
• Pass-through Authentication

---

### **問題 158**
**問題 158. あなたの組織が所有する Azure サブスクリプション内に複数の仮想マシンが稼働しています。オンプレミスネットワークとこれらの仮想マシン間のネットワーク遅延を継続的に監視します。どの Azure Network Watcher の機能を使用しますか。（一つ選択）**
• IP Flow Verify
• 接続モニター
• NSG 診断
• 接続のトラブルシューティング

**解答例**
• 接続モニター

**解説**
オンプレミスネットワークと Azure 仮想マシン間のネットワーク遅延を継続的に監視するには、Network Watcher の接続モニター機能を使用します。 接続モニターは、送信元と宛先間の到達可能性、遅延、パケット損失などのネットワークメトリックを定期的に測定し、長期的な監視とアラート設定が可能です。

接続のトラブルシューティングは、特定時点での接続問題の診断に使用する機能であり、継続的な監視には適していません。 IP Flow Verify は、特定のパケットが NSG ルールによって許可または拒否されるかを検証する機能です。 NSG 診断は、ネットワークセキュリティグループのルール評価を確認する機能であり、遅延監視には使用しません。

Network Watcher の各機能の用途を整理すると以下のようになります。

**機能 | 主な用途**
接続モニター | 継続的なネットワーク監視と遅延測定
接続のトラブルシューティング | 特定時点での接続問題の診断
IP Flow Verify | NSG ルールによるパケット許可／拒否の検証

接続モニターは、オンプレミス環境に配置された Log Analytics エージェントと、Azure 仮想マシン上の Network Watcher エージェント拡張機能を使用して、エンドツーエンドの接続性を監視します。 測定結果は Azure Monitor に統合され、メトリックとログとして保存されます。

**リファレンス**
• Network Watcher
• Connection Monitor
• Azure Monitor

---

### **問題 159**
**問題 159. あなたの会社では、Azure 上でロードバランサー LB1 を使用してトラフィックを分散しています。現在、仮想マシン VM1 と VM2 が異なるネットワーク構成で稼働しており、これらを LB1 のバックエンドプールに追加する必要があります。VM1 は VNET1/Subnet1 に接続されていますが、VM2 は別の仮想ネットワークに接続されています。LB1 は Standard SKU のロードバランサーで、VNET1 に関連付けられています。VM1 と VM2 を LB1 のバックエンドプールに追加するために、最初に実行すべき作業は何ですか。（一つ選択）**
• VM1 と VM2 を同じ可用性セットに再デプロイする
• 新しいネットワークセキュリティグループを作成し、VNET1/Subnet1 に関連付ける
• VM2 を VNET1/Subnet1 に接続する
• VM1 と VM2 を同じ可用性ゾーンに再デプロイする

**解答例**
• VM2 を VNET1/Subnet1 に接続する

**解説**
Azure Load Balancer のバックエンドプールに仮想マシンを追加するには、すべての仮想マシンが同じ仮想ネットワーク内に存在する必要があります。 Standard SKU のロードバランサーは、特定の仮想ネットワークに関連付けられており、そのバックエンドプールに追加できるのは同じ仮想ネットワーク内のリソースのみです。

本問では、VM1 は既に VNET1/Subnet1 に接続されていますが、VM2 は別の仮想ネットワークに接続されています。 そのため、VM2 を LB1 のバックエンドプールに追加する前に、まず VM2 を VNET1/Subnet1 に接続する必要があります。 これにより、両方の仮想マシンが同じ仮想ネットワーク内に配置され、ロードバランサーのバックエンドプールに追加できるようになります。

可用性セットや可用性ゾーンは高可用性を実現するための構成ですが、ロードバランサーのバックエンドプールへの追加には必須ではありません。 また、ネットワークセキュリティグループはトラフィックのフィルタリングに使用されますが、バックエンドプールへの追加要件とは関係ありません。

**要件 | 説明**
仮想ネットワークの統一 | バックエンドプール内のすべての VM は同じ仮想ネットワークに接続する必要がある
Standard SKU | 特定の仮想ネットワークに関連付けられ、そのネットワーク内のリソースのみをバックエンドに追加可能
高可用性構成 | 可用性セットや可用性ゾーンは推奨されるが、バックエンドプール追加の必須要件ではない

**リファレンス**
• Azure Load Balancer
• Azure Virtual Network
• Backend Pool

---

### **問題 160**
**問題 160. Azure サブスクリプション内で、複数の Azure Container Instances を単一のコンテナーグループとしてデプロイする計画があります。以下の表に示すコンテナーインスタンスのうち、同一のコンテナーグループにデプロイ可能な組み合わせを選択してください。（一つ選択）**

**インスタンス名 | オペレーティングシステム**
Instance-A | Windows Server 2019 Nano Server
Instance-B | Windows Server 2019 Server Core
Instance-C | Linux
Instance-D | Linux
Instance-E | Linux

• Instance-A と Instance-B
• Instance-C、Instance-D、Instance-E
• Instance-A と Instance-C
• Instance-B のみ

**解答例**
• Instance-C、Instance-D、Instance-E

**解説**
Azure Container Instances のコンテナーグループには、同一のオペレーティングシステムタイプを持つコンテナーのみをデプロイできるという制約があります。 Windows コンテナーと Linux コンテナーを混在させることはできません。

本問では、Instance-A と Instance-B はいずれも Windows Server 2019 ベースですが、Nano Server と Server Core という異なるインストールオプションです。 一方、Instance-C、Instance-D、Instance-E はすべて同じ Linux オペレーティングシステムです。

コンテナーグループの制約として、同一グループ内のすべてのコンテナーは同じ OS タイプである必要があります。 したがって、3 つの Linux ベースのインスタンス（Instance-C、Instance-D、Instance-E）を単一のコンテナーグループにデプロイすることが可能です。

Windows コンテナーについては、Nano Server と Server Core の両方をサポートしていますが、実運用環境では同一のベースイメージを使用することが推奨されます。 複数の Windows インスタンスを同一グループにデプロイする場合も、OS タイプの一貫性が求められます。

Azure Container Instances のコンテナーグループは、同一ホスト上でスケジュールされ、ローカルネットワーク、ストレージ、ライフサイクルを共有します。 この特性により、サイドカーパターンなどのマルチコンテナー設計が可能になります。

**項目 | 制約内容**
OS タイプ | 同一グループ内は単一 OS（Windows または Linux）
混在デプロイ | Windows と Linux の混在は不可
推奨構成 | 同一ベースイメージの使用

**リファレンス**
• Azure Container Instances

---

### **問題 161**
**問題 161. VM1 と VM2 という 2 つの Azure 仮想マシンがあります。RSV1 と RSV2 という 2 つの Recovery Services コンテナーがあります。VM2 は RSV1 にバックアップされています。VM2 を RSV2 にバックアップする必要があります。最初に実行すべき操作はどれですか。（一つ選択）**
• RSV1 のブレードでバックアップアイテムを選択し、VM2 のバックアップを停止する
• VM2 のブレードでバックアップ設定を開き、バックアップ先を RSV2 に変更する
• RSV2 のブレードでバックアップを選択し、仮想マシンのバックアップを構成して VM2 を指定する
• VM2 のブレードでディザスターリカバリーを選択し、レプリケーション設定で RSV2 を Recovery Services コンテナーとして指定する

**解答例**
• RSV1 のブレードでバックアップアイテムを選択し、VM2 のバックアップを停止する

**解説**
Azure 仮想マシンは一度に 1 つの Recovery Services コンテナーにのみバックアップできます。 VM2 は既に RSV1 にバックアップされているため、RSV2 に切り替えるには、まず現在のバックアップを停止する必要があります。

バックアップの停止は、RSV1 のバックアップアイテムから VM2 を選択し、バックアップの停止操作を実行します。 この際、バックアップデータの保持または削除を選択できます。 バックアップ停止後、VM2 を RSV2 に新規バックアップとして構成できます。

VM2 のブレードから直接バックアップ先を変更する機能は存在しません。 また、ディザスターリカバリー機能の Azure Site Recovery は、バックアップとは異なる災害復旧ソリューションであり、Recovery Services コンテナーを使用しますが、バックアップの切り替えには使用しません。

**操作 | 説明 | 実施場所**
バックアップ停止 | 既存バックアップを無効化 | RSV1 のバックアップアイテム
新規バックアップ構成 | 新しいコンテナーへ登録 | RSV2 のバックアップ設定
データ保持選択 | 停止時の復旧ポイント管理 | バックアップ停止画面

**リファレンス**
• Azure Backup
• Recovery Services Vault
• Azure Site Recovery

---

### **問題 162**
**問題 162. Azure サブスクリプションを運用しています。すべてのユーザーに対して多要素認証を有効化しました。一部のユーザーから、モバイルデバイスのメールアプリケーションが Microsoft Exchange Online メールボックスに接続できないという報告がありました。これらのユーザーは Web ブラウザーおよびコンピューター上の Microsoft Outlook 2016 からは Exchange Online にアクセスできます。モバイルデバイスのメールアプリケーションを使用できるようにするため、ユーザーに何を指示しますか。（一つ選択）**
• Azure Active Directory パスワードをリセットする
• アプリパスワードを作成する
• セルフサービスパスワードリセットを有効化する
• Microsoft Authenticator アプリを再インストールする

**解答例**
• アプリパスワードを作成する

**解説**
多要素認証（MFA）を有効化した環境では、最新の認証プロトコル（Modern Authentication）に対応していないレガシーアプリケーションは通常の認証方法でサインインできません。 モバイルデバイスの一部のメールアプリケーションは基本認証（Basic Authentication）を使用しており、MFA の第 2 要素による認証に対応していないため接続が失敗します。

この問題を解決するには、アプリパスワードを生成してレガシーアプリケーションに設定します。 アプリパスワードは、MFA が有効なアカウントで基本認証のみをサポートするアプリケーション専用に生成される一意のパスワードです。 ユーザーは通常のパスワードの代わりにこのアプリパスワードをモバイルメールアプリに入力することで、MFA 環境下でも接続が可能になります。

Web ブラウザーや Outlook 2016 が正常に動作しているのは、これらが最新の認証プロトコルに対応しているためです。 Azure AD パスワードのリセットやセルフサービスパスワードリセットの有効化は認証方式の問題を解決しません。 Microsoft Authenticator アプリの再インストールもメールアプリの認証方式には影響しません。

**認証方式 | MFA 対応 | 対象アプリケーション**
最新の認証 | 対応 | Web ブラウザー、Outlook 2016 以降
基本認証 | 非対応 | レガシーメールアプリ
アプリパスワード | 対応 | 基本認証のみのアプリ

**リファレンス**
• セルフサービスパスワードリセット (SSPR)
• 多要素認証 (Multi-Factor Authentication)

---

### **問題 163**
**問題 163. ある Azure サブスクリプションに仮想ネットワーク VNet1 が含まれており、この VNet1 はリソースグループ RG1 に属しています。サブスクリプションには User1 というユーザーが存在し、現在 Reader、Security Admin、Security Reader の各ロールが割り当てられています。User1 が VNet1 に対して他のユーザーに Reader ロールを割り当てられるようにします。どのように構成しますか。（一つ選択）**
• User1 に VNet1 の User Access Administrator ロールを割り当てる
• User1 に VNet1 の Contributor ロールを割り当てる
• User1 からサブスクリプションの Security Reader ロールと Reader ロールを削除する
• User1 に VNet1 の Owner ロールを割り当てる

**解答例**
• User1 に VNet1 の User Access Administrator ロールを割り当てる

**解説**
Azure でロールの割り当て権限を付与するには、User Access Administrator ロールまたは Owner ロールが必要です。 User1 が他のユーザーに Reader ロールを割り当てるためには、VNet1 のスコープで User Access Administrator ロールを付与することで、リソースへのアクセス管理権限のみを委任できます。

現在 User1 に割り当てられている Reader、Security Admin、Security Reader ロールには、ロール割り当ての権限は含まれていません。 Reader ロールはリソースの読み取り専用アクセスを提供し、Security Admin と Security Reader はセキュリティ関連の操作に特化したロールですが、いずれもロール管理の権限はありません。

Contributor ロールはリソースの作成や管理が可能ですが、ロールの割り当て権限は含まれていません。 User Access Administrator ロールは、ユーザーの Azure リソースへのアクセス管理に特化しており、リソース自体の変更権限を持たずにロール割り当てのみを実行できます。 Owner ロールも選択肢として有効ですが、リソースの完全な制御権限を含むため、ロール割り当てのみを目的とする場合は過剰な権限付与となります。

**ロール名 | ロール割り当て権限 | リソース管理権限**
User Access Administrator | あり | なし
Owner | あり | あり
Contributor | なし | あり
Reader | なし | なし

最小権限の原則に基づき、User1 には VNet1 スコープで User Access Administrator ロールを割り当てることで、必要な権限のみを付与し、他のユーザーへの Reader ロール割り当てが可能になります。

**リファレンス**
• Azure RBAC (Role-Based Access Control)
• User Access Administrator ロール
• 組み込みロール

---

### **問題 164**
**問題 164. Azure App Service で .NET アプリケーションを運用しています。数日後に大量のトラフィック流入が予想されており、トラフィック急増時にリクエストエラーやクエリ失敗などの異常をリアルタイムで検知したいと考えています。.NET アプリケーションに関連するこれらのエラーを即座に把握するために使用できるサービスはどれですか。（一つ選択）**
• Application Insights の検索機能を使用する
• Log Analytics ワークスペースでクエリを実行する
• Application Insights の Live Metrics Stream を使用する
• Azure Monitor のメトリックアラートを構成する

**解答例**
• Application Insights の Live Metrics Stream を使用する

**解説**
リアルタイムでアプリケーションの異常を検知する場合、Application Insights の Live Metrics Stream が最適です。 この機能は 1 秒未満の待機時間でテレメトリデータをストリーミング表示し、トラフィック急増時の即座の監視を可能にします。

Live Metrics Stream は、リクエスト数、応答時間、失敗率、例外、依存関係の呼び出しなどをリアルタイムで可視化します。 ダッシュボード上で異常を即座に確認でき、問題発生時の迅速な対応が可能です。 .NET Core アプリケーションでは、Application Insights SDK を統合することで自動的にテレメトリが収集されます。

Application Insights の検索機能は過去のテレメトリデータを分析するためのツールであり、リアルタイム監視には適していません。 Log Analytics ワークスペースも同様に、収集済みデータのクエリと分析に使用されますが、即座の検知には遅延が発生します。 Azure Monitor のメトリックアラートは通知機能として有効ですが、Live Metrics Stream のような詳細なリアルタイム可視化は提供しません。

**機能 | 用途 | リアルタイム性**
Live Metrics Stream | 即座の異常検知と可視化 | 1 秒未満
Application Insights 検索 | 過去データの詳細分析 | 数分の遅延
Log Analytics ワークスペース | 複雑なクエリと長期分析 | 数分の遅延

**リファレンス**
• Application Insights
• Live Metrics Stream
• Azure Monitor

---

### **問題 165**
**問題 165. あなたの会社には、パリのオフィスに 100 人のユーザーがいます。オンプレミスネットワークには、複数のサーバー（Web サーバー、ファイルサーバー、データベースサーバーを含む）が稼働しています。新しい Azure サブスクリプションを作成しました。すべてのサーバーを Azure に移行する必要があります。解決策として、azcopy.exe を実行します。この解決策は目標を達成できますか？（一つ選択）**
• いいえ、この解決策では目標を達成できない
• はい、この解決策で目標を達成できる
• 部分的に達成できるが、追加の構成が必要である
• Azure Migrate と組み合わせる場合のみ達成できる

**解答例**
• いいえ、この解決策では目標を達成できない

**解説**
AzCopy は、Azure ストレージアカウント間で BLOB やファイルをコピーするためのコマンドラインユーティリティです。 オンプレミスのサーバー全体を Azure に移行する目的には適していません。

サーバー移行には、オペレーティングシステム、アプリケーション、構成、データなど、サーバーの完全な状態を移行する必要があります。 AzCopy はファイルレベルのコピーツールであり、サーバーのシステム構成やアプリケーション設定を移行できません。

オンプレミスサーバーを Azure に移行する場合、Azure Migrate が推奨されるソリューションです。 Azure Migrate は、サーバーの検出、評価、移行を包括的にサポートし、物理サーバー、VMware、Hyper-V など様々な環境からの移行に対応しています。

**ツール | 用途 | サーバー移行の適合性**
AzCopy | ファイル・BLOB のコピー | 不適合
Azure Migrate | サーバー移行・評価 | 適合
Azure Site Recovery | ディザスタリカバリ・移行 | 適合

Azure Migrate を使用すると、サーバーの依存関係マッピング、パフォーマンス評価、コスト見積もりを実施した上で、ダウンタイムを最小限に抑えた移行が可能です。 移行後のサーバーは、Azure Virtual Machines として稼働します。

**リファレンス**
• Azure Migrate
• AzCopy
• Azure Site Recovery

---

### **問題 166**
**問題 166. Azure で、webapp という名前の Web アプリを運用しています。また、MySQL データベースをホストする vm-db という名前の仮想マシンがあり、この仮想マシンは vnet-prod という名前の仮想ネットワークに接続されています。webapp から vm-db 上のデータにアクセスできるようにします。どうすればよいですか。（一つ選択）**
• webapp を vnet-prod に接続する
• Azure Application Gateway をデプロイする
• Azure Traffic Manager を構成する
• vnet-prod に内部ロードバランサーをデプロイする

**解答例**
• webapp を vnet-prod に接続する

**解説**
Azure App Service の Web アプリは、デフォルトではパブリックインターネット経由でのみ通信します。 仮想ネットワーク内のリソース（この場合は仮想マシン上の MySQL データベース）にアクセスするには、Web アプリを VNet 統合機能を使って仮想ネットワークに接続する必要があります。

VNet 統合を構成すると、Web アプリから仮想ネットワーク内のプライベート IP アドレスを持つリソースへの送信トラフィックが可能になります。 これにより、データベースをインターネットに公開することなく、セキュアな通信が実現できます。

他の選択肢が不適切な理由を整理します。

**選択肢 | 不適切な理由**
Application Gateway | レイヤー 7 のロードバランサーで受信トラフィック用。Web アプリからの送信接続には不便
Traffic Manager | DNS ベースのトラフィック分散サービス。VNet 内通信の実現には使用しない
内部ロードバランサー | 複数バックエンドへの負荷分散用。単一 VM への接続には不要

VNet 統合の構成手順は、App Service のネットワーク設定から統合する仮想ネットワークとサブネットを選択するだけです。 統合後は、Web アプリのアプリケーションコードから仮想マシンのプライベート IP アドレスまたはプライベート DNS 名を使用してデータベースに接続できます。

**リファレンス**
• VNET 統合
• Virtual Network Integration
• Azure App Service
• Azure Virtual Network

---

### **問題 167**
**問題 167. あなたは VM1 という名前の仮想マシンを含む Azure サブスクリプションを管理しています。オンプレミスのデータセンターには DC1 という名前のドメインコントローラーがあり、ExpressRoute を使用して Azure に接続されています。Connection Monitor で VM1 と DC1 間のネットワーク遅延を測定します。DC1 にインストールすべきものはどれですか。（一つ選択）**
• Azure Monitor Agent
• Azure Connected Machine agent
• Log Analytics agent
• Network Watcher Agent

**解答例**
• Azure Monitor Agent

**解説**
Connection Monitor は、Azure Network Watcher の機能であり、Azure VM、オンプレミスマシン、他のクラウド環境間のネットワーク接続を監視します。 オンプレミスのマシンから Azure VM への接続を監視する場合、オンプレミス側に Azure Monitor Agent をインストールする必要があります。

Azure Monitor Agent は、従来の Log Analytics agent や Network Watcher Agent VM extension の後継として統合された監視エージェントです。 Connection Monitor の最新バージョンでは、Azure Monitor Agent を使用してネットワークメトリクスを収集し、遅延、パケット損失、接続性の問題を検出します。

オンプレミスマシンに Azure Monitor Agent をインストールするには、まず Azure Arc を使用してマシンを Azure に接続する必要があります。 Azure Connected Machine agent は Azure Arc 対応サーバーとしてオンプレミスマシンを登録するために必要ですが、実際のネットワーク監視機能を提供するのは Azure Monitor Agent です。

Log Analytics agent は旧世代のエージェントであり、現在は Azure Monitor Agent への移行が推奨されています。 Network Watcher Agent VM extension は Azure VM 専用の拡張機能であり、オンプレミスマシンには直接インストールできません。

**項目 | 説明**
Azure Monitor Agent | 統合監視エージェント、Connection Monitor 対応
Azure Arc | オンプレミスマシンを Azure に接続
Connection Monitor | ネットワーク遅延と接続性を監視

**リファレンス**
• Azure Monitor Agent
• Azure Network Watcher
• Azure Arc

---

### **問題 168**
**問題 168. オンプレミスネットワークに VPN ゲートウェイがあります。次のリソースを含む Azure サブスクリプションがあります：仮想マシン VM1 と ストレージアカウント storage1。VM1 から storage1 へのすべてのトラフィックが Microsoft バックボーンネットワークを経由するようにします。何を構成しますか。（一つ選択）**
• Azure Peering Service
• Service Endpoint
• Private Endpoint
• Azure Firewall

**解答例**
• Private Endpoint

**解説**
VM1 からストレージアカウントへのトラフィックを Microsoft バックボーンネットワーク経由にするには、Private Endpoint を構成します。 Private Endpoint は、Azure 仮想ネットワーク内のプライベート IP アドレスを使用してストレージアカウントに接続する機能です。

Private Endpoint を構成すると、ストレージアカウントへのアクセスは仮想ネットワーク内のプライベート IP アドレス経由となり、トラフィックはパブリックインターネットを経由せず Microsoft バックボーンネットワーク上を流れます。 オンプレミスから VPN 経由で接続している場合も、VPN トンネルを通じてプライベート IP アドレスにアクセスできるため、すべての通信が Microsoft のネットワーク内で完結します。

Service Endpoint も仮想ネットワークから Azure サービスへの最適化された経路を提供しますが、パブリック IP アドレスを使用するため要件を完全には満たしません。 Azure Firewall はネットワークセキュリティ機能を提供しますが、トラフィック経路の制御には直接関係しません。 Azure Peering Service はインターネットサービスプロバイダー向けのサービスで、この要件には適用できません。

**機能 | 接続方式 | 用途**
Private Endpoint | プライベート IP 経由 | 完全プライベート接続
Service Endpoint | パブリック IP 経由 | 仮想ネットワークからの最適化
Azure Firewall | ファイアウォール機能 | トラフィック制御とセキュリティ

**リファレンス**
• Private Endpoint
• Azure Virtual Network

---

### **問題 169**
**問題 169. Subnet1 という名前のサブネットがあり、Azure 仮想マシンが含まれています。NSG1 という名前のネットワークセキュリティグループが Subnet1 に関連付けられており、NSG1 は既定のルールで構成されています。Subnet1 上のホストが Azure ポータルに接続できないようにするため、NSG1 に新しいルールを作成します。ただし、ホストは他の Azure サービスには接続できる必要があります。このルールの宛先として何を設定しますか。（一つ選択）**
• Application Security Group
• Service Tag
• Any
• CIDR 表記の IP アドレス範囲

**解答例**
• Service Tag

**解説**
Azure ポータルへのアクセスのみをブロックし、他の Azure サービスへの接続は維持する必要があります。 この要件を満たすには、宛先に Service Tag を指定します。

Service Tag は、Azure サービスの IP アドレス範囲をグループ化した論理的な識別子です。 Azure ポータルにアクセスするための Service Tag として AzurePortal が提供されており、これを宛先に指定することでポータルへのトラフィックのみを制御できます。 NSG ルールで AzurePortal タグを宛先に設定し、アクションを「拒否」にすることで、ポータルへのアクセスをブロックしながら、他の Azure サービス（Storage、SQL Database など）への接続は影響を受けません。

Application Security Group は仮想マシンをグループ化してセキュリティポリシーを適用する機能ですが、Azure ポータルという特定のサービスを対象とする場合には適していません。 Any を指定するとすべての宛先へのトラフィックが対象となり、他の Azure サービスへの接続もブロックされてしまいます。 CIDR 表記の IP アドレス範囲を指定する方法もありますが、Azure ポータルのエンドポイントは複数の IP アドレスで構成され、これらは変更される可能性があるため、管理が困難です。

**宛先の種類 | 用途 | Azure ポータルのみブロック**
Service Tag | Azure サービスの論理グループ | 可能
Application Security Group | VM 単位のグループ化 | 不可
Any | すべての宛先 | 不可（全サービスに影響）

**リファレンス**
• Network Security Group
• Service Tag
• Application Security Group

---

### **問題 170**
**問題 170. Azure 仮想マシン VM1 があり、Azure Backup を使用して Backup1 という名前のバックアップを作成しました。Backup1 の作成後、VM1 に対して次の変更を実施しました：VM1 のサイズ変更、Data フォルダへの budget.xls ファイルのコピー、組み込み管理者アカウントのパスワードリセット、VM1 へのデータディスクの追加。管理者が「既存のものを置き換える」オプションを使用して Backup1 から VM1 を復元します。VM1 に対するすべての変更が復元されるようにするには、どの変更を再度実行する必要がありますか。（一つ選択）**
• データディスクを追加する
• VM1 のサイズを変更する
• 組み込み管理者アカウントのパスワードをリセットする
• budget.xls を Data フォルダにコピーする

**解答例**
• budget.xls を Data フォルダにコピーする

**解説**
Azure Backup の「既存のものを置き換える」オプションで仮想マシンを復元する場合、バックアップ時点のディスク構成とデータが復元されます。 この復元方法では、仮想マシンの構成（サイズ、接続されているディスク）は保持されますが、ディスク内のデータはバックアップ時点の状態に戻ります。

VM1 のサイズ変更とデータディスクの追加は、仮想マシンの構成レベルの変更であり、復元後も保持されます。 Azure Backup は仮想マシンのディスクデータのみをバックアップし、Azure Resource Manager (ARM) で管理される仮想マシンの構成情報（VM サイズ、接続されているディスクの数と種類）は復元プロセスで上書きされません。

組み込み管理者アカウントのパスワードは、Windows のセキュリティデータベース（SAM）に保存されており、OS ディスクのデータの一部として復元されます。 したがって、バックアップ時点のパスワードに戻ります。

budget.xls ファイルは、バックアップ作成後に Data フォルダにコピーされたため、Backup1 には含まれていません。 復元後、このファイルは存在しないため、再度コピーする必要があります。

**変更内容 | 復元後の状態 | 再実行の必要性**
VM サイズ変更 | 保持される | 不要
データディスク追加 | 保持される | 不要
パスワードリセット | バックアップ時点に戻る | 不要（既に復元済）
ファイルコピー | 失われる | 必要

**リファレンス**
• Azure Backup
• Azure Virtual Machine
• Azure Resource Manager

---

### **問題 171**
**問題 171. Azure サブスクリプションに、VNet1、VNet2、VNet3 という 3 つの仮想ネットワークがあります。VNet2 には、ルーターとして動作する VM2 という仮想アプライアンスが含まれています。VNet2 をハブネットワークとして使用するハブアンドスポークトポロジで仮想ネットワークを構成しています。VNet1 と VNet2 の間、および VNet2 と VNet3 の間でピアリングを構成する予定です。VNet2 を経由して VNet1 と VNet3 の間の接続を提供します。どの 2 つの構成を実行しますか。（二つ選択）**
• ピアリング接続で転送されたトラフィックを許可する
• サブネットに関連付けるルートテーブルを作成する
• ピアリング接続でリモートゲートウェイを使用する
• ピアリング接続でゲートウェイトランジットを許可する

**解答例**
• ピアリング接続で転送されたトラフィックを許可する
• サブネットに関連付けるルートテーブルを作成する

**解説**
ハブアンドスポークトポロジでは、ハブ VNet を経由してスポーク VNet 間の通信を実現するために、転送されたトラフィックの許可とルーティング設定が必要です。

VNet ピアリングはデフォルトで非推移的な接続です。 つまり、VNet1 と VNet2 がピアリングされ、VNet2 と VNet3 がピアリングされていても、VNet1 と VNet3 は直接通信できません。 ハブ VNet (VNet2) を経由した通信を実現するには、ピアリング接続で「転送されたトラフィックを許可」を有効化する必要があります。 この設定により、ピアリングされた VNet 以外から送信されたトラフィックを受け入れることができます。

さらに、VM2 (仮想アプライアンス) を経由してトラフィックをルーティングするため、ルートテーブルの作成と構成が必要です。 VNet1 のサブネットには、VNet3 宛てのトラフィックを VM2 の IP アドレスにルーティングするユーザー定義ルート (UDR) を設定します。 同様に、VNet3 のサブネットには、VNet1 宛てのトラフィックを VM2 にルーティングするルートを設定します。

**設定項目 | 目的 | 設定場所**
転送されたトラフィックを許可 | ピアリング外のトラフィック受信 | ピアリング接続
ルートテーブル | VM2 経由のルーティング | 各 VNet のサブネット

ゲートウェイトランジットとリモートゲートウェイは、VPN Gateway や ExpressRoute ゲートウェイを使用する場合の設定であり、このシナリオでは該当しません。 VM2 は仮想アプライアンスとして動作するため、これらのゲートウェイ関連設定は不要です。

**構成要素 | VNet1 | VNet2 (ハブ) | VNet3**
ピアリング設定 | 転送トラフィック許可 | 転送トラフィック許可 | 転送トラフィック許可
ルートテーブル | VNet3 宛 → VM2 | 不要 | VNet1 宛 → VM2

**リファレンス**
• User-Defined Route (UDR)

---

### **問題 172**
**問題 172. Azure サブスクリプション「Subscription-A」に以下のリソースが構成されています。仮想ネットワークリンク「Link-B」の自動登録を有効にすることができますか。（一つ選択）**

**仮想ネットワーク**
**名前 | リージョン**
VNet-A | 東日本
VNet-B | 東日本
VNet-C | 西日本

**プライベート DNS ゾーン**
**名前 | ロケーション**
**spat-a.com** | 東日本
**spat-b.com** | 東日本
**spat-c.com** | 西日本

**仮想ネットワークリンク**
**名前 | プライベート DNS ゾーン | 仮想ネットワーク | 自動登録**
Link-A | spat-a.com | VNet-A | 有効
Link-B | spat-b.com | VNet-B | 無効
Link-C | spat-c.com | VNet-C | 無効

• いいえ
• はい

**解答例**
• はい

**解説**
Link-B の自動登録は有効にできます。 プライベート DNS ゾーンの仮想ネットワークリンクでは、自動登録機能を有効化することで、リンクされた仮想ネットワーク内の VM の DNS レコードを自動的にプライベート DNS ゾーンに登録できます。

自動登録を有効にするための条件は、プライベート DNS ゾーンと仮想ネットワークが仮想ネットワークリンクで接続されていることです。 リージョンの制約はありません。 プライベート DNS ゾーンはグローバルリソースであり、任意のリージョンの仮想ネットワークとリンク可能です。

現在の構成では、Link-B は **spat-b.com** と VNet-B を接続しており、自動登録は無効ですが、設定変更により有効化できます。 自動登録を有効にすると、VNet-B 内の VM が起動・停止・削除されるたびに、対応する A レコードと PTR レコードが **spat-b.com** ゾーンに自動的に追加・更新・削除されます。

**仮想ネットワークリンクの主要機能**
**機能 | 説明**
名前解決 | リンクされた仮想ネットワークからプライベート DNS ゾーンのレコードを解決可能
自動登録 | 仮想ネットワーク内の VM の DNS レコードを自動的にゾーンに登録

なお、一つのプライベート DNS ゾーンに対して自動登録を有効にできる仮想ネットワークリンクは一つだけという制限があります。 Link-A で既に自動登録が有効な場合、Link-B で自動登録を有効にするには、まず Link-A の自動登録を無効にする必要があります。

**リファレンス**
• Azure Private DNS
• 仮想ネットワークリンク

---

### **問題 173**
**問題 173. あなたは Azure 管理者として、Web01 という名前の仮想マシン上で複数のセキュアな Web サイトをホストする計画を立てています。TCP 443 ポートを使用した HTTPS 通信を Web01 に許可し、TCP 80 ポートを使用した HTTP 通信を Web01 に対してブロックする必要があります。この要件を満たすために、Azure ポータルから実施すべき最も適切な構成手順を選択してください。（一つ選択）**
• Network Security Group (NSG) でインバウンドセキュリティ規則を作成し、TCP 443 ポートを許可する規則と、TCP 80 ポートを拒否する規則を追加する
• Azure Firewall の DNAT ルールを構成し、TCP 443 ポートへのトラフィックを許可し、TCP 80 ポートへのトラフィックをドロップする
• Application Gateway のバックエンドプールに Web01 を追加し、リスナーで TCP 443 ポートのみを構成する
• Azure Load Balancer で TCP 443 ポート用の負荷分散規則を作成し、TCP 80 ポート用のヘルスプローブを無効化する

**解答例**
• Network Security Group (NSG) でインバウンドセキュリティ規則を作成し、TCP 443 ポートを許可する規則と、TCP 80 ポートを拒否する規則を追加する

**解説**
この問題の最重要ポイントは、仮想マシンレベルでのトラフィック制御には Network Security Group (NSG) が最も適切なソリューションであることを理解することです。 NSG は Azure の基本的なネットワークセキュリティ機能であり、仮想マシンのネットワークインターフェイスまたはサブネットに関連付けて、インバウンドおよびアウトバウンドのトラフィックを制御します。

NSG を使用した構成手順は以下の通りです。 Azure ポータルで対象の仮想マシン Web01 に関連付けられている NSG を開き、インバウンドセキュリティ規則を追加します。 まず、TCP 443 ポートへのアクセスを許可する規則を作成します。 この規則では、宛先ポート範囲に 443 を指定し、プロトコルに TCP を選択し、アクションを「許可」に設定します。 次に、TCP 80 ポートへのアクセスをブロックする規則を作成します。 宛先ポート範囲に 80 を指定し、プロトコルに TCP を選択し、アクションを「拒否」に設定します。 規則の優先度は数値が小さいほど優先されるため、拒否規則が既定の許可規則よりも優先されるように適切な優先度番号を設定する必要があります。

他の選択肢が不適切な理由を説明します。 Azure Firewall は高度なネットワークセキュリティ機能を提供しますが、単一の仮想マシンへのポート制御には過剰な機能であり、コストも高くなります。 Application Gateway はレイヤー 7 のロードバランサーであり、HTTPS トラフィックの負荷分散や SSL 終端には適していますが、単純なポート制御には不要です。 Azure Load Balancer はレイヤー 4 のロードバランサーであり、トラフィックの分散には使用できますが、特定のポートへのアクセスを拒否する機能は提供していません。

**機能 | 用途 | ポート制御**
NSG | 仮想マシンやサブネットのトラフィック制御 | 許可と拒否の両方が可能
Azure Firewall | エンタープライズレベルのネットワークセキュリティ | 高度なフィルタリングが可能
Application Gateway | レイヤー 7 の負荷分散と WAF | HTTPS トラフィックの処理に特化

**リファレンス**
• Network Security Group
• Azure Firewall

---

### **問題 174**
**問題 174. Azure サブスクリプションに、VNet1 という仮想ネットワークと VM1 という仮想マシンが含まれています。VM1 は内部ネットワークからのみアクセス可能です。外部の契約業者が VM1 にアクセスする必要があります。管理作業を最小限に抑えるソリューションを実装します。何を構成しますか。（一つ選択）**
• Azure Bastion
• Site-to-Site VPN
• 2 つ目のプライベート IP アドレス
• パブリック IP アドレス

**解答例**
• Azure Bastion

**解説**
外部の契約業者が内部ネットワーク上の VM1 に安全にアクセスするには、Azure Bastion が最適です。 Azure Bastion は、仮想ネットワーク内の仮想マシンに対して、ブラウザ経由で RDP および SSH 接続を提供するマネージドサービスです。

パブリック IP アドレスを割り当てる方法は、VM を直接インターネットに公開することになり、セキュリティリスクが高まります。 また、NSG（ネットワークセキュリティグループ）の管理も必要になります。 Site-to-Site VPN は、オンプレミスネットワークと Azure 仮想ネットワーク間の恒常的な接続を確立する方法であり、外部契約業者の一時的なアクセスには過剰な構成です。 2 つ目のプライベート IP アドレスは、外部からのアクセスには使用できません。

Azure Bastion を使用すると、VM にパブリック IP アドレスを割り当てる必要がなく、Azure Portal 経由で安全に接続できます。 TLS 経由でセキュアな接続が確立され、追加の VPN クライアントソフトウェアも不要です。 管理作業も最小限で済みます。

**方式 | セキュリティ | 管理負荷**
Azure Bastion | 高 (TLS 暗号化) | 低
パブリック IP | 低 (直接公開) | 中
Site-to-Site VPN | 高 | 高

**リファレンス**
• Azure Bastion
• Network Security Group
• Site-to-Site VPN

---

### **問題 175**
**問題 175. Azure サブスクリプションに 3 つの仮想マシンが存在します。各仮想マシンは以下の構成です。vm-A はプライベート IP 192.168.1.4、パブリック IP 7.198.2.1、DNS サフィックス hoge-hoge.com で VNet-A に接続。vm-B はプライベート IP 192.168.1.5、パブリック IP 131.107.90.80、DNS サフィックスなしで VNet-A に接続。vm-C はプライベート IP 10.0.1.2、パブリック IP 133.200.1.2、DNS サフィックス foobar-test.com で VNet-A に接続。次に、パブリック DNS ゾーン hoge-hoge.com、プライベート DNS ゾーン internal-test.com、パブリック DNS ゾーン foobar-test.com を作成します。internal-test.com では VNet-A への仮想ネットワークリンクを追加し自動登録を有効化します。hoge-hoge.com では vm-A と vm-B に所有者ロールを割り当てます。この構成において、vm-A の DNS A レコードが hoge-hoge.com に追加され IP アドレスが 7.198.2.1 になりますか。（一つ選択）**
• いいえ
• はい

**解答例**
• いいえ

**解説**
パブリック DNS ゾーンは自動登録機能をサポートしていません。 自動登録が機能するのはプライベート DNS ゾーンのみです。 hoge-hoge.com はパブリック DNS ゾーンとして作成されているため、仮想ネットワークリンクを設定して自動登録を有効化することはできません。

vm-A に所有者ロールを割り当てても、DNS レコードの自動作成には影響しません。 ロールベースのアクセス制御 (RBAC) は管理操作の権限を制御するものであり、DNS レコードの自動登録とは無関係です。

自動登録が有効な場合、プライベート DNS ゾーンにリンクされた仮想ネットワーク内の仮想マシンは、起動時や IP アドレス変更時に自動的に A レコードが作成されます。 本問では internal-test.com がプライベート DNS ゾーンとして作成され、VNet-A にリンクされ自動登録が有効化されているため、vm-A、vm-B、vm-C の A レコードは internal-test.com に自動作成されます。

パブリック DNS ゾーンでレコードを追加するには、Azure Portal、Azure CLI、Azure PowerShell、REST API などを使用して手動で作成する必要があります。

**DNS ゾーンタイプ | 自動登録 | 用途**
パブリック DNS ゾーン | 非対応 | インターネット公開名前解決
プライベート DNS ゾーン | 対応 | VNet 内部名前解決

したがって、vm-A の DNS A レコードは hoge-hoge.com には自動追加されません。正解は「いいえ」です。

**リファレンス**
• Azure DNS

---

### **問題 176**
**問題 176. あなたは Azure 環境の管理者です。Tenant1 という名前の Azure Active Directory テナントと、Subscription1 という名前の Azure サブスクリプションを管理しています。Azure AD Privileged Identity Management を有効化しました。Lab Creator ロールのメンバーをセキュアにする必要があります。ソリューションは、ラボ作成者がラボを作成する際にアクセスを要求することを保証する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**
• Azure AD Privileged Identity Management で Azure リソースを検出する
• Subscription1 で Lab Creator ロールのメンバーを編集する
• Azure AD Privileged Identity Management で Lab Creator のロール設定を編集する
• Azure AD Identity Protection でサインインリスクポリシーを作成する

**解答例**
• Azure AD Privileged Identity Management で Azure リソースを検出する

**解説**
Lab Creator はサブスクリプションレベルのロールであり、Azure AD Privileged Identity Management (PIM) でこのロールを管理するには、まず Azure リソースを PIM に登録する必要があります。

PIM は既定で Azure AD ロールのみを管理対象とします。 Azure サブスクリプションやリソースグループレベルのロール（Lab Creator など）を管理するには、PIM で Azure リソースを検出し、管理対象として追加する必要があります。 この検出プロセスにより、サブスクリプション内のロール割り当てが PIM で可視化され、Just-In-Time (JIT) アクセスや承認ワークフローなどの特権管理機能を適用できるようになります。

リソース検出後、Lab Creator ロールの設定を編集してアクティブ化時の承認要求を構成できます。 これにより、ラボ作成者は必要な時にのみロールをアクティブ化し、アクセスを要求する運用が実現します。

**操作 | 目的 | 実施タイミング**
Azure リソースの検出 | サブスクリプションを PIM 管理下に配置 | 最初
ロール設定の編集 | 承認要求やアクティブ化条件を構成 | 検出後
メンバーの編集 | 適格な割り当てを設定 | 設定後

**リファレンス**
• Azure AD Privileged Identity Management
• Just-In-Time Access
• Lab Creator ロール

---

### **問題 177**
**問題 177. あなたの組織では、storage1 と storage2 という 2 つの Premium Block Blob ストレージアカウントを運用しています。storage1 から storage2 へのオブジェクトレプリケーションを構成します。オブジェクトレプリケーションを構成する前に有効化する必要がある機能を選択してください。（該当するものをすべて選択）**
• storage2 の変更フィード
• storage1 の BLOB バージョン管理
• storage1 のコンテナーに対するポイントインタイムリストア
• storage2 の BLOB バージョン管理
• storage2 のコンテナーに対するポイントインタイムリストア
• storage1 の変更フィード

**解答例**
• storage1 の BLOB バージョン管理
• storage2 の BLOB バージョン管理
• storage1 の変更フィード

**解説**
Azure Storage のオブジェクトレプリケーションは、ソースストレージアカウントからデスティネーションストレージアカウントへブロック BLOB を非同期的にコピーする機能です。 この機能を利用するには、レプリケーション元とレプリケーション先の両方で特定の前提条件を満たす必要があります。

オブジェクトレプリケーションを構成する前に、ソースアカウント (storage1) では変更フィードと BLOB バージョン管理の両方を有効化する必要があります。 変更フィードは BLOB とメタデータの変更を追跡し、レプリケーション対象を特定するために必須です。 BLOB バージョン管理は各 BLOB の変更履歴を保持し、レプリケーションの整合性を保証します。

デスティネーションアカウント (storage2) では、BLOB バージョン管理のみを有効化する必要があります。 変更フィードはソース側でのみ必要な機能であり、デスティネーション側では不要です。

ポイントインタイムリストアは、誤削除や破損からの復旧を可能にする機能ですが、オブジェクトレプリケーションの前提条件ではありません。 この機能は任意で有効化できますが、レプリケーション構成には必須ではありません。

**機能 | storage1 (ソース) | storage2 (デスティネーション)**
BLOB バージョン管理 | 必須 | 必須
変更フィード | 必須 | 不要
ポイントインタイムリストア | 任意 | 任意

**リファレンス**
• 変更フィード

---

### **問題 178**
**問題 178. Azure サブスクリプションに、ストレージアカウント storage1 があり、Microsoft Entra ID テナントにリンクされています。storage1 に対して ID ベースのアクセスを構成する予定です。ID ベースのアクセスをサポートする storage1 のデータサービスはどれですか。（該当するものをすべて選択）**
• Blob Storage
• Azure Files
• Queue Storage
• Table Storage

**解答例**
• Blob Storage
• Azure Files
• Queue Storage

**解説**
Microsoft Entra ID（旧 Azure Active Directory）を使用した ID ベースのアクセス制御は、Azure Storage 内の特定のデータサービスでサポートされています。 この認証方式により、共有キーや SAS トークンを使用せず、ユーザーやアプリケーションの ID に基づいてアクセス制御を実装できます。

Blob Storage、Azure Files（SMB プロトコル経由）、Queue Storage の 3 つのサービスは、Microsoft Entra ID による認証と承認をサポートしています。 これらのサービスでは、Azure RBAC ロール（Storage Blob Data Contributor や Storage Queue Data Reader など）を割り当てることで、きめ細かいアクセス制御が可能です。

一方、Table Storage は現時点で Microsoft Entra ID ベースの認証をサポートしていません。 Table Storage へのアクセスには、ストレージアカウントキーまたは SAS トークンを使用する必要があります。

**データサービス | Microsoft Entra ID 認証 | 主な用途**
Blob Storage | サポート | 非構造化データ保存
Azure Files | サポート | ファイル共有
Queue Storage | サポート | メッセージキュー
Table Storage | 非サポート | NoSQL データ保存

ID ベースのアクセス制御を実装する際は、最小権限の原則に従い、必要最小限のアクセス許可を持つ RBAC ロールを割り当てることが推奨されます。

**リファレンス**
• Microsoft Entra ID
• Azure RBAC (Role-Based Access Control)
• Azure Storage Account

---

### **問題 179**
**問題 179. Azure サブスクリプションに複数のリソースが含まれています。ロードバランサー LB1 が構成されており、インターネットからポート 3389 を使用して VM2 へのリモートデスクトップアクセスを提供する新しいインバウンド NAT ルールを作成する予定です。この要件を満たすために、LB1 に追加で構成する必要があるコンポーネントを選択してください。（一つ選択）**
• バックエンドプール
• 正常性プローブ
• 送信規則
• フロントエンド IP アドレス

**解答例**
• フロントエンド IP アドレス

**解説**
インバウンド NAT ルールを作成してインターネットから特定の仮想マシンへのアクセスを提供するには、ロードバランサーにパブリック IP アドレスを持つフロントエンド IP アドレスが必要です。 インバウンド NAT ルールは、フロントエンド IP アドレスの特定のポートへのトラフィックを、バックエンドプール内の特定の仮想マシンの指定されたポートに転送します。

この問題では、インターネットから VM2 のポート 3389 (RDP) へアクセスするため、ロードバランサーのフロントエンドにパブリック IP アドレスが割り当てられている必要があります。 フロントエンド IP アドレスが構成されていない場合、外部からのトラフィックを受信できません。

バックエンドプールは仮想マシンをグループ化するために使用され、正常性プローブはバックエンドインスタンスの可用性を監視します。 送信規則はバックエンドプールからインターネットへの送信接続を構成するために使用されます。 これらはインバウンド NAT ルールの作成には直接必要ありません。

**コンポーネント | 用途**
フロントエンド IP アドレス | 外部トラフィックの受信エンドポイント
インバウンド NAT ルール | 特定ポートを特定 VM に転送
バックエンドプール | 負荷分散対象の VM グループ

インバウンド NAT ルールを構成する際の基本的な流れは、フロントエンド IP アドレスとポート番号を指定し、ターゲットとなる仮想マシンとポート番号をマッピングすることです。 この設定により、ロードバランサーのパブリック IP アドレスの特定ポートへのトラフィックが、指定された仮想マシンに直接転送されます。

**リファレンス**
• Azure Load Balancer

---

### **問題 180**
**問題 180. Computer1 という名前のコンピューターがあり、VNet1 という名前の Azure 仮想ネットワークへのポイント対サイト VPN 接続を持っています。このポイント対サイト接続は自己署名証明書を使用しています。Azure から、Computer2 という名前のコンピューターに VPN クライアント構成パッケージをダウンロードしてインストールしました。Computer2 から VNet1 へのポイント対サイト VPN 接続を確立できるようにします。解決策：Microsoft Entra ID の認証ポリシーを変更します。この解決策は目標を達成していますか？（一つ選択）**
• いいえ
• はい

**解答例**
• いいえ

**解説**
この解決策は目標を達成していません。 ポイント対サイト VPN 接続で自己署名証明書を使用している場合、新しいクライアントコンピューターから接続するには、そのクライアント証明書を Computer2 にインストールする必要があります。 Microsoft Entra ID の認証ポリシーを変更しても、証明書ベースの認証要件は満たされません。

ポイント対サイト VPN 接続では、クライアント認証に証明書または Microsoft Entra ID 認証のいずれかを使用できます。 この問題では自己署名証明書を使用した証明書ベース認証が構成されているため、Computer1 で使用されているクライアント証明書を Computer2 にエクスポートしてインストールする必要があります。 証明書は秘密キーと共にエクスポートし、Computer2 の個人証明書ストアにインポートします。

VPN クライアント構成パッケージには接続設定が含まれていますが、証明書ベース認証で必要なクライアント証明書自体は含まれていません。 そのため、構成パッケージをインストールしただけでは接続を確立できません。

**認証方式 | 必要な対応**
証明書ベース | クライアント証明書のインストール
Microsoft Entra ID | 認証ポリシーの構成
RADIUS | RADIUS サーバーの構成

**リファレンス**
• Point-to-Site VPN
• 自己署名証明書
• Microsoft Entra ID

---

### **問題 181**
**問題 181. Azure 仮想マシンで以下の操作を実行した後、仮想マシンの再デプロイを実施します。この場合、失われる変更はどれですか。（一つ選択）**
• C ドライブにファイルを作成
• D ドライブにファイルを作成
• スクリーンセーバーのタイムアウト設定を変更
• デスクトップの背景画像を変更

• C ドライブに作成したファイル
• スクリーンセーバーのタイムアウト設定
• D ドライブに作成したファイル
• レジストリに保存されたユーザー設定

**解答例**
• D ドライブに作成したファイル

**解説**
Azure 仮想マシンの再デプロイでは、OS ディスク（C ドライブ）のデータは保持されますが、一時ディスク（D ドライブ）のデータは失われます。

Azure 仮想マシンには、永続的な OS ディスクと一時ディスクが存在します。 OS ディスクは Azure Storage に保存される永続ストレージで、仮想マシンの再デプロイや停止・起動を行ってもデータは保持されます。 一方、一時ディスク（通常 D ドライブとして割り当て）は物理ホストのローカルストレージを使用する揮発性ストレージです。 再デプロイ時には仮想マシンが別の物理ホストに移動する可能性があるため、一時ディスクのデータは必ず失われます。

スクリーンセーバー設定やデスクトップ背景などのユーザー設定は、C ドライブ内のユーザープロファイルやレジストリに保存されるため、再デプロイ後も保持されます。 C ドライブに作成したファイルも同様に保持されます。

**ストレージ種別 | ドライブ | データ保持**
OS ディスク | C ドライブ | 保持される
一時ディスク | D ドライブ | 失われる
データディスク | 追加ドライブ | 保持される

一時ディスクは高速な I/O 性能を提供しますが、ページファイルやキャッシュなど揮発性データの保存にのみ使用すべきです。 重要なデータは必ず OS ディスクまたはデータディスクに保存する必要があります。

**リファレンス**
• Azure Virtual Machine
• Managed Disk

---

### **問題 182**
**問題 182. Azure 仮想マシンをデプロイするための Azure Resource Manager テンプレート「Template1」があります。このテンプレートの variables セクションには "location": "westeurope" という記述があり、resources セクションでは仮想マシンの location プロパティがこの変数を参照しています。Template1 を使用して仮想マシンを West US リージョンにデプロイする必要があります。どのような対応を行うべきですか。（一つ選択）**
• デプロイ時にパラメータファイルで location の値を westus に指定する
• variables セクションの location の値を westus に変更する
• resources セクションで仮想マシンの location プロパティを直接 westus に変更する
• テンプレートのデプロイ先リソースグループのリージョンを West US に設定する

**解答例**
• variables セクションの location の値を westus に変更する

**解説**
Azure Resource Manager (ARM) テンプレートでは、リソースのデプロイ先リージョンはテンプレート内で明示的に指定する必要があります。 本問題では、resources セクションの仮想マシン定義が variables セクションで定義された location 変数を参照しているため、この変数の値を変更することが最も適切な対応となります。

variables セクションは、テンプレート内で繰り返し使用される値を一元管理するための機能です。 location 変数の値を "westeurope" から "westus" に変更することで、この変数を参照しているすべてのリソースのデプロイ先が自動的に West US リージョンに変更されます。

resources セクションで直接 location を指定する方法も技術的には可能ですが、変数を使用している設計意図を無視することになり、テンプレートの保守性が低下します。 また、デプロイ先リソースグループのリージョンとリソース自体のリージョンは独立しており、リソースグループのリージョン設定はリソースのデプロイ先に影響しません。

**項目 | 説明**
variables セクション | テンプレート内で再利用する値を定義する領域
resources セクション | デプロイする Azure リソースを定義する領域
location プロパティ | リソースをデプロイする Azure リージョンを指定

**リファレンス**
• ARM Template
• Azure Region

---

### **問題 183**
**問題 183. Azure Active Directory (Azure AD) ドメインに 5,000 のユーザーアカウントが存在します。AdminUser1 という新しいユーザーアカウントを作成しました。AdminUser1 に User Administrator 管理者ロールを割り当てます。ユーザーアカウントのプロパティから何を実行しますか。（一つ選択）**
• Assigned roles ブレードから、ディレクトリロールを変更する
• Licenses ブレードから、新しいライセンスを割り当てる
• Groups ブレードから、ユーザーアカウントを新しいグループに招待する
• Administrative units ブレードから、管理単位を構成する

**解答例**
• Assigned roles ブレードから、ディレクトリロールを変更する

**解説**
Azure AD でユーザーに管理者ロールを割り当てる場合、ユーザーアカウントのプロパティから Assigned roles ブレードにアクセスし、適切なディレクトリロールを割り当てる必要があります。 User Administrator ロールは、ユーザーとグループの管理、パスワードのリセット、サポートチケットの管理などの権限を付与する組み込みロールです。

Assigned roles ブレードでは、Add assignments オプションを選択し、利用可能なロールの一覧から User Administrator を検索して選択します。 ロールの割り当ては即座に有効になり、AdminUser1 は割り当てられた権限を使用できるようになります。

Licenses ブレードはライセンスの割り当てに使用され、管理者ロールの付与とは関係ありません。 Groups ブレードはグループメンバーシップの管理に使用されますが、直接的な管理者ロールの割り当てには使用されません。 Administrative units は特定のリソースに対する管理権限のスコープを制限するために使用されますが、ロールの割り当て自体は Assigned roles ブレードで行います。

**項目 | 説明 | 用途**
Assigned roles | ディレクトリロールの割り当て管理 | 管理者権限の付与
Licenses | ライセンスの割り当て管理 | サービス利用権限の付与
Groups | グループメンバーシップ管理 | アクセス制御の簡素化

**リファレンス**
• Microsoft Entra ID
• User Administrator ロール





ご提示いただいたソース（AZ-104試験問題集）に基づき、その内容を一文字も省略することなく、全文をそのまま出力します。

---

### **問題 184**
組織で新しい **Azure ストレージアカウント「storage-A」** を作成します。このストレージアカウントは、**Azure Data Lake Storage** をサポートし、**アクセス頻度の低いデータのコストを最小限に抑え**、データを**セカンダリ Azure リージョンに自動的にレプリケート**する必要があります。storage-A に設定する必要があるオプションはどれですか。（三つ選択）

*   階層型名前空間
*   ローカル冗長ストレージ (LRS)
*   **geo 冗長ストレージ (GRS)**
*   **クールアクセス層**
*   ホットアクセス層

#### **解答例**
*   **階層型名前空間**
*   **geo 冗長ストレージ (GRS)**
*   **クールアクセス層**

#### **解説**
この問題では、Azure Data Lake Storage Gen2 の要件、コスト最適化、データ冗長性の 3 つの要件を同時に満たす構成を選択する必要があります。

**Azure Data Lake Storage Gen2** を有効にするには、ストレージアカウント作成時に「**階層型名前空間**」を有効化する必要があります。この機能により、ディレクトリとファイルの階層構造が提供され、ビッグデータ分析のパフォーマンスが向上します。階層型名前空間は作成後に変更できないため、初期設定で有効化する必要があります。

アクセス頻度の低いデータのコストを最小限に抑えるには、「**クールアクセス層**」を選択します。クールアクセス層は、少なくとも 30 日間保存されるデータに最適で、ホットアクセス層と比較してストレージコストが低く設定されています。ただし、データアクセス時のトランザクションコストはホットより高くなります。

データをセカンダリリージョンに自動的にレプリケートするには、「**geo 冗長ストレージ (GRS)**」を選択します。GRS は、プライマリリージョンから数百マイル離れたセカンダリリージョンにデータを非同期的にレプリケートし、リージョン全体の障害に対する保護を提供します。ゾーン冗長ストレージ (ZRS) は同一リージョン内の複数の可用性ゾーンにデータをレプリケートしますが、セカンダリリージョンへのレプリケーションは行いません。

| オプション | 機能 | 要件との適合 |
| :--- | :--- | :--- |
| **階層型名前空間** | Data Lake Storage Gen2 を有効化 | Data Lake Storage サポート要件を満たす |
| **クールアクセス層** | 低頻度アクセスデータの低コスト保存 | コスト最小化要件を満たす |
| **GRS** | セカンダリリージョンへの自動レプリケーション | リージョン間レプリケーション要件を満たす |

#### **リファレンス**
*   [Azure Data Lake Storage Gen2](https://learn.microsoft.com/ja-jp/azure/storage/blobs/data-lake-storage-introduction)
*   [Azure ストレージの冗長性](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-redundancy)

---

### **問題 185**
**Azure サブスクリプションに、RG1 という名前のリソースグループがあります。RG1 には、VM1 という名前の Azure 仮想マシンが含まれています。VM1 をテンプレートとして使用して新しい Azure 仮想マシンを作成します。このタスクを完了するために使用できる方法を 3 つ選択してください。（三つ選択）**

*   **Azure Cloud Shell から Get-AzVM と New-AzVM コマンドレットを実行する**
*   **VM1 から Export template を選択し、Deploy を選択する**
*   Azure Cloud Shell から Export-AzResourceGroup と New-AzResourceGroupDeployment コマンドレットを実行する
*   **RG1 から Export template を選択し、Download を選択してから、Azure Cloud Shell で New-AzResourceGroupDeployment コマンドレットを実行する**
*   Azure Cloud Shell から Save-AzDeploymentTemplate と New-AzResourceGroupDeployment コマンドレットを実行する

#### **解答例**
*   **Azure Cloud Shell から Get-AzVM と New-AzVM コマンドレットを実行する**
*   **VM1 から Export template を選択し、Deploy を選択する**
*   **RG1 から Export template を選択し、Download を選択してから、Azure Cloud Shell で New-AzResourceGroupDeployment コマンドレットを実行する**

#### **解説**
既存の仮想マシンをテンプレートとして新しい仮想マシンを作成する方法は、大きく分けて **PowerShell コマンドレットを使用する方法**と **Azure Resource Manager (ARM) テンプレートを使用する方法**があります。

**PowerShell** を使用する場合、`Get-AzVM` コマンドレットで既存の VM1 の構成情報を取得し、その情報を `New-AzVM` コマンドレットのパラメータとして渡すことで、同じ構成の新しい仮想マシンを作成できます。この方法は、スクリプトによる自動化に適しています。

**ARM テンプレート**を使用する方法では、VM1 から直接 **Export template** 機能を使用してテンプレートをエクスポートし、そのまま **Deploy** を選択することで新しい仮想マシンをデプロイできます。この方法は最も直感的で、ポータル上で完結する操作です。

また、**RG1 レベルで Export template** を実行してテンプレートをダウンロードし、`New-AzResourceGroupDeployment` コマンドレットでデプロイする方法も有効です。この方法では、テンプレートファイルをカスタマイズしてから展開することが可能です。

`Save-AzDeploymentTemplate` は既存のデプロイメントからテンプレートを保存するコマンドレットですが、VM 構成の取得には使用しません。`Export-AzResourceGroup` は非推奨のコマンドレットであり、現在はポータルの Export template 機能を使用することが推奨されています。

| 方法 | 使用ツール | 特徴 |
| :--- | :--- | :--- |
| **PowerShell 直接実行** | Get-AzVM + New-AzVM | スクリプト自動化に最適 |
| **VM 直接エクスポート** | Export template + Deploy | ポータルで完結、最も簡単 |
| **テンプレート ダウンロード** | Export + New-AzResourceGroupDeployment | カスタマイズ可能 |

#### **リファレンス**
*   [ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)
*   [Azure PowerShell コマンドレット](https://learn.microsoft.com/en-us/powershell/module/az.compute/new-azvm)

---

### **問題 186**
Azure 上で **Windows Server 2022 を実行する VM-A という仮想マシン**を運用しています。VM-A のシステムイベントログで **1 時間以内に 3 つ以上のエラーイベントが記録された場合に通知を受け取るアラートを構成**します。次の解決策を実装しました：**Log Analytics ワークスペースを作成してエージェント構成設定を行い、VM-A に Microsoft Monitoring Agent をインストールし、Azure Monitor で Log Analytics ワークスペースをソースとするアラートを作成しました。**この解決策は要件を満たしていますか。（一つ選択）**

*   いいえ
*   **はい**

#### **解答例**
*   **はい**

#### **解説**
この解決策は要件を満たしています。Azure 仮想マシンのシステムイベントログを監視してアラートを生成するには、**Log Analytics ワークスペースを使用したログ収集**と **Azure Monitor によるアラート設定**が必要です。

**Microsoft Monitoring Agent (MMA)** を VM-A にインストールすることで、Windows イベントログを含むシステムログデータが Log Analytics ワークスペースに転送されます。エージェント構成設定でシステムイベントログの収集を有効化することで、エラーレベルのイベントが記録されます。

Log Analytics ワークスペースに収集されたログデータに対して、Azure Monitor で **KQL クエリを使用したアラートルール**を作成できます。クエリでは特定の時間枠内のエラーイベント数を集計し、閾値（この場合は 3 つ以上）を超えた場合にアラートを発火させる条件を設定します。

| 構成要素 | 役割 |
| :--- | :--- |
| **Log Analytics ワークスペース** | ログデータの収集と保存 |
| **Microsoft Monitoring Agent** | VM-A から Log Analytics へのデータ転送 |
| **Azure Monitor アラート** | KQL クエリによる条件監視と通知 |

この構成により、システムイベントログのエラーを継続的に監視し、指定された条件でアラートを生成できます。

#### **リファレンス**
*   [Log Analytics Workspace](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/log-analytics-workspace-overview)
*   [Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)

---

### **問題 187**
**AKS1 という名前の Azure Kubernetes Service (AKS) クラスターがあります。AKS1 のクラスター自動スケーラーを構成します。使用すべきツールを 2 つ選択してください。（二つ選択）**

*   **Azure CLI の `az aks` コマンド**
*   Azure PowerShell の `Set-AzAks` コマンドレット
*   Kubernetes の `kubectl` コマンド
*   **Azure Portal**
*   Azure PowerShell の `Update-AzAksCluster` コマンドレット

#### **解答例**
*   **Azure CLI の `az aks` コマンド**
*   **Azure Portal**

#### **解説**
AKS クラスターの自動スケーラー構成は、**Azure のネイティブ管理ツールを使用して実行**します。クラスター自動スケーラーは、ノードプールのスケーリング設定を管理する **Azure リソースレベルの機能**であり、Kubernetes レベルのツールでは構成できません。

**Azure Portal** では、AKS クラスターのノードプール設定画面から自動スケーラーを有効化し、最小ノード数と最大ノード数を指定できます。直感的な GUI で設定を確認しながら構成できるため、初期設定や設定確認に適しています。

**Azure CLI の `az aks` コマンド**では、`az aks update` や `az aks nodepool update` コマンドに `--enable-cluster-autoscaler`、`--min-count`、`--max-count` パラメータを指定することで自動スケーラーを構成します。スクリプト化や自動化に適しており、CI/CD パイプラインに組み込むことも可能です。

`kubectl` コマンドは Kubernetes クラスター内のリソース管理に使用するツールですが、AKS のノードプールスケーリングという Azure インフラストラクチャレベルの設定は管理できません。`Set-AzAks` コマンドレットは実在しないコマンドレットです。実際の Azure PowerShell で AKS を管理する場合は `Set-AzAksCluster` などのコマンドレットを使用しますが、これも自動スケーラーの構成には対応していません。

| ツール | 自動スケーラー構成 | 用途 |
| :--- | :--- | :--- |
| **Azure Portal** | 可能 | GUI 操作、設定確認 |
| **Azure CLI** | 可能 | スクリプト化、自動化 |
| **kubectl** | 不可 | Pod 管理のみ |

#### **リファレンス**
*   [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/ja-jp/azure/aks/cluster-autoscaler)
*   [Azure CLI](https://learn.microsoft.com/ja-jp/cli/azure/aks)

---

### **問題 188**
**Azure サブスクリプションに以下のリソースが含まれています。Subnet1 という名前のサブネットを持つ仮想ネットワーク、NSG-VM1 と NSG-Subnet1 という名前の 2 つのネットワークセキュリティグループ (NSG: Network Security Group)、リモートデスクトップ接続を許可するために必要な Windows Server 構成を持つ VM1 という名前の仮想マシンです。NSG-Subnet1 にはデフォルトの受信セキュリティ規則のみが設定されています。NSG-VM1 にはデフォルトの受信セキュリティ規則と次のカスタム受信セキュリティ規則があります。優先度 100、送信元 Any、送信元ポート範囲 *、宛先 *、宛先ポート範囲 3389、プロトコル UDP、アクション Allow です。VM1 は Subnet1 に接続されており、NSG-VM1 は VM1 のネットワークインターフェイスに関連付けられ、NSG-Subnet1 は Subnet1 に関連付けられています。インターネットから VM1 へのリモートデスクトップ接続を確立できるようにします。解決策として、NSG-Subnet1 と NSG-VM1 に受信セキュリティ規則を追加し、インターネットソースから VirtualNetwork 宛先へのポート範囲 3389 の接続を TCP プロトコルで許可します。この解決策は目標を満たしていますか。（一つ選択）**

*   いいえ
*   **はい**

#### **解答例**
*   **はい**

#### **解説**
**リモートデスクトップ接続 (RDP : Remote Desktop Protocol) は TCP プロトコルのポート 3389 を使用します**。問題文の VM1 には優先度 100 で UDP プロトコルのポート 3389 を許可するカスタム規則が存在しますが、これは RDP 接続には使用されません。

Azure のネットワークセキュリティグループでは、仮想マシンへのトラフィックは**複数の NSG によって評価**されます。VM1 のネットワークインターフェイスに関連付けられた NSG-VM1 と、Subnet1 に関連付けられた NSG-Subnet1 の**両方で許可される必要があります**。

解決策では、NSG-Subnet1 と NSG-VM1 の両方に、インターネットから VirtualNetwork への TCP ポート 3389 の受信を許可する規則を追加しています。これにより、**サブネットレベルとネットワークインターフェイスレベルの両方で RDP トラフィックが許可される**ため、インターネットから VM1 へのリモートデスクトップ接続が確立可能になります。

NSG の評価は以下の順序で行われます。

| 評価順序 | 対象 NSG | 関連付け先 |
| :--- | :--- | :--- |
| 1 | **サブネット NSG** | サブネット全体 |
| 2 | **NIC NSG** | 個別の仮想マシン |

**両方の NSG で許可されない限り、トラフィックは仮想マシンに到達できません**。デフォルトの受信規則ではインターネットからの接続は拒否されるため、明示的な許可規則の追加が必要です。

| プロトコル | ポート番号 | 用途 |
| :--- | :--- | :--- |
| **TCP** | 3389 | リモートデスクトップ接続 |
| UDP | 3389 | 一般的には未使用 |
| TCP | 22 | SSH 接続 |

#### **リファレンス**
*   [Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
*   [リモートデスクトッププロトコル](https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/windows/rdp-guidance)
*   [Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

---

### **問題 189**
**オンプレミスの Active Directory フォレスト内に、hogehoge.com という名前のフォレストがあり、hogehoge.com と east.hogehoge.com という 2 つのドメインが含まれています。このフォレストには複数のユーザーアカウントが存在します。Azure AD Connect を使用して east.hogehoge.com を Microsoft Entra ID（旧 Azure AD）テナントに同期する予定です。Azure AD Connect がフォレストへの接続に使用するアカウントを選択する必要があります。次のユーザーアカウント情報を確認し、最も適切なアカウントを選択してください。（一つ選択）**

| ユーザー | ドメイン | グループメンバーシップ |
| :--- | :--- | :--- |
| User1 | hogehoge.com | Domain Admins |
| User2 | east.hogehoge.com | Enterprise Admins |
| User3 | hogehoge.com | **Enterprise Admins** |
| User4 | east.hogehoge.com | Domain Admins |

*   User4 を選択する
*   User2 を選択する
*   User1 を選択する
*   **User3 を選択する**

#### **解答例**
*   **User3 を選択する**

#### **解説**
Azure AD Connect でオンプレミスの Active Directory フォレストを同期する際、接続アカウントには特定の権限要件があります。フォレスト全体にアクセスできる権限が必要となるため、**Enterprise Admins グループのメンバーシップを持つアカウント**を使用する必要があります。

**Enterprise Admins** はフォレストレベルの管理者グループであり、フォレスト内のすべてのドメインに対する完全な管理権限を持ちます。一方、Domain Admins は特定のドメイン内でのみ管理権限を持つため、複数ドメインを含むフォレスト全体の同期には不十分です。

本シナリオでは、east.hogehoge.com ドメインを同期対象としていますが、Azure AD Connect はフォレスト全体の構造を理解し、すべてのドメインにアクセスできる必要があります。**User3 は hogehoge.com ドメインに所属し、Enterprise Admins グループのメンバーであるため、フォレスト全体に対する必要な権限を持っています**。

User2 も Enterprise Admins のメンバーですが、east.hogehoge.com ドメインに所属しているため、フォレストルートドメイン (hogehoge.com) からの管理という観点では、User3 の方がより適切な選択となります。User1 と User4 は Domain Admins のみであり、フォレストレベルの権限を持たないため不適切です。

| アカウント | グループ | 権限範囲 | 適切性 |
| :--- | :--- | :--- | :--- |
| User1 | Domain Admins | hogehoge.com のみ | 不適切 |
| User2 | Enterprise Admins | フォレスト全体 | 適切だが次善 |
| **User3** | **Enterprise Admins** | **フォレスト全体** | **最適** |
| User4 | Domain Admins | east.hogehoge.com のみ | 不適切 |

#### **リファレンス**
*   [Microsoft Entra Connect](https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/whatis-azure-ad-connect)
*   [Microsoft Entra ID](https://learn.microsoft.com/ja-jp/entra/fundamentals/whatis)

---

### **問題 190**
**Azure サブスクリプションに、VNet1 という名前の仮想ネットワークがあります。VNet1 には、Gateway、Perimeter、NVA、Production という 4 つのサブネットが含まれています。NVA サブネットには、Perimeter サブネットと Production サブネット間のネットワークトラフィック検査を実行する 2 つのネットワーク仮想アプライアンス (NVA) が含まれています。NVA 用の Azure Load Balancer を実装します。ソリューションは次の要件を満たす必要があります。NVA は自動フェールオーバーを使用するアクティブ - アクティブ構成で実行する必要があります。ロードバランサーは、Production サブネット上の 2 つのサービスにトラフィックを負荷分散する必要があります。これらのサービスは異なる IP アドレスを持ちます。実行する必要がある 3 つのアクションはどれですか。（該当するものをすべて選択）**

*   **Standard Load Balancer をデプロイする**
*   **フロントエンド IP 構成、2 つのバックエンドプール、正常性プローブを追加する**
*   **HA ポートと Floating IP を有効にした 2 つの負荷分散ルールを追加する**
*   Basic Load Balancer をデプロイする
*   フロントエンド IP 構成、バックエンドプール、正常性プローブを追加する
*   HA ポートを有効にし、Floating IP を無効にした 2 つの負荷分散ルールを追加する

#### **解答例**
*   **Standard Load Balancer をデプロイする**
*   **フロントエンド IP 構成、2 つのバックエンドプール、正常性プローブを追加する**
*   **HA ポートと Floating IP を有効にした 2 つの負荷分散ルールを追加する**

#### **解説**
この問題は、NVA のアクティブ - アクティブ構成と複数サービスへの負荷分散を実現する Load Balancer 構成を問うものです。

NVA シナリオでは、内部トラフィックの検査と転送を行うため、**Standard Load Balancer** の内部ロードバランサー構成が必要です。Basic Load Balancer は機能制限があり、HA ポート機能をサポートしていないため不適切です。Standard Load Balancer は、より高度な機能と SLA 保証を提供します。

Production サブネット上の 2 つの異なる IP アドレスを持つサービスに負荷分散するには、**サービスごとに個別のバックエンドプールが必要**です。各バックエンドプールは特定のサービスのターゲットを管理し、フロントエンド IP 構成と正常性プローブによって可用性を監視します。

**HA ポート機能**は、すべてのポートとプロトコルでトラフィックを負荷分散する機能で、NVA シナリオに最適です。**Floating IP (Direct Server Return)** を有効にすることで、NVA は元の宛先 IP アドレスを保持したままトラフィックを処理できます。これにより、NVA は適切にトラフィックを検査し、正しい宛先に転送できます。

| 構成要素 | 必要な設定 | 理由 |
| :--- | :--- | :--- |
| **Load Balancer タイプ** | Standard Load Balancer | HA ポート機能と SLA 保証が必要 |
| **バックエンドプール** | 2 つのプール | 異なる IP アドレスの 2 サービスに対応 |
| **負荷分散ルール** | HA ポートと Floating IP 有効 | 全ポート対応と IP 保持が必要 |

#### **リファレンス**
*   [Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
*   [HA ポート](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-ha-ports-overview)
*   [Floating IP](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-floating-ip)

---

### **問題 191**
**Azure サブスクリプションに複数のリソースが含まれています。新しく IP1 という名前のパブリック IP アドレスを作成しました。IP1 を関連付けることができるリソースはどれですか。（二つ選択）**

*   Application Gateway
*   仮想マシン
*   **Load Balancer**
*   仮想ネットワーク
*   **VPN Gateway**

#### **解答例**
*   **Load Balancer**
*   **VPN Gateway**

#### **解説**
パブリック IP アドレスは、インターネットから Azure リソースへの通信を可能にするために使用されます。パブリック IP アドレスを直接関連付けできるリソースには制限があり、主に**ネットワークインターフェイス、Load Balancer、Application Gateway、VPN Gateway** などが該当します。

仮想マシンに対してパブリック IP アドレスを割り当てる場合、実際にはその仮想マシンに接続されている**ネットワークインターフェイスに対して関連付け**を行います。仮想マシン自体に直接パブリック IP アドレスを関連付けることはできません。

**Load Balancer** は、フロントエンド IP としてパブリック IP アドレスを関連付けることができます。これにより、インターネットからのトラフィックを複数のバックエンドリソースに分散できます。

**VPN Gateway** は、オンプレミスネットワークと Azure 仮想ネットワーク間の安全な接続を確立するために、パブリック IP アドレスを必要とします。VPN Gateway にパブリック IP アドレスを関連付けることで、外部からの接続エンドポイントとして機能します。

Application Gateway もパブリック IP アドレスを関連付けできますが、これは Web アプリケーション向けのレイヤー 7 ロードバランサーとして機能します。

仮想ネットワーク自体にはパブリック IP アドレスを直接関連付けることはできません。仮想ネットワークは、プライベート IP アドレス空間を定義するコンテナとして機能します。

| リソースタイプ | パブリック IP 関連付け | 用途 |
| :--- | :--- | :--- |
| **Load Balancer** | **可能** | トラフィック分散 |
| **VPN Gateway** | **可能** | VPN 接続エンドポイント |
| **Application Gateway** | 可能 | Web トラフィック管理 |
| 仮想マシン | 不可（NIC 経由） | 間接的に利用 |
| 仮想ネットワーク | 不可 | アドレス空間定義 |

#### **リファレンス**
*   [Public IP Address](https://learn.microsoft.com/ja-jp/azure/virtual-network/ip-services/public-ip-addresses)
*   [VPN Gateway](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/vpn-gateway-about-vpngateways)

---

### **問題 192**
**あなたの組織が所有する Azure サブスクリプションには、VM-A という名前の仮想マシンがあります。VM-A は 24 時間 365 日稼働が必要なアプリケーションをホストしています。VM-A には 1 つのネットワークインターフェイスと 1 つのマネージドディスクがあり、D4s v3 サイズを使用しています。VM-A に対して構成変更を実施する予定です。VM-A のダウンタイムを引き起こす変更はどれですか。（一つ選択）**

*   500GB のマネージドディスクを追加する
*   **サイズを D8s v3 に変更する**
*   Azure Automation State Configuration を有効にする
*   ネットワークインターフェイスを追加する

#### **解答例**
*   **サイズを D8s v3 に変更する**

#### **解説**
仮想マシンのサイズ変更は、**仮想マシンの再起動を伴うため必ずダウンタイムが発生します**。D4s v3 から D8s v3 へのサイズ変更では、vCPU 数やメモリ容量などのハードウェアリソースが変更されるため、仮想マシンの停止と再起動が必要です。

その他の選択肢はダウンタイムを発生させません。**マネージドディスクの追加**は、仮想マシンが稼働中でも実行可能です。**Azure Automation State Configuration の有効化**は、構成管理機能の追加であり仮想マシンの稼働に影響しません。**ネットワークインターフェイスの追加**も、仮想マシンを停止する必要がありますが割り当て解除は不要なため、短時間の停止で済み一般的にはダウンタイムとして扱われません。ただし、サイズ変更は完全な再起動を伴うため、明確なダウンタイムが発生します。

Azure の仮想マシン管理において、サイズ変更は計画的なメンテナンスウィンドウで実施すべき操作です。可用性セットや可用性ゾーンを使用した冗長構成を採用している場合は、ローリングアップデート方式でダウンタイムを最小化できます。

| 操作 | ダウンタイム | 理由 |
| :--- | :--- | :--- |
| **サイズ変更** | **発生する** | 仮想マシンの再起動が必要 |
| ディスク追加 | 発生しない | 稼働中に実行可能 |
| NIC 追加 | 発生しない | 停止のみで割り当て解除不要 |

#### **リファレンス**
*   [Azure Automation](https://learn.microsoft.com/ja-jp/azure/automation/automation-intro)
*   [Azure Virtual Machine](https://learn.microsoft.com/ja-jp/azure/virtual-machines/overview)
*   [Availability Set](https://learn.microsoft.com/ja-jp/azure/virtual-machines/availability-set-overview)
*   [Managed Disk](https://learn.microsoft.com/ja-jp/azure/managed-disks-overview)

---

### **問題 193**
**Azure AD テナント hogehoge と Azure サブスクリプション Sub1 があります。hogehoge には DevTeam というグループが含まれています。Sub1 には DevRG というリソースグループが含まれています。DevRG リソースグループ内で DevTeam グループに Logic Apps を作成する権限を付与します。解決策として、Sub1 で DevTeam グループに DevTest Labs User ロールを割り当てました。この解決策は要件を満たしていますか。（一つ選択）**

*   要件を満たしている
*   **要件を満たしていない**
*   Logic Apps Contributor ロールを割り当てる必要がある
*   リソースグループレベルで Contributor ロールを割り当てる必要がある

#### **解答例**
*   **要件を満たしていない**

#### **解説**
**DevTest Labs User ロール**は Azure DevTest Labs サービス専用のロールであり、**Logic Apps の作成権限は含まれていません**。このロールは仮想マシンの接続、起動、停止、再起動など DevTest Labs 環境内での限定的な操作のみを許可します。

Logic Apps を作成するには、適切なロールベースアクセス制御 (RBAC) の割り当てが必要です。リソースグループレベルで **Contributor (共有作成者) ロール** または **Logic App Contributor ロール**を割り当てることで、指定されたリソースグループ内での Logic Apps の作成、管理、削除が可能になります。

要件を満たすための正しい手順は、**DevRG リソースグループに対して DevTeam グループに Contributor ロールまたは Logic App Contributor ロールを割り当てること**です。これにより DevTeam グループのメンバーは、DevRG リソースグループ内で Logic Apps を作成および管理できるようになります。

| ロール名 | 適用範囲 | Logic Apps 作成権限 |
| :--- | :--- | :--- |
| **DevTest Labs User** | DevTest Labs 環境 | なし |
| **Logic App Contributor** | Logic Apps | **あり** |
| **Contributor** | すべてのリソース | **あり** |

#### **リファレンス**
*   [Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/overview)
*   [Logic Apps](https://learn.microsoft.com/ja-jp/azure/logic-apps/logic-apps-overview)
*   [Resource group](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview#resource-groups)

---

### **問題 194**
**Azure サブスクリプション内に TestRG という名前のリソースグループがあります。このリソースグループには VM1（仮想マシン）、VNET1（仮想ネットワーク）、Vault1（Recovery Services コンテナー）が含まれています。VNET1 には Delete リソースロックが設定されており、Vault1 には VM1 のバックアップデータが保存されています。TestRG リソースグループ全体を削除する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

*   VM1 の電源をオフにし、Vault1 内のすべてのバックアップデータを削除する
*   VNET1 のリソースロックを削除し、VM1 の電源をオフにする
*   Vault1 内のすべてのバックアップデータを削除し、VNET1 のリソースロックを ReadOnly に変更する
*   **VNET1 のリソースロックを削除し、Vault1 内のすべてのバックアップデータを削除する**

#### **解答例**
*   **VNET1 のリソースロックを削除し、Vault1 内のすべてのバックアップデータを削除する**

#### **解説**
Azure リソースグループを削除する際には、含まれるすべてのリソースが削除可能な状態である必要があります。本問では 2 つの削除阻害要因が存在します。

第一に、VNET1 に設定された **Delete リソースロック**です。リソースロックには 2 種類あり、ReadOnly は読み取り専用、Delete は削除防止を意味します。Delete ロックが設定されている場合、そのリソース自体およびそれを含むリソースグループの削除が完全にブロックされます。したがって **VNET1 のリソースロックを削除することが必須**です。

第二に、Recovery Services コンテナーである Vault1 内の**バックアップデータ**です。Azure では保護されたアイテム（バックアップデータ）が存在する Recovery Services コンテナーは削除できません。VM1 が稼働中か停止中かに関わらず、**Vault1 内のバックアップデータを先に削除する必要があります**。VM1 の電源状態はリソースグループ削除の前提条件ではありません。

リソースグループ削除の正しい手順は、まず **VNET1 の Delete ロックを解除し、次に Vault1 内の保護されたアイテムをすべて削除してから、リソースグループ全体を削除します**。

| 削除阻害要因 | 必要な対処 |
| :--- | :--- |
| **Delete リソースロック** | ロックの削除 |
| **バックアップデータ** | データの事前削除 |
| VM 稼働状態 | 対処不要 |

#### **リファレンス**
*   [Resource Lock](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/lock-resources)
*   [Recovery Services Vault](https://learn.microsoft.com/ja-jp/azure/backup/backup-azure-recovery-services-vault-overview)
*   [Resource group](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/manage-resource-groups-portal)

---

### **問題 195**
**Azure AD（Azure Active Directory）テナントで Azure AD Privileged Identity Management を構成しています。テナントの Security Administrator（セキュリティ管理者）ロールが割り当てられた 10 人のユーザーがいます。これらのユーザーが Security Administrator ロールを引き続き必要としているかどうかを定期的に検証します。どの操作を実行しますか。（一つ選択）**

*   **Azure AD Privileged Identity Management でアクセスレビューを作成する**
*   Azure AD Identity Protection でユーザーリスクポリシーを構成する
*   Azure AD Identity Protection で週次ダイジェストを構成する
*   Azure AD でロールベースのアクセス制御ポリシーを作成する

#### **解答例**
*   **Azure AD Privileged Identity Management でアクセスレビューを作成する**

#### **解説**
**Azure AD Privileged Identity Management (PIM) のアクセスレビュー機能**を使用することで、特権ロールの割り当てが適切かどうかを定期的に検証できます。

**アクセスレビュー**は、ロール割り当ての妥当性を確認するための機能です。レビュー担当者（管理者または本人）が、各ユーザーのロール割り当てが引き続き必要かどうかを評価します。レビュー期間を設定し、定期的な実施も可能です。レビュー結果に基づいて、不要になったロール割り当てを自動的に削除することもできます。

Azure AD Identity Protection のユーザーリスクポリシーは、不審なサインイン行動やアカウント侵害のリスクを検出して対応するための機能であり、ロール割り当ての妥当性検証には使用しません。週次ダイジェストは、検出されたリスクイベントの要約レポートを管理者に送信する機能です。ロールベースのアクセス制御ポリシーは、リソースへのアクセス権限を管理する仕組みですが、既存のロール割り当ての定期的な検証機能は提供していません。

| 機能 | 用途 | ロール検証 |
| :--- | :--- | :--- |
| **アクセスレビュー** | **ロール割り当ての妥当性を定期検証** | **可能** |
| ユーザーリスクポリシー | 不審な行動やアカウント侵害の検出 | 不可 |
| 週次ダイジェスト | リスクイベントの要約レポート送信 | 不可 |

#### **リファレンス**
*   [Azure AD Privileged Identity Management](https://learn.microsoft.com/ja-jp/entra/id-governance/privileged-identity-management/pim-configure)
*   [Azure AD Identity Protection](https://learn.microsoft.com/ja-jp/entra/id-protection/overview-identity-protection)

---

### **問題 196**
**Log Analytics ワークスペースがあり、さまざまなデータソースからデータを収集しています。新しい Azure Monitor ログクエリを作成し、その結果をグラフとして共有ダッシュボードにピン留めする予定です。共有ダッシュボードに表示できるデータの最大日数はどれですか。（一つ選択）**

*   30 日
*   **90 日**
*   14 日
*   365 日

#### **解答例**
*   **90 日**

#### **解説**
Azure Monitor の共有ダッシュボードにピン留めされたログクエリの結果は、**最大 90 日間のデータを表示できます**。これは Azure Portal の共有ダッシュボード機能における技術的な制限です。

Log Analytics ワークスペース自体はデフォルトで 30 日間のデータ保持期間を持ちますが、最大 730 日（約 2 年）まで延長可能です。ただし、**共有ダッシュボードにピン留めしたグラフで表示できる期間は、ワークスペースの保持期間とは別に 90 日という上限が設定されています**。

この制限は、ダッシュボードのパフォーマンスと応答性を維持するために設けられています。より長期間のデータ分析が必要な場合は、Log Analytics ワークスペースで直接クエリを実行するか、Azure Workbooks を採用することで、保持期間内の全データにアクセスできます。

| 項目 | 期間 |
| :--- | :--- |
| **共有ダッシュボードの表示上限** | **90 日** |
| Log Analytics デフォルト保持期間 | 30 日 |
| Log Analytics 最大保持期間 | 730 日 |

14 日や 30 日は共有ダッシュボードの制限値として短すぎ、365 日は上限を超えています。Azure 環境でのモニタリング戦略を計画する際は、データの保持期間と表示期間の違いを理解することが重要です。

#### **リファレンス**
*   [Log Analytics Workspace](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/log-analytics-workspace-overview)
*   [Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)
*   [Azure Dashboard](https://learn.microsoft.com/ja-jp/azure/azure-portal/azure-portal-dashboards)

---

### **問題 197**
**オンプレミスの Active Directory フォレスト（hogehoge.com）があり、Azure AD Connect をインストールしてパスワードハッシュ同期をシングルサインオン方式として構成しました。同期結果を確認したところ、Synchronization Service Manager に同期ジョブが表示されません。同期を正常に完了させます。どうすればよいですか。（一つ選択）**

*   **Azure AD Connect を実行してステージングモードを無効にする**
*   Azure PowerShell から Start-AdSyncSyncCycle -PolicyType Initial コマンドレットを実行する
*   Synchronization Service Manager からフルインポートを実行する
*   Azure AD Connect を実行してシングルサインオン方式をパススルー認証に変更する

#### **解答例**
*   **Azure AD Connect を実行してステージングモードを無効にする**

#### **解説**
Azure AD Connect の**ステージングモード**は、本番環境に影響を与えずに同期設定をテストするための機能です。ステージングモードが有効な場合、同期エンジンはオンプレミス Active Directory からデータをインポートして処理しますが、**Azure AD へのエクスポート（実際の同期）は実行されません**。このため、Synchronization Service Manager に同期ジョブが表示されない状態となります。

同期を正常に完了させるには、ステージングモードを無効にする必要があります。Azure AD Connect ウィザードを実行し、構成オプションからステージングモードを無効化することで、同期エンジンが Azure AD へのエクスポートを開始し、同期ジョブが Synchronization Service Manager に表示されるようになります。

他の選択肢が不適切な理由を整理します。フルインポートの実行は、オンプレミスからのデータ読み込みを再実行するだけで、Azure AD へのエクスポートは行われません。`Start-AdSyncSyncCycle` コマンドレットは同期サイクルを手動で開始しますが、ステージングモードが有効な状態では依然としてエクスポートが実行されません。シングルサインオン方式の変更は、認証方法を変更するだけで同期の問題を解決しません。

| 項目 | 説明 |
| :--- | :--- |
| **ステージングモード** | 同期設定のテスト用モード。Azure AD へのエクスポートを実行しない |
| **同期の完了条件** | **ステージングモードを無効化してエクスポートを有効にする** |
| Synchronization Service Manager | 同期ジョブの監視ツール。エクスポートが実行されないと表示されない |

#### **リファレンス**
*   [Microsoft Entra Connect](https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/how-to-connect-sync-operations)
*   [Synchronization Service Manager](https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/how-to-connect-sync-service-manager-ui)

---

### **問題 198**
**あなたは、West US リージョンにある VNet1 という仮想ネットワークを管理しています。VNet1 には、Windows Server を実行する VM1 と VM2 という 2 つの仮想マシンがホストされています。3 時間にわたって VM1 から VM2 へのすべてのネットワークトラフィックを検査します。解決策として、Azure Monitor で Network In と Network Out のメトリックを作成しました。この解決策は要件を満たしていますか。（一つ選択）**

*   **いいえ、要件を満たしていない**
*   はい、要件を満たしている

#### **解答例**
*   **いいえ、要件を満たしていない**

#### **解説**
Azure Monitor の Network In と Network Out メトリックでは、**VM 間のネットワークトラフィックの詳細な検査は実現できません**。これらのメトリックは、仮想マシンの受信バイト数と送信バイト数の集計値を提供するのみで、パケットレベルでのトラフィック内容の分析や検査には対応していません。

VM 間のネットワークトラフィックを詳細に検査するには、**Network Watcher のパケットキャプチャ機能**を使用する必要があります。パケットキャプチャを使用すると、指定した期間中のネットワークトラフィックをキャプチャし、送信元 IP アドレス、宛先 IP アドレス、ポート番号、プロトコルなどの詳細情報を含むパケットレベルでの分析が可能になります。キャプチャしたデータは Storage Account に保存され、Wireshark などのツールで詳細な分析を実行できます。

| 機能 | Azure Monitor メトリック | **Network Watcher パケットキャプチャ** |
| :--- | :--- | :--- |
| 提供情報 | 送受信バイト数の集計 | パケットレベルの詳細情報 |
| トラフィック検査 | 不可 | **可能** |
| 保存先 | メトリックストア | Storage Account |

Network Watcher のパケットキャプチャは、最大 5 時間まで継続でき、フィルター条件を設定してキャプチャ対象を絞り込むことも可能です。今回の要件である 3 時間のトラフィック検査には、この機能が最適です。

#### **リファレンス**
*   [Network Watcher](https://learn.microsoft.com/ja-jp/azure/network-watcher/network-watcher-monitoring-overview)
*   [パケットキャプチャ](https://learn.microsoft.com/ja-jp/azure/network-watcher/network-watcher-packet-capture-overview)
*   [Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)

---

### **問題 199**
**Azure 環境で複数の仮想マシンを運用しています。コスト最適化のため、現在使用されていない休止状態の仮想マシンや、削除された仮想マシンから切り離されたまま残っている未接続のマネージドディスクを特定したいと考えています。これらの未使用リソースを効率的に発見するために最も適切な方法を選びます。（一つ選択）**

*   **Azure Advisor のコスト最適化カテゴリで推奨事項を確認する**
*   Azure Monitor のメトリックエクスプローラーでディスクのパフォーマンスメトリックを分析する
*   Azure Cost Management のコスト分析機能でリソース別の支出を確認する
*   Azure Storage Explorer でストレージアカウントのプロパティとメトリックを表示する

#### **解答例**
*   **Azure Advisor のコスト最適化カテゴリで推奨事項を確認する**

#### **解説**
**Azure Advisor** は、Azure リソースの構成とテレメトリデータを継続的に分析し、ベストプラクティスに基づいた推奨事項を提供するサービスです。**コスト最適化カテゴリ**では、未接続のマネージドディスクや長期間停止している仮想マシンなど、無駄なコストが発生しているリソースを自動的に検出して通知します。

未接続のマネージドディスクとは、仮想マシンから切り離されたまま課金が継続しているディスクのことです。仮想マシンを削除してもディスクは自動削除されないため、明示的に削除しない限り料金が発生し続けます。Azure Advisor はこのような非効率なリソースを特定し、削除や最適化の推奨事項として提示します。

Azure Cost Management のコスト分析は支出の可視化には有効ですが、リソースが未使用かどうかの判定や具体的な最適化提案は行いません。Azure Monitor はパフォーマンス監視が主目的であり、コスト最適化の推奨には適していません。Azure Storage Explorer はストレージアカウント内のデータ管理ツールであり、マネージドディスクの使用状況分析には対応していません。

| サービス | 主な用途 | 未使用リソース検出 |
| :--- | :--- | :--- |
| **Azure Advisor** | ベストプラクティス推奨 | **対応（自動検出）** |
| Cost Management | コスト可視化と予算管理 | 非対応 |
| Azure Monitor | パフォーマンス監視 | 非対応 |

Azure Advisor の推奨事項は、Azure ポータルの「Advisor」ブレードまたは「Cost Management + Billing」の「Advisor recommendations」から確認できます。定期的にチェックすることで、継続的なコスト最適化が実現できます。

#### **リファレンス**
*   [Azure Advisor](https://learn.microsoft.com/ja-jp/azure/advisor/advisor-overview)
*   [Managed Disk](https://learn.microsoft.com/ja-jp/azure/virtual-machines/managed-disks-overview)
*   [Azure Cost Management](https://learn.microsoft.com/ja-jp/azure/cost-management-billing/costs/quick-acm-cost-analysis)

---

### **問題 200**
**あなたは、West US、Central US、East US の Azure リージョンで Web アプリを運用しています。現在、以下の App Service plan を使用しています。**

| プラン名 | リージョン | OS |
| :--- | :--- | :--- |
| ASP1 | West US | Windows |
| ASP2 | Central US | Windows |
| ASP3 | East US | Linux |

**新たに Linux OS を使用する App Service plan (ASP4) を作成する予定です。現在使用しているリージョンのうち、ASP4 をデプロイできるリージョンを特定する必要があります。どのリージョンを推奨しますか。（一つ選択）**

*   Central US のみ
*   West US、Central US、または East US
*   **East US のみ**
*   West US のみ

#### **解答例**
*   **East US のみ**

#### **解説**
App Service plan には、**同一リージョン内で異なる OS のプランを混在させることができない**という制約があります。具体的には、Windows ベースの App Service plan が存在するリージョンに、新たに Linux ベースの App Service plan を作成することはできません。

現在の構成を確認すると、West US と Central US にはすでに Windows OS の App Service plan (ASP1 と ASP2) が存在します。そのため、これらのリージョンには新しい Linux OS のプランを作成できません。一方、**East US にはすでに Linux OS のプラン (ASP3) が存在するため、同じ Linux OS を使用する ASP4 を追加デプロイすることが可能**です。

この制約は、Azure の内部アーキテクチャに起因します。App Service は、OS ごとに異なるインフラストラクチャスタックを使用しており、同一リージョン内でこれらを分離して管理しています。したがって、リージョンごとに Windows または Linux のいずれか一方の OS タイプに統一する必要があります。

| リージョン | 既存 OS | 新規 Linux plan |
| :--- | :--- | :--- |
| West US | Windows | 不可 |
| Central US | Windows | 不可 |
| **East US** | **Linux** | **可能** |

#### **リファレンス**
*   [App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
*   [Azure App Service](https://learn.microsoft.com/ja-jp/azure/app-service/overview)

---

### **問題 201**
**Azure の仮想ネットワークに 4 つのサブネットがあり、各サブネットには 10 台の仮想マシンが含まれています。各サブネットの 2 台の仮想マシンに対して、TCP ポート 8080 経由のインバウンドトラフィックを許可するネットワークセキュリティグループ (NSG) を構成します。NSG は各サブネットに関連付けられます。最小限の NSG ルール数でインバウンドアクセスを構成するソリューションを推奨する必要があります。NSG の宛先として何を使用しますか。（一つ選択）**

*   **Application Security Group**
*   仮想マシンのプライベート IP アドレス
*   Service Tag
*   仮想マシンのサブネット

#### **解答例**
*   **Application Security Group**

#### **解説**
この問題の最重要ポイントは、複数のサブネットにまたがる特定の仮想マシンに対して、**最小限の NSG ルールで効率的にアクセス制御を実現する**方法を理解することです。

**Application Security Group (ASG)** は、仮想マシンを論理的にグループ化し、ネットワークセキュリティポリシーを適用するための Azure の機能です。ASG を使用すると、IP アドレスではなくアプリケーションの構造に基づいてセキュリティを定義できます。

本シナリオでは、4 つのサブネットにまたがる合計 8 台の仮想マシン（各サブネット 2 台ずつ）に対して TCP ポート 8080 のインバウンドアクセスを許可する必要があります。ASG を使用すれば、対象となる 8 台の仮想マシンを 1 つの ASG に追加し、NSG ルールを 1 つ作成するだけで済みます。このルールを ASG を宛先として設定することで、すべてのサブネットの NSG で同じルールを援用できます。

仮想マシンのプライベート IP アドレスを使用する場合、8 台の仮想マシンそれぞれに対して個別のルールが必要となり、合計 8 つのルールが必要です。Service Tag は、Azure サービスのパブリック IP アドレス範囲を表すもので、特定の仮想マシンを指定する用途には適していません。サブネットを宛先にすると、各サブネットの 10 台すべて（合計 40 台）の仮想マシンにアクセスが許可されてしまい、要件を満たしません。

| 方法 | 必要なルール数 | 特徴 |
| :--- | :--- | :--- |
| **ASG** | **1** | **論理グループ化、最小限のルール** |
| IP アドレス | 8 | 個別指定、管理が煩雑 |
| サブネット | 4 | 範囲が広すぎる |

ASG を使用することで、ネットワークセキュリティの管理が簡素化され、仮想マシンの追加や削除時にもルールの変更が不要になります。また、IP アドレスの変更にも影響を受けないため、運用の柔軟性が向上します。

#### **リファレンス**
*   [Application Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/application-security-groups)
*   [Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)

---

### **問題 202**
**複数のリソースグループと Azure App Service Web アプリを含む Azure サブスクリプションがあります。RG1 という名前のリソースグループには appservice1 という名前の Web アプリがホストされています。この App Service は無料の App Service Managed SSL 証明書を使用しています。RG2 という名前のリソースグループを作成しました。RG1 内のすべてのリソースを RG2 に移動する予定です。実行する必要があるアクションはどれですか。（二つ選択）**

*   RG1 から SSL 証明書を削除し、RG2 にアップロードする
*   **RG2 に新しい App Service plan を作成する**
*   **すべてのリソースを RG1 から RG2 に移動する**
*   RG2 に新しい Web アプリを作成する

#### **解答例**
*   **RG2 に新しい App Service plan を作成する**
*   **すべてのリソースを RG1 から RG2 に移動する**

#### **解説**
App Service Managed SSL 証明書を使用している Web アプリをリソースグループ間で移動する際の制約を理解することが重要です。**App Service Managed SSL 証明書は、Azure が自動的に管理する無料の SSL 証明書で、リソースグループ間の移動に対応していません**。

リソース移動を成功させるには、まず移動先の **RG2 に新しい App Service plan を作成する**必要があります。App Service plan は Web アプリの実行環境を定義するコンテナであり、移動先に事前に準備しておく必要があります。次に、RG1 から RG2 へリソースを移動します。この際、**App Service Managed SSL 証明書は自動的に削除され、移動後に再作成されます**。

SSL 証明書を手動で削除してアップロードする操作は不要です。App Service Managed SSL 証明書は Azure が管理するため、ユーザーがエクスポートや手動アップロードを行うことはできません。また、新しい Web アプリを作成する必要もありません。既存の Web アプリをそのまま移動できます。

| 操作 | 必要性 | 理由 |
| :--- | :--- | :--- |
| **App Service plan 作成** | **必要** | 移動先の実行環境として必須 |
| **リソース移動実行** | **必要** | 実際の移動操作 |
| SSL 証明書の手動操作 | 不要 | Azure が自動管理 |

#### **リファレンス**
*   [App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)

---

### **問題 203**
**Azure AD テナント adatum.com があり、以下のグループとユーザーが含まれています。Group1 と User4 に Azure AD Premium P2 ライセンスを割り当てました。この場合、Azure AD Premium P2 ライセンスが割り当てられるユーザーはどれですか。（一つ選択）**

**グループ情報：**
| グループ名 | メンバーシップの種類 | メンバー |
| :--- | :--- | :--- |
| Group1 | 割り当て済み | User1, User2 |
| Group2 | 動的ユーザー | User3 |

**ユーザー情報：**
| ユーザー名 | 所属グループ |
| :--- | :--- |
| User1 | Group1 |
| User2 | Group1 |
| User3 | Group2 |
| User4 | なし |

*   User1, User2, User3, User4 のすべて
*   User4 のみ
*   **User1, User2, User4 のみ**
*   User1, User4 のみ

#### **解答例**
*   **User1, User2, User4 のみ**

#### **解説**
Azure AD のグループベースライセンスでは、**グループに割り当てられたライセンスは、そのグループのすべてのメンバーに自動的に継承されます**。本問では Group1 と User4 に Azure AD Premium P2 ライセンスを割り当てているため、Group1 のメンバーである User1 と User2、および直接割り当てられた User4 がライセンスを取得します。

Group2 は動的ユーザーグループですが、このグループにはライセンスが割り当てられていないため、User3 はライセンスを取得しません。動的グループであってもライセンスの割り当て対象として機能しますが、グループ自体にライセンスが付与されていない場合、メンバーはライセンスを継承できません。

ライセンス割り当ての重要なポイントは以下の通りです。グループベースライセンスは管理を簡素化し、ユーザーの追加や削除に応じて自動的にライセンスが付与または削除されます。直接割り当てとグループベース割り当ては併用可能で、ユーザーは両方からライセンスを取得できます。

ライセンス割り当て方法の比較：
| 割り当て方法 | 対象 | 自動更新 |
| :--- | :--- | :--- |
| **グループベース** | **グループメンバー全員** | **あり** |
| 直接割り当て | 個別ユーザー | なし |
| 継承なし | ライセンス未割り当てグループのメンバー | 該当なし |

したがって、**User1 (Group1 経由)、User2 (Group1 経由)、User4 (直接割り当て) の 3 名が Azure AD Premium P2 ライセンスを取得します**。

#### **リファレンス**
*   [Azure AD グループベースライセンス](https://learn.microsoft.com/ja-jp/entra/identity/users/licensing-groups-assign)
*   [Azure AD Premium P2](https://www.microsoft.com/ja-jp/security/business/identity-access-management/azure-ad-pricing)
*   [Dynamic Group](https://learn.microsoft.com/ja-jp/entra/identity/users/groups-create-rule)

---

### **問題 204**
**Azure サブスクリプションに、hogehoge.com という名前の Microsoft Entra ID テナントと、AKS1 という名前の Azure Kubernetes Service (AKS) クラスターが含まれています。管理者から、hogehoge.com のユーザーに AKS1 へのアクセス権を付与できないという報告がありました。hogehoge.com のユーザーに AKS1 へのアクセス権を付与できるようにします。最初に実行する操作を選択してください。（一つ選択）**

*   **AKS1 で RBAC を有効化する**
*   hogehoge.com でマネージド ID を作成する
*   AKS1 でネームスペースを作成する
*   hogehoge.com で条件付きアクセスポリシーを構成する

#### **解答例**
*   **AKS1 で RBAC を有効化する**

#### **解説**
AKS クラスターで Microsoft Entra ID ユーザーに対してアクセス制御を行うには、**AKS 統合 RBAC (Role-Based Access Control) を有効化する必要があります**。AKS クラスター作成時に Microsoft Entra ID 統合が有効化されていない場合、ユーザーやグループに対する認証と認可が機能しません。

**AKS 統合 RBAC を有効化することで、Microsoft Entra ID の認証情報を使用して Kubernetes リソースへのアクセスを制御できるようになります**。これにより、Azure RBAC ロール（Azure Kubernetes Service Cluster User Role など）や Kubernetes RBAC ロール（ClusterRole、Role など）を組み合わせた詳細なアクセス制御が可能になります。

マネージド ID は、AKS クラスター自体が Azure リソースにアクセスする際に使用される認証方式であり、ユーザーアクセス制御とは直接関係ありません。ネームスペースの作成は論理的なリソース分離には有効ですが、Microsoft Entra ID ユーザーの認証課題は解決しません。条件付きアクセスポリシーは、アクセス時の追加条件を設定するものであり、基本的な RBAC 統合が前提となります。

| 項目 | 説明 | 用途 |
| :--- | :--- | :--- |
| **AKS 統合 RBAC** | **Microsoft Entra ID と AKS の統合認証** | **ユーザー・グループのアクセス制御** |
| マネージド ID | AKS クラスターの Azure リソースアクセス | クラスター自体の認証 |
| ネームスペース | Kubernetes リソースの論理分離 | リソース管理と分離 |

#### **リファレンス**
*   [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/ja-jp/azure/aks/manage-azure-rbac)
*   [Microsoft Entra ID](https://learn.microsoft.com/ja-jp/entra/fundamentals/whatis)

---

### **問題 205**
**あなたの組織では、P2v2 価格レベルを使用する App Service プラン「PlanA」があり、このプラン上で Web アプリ「WebApp1」を運用しています。開発チーム「DevTeam」に WebApp1 の管理を委任する必要があります。DevTeam には以下のタスクを実行する権限が必要です：デプロイスロットの追加、PlanA の構成の閲覧、WebApp1 のロール割り当ての変更。DevTeam に割り当てるべきロールはどれですか。（一つ選択）**

*   Website Contributor
*   Contributor
*   Web Plan Contributor
*   **Owner**

#### **解答例**
*   **Owner**

#### **解説**
この問題では、Azure App Service の管理権限と Azure RBAC ロールの理解が求められます。要件として「**ロール割り当ての変更**」が含まれている点が重要です。

Azure RBAC において、ロール割り当ての変更（IAM 操作）を実行できるのは、**User Access Administrator (ユーザーアクセス管理者) または Owner (所有者) ロールのみです**。Contributor ロールや Website Contributor ロールでは、リソースの作成・管理は可能ですが、アクセス権限の管理はできません。

要件を分析すると、デプロイスロットの追加と App Service プランの構成閲覧は Contributor レベルの権限で実行可能ですが、ロール割り当ての変更には Owner ロールが必須となります。したがって、すべての要件を満たすには **Owner ロールの割り当てが必要**です。

各ロールの権限比較を以下に示します。

| ロール | デプロイスロット追加 | プラン構成閲覧 | **ロール割り当て変更** |
| :--- | :--- | :--- | :--- |
| **Owner** | **可能** | **可能** | **可能** |
| Contributor | 可能 | 可能 | 不可 |
| Website Contributor | 可能 | 可能 | 不可 |
| Web Plan Contributor | 可能 | 可能 | 不可 |

Website Contributor は Web アプリの管理に特化したロールで、デプロイスロットの管理は可能ですが、IAM 操作はできません。Web Plan Contributor は App Service プランの管理に特化していますが、同様に IAM 操作の権限はありません。Contributor は広範なリソース管理権限を持ちますが、アクセス制御の変更権限は含まれていません。

セキュリティのベストプラクティスとしては、必要最小限の権限を付与する原則がありますが、本シナリオではロール割り当て変更が明示的な要件として含まれているため、Owner ロールの割り当てが適切な選択となります。

#### **リファレンス**
*   [Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/built-in-roles)
*   [Azure App Service](https://learn.microsoft.com/ja-jp/azure/app-service/overview)
*   [Deployment Slot](https://learn.microsoft.com/ja-jp/azure/app-service/deploy-staging-slots)

---

### **問題 206**
**5 台の Windows Server 2016 を実行する Azure 仮想マシンがあり、Web サーバーとして構成されています。LB1 という名前の Azure Load Balancer がこれらの仮想マシンに負荷分散サービスを提供しています。訪問者が各リクエストで同じ Web サーバーによってサービスを受けられるようにする必要があります。何を構成しますか。（一つ選択）**

*   **セッション永続化を Client IP に設定する**
*   アイドルタイムアウト（分）を 20 に設定する
*   プロトコルを UDP に設定する
*   Floating IP（ダイレクトサーバーリターン）を有効化に設定する

#### **解答例**
*   **セッション永続化を Client IP に設定する**

#### **解説**
Azure Load Balancer でクライアントが同じバックエンドサーバーに接続し続けるようにするには、**セッション永続化 (Session Persistence)** の設定が必要です。この機能は配分モードとも呼ばれ、トラフィックがバックエンドプールのサーバーにどのように分散されるかを制御します。

セッション永続化には 3 つのモードがあります。デフォルトは 5 タプル（送信元 IP、送信元ポート、宛先 IP、宛先ポート、プロトコル）を使用したハッシュベースの分散ですが、これでは同じクライアントからの新しい接続が異なるサーバーに振り分けられる可能性があります。**Client IP モードでは送信元 IP アドレスのみを使用した 2 タプルハッシュ、Client IP and Protocol モードでは送信元 IP とプロトコルを使用した 3 タプルハッシュにより、同じクライアントからのリクエストを常に同じバックエンドサーバーに転送します**。

他の選択肢について、Floating IP は Direct Server Return (DSR) を実現する機能でロードバランサーを経由せず直接クライアントに応答を返す構成に使用されますが、セッション維持とは無関係です。アイドルタイムアウトは接続が維持される時間を制御しますが、新しいリクエストの振り分け先には影響しません。プロトコルを UDP に変更することは要件と関係なく、通常の HTTP/HTTPS 通信では TCP を使用します。

| 配分モード | ハッシュ要素 | 用途 |
| :--- | :--- | :--- |
| 5 タプル（既定） | 送信元 IP、送信元ポート、宛先 IP、宛先ポート、プロトコル | 標準的な負荷分散 |
| **Client IP** | **送信元 IP、宛先 IP** | **セッション維持が必要な場合** |
| Client IP and Protocol | 送信元 IP、宛先 IP、プロトコル | プロトコル別のセッション維持 |

#### **リファレンス**
*   [セッション永続化](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-custom-probe-overview#session-persistence)
*   [Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
*   [Direct Server Return (DSR)](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-multivip-overview#direct-server-return)
*   [Floating IP](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-floating-ip)

---

### **問題 207**
**あなたの会社の Azure サブスクリプションに Ubuntu Server 仮想マシンをデプロイする計画を立てています。特定の信頼されたルート証明機関 (CA) を追加するカスタムデプロイを実装します。仮想マシンを作成するために使用すべきものはどれですか。（一つ選択）**

*   **az vm create コマンド**
*   New-AzVM コマンドレット
*   Azure portal のカスタムデータフィールド
*   New-AzureRmVm コマンドレット

#### **解答例**
*   **az vm create コマンド**

#### **解説**
この問題の最重要ポイントは、Ubuntu Server 仮想マシンのデプロイ時にカスタム証明書を追加する要件に対して、**cloud-init スクリプトやカスタムデータを柔軟に指定できるツールを選択すること**です。

**az vm create コマンド**は、Azure CLI の仮想マシン作成コマンドで、`--custom-data` パラメータを使用して **cloud-init スクリプトやカスタム構成を渡すことができます**。Ubuntu Server などの Linux 仮想マシンでは、cloud-init を通じて初回起動時に証明書のインストールやシステム構成を自動化できます。このため、信頼されたルート証明機関の追加といったカスタムデプロイ要件に最適です。

New-AzVM コマンドレットは Azure PowerShell の仮想マシン作成コマンドレットですが、カスタムデータの指定には追加の構成オブジェクトが必要で、Azure CLI と比較して記述が複雑になります。New-AzureRmVm コマンドレットは旧バージョンの Azure PowerShell モジュール (AzureRM) のコマンドレットであり、現在は非推奨となっています。Az モジュールへの移行が推奨されています。Azure portal のカスタムデータフィールドも利用可能ですが、問題文は「使用すべきもの」を問うており、自動化とスクリプト実行の観点からコマンドラインツールが適切です。

| ツール | カスタムデータ対応 | 推奨状況 |
| :--- | :--- | :--- |
| **az vm create** | **対応 (--custom-data)** | **推奨** |
| New-AzVM | 対応（構成要） | 推奨 |
| New-AzureRmVm | 対応 | 非推奨（旧版） |

#### **リファレンス**
*   [Azure CLI](https://learn.microsoft.com/ja-jp/cli/azure/vm)
*   [cloud-init](https://learn.microsoft.com/ja-jp/azure/virtual-machines/linux/using-cloud-init)
*   [Azure PowerShell](https://learn.microsoft.com/ja-jp/powershell/azure/overview)

---

### **問題 208**
**あなたの組織では、Subscription-A と Subscription-B という 2 つの Azure サブスクリプションを管理しています。Subscription-A には表 1 の仮想ネットワークがあり、表 2 のサブネットが含まれています。Subscription-B には表 3 に示す仮想ネットワーク VNet-Z が含まれており、表 4 のサブネットが含まれています。次の記述について、正しい場合は「はい」を選択し、正しくない場合は「いいえ」を選択します。「VNet-A と VNet-B の間で VNet Peering を確立できる。」（一つ選択）**

**表 1: Subscription-A の仮想ネットワーク**
| 名前 | アドレス空間 | リージョン |
| :--- | :--- | :--- |
| VNet-A | 10.10.10.0/24 | 西ヨーロッパ |
| VNet-B | 172.16.0.0/16 | 米国西部 |

**表 2: Subscription-A のサブネット**
| 名前 | アドレス空間 | 仮想ネットワーク |
| :--- | :--- | :--- |
| SubnetA-A | 10.10.10.0/24 | VNet-A |
| SubnetB-A | 172.16.10.0/18 | VNet-B |
| SubnetB-B | 172.16.128.0/18 | VNet-B |

**表 3: Subscription-B の仮想ネットワーク**
| 名前 | アドレス空間 | リージョン |
| :--- | :--- | :--- |
| VNet-Z | 10.10.128.0/17 | カナダ中部 |

**表 4: VNet-Z のサブネット**
| 名前 | アドレス空間 |
| :--- | :--- |
| Subnet-Z1 | 10.10.130.0/24 |
| Subnet-Z2 | 10.10.131.0/24 |

*   いいえ
*   **はい**

#### **解答例**
*   **はい**

#### **解説**
**VNet-A と VNet-B の間で VNet Peering を確立することは可能です**。VNet Peering は、異なる Azure サブスクリプション、異なるリージョン、異なる Azure Active Directory テナント間でも構成できます。

VNet Peering を確立するための主な要件は、**ピアリングする仮想ネットワークのアドレス空間が重複していないこと**です。表 1 を確認すると、VNet-A のアドレス空間は 10.10.10.0/24、VNet-B のアドレス空間は 172.16.0.0/16 であり、これらは重複していません。

また、VNet-A は西ヨーロッパリージョン、VNet-B は米国西部リージョンに配置されていますが、**グローバル VNet Peering** を採用することで異なるリージョン間でもピアリングを確立できます。さらに、両方の仮想ネットワークが同じ Subscription-A に属しているため、適切な RBAC アクセス許可があれば設定は容易です。

VNet Peering の確立後、VNet-A と VNet-B 間でプライベート IP アドレスを使用した直接通信が可能になり、トラフィックは Microsoft バックボーンネットワークを経由するため、低遅延で高帯域幅の接続が実現されます。

VNet Peering の主な特徴：
| 項目 | 内容 |
| :--- | :--- |
| **対応範囲** | **同一リージョン、異なるリージョン、異なるサブスクリプション** |
| **要件** | **アドレス空間の重複がないこと** |
| **通信経路** | **Microsoft バックボーンネットワーク** |

#### **リファレンス**
*   [Virtual Network Peering](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-peering-overview)
*   [Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

---

### **問題 209**
**あなたの会社では、Azure サブスクリプションの管理者として Admin1 というユーザーアカウントが存在します。Admin1 に対して、特定のサブスクリプション内のすべてのリソースを管理する権限を付与する必要がありますが、サブスクリプション自体の設定変更や他のユーザーへの権限付与は許可しません。この要件を満たすために実行すべき操作を選択してください。（一つ選択）**

*   **サブスクリプションブレードでサブスクリプションを選択し、アクセス制御 (IAM) の設定を変更する**
*   Microsoft Entra ID ブレードでプロパティを変更する
*   サブスクリプションブレードでサブスクリプションを選択し、プロパティを変更する
*   Microsoft Entra ID ブレードでグループを変更する

#### **解答例**
*   **サブスクリプションブレードでサブスクリプションを選択し、アクセス制御 (IAM) の設定を変更する**

#### **解説**
Azure におけるアクセス権限の管理は、**Azure RBAC (Role-Based Access Control) を使用して実現**します。特定のスコープ（サブスクリプション、リソースグループ、個別リソース）に対してユーザーやグループに適切なロールを割り当てることで、きめ細かなアクセス制御が可能になります。

本問では Admin1 に対してサブスクリプション内のリソース管理権限を付与しつつ、サブスクリプション設定の変更や他ユーザーへの権限付与は制限する必要があります。この要件を満たすには、サブスクリプションのアクセス制御 (IAM) 設定で「**共同作成者 (Contributor)**」ロールを割り当てます。共同作成者ロールは、リソースの作成、変更、削除が可能ですが、**他のユーザーへのアクセス権限の付与はできません**。

サブスクリプションのプロパティ変更では、サブスクリプション名やディレクトリの変更などの基本設定のみが対象となり、アクセス権限の管理はできません。Microsoft Entra ID (旧 Azure Active Directory) のプロパティやグループの変更は、テナント全体の設定やユーザー管理に関わる操作であり、特定サブスクリプションへのアクセス制御とは直接関係しません。

Azure RBAC の主要な組み込みロールとその権限範囲を以下に示します。

| ロール名 | リソース管理 | アクセス権限の付与 |
| :--- | :--- | :--- |
| 所有者 (Owner) | 可能 | 可能 |
| **共同作成者 (Contributor)** | **可能** | **不可** |
| 閲覧者 (Reader) | 読み取りのみ | 不可 |

アクセス制御の設定は、Azure Portal のサブスクリプションブレードから対象サブスクリプションを選択し、「アクセス制御 (IAM)」メニューから「ロールの割り当ての追加」を実行します。ここで Admin1 ユーザーを選択し、適切なロール（この場合は共同作成者）を割り当てることで要件を満たすことができます。

#### **リファレンス**
*   [Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/overview)
*   [共同作成者ロール](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/built-in-roles#contributor)

---

### **問題 210**
**あなたの組織は Azure サブスクリプション「Subscription-A」を所有しています。App-A という名前のアプリケーションをサポートするために、Azure Kubernetes Service (AKS) クラスターをデプロイします。オンプレミスのクライアントは、Pod の IP アドレスを使用して App-A に接続する必要があります。AKS クラスターに適切なネットワークプラグインを選択します。（一つ選択）**

*   kubenet
*   Azure Private Link
*   **Azure Container Networking Interface (CNI)**
*   VNet 統合

#### **解答例**
*   **Azure Container Networking Interface (CNI)**

#### **解説**
オンプレミスのクライアントが **Pod の IP アドレスを使用して直接接続する**要件を満たすには、**Azure CNI を選択する必要があります**。

**Azure CNI** は、AKS クラスター内の各 Pod に VNet 内の IP アドレスを直接割り当てるネットワークプラグインです。これにより、Pod は VNet の一部として扱われ、**オンプレミスネットワークから VPN 接続や ExpressRoute 経由で直接アクセス可能になります**。

一方、kubenet は Pod に対してクラスター内部のプライベート IP アドレスを割り当て、NAT を使用して外部通信を行います。このため、オンプレミスから Pod の IP アドレスへの直接接続はできません。

Azure Private Link は Azure サービスへのプライベート接続を提供するサービスですが、AKS のネットワークプラグインではありません。VNet 統合は App Service などの PaaS サービスで使用される機能であり、AKS のネットワーク構成には該当しません。

| ネットワークプラグイン | Pod IP アドレス | **オンプレミスからの直接接続** |
| :--- | :--- | :--- |
| **Azure CNI** | **VNet の IP アドレス空間から割り当て** | **可能** |
| kubenet | クラスター内部のプライベート IP | 不可（NAT が必要） |

Azure CNI を使用する場合、VNet の IP アドレス空間を十分に確保する必要があります。各 Pod が個別の IP アドレスを消費するため、大規模なクラスターでは適切なアドレス計画が重要です。

#### **リファレンス**
*   [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/ja-jp/azure/aks/concepts-network)
*   [kubenet](https://learn.microsoft.com/ja-jp/azure/aks/configure-kubenet)





  ご指定いただいたソース（「AZ-104試験問題500_part1_part9.pdf」の抜粋）に基づき、含まれている文章を省略することなく全文出力いたします。

---

**問題 211. あなたは hogehoge.com という名前の Microsoft Entra テナントを管理しています。500 人の外部ユーザーの名前とメールアドレスを含む CSV ファイルがあります。hogehoge.com テナント内に 500 人の外部ユーザーそれぞれに対してゲストユーザーアカウントを作成します。解決策：Azure portal の Microsoft Entra ID から「ユーザーの一括招待」操作を使用します。この解決策は要件を満たしていますか？（一つ選択）**
* **いいえ、要件を満たしていません**
* **はい、要件を満たしています**

**解答例**
* **はい、要件を満たしています**

**解説**
**Microsoft Entra ID の「ユーザーの一括招待」機能を使用することで、CSV ファイルから複数の外部ユーザーを一度にゲストユーザーとして招待できます。** この機能は大量のゲストユーザーを効率的に追加する標準的な方法です。
CSV ファイルには招待するユーザーのメールアドレスや表示名などの情報を含めることができ、Azure portal から一括操作として実行可能です。招待されたユーザーには招待メールが送信され、受諾後にテナントのゲストユーザーとしてアクセスできるようになります。
この方法は 500 人という大量のユーザーを個別に招待する手間を省き、管理者の作業負荷を大幅に軽減します。PowerShell や Microsoft Graph API を使用する方法もありますが、Azure portal の一括招待機能は最も簡単で直感的な解決策です。

| 方法 | 特徴 | 適用シーン |
| :--- | :--- | :--- |
| ユーザーの一括招待 | CSV ファイルから一括処理 | 大量ゲストユーザー追加 |
| 個別招待 | Azure portal から 1 件ずつ | 少数ユーザー追加 |
| PowerShell/Graph API | スクリプトによる自動化 | 定期的な招待処理 |

**リファレンス**
* Microsoft Entra ID

---

**問題 212. あなたは 10 個の Azure Web Apps をデプロイするためのテンプレートを管理しています。デプロイメントテンプレートを実行する前に、必要なリソースを事前にプロビジョニングする必要があります。Azure のコストを最小限に抑えるソリューションを選択してください。（一つ選択）**
* 5 個の App Service plan
* **1 個の App Service plan**
* 10 個の App Service plan
* 1 個の Azure Traffic Manager

**解答例**
* **1 個の App Service plan**

**解説**
Azure Web Apps をデプロイする際、**App Service plan は必須の前置リソースです。** App Service plan は Web Apps の実行環境を提供し、コンピューティングリソース（CPU、メモリ、ストレージ）を定義します。
**コスト最適化の観点では、1 個の App Service plan で複数の Web Apps をホストすることが可能です。** 同一の App Service plan 内で最大 100 個までの Web Apps を実行でき、リソースを共有することでコストを大幅に削減できます。10 個の Web Apps に対して 10 個の App Service plan を作成すると、各 plan ごとに課金が発生し、コストが 10 倍になります。
Azure Traffic Manager は DNS ベースのトラフィック負荷分散サービスですが、Web Apps の実行に必須ではなく、複数リージョンへのトラフィック分散が必要な場合にのみ使用します。本問では事前プロビジョニングが必要な必須リソースを問われているため、正解は 1 個の App Service plan となります。

| リソース | 必要性 | コスト影響 |
| :--- | :--- | :--- |
| App Service plan（1 個） | 必須 | 最小 |
| App Service plan（10 個） | 不要 | 10 倍 |
| Traffic Manager | オプション | 追加コスト |

App Service plan の価格レベル（Free, Shared, Basic, Standard, Premium）によって、ホスト可能なアプリ数やスケーリング機能が異なります。本番環境では通常 Standard または Premium レベルを選択し、自動スケーリングやデプロイスロットなどの機能を活用します。

**リファレンス**
* App Service Plan
* Azure Web Apps
* Azure Traffic Manager

---

**問題 213. App Service plan として plan1 を作成し、Azure web app として webapp1 を作成しました。ステージングスロットを作成するオプションが利用できないことがわかりました。plan1 のステージングスロットを作成します。最初に実行する操作を選択してください。（一つ選択）**
* **plan1 の App Service plan をスケールアップする**
* webapp1 のカスタムドメインを追加する
* webapp1 の Application settings を変更する
* webapp1 のデプロイメントセンターを構成する

**解答例**
* **plan1 の App Service plan をスケールアップする**

**解説**
**App Service のデプロイスロット機能は、Standard、Premium、Isolated の各価格レベルでのみ利用可能です。** Free、Shared、Basic 価格レベルではデプロイスロットを作成できません。
ステージングスロットを作成するには、**まず App Service plan の価格レベルを Standard 以上にスケールアップする必要があります。** スケールアップとは、より高い価格レベルに移行することで、より多くの CPU、メモリ、機能を利用できるようになります。
Application settings の変更やカスタムドメインの追加は、デプロイスロット機能の利用可否には影響しません。デプロイメントセンターの構成も、スロット作成の前提条件ではありません。

| 価格レベル | デプロイスロット | 最大スロット数 |
| :--- | :--- | :--- |
| Free/Shared | 利用不可 | 0 |
| Basic | 利用不可 | 0 |
| Standard | 利用可能 | 5 |
| Premium | 利用可能 | 20 |
| Isolated | 利用可能 | 20 |

スケールアップ操作は、Azure portal の App Service plan の設定画面から実行できます。価格レベルを変更すると、即座に新しい機能が利用可能になります。

**リファレンス**
* App Service Plan
* Deployment Slot
* Scale Up and Scale Out

---

**問題 214. Azure 仮想マシン上で Microsoft SQL Server Always On 可用性グループを運用しています。可用性グループのリスナーとして Azure 内部ロードバランサーを構成します。どの設定を行いますか。（一つ選択）**
* セッション永続性をクライアント IP に設定する
* **Floating IP を有効化する**
* ポート 1433 で HTTP ヘルスプローブを作成する
* セッション永続性をクライアント IP とプロトコルに設定する

**解答例**
* **Floating IP を有効化する**

**解説**
SQL Server Always On 可用性グループのリスナーを Azure 内部ロードバランサーで構成する場合、**Floating IP（Direct Server Return）の有効化が必須です。** この設定により、SQL Server が複数の IP アドレスで同じポートをリッスンできるようになり、可用性グループリスナーが正常に機能します。
Floating IP を有効にすると、ロードバランサーは受信パケットの宛先 IP アドレスを変更せずにバックエンド VM に転送します。これにより SQL Server インスタンスは、リスナーの IP アドレスで直接トラフィックを受信できます。Always On 可用性グループでは、プライマリレプリカとセカンダリレプリカが同じポート番号を使用するため、この機能が不可欠です。
セッション永続性の設定は接続の分散方法を制御しますが、Always On 可用性グループの動作には直接影響しません。HTTP ヘルスプローブは SQL Server の正常性確認には適さず、TCP プローブを使用する必要があります。

| 設定項目 | 必要性 | 理由 |
| :--- | :--- | :--- |
| Floating IP | 必須 | リスナー IP での直接受信を実現 |
| TCP ヘルスプローブ | 必須 | SQL Server の正常性監視 |
| セッション永続性 | 任意 | 接続分散の制御のみ |

**リファレンス**
* Azure Load Balancer
* Floating IP

---

**問題 215. Azure サブスクリプションに以下のリソースが存在します。Subnet-A は VNet-A に関連付けられており、NIC-A によって VM-A が Subnet-A に接続されています。この環境において、ASG-A を VM-A に適用する必要があります。この要件を満たすために実行すべき操作を選択してください。（一つ選択）**

| 名前 | タイプ |
| :--- | :--- |
| ASG-A | Application Security Group |
| NSG-A | Network Security Group |
| Subnet-A | サブネット |
| VNet-A | 仮想ネットワーク |
| NIC-A | ネットワークインターフェイス |
| VM-A | 仮想マシン |

* ASG-A のプロパティから VM-A を指定する
* **NIC-A を ASG-A に関連付ける**
* NSG-A のセキュリティルールで ASG-A を送信元または送信先として指定する
* Subnet-A に ASG-A を関連付ける

**解答例**
* **NIC-A を ASG-A に関連付ける**

**解説**
**Application Security Group (ASG) を仮想マシンに適用するには、その仮想マシンのネットワークインターフェイス (NIC) を ASG に関連付ける必要があります。** ASG は仮想マシンを論理的にグループ化し、Network Security Group (NSG) のセキュリティルール内で送信元や送信先として利用できる機能です。
ASG の関連付けは、NIC のプロパティから実行します。Azure Portal では、NIC の設定画面から Application Security Groups セクションを選択し、対象の ASG を追加することで関連付けが完了します。この操作により、VM-A は ASG-A のメンバーとなり、NSG ルール内で ASG-A を参照する際に VM-A が対象に含まれるようになります。
ASG 自体のプロパティを変更しても VM との関連付けは行えません。ASG は単なるグループ定義であり、実際の関連付けは NIC 側で設定します。またサブネットに ASG を直接関連付けることはできません。サブネットに関連付けられるのは NSG です。NSG のセキュリティルールで ASG を指定することは可能ですが、それだけでは VM-A が ASG-A のメンバーになるわけではありません。

以下に ASG と NSG の関係を整理します。

| 項目 | 説明 |
| :--- | :--- |
| ASG の関連付け先 | ネットワークインターフェイス (NIC) |
| ASG の用途 | NSG ルール内で送信元・送信先として利用 |
| NSG の関連付け先 | サブネットまたは NIC |

ASG を活用することで、IP アドレスではなくアプリケーションの役割に基づいたセキュリティルールの管理が可能になり、仮想マシンの追加や削除時にもルールの変更が不要になるため、運用管理が簡素化されます。

**リファレンス**
* Application Security Group
* Network Security Group
* Network Interface

---

**問題 216. VNet-A という名前の仮想ネットワークを含む Azure サブスクリプションがあります。VNet-A は 10.0.0.0/16 の IP アドレス空間を使用し、次の表に示すサブネットと VPN Gateway が含まれています。Subnet-A には、ルーターとして動作する VM-A という名前の仮想アプライアンスが含まれています。RT-A という名前のルートテーブルを作成しました。すべての受信トラフィックを VPN Gateway から VM-A 経由で VNet-A にルーティングします。RT-A のルート設定で、アドレスプレフィックスに指定すべき値を選択してください。（一つ選択）**

| サブネット名 | IP アドレス範囲 |
| :--- | :--- |
| Subnet | 10.0.0.0/24 |
| Subnet-A | 10.0.1.0/24 |
| Subnet-B | 10.0.2.0/24 |
| GatewaySubnet | 10.0.254.0/24 |

* **10.0.0.0/16**
* 10.0.1.0/24
* 10.0.254.0/24
* 10.0.0.0/24

**解答例**
* **10.0.0.0/16**

**解説**
VPN Gateway から受信したトラフィックを VM-A 経由で VNet-A 全体にルーティングするには、**VNet-A 全体のアドレス空間を対象とするルート設定が必要です。** RT-A のアドレスプレフィックスには、VNet-A のアドレス空間全体である 10.0.0.0/16 を指定します。
ルートテーブルでは、アドレスプレフィックスで指定した宛先範囲のトラフィックを、指定したネクストホップ（この場合は VM-A）に転送します。VPN Gateway から入ってくるトラフィックの宛先は、VNet-A 内の任意のサブネット（Subnet、Subnet-A、Subnet-B）になる可能性があるため、これらすべてを包含する 10.0.0.0/16 を指定する必要があります。
10.0.0.0/24 や 10.0.1.0/24 などの個別サブネットを指定した場合、そのサブネット宛てのトラフィックのみが VM-A 経由でルーティングされ、他のサブネット宛てのトラフィックは対象外となります。10.0.254.0/24 は GatewaySubnet のアドレス範囲であり、ゲートウェイ自身のサブネットを宛先とする設定は不適切です。
ルートテーブルを GatewaySubnet に関連付けることで、VPN Gateway から入ってくるすべてのトラフィックが VM-A を経由して VNet-A 内の各サブネットに転送されます。

| 項目 | 設定値 |
| :--- | :--- |
| アドレスプレフィックス | 10.0.0.0/16 |
| ネクストホップの種類 | 仮想アプライアンス |
| ネクストホップアドレス | VM-A の IP アドレス |

| アドレス範囲 | 対象範囲 |
| :--- | :--- |
| 10.0.0.0/16 | VNet-A 全体 |
| 10.0.0.0/24 | Subnet のみ |
| 10.0.1.0/24 | Subnet-A のみ |

**リファレンス**
* ルートテーブル
* ユーザー定義ルート

---

**問題 217. Azure サブスクリプションに仮想マシン VM-A と、Azure Key Vault「KV-A」が存在します。VM-A に対して次の要件を満たす暗号化を実装します。暗号化キーは KV-A に格納して使用すること、VM がエクスポートされた場合も暗号化を維持すること、OS ディスクとデータディスクの両方を暗号化すること。これらの要件を満たす暗号化方式を選択してください。（一つ選択）**
* **Azure Disk Encryption**
* プラットフォーム管理キーによるサーバー側暗号化
* ホストでの暗号化
* 顧客管理キーを使用したサーバー側暗号化

**解答例**
* **Azure Disk Encryption**

**解説**
この問題では、Key Vault に格納されたキーを使用し、VM エクスポート後も暗号化を維持し、OS ディスクとデータディスクの両方を暗号化する方式を選択する必要があります。
**Azure Disk Encryption は、Windows 仮想マシンでは BitLocker、Linux 仮想マシンでは DM-Crypt を利用してゲスト OS 内でディスク暗号化を実行します。** 暗号化キーは Azure Key Vault に保存され、OS ディスクとデータディスクの両方を暗号化できます。この方式では暗号化がゲスト OS 層で実行されるため、VM イメージをエクスポートしても暗号化状態が維持されます。
プラットフォーム管理キーによるサーバー側暗号化は、Azure プラットフォーム側で管理されるキーを使用するため、Key Vault へのキー格納という要件を満たしません。
ホストでの暗号化は、VM ホストレベルで暗号化を実行しますが、VM をエクスポートした場合に暗号化が維持されないため要件を満たしません。
顧客管理キーを使用したサーバー側暗号化は、Key Vault のキーを使用できますが、ストレージサービス暗号化レベルで動作するため、VM エクスポート時に暗号化が維持されません。

| 暗号化方式 | Key Vault 使用 | エクスポート後の暗号化維持 |
| :--- | :--- | :--- |
| Azure Disk Encryption | 可能 | 維持される |
| サーバー側暗号化 | 可能 | 維持されない |
| ホストでの暗号化 | 不可 | 維持されない |

**リファレンス**
* Azure Disk Encryption
* Azure Key Vault
* BitLocker

---

**問題 218. Azure 環境でパブリック Standard Load Balancer を新規作成します。次の表に示すパブリック IP アドレスリソースが既に存在する場合、このロードバランサーに関連付け可能な IP アドレスはどれですか。（一つ選択）**

| 名前 | IP バージョン | SKU | 割り当て方法 | 可用性ゾーン |
| :--- | :--- | :--- | :--- | :--- |
| IP-A | IPv6 | Basic | 静的 | 適用不可 |
| IP-B | IPv4 | Basic | 動的 | 適用不可 |
| IP-C | IPv4 | Standard | 静的 | ゾーン冗長 |
| IP-D | IPv4 | Standard | 動적 | ゾーン冗長 |

* **IP-C または IP-D**
* IP-A または IP-C
* IP-B
* IP-A、IP-B、IP-C、IP-D

**解答例**
* **IP-C または IP-D**

**解説**
**Azure Load Balancer の SKU とパブリック IP アドレスの SKU は一致させる必要があります。** Standard Load Balancer を作成する場合、関連付けるパブリック IP アドレスも Standard SKU である必要があります。
表を確認すると、Standard SKU のパブリック IP アドレスは IP-C と IP-D の 2 つです。IP-C は静的割り当て、IP-D は動的割り当てですが、**どちらも Standard Load Balancer に関連付け可能です。** Standard SKU のパブリック IP アドレスは、静的・動的いずれの割り当て方法でもロードバランサーで使用できます。
一方、IP-A と IP-B は Basic SKU のため、Standard Load Balancer には使用できません。Basic SKU のリソースと Standard SKU のリソースは混在できないという制約があります。
また IP バージョンについて、IP-A は IPv6 ですが、現在の Azure Load Balancer ではフロントエンド構成として IPv4 が主に使用されます。IPv6 のサポートは限定的なシナリオでのみ利用可能です。

| 項目 | Basic SKU | Standard SKU |
| :--- | :--- | :--- |
| Load Balancer との互換性 | Basic Load Balancer | Standard Load Balancer |
| 可用性ゾーン | 非対応 | 対応 |
| SKU 間の混在 | 不可 | 不可 |

Standard Load Balancer を使用する場合は、パブリック IP アドレスも Standard SKU を選択し、可用性ゾーンや SLA などのエンタープライズ機能を活用できます。

**リファレンス**
* Azure Load Balancer
* Public IP Address
* Availability Zone

---

**問題 219. VM4 の技術要件を満たすために、診断ログデータを収集し、特定の条件に基づいて管理者に通知を送信する必要があります。この要件を実現するために作成および構成すべき Azure サービスはどれですか。（一つ選択）**
* Azure Monitor アクショングループ
* Azure Event Hub
* **Azure Logic App**
* Azure Service Bus

**解答例**
* **Azure Logic App**

**解説**
VM4 の診断ログデータを収集し、特定の条件に基づいて管理者に通知を送信するという要件を満たすには、**Azure Logic App が最適です。**
Azure Logic App は、ワークフローを自動化するためのクラウドサービスで、Azure Monitor からの診断ログデータをトリガーとして受け取り、条件分岐やデータ変換を行い、メール送信や Teams 通知などのアクションを実行できます。コードを記述することなく、ビジュアルデザイナーを使用してワークフローを構築できるため、管理者による迅速な実装が可能です。
Azure Event Hub と Azure Service Bus は、大量のイベントデータやメッセージを処理するためのメッセージングサービスですが、条件に基づいた通知機能を直接提供するものではありません。これらのサービスは、データの受信と配信に特化しており、通知ロジックを実装するには追加の開発が必要です。
Azure Monitor アクショングループは、アラートルールと組み合わせて通知を送信できますが、複雑な条件分岐やカスタムワークフローには対応していません。

各サービスの比較を以下に示します。

| サービス | 主な用途 | 通知機能 |
| :--- | :--- | :--- |
| Azure Logic App | ワークフロー自動化と統合 | 条件分岐付き通知が可能 |
| Azure Event Hub | 大量イベントデータの取り込み | 通知機能なし |
| Azure Service Bus | メッセージキューイング | 通知機能なし |

**リファレンス**
* Azure Monitor
* Azure Event Hub

---

**問題 220. あなたの組織では、異なるランタイムスタックを使用する 5 つの Azure Web Apps を作成します。WebApp-A は .NET Core 3.1 (LTS)、WebApp-B は ASP.NET v4.8、WebApp-C は PHP 7.3、WebApp-D は Ruby 2.6、WebApp-E は PHP 7.4 を使用します。これらの Web Apps をホストするために必要な Azure App Service プランの最小数はいくつですか。（一つ選択）**
* 1
* **2**
* 3
* 5

**解答例**
* **2**

**解説**
この問題の最重要ポイントは、**Azure App Service プランがサポートするランタイムスタックがオペレーティングシステム（Windows/Linux）によって異なることです。** 同一の App Service プラン内では、同じ OS を使用する Web Apps のみをホストできます。
Windows ベースの App Service プランでは、.NET、ASP.NET、Node.js、PHP などをサポートします。一方、Linux ベースの App Service プランでは、.NET Core、Node.js、PHP、Python、Ruby などをサポートします。重要な点として、ASP.NET v4.8 は Windows 専用のランタイムであり、Linux では実行できません。
本問では、WebApp-B (ASP.NET v4.8) は Windows 専用であるため、Windows ベースのプランが 1 つ必要です。残りの WebApp-A (.NET Core 3.1)、WebApp-C (PHP 7.3)、WebApp-D (Ruby 2.6)、WebApp-E (PHP 7.4) は、すべて Linux でサポートされるランタイムです。Linux ベースのプランでは、異なるバージョンの PHP や異なるランタイムスタックを同一プラン内で混在させることができます。したがって、これら 4 つの Web Apps は Linux ベースのプラン 1 つで対応可能です。
結果として、最小限必要な App Service プランの数は 2 つ（Windows 用 1 つ、Linux 用 1 つ）となります。

| OS | ホストする Web Apps | ランタイム |
| :--- | :--- | :--- |
| Windows | WebApp-B | ASP.NET v4.8 |
| Linux | WebApp-A, C, D, E | .NET Core 3.1, PHP 7.3, Ruby 2.6, PHP 7.4 |

**リファレンス**
* App Service Plan
* ランタイムスタック
* ASP.NET

---

**問題 221. Azure サブスクリプションに、VM1 と VM2 という 2 つの仮想マシンが含まれています。VM1 と VM2 は、同じバックアップポリシーを使用して Vault1 という Recovery Services コンテナーにバックアップされています。会社は追加の仮想マシンと Recovery Services コンテナーを作成する計画があり、このプロセス中に Vault1 は廃止されます。Vault1 を削除する必要があります。Vault1 を削除する前に実行する必要がある 3 つのアクションはどれですか。正解はそれぞれソリューションの一部を示しています。（該当するものをすべて選択）**
* **VM1 と VM2 のバックアップを停止し、バックアップデータを削除する**
* Vault1 に対して削除ロックを有効にする
* **論理的な削除機能を無効にし、すべてのバックアップデータを削除する**
* **論理的な削除状態にあるすべてのアイテムを完全に削除する**
* VM1 と VM2 を削除する

**解答例**
* **VM1 と VM2 のバックアップを停止し、バックアップデータを削除する**
* **論理的な削除機能を無効にし、すべてのバックアップデータを削除する**
* **論理的な削除状態にあるすべてのアイテムを完全に削除する**

**解説**
Recovery Services コンテナーを削除するには、**コンテナー内のすべての保護されたアイテムとバックアップデータを完全に削除する必要があります。** Azure Backup では、誤削除を防ぐために論理的な削除 (Soft Delete) 機能がデフォルトで有効になっており、削除されたバックアップデータは 14 日間保持されます。
まず、VM1 と VM2 のバックアップを停止し、バックアップデータを削除します。この操作により、バックアップアイテムは論理的な削除状態に移行します。次に、論理的な削除機能を無効にする必要があります。この機能が有効な状態では、削除されたデータが保持期間中は完全に削除されないため、コンテナーの削除ができません。最後に、論理的な削除状態にあるすべてのアイテムを完全に削除 (Undelete) します。これにより、コンテナー内のすべてのバックアップデータが完全に削除され、Vault1 を削除できる状態になります。
仮想マシン自体 (VM1 と VM2) を削除する必要はありません。Recovery Services コンテナーの削除は、バックアップデータの管理に関する操作であり、保護対象のリソース自体の削除とは独立しています。また、削除ロックはリソースの削除を防ぐ機能であり、コンテナーを削除する際には逆効果となります。

| 操作 | 目的 | 必須 |
| :--- | :--- | :--- |
| バックアップの停止とデータ削除 | 保護アイテムの削除 | 必須 |
| 論理的な削除機能の無効化 | 完全削除の許可 | 必須 |
| 論理的な削除状態のアイテム完全削除 | コンテナーの空化 | 必須 |

**リファレンス**
* Recovery Services Vault
* Azure Backup

---

**問題 222. Azure サブスクリプションに、storage1 という名前のストレージアカウントが含まれています。インターネットから storage1 へのアクセスを無効にします。storage1 で構成する必要があるのはどれですか。（一つ選択）**
* **Firewalls and virtual networks**
* Access keys
* Encryption
* Data protection

**解答例**
* **Firewalls and virtual networks**

**解説**
この問題は、Azure Storage Account へのネットワークアクセスを制御する方法を問う問題です。インターネットからのアクセスを無効にするには、**ネットワークレベルでのアクセス制御を構成する必要があります。**
Storage Account の「Firewalls and virtual networks」設定では、パブリックネットワークアクセスの制限が可能です。この設定で「Disabled」を選択することで、インターネットからの直接アクセスを完全にブロックできます。また、特定の仮想ネットワークや IP アドレス範囲からのみアクセスを許可する構成も可能です。
Access keys は認証に使用される資格情報の管理機能であり、ネットワークアクセスの制御には使用しません。Encryption はデータの暗号化設定であり、保存データや転送中データの保護に関する機能です。Data protection は論理削除やバージョン管理などのデータ保護機能を提供しますが、ネットワークアクセスの制御とは無関係です。

| 設定項目 | 用途 |
| :--- | :--- |
| Firewalls and virtual networks | ネットワークアクセス制御 |
| Access keys | 認証資格情報の管理 |
| Encryption | データ暗号化設定 |

インターネットからのアクセスを無効にする場合、Private Endpoint を使用して特定の仮想ネットワークからのみアクセスを許可する構成も検討できます。この方法では、Storage Account へのアクセスがプライベート IP アドレス経由となり、よりセキュアな通信が実現します。

**リファレンス**
* Azure Storage Account
* Private Endpoint

---

**問題 223. App-A、App-B、App-C という名前の 3 つの Azure App Service アプリがあります。各アプリには本番デプロイスロットとテストデプロイスロットがあり、本番スロットのバックアップ構成設定は次の表の通りです。2024 年 3 月 26 日時点で、App-A のストレージには 1 つだけバックアップが存在するかどうかを判断します。正しい場合は「はい」を選択し、正しくない場合は「いいえ」を選択します。（一つ選択）**

| アプリ | バックアップ間隔 | バックアップスケジュール開始日 | 保持期間 (日数) | 少なくとも 1 つのバックアップを保持 |
| :--- | :--- | :--- | :--- | :--- |
| App-A | 1 日 | 2024 年 3 月 16 日 | 0 | はい |
| App-B | 1 日 | 2024 年 3 月 20 日 | 30 | はい |
| App-C | 1 日 | 2024 年 4 月 15 日 | 15 | いいえ |

* いいえ
* **はい**

**解答例**
* **はい**

**解説**
App Service のバックアップとリストアは Standard プラン以上で利用可能な機能で、アプリの構成、ファイルコンテンツ、データベースを自動的にバックアップします。この問題では保持期間と「少なくとも 1 つのバックアップを保持」設定の関係を理解することが重要です。
App-A の設定を確認すると、バックアップスケジュール開始日が 2024 年 3 月 16 日で、バックアップ間隔が 1 日のため、2024 年 3 月 26 日までに 11 個のバックアップが作成されています。**保持期間が 0 日に設定されていますが、「少なくとも 1 つのバックアップを保持」が「はい」になっているため、保持期間の設定に関わらず最新のバックアップが 1 つ保持されます。** この設定により、古いバックアップは自動的に削除されますが、最新のバックアップは常に保持されるため、2024 年 3 月 26 日時点で App-A のストレージには 1 つだけバックアップが存在することになります。
保持期間が 0 日の場合、通常はバックアップが即座に削除されますが、「少なくとも 1 つのバックアップを保持」オプションを有効にすることで、ストレージコストを最小限に抑えながら最新のバックアップを確保できます。App-B は保持期間 30 日で最大 30 個のバックアップを保持し、App-C はまだバックアップスケジュール開始日に達していないためバックアップは存在しません。

| 設定項目 | App-A | 動作 |
| :--- | :--- | :--- |
| 保持期間 | 0 日 | 通常は即座に削除 |
| 少なくとも 1 つ保持 | はい | 最新バックアップを 1 つ保持 |
| 結果 | 1 個 | 最新のみ保存される |

**リファレンス**
* Azure App Service
* Deployment Slot

---

**問題 224. Azure 仮想マシンをカスタム Azure Resource Manager テンプレートを使用してデプロイしました。仮想マシンがメンテナンスの影響を受けるという通知を受け取ったため、直ちに別の物理ホストに移動します。解決策として、仮想マシンの概要ブレードから別のサブスクリプションに移動する操作を実行しました。この解決策は目標を達成していますか。（一つ選択）**
* **いいえ**
* はい

**解答例**
* **いいえ**

**解説**
仮想マシンを別のサブスクリプションに移動しても、物理ホストの変更は発生しません。サブスクリプション間の移動は論理的なリソース管理の変更であり、仮想マシンが稼働する物理ホストには影響を与えないためです。
メンテナンスの影響を受ける仮想マシンを直ちに別の物理ホストに移動するには、**Azure Portal または az vm redeploy コマンドを使用して再デプロイ操作を実行する必要があります。** 再デプロイを実行すると、仮想マシンは同じリージョン内の別の物理ホストに移動され、メンテナンスの影響を回避できます。この操作中、仮想マシンは一時的に停止しますが、IP アドレスやディスク構成などの設定は保持されます。

| 操作 | 物理ホストの変更 | 用途 |
| :--- | :--- | :--- |
| サブスクリプション移動 | なし | リソース管理の整理 |
| 再デプロイ | あり | ホスト障害やメンテナンス回避 |
| 停止 / 起動 | 可能性あり | 通常の運用操作 |

**リファレンス**
* Azure Resource Manager

---

**問題 225. 組織が所有する VM-A という名前の Azure 仮想マシンで基幹業務システムのアプリケーションを実行しています。VM-A のバックアップを構成する際、バックアップ事前チェックのステータスが「警告」と表示されました。この警告ステータスの原因として最も可能性が高いものはどれですか。（一つ選択）**
* **VM-A に最新バージョンの Azure VM Agent がインストールされていない**
* VM-A が停止状態になっている
* VM-A に接続されているディスクが非管理ディスクである
* バックアップポリシーの保持期間設定が不適切である

**解答例**
* **VM-A に最新バージョンの Azure VM Agent がインストールされていない**

**解説**
Azure Backup で仮想マシンをバックアップする際、事前チェックで「警告」ステータスが表示される主な原因は、**Azure VM Agent のバージョンが古いことです。** Azure VM Agent は、バックアップ拡張機能と連携してアプリケーション整合性のあるバックアップを実現するために必要なコンポーネントです。
Azure Backup は、VM Agent を通じて VSS (Volume Shadow Copy Service) スナップショットを取得し、実行中のアプリケーションのデータ整合性を保ちながらバックアップを実行します。VM Agent が最新でない場合、バックアップ拡張機能が正常に動作しない可能性があるため、警告が表示されます。ただし、バックアップ自体は実行可能であり、エラーではなく警告として扱われます。
VM-A が停止している場合は、バックアップは正常に実行できますが、アプリケーション整合性スナップショットではなくクラッシュ整合性スナップショットとして取得されます。非管理ディスクの場合、Azure Backup は対応していますが、管理ディスクと比較して一部機能制限があります。バックアップポリシーの保持期間設定は、事前チェックの警告には直接関係しません。

| 状態 | 説明 | バックアップ実行 |
| :--- | :--- | :--- |
| 警告 | VM Agent が古いなど改善推奨事項がある | 実行可能 |
| エラー | Recovery Services コンテナーが利用不可など致命的問題 | 実行不可 |
| 正常 | すべての事前チェックに合格 | 実行可能 |

**リファレンス**
* Azure VM Agent
* Azure Backup
* Recovery Services Vault

---

**問題 226. あなたは Azure Web App の管理者です。App1 という名前の Azure Web App を運用しており、このアプリは Plan1 という名前の App Service Plan で実行されています。Plan1 は Free 価格レベルに関連付けられています。App1 が毎日 60 分間連続実行された後に停止することが判明しました。App1 を 1 日中連続して実行できるようにする必要があります。解決策として、App1 にトリガー型の WebJob を追加することを検討しています。この解決策は要件を満たしていますか？（一つ選択）**
* **いいえ、要件を満たしていません**
* はい、要件を満たしています
* WebJob の実行頻度を調整すれば要件を満たします
* Always On を有効化すれば要件を満たします

**解答例**
* **いいえ、要件を満たしていません**

**解説**
**Free 価格レベルの App Service Plan には、1 日あたり 60 分間という実行時間の制限があります。** この制限は、WebJob を追加しても解消されません。WebJob はアプリケーション内でバックグラウンドタスクを実行するための機能であり、App Service Plan の価格レベルによる実行時間制限を回避する手段ではありません。
App1 を 1 日中連続して実行するには、**Free 価格レベルから上位の価格レベル（Basic、Standard、Premium など）にアップグレードする必要があります。** 上位の価格レベルでは、実行時間の制限が撤廃され、Always On 機能も利用可能になります。Always On 機能を有効にすると、アプリケーションがアイドル状態でもアンロードされず、常に実行状態を維持できます。

| 価格レベル | 実行時間制限 | Always On 機能 |
| :--- | :--- | :--- |
| Free | 60 分 / 日 | 利用不可 |
| Shared | 240 分 / 日 | 利用不可 |
| Basic 以上 | 制限なし | 利用可能 |

したがって、トリガー型 WebJob の追加だけでは要件を満たすことができず、App Service Plan の価格レベルをアップグレードする必要があります。

**リファレンス**
* App Service Plan
* WebJobs
* Always On

---

**問題 227. Azure サブスクリプションに複数のストレージリソースが含まれています。以下のタスクを実行する必要があります。Azure Storage Explorer を使用して実行できるタスクはどれですか。（一つ選択）**

タスク一覧：
| タスク | 内容 |
| :--- | :--- |
| タスク 1 | BLOB コンテナーへのファイルアップロード |
| タスク 2 | Table Storage のエンティティ管理 |
| タスク 3 | Azure Files の共有フォルダー作成 |
| タスク 4 | ストレージアカウントのアクセスキー再生成 |

* タスク 2、タスク 3、タスク 4 のみ
* **タスク 1、タスク 2、タスク 3 のみ**
* タスク 1 と タスク 3 のみ
* タスク 1、タスク 2、タスク 3、タスク 4 すべて

**解答例**
* **タスク 1、タスク 2、タスク 3 のみ**

**解説**
Azure Storage Explorer は、Azure ストレージサービスのデータを管理するためのスタンドアロンアプリケーションです。Windows, macOS, Linux で動作し、GUI 操作でストレージリソースを効率的に管理できます。
各タスクの実行可否は以下の通りです。タスク 1 の BLOB コンテナーへのファイルアップロードは、Storage Explorer の基本機能です。ドラッグアンドドロップ操作でファイルをアップロードでき、フォルダー構造も維持できます。タスク 2 の Table Storage のエンティティ管理も対応しており、エンティティの追加、編集、削除、クエリ実行が可能です。タスク 3 の Azure Files の共有フォルダー作成も実行でき、ファイル共有の作成、ディレクトリ構造の管理、ファイルのアップロード・ダウンロードが行えます。
一方、**タスク 4 のストレージアカウントのアクセスキー再生成は、Storage Explorer では実行できません。** アクセスキーの再生成はセキュリティに関わる管理操作であり、Azure Portal または Azure CLI や Azure PowerShell を使用する必要があります。Storage Explorer は既存のアクセスキーや SAS トークンを使用してストレージに接続しますが、キー自体の管理機能は提供していません。

Storage Explorer の主な機能：
| 機能カテゴリ | 対応操作 |
| :--- | :--- |
| データ操作 | BLOB, Files, Queue, Table の読み書き |
| 接続方法 | アクセスキー, SAS トークン, Azure AD 認証 |
| 管理操作 | コンテナー作成、プロパティ設定、メタデータ編集 |

したがって、Azure Storage Explorer で実行できるのはタスク 1、タスク 2、タスク 3 のみとなります。

**リファレンス**
* Azure Storage Explorer
* Shared Access Signature (SAS)
* Azure Table Storage

---

**問題 228. 登録済みの DNS ドメイン hogehoge.com を所有しています。Azure DNS に hogehoge.com という名前のパブリック DNS ゾーンを作成しました。hogehoge.com ゾーンに作成されたレコードがインターネットから名前解決可能になるようにします。何をすべきですか？（一つ選択）**
* **DNS ドメインレジストラで NS レコードを変更する**
* hogehoge.com ゾーンに CNAME レコードを作成する
* hogehoge.com ゾーンに SOA レコードを作成する
* DNS ドメインレジストラで SOA レコードを変更する

**解答例**
* **DNS ドメインレジストラで NS レコードを変更する**

**解説**
Azure DNS で作成したパブリック DNS ゾーンをインターネットから名前解決可能にするには、**ドメインレジストラ側のネームサーバー (NS) レコードを Azure DNS のネームサーバーに向ける必要があります。**
Azure DNS でパブリック DNS ゾーンを作成すると、Azure は自動的に 4 つのネームサーバーをそのゾーンに割り当てます。これらのネームサーバー情報は、作成した DNS ゾーンの NS レコードとして確認できます。インターネット上の DNS クライアントがドメイン名を解決する際、まずドメインレジストラに登録されているネームサーバー情報を参照します。そのため、ドメインレジストラ側で NS レコードを Azure DNS のネームサーバーに更新することで、Azure DNS 上のレコードが参照されるようになります。
SOA レコード (Start of Authority) は DNS ゾーンの管理情報を含むレコードで、Azure DNS ゾーン作成時に自動的に生成されます。このレコードはゾーンの権威を示すものであり、手動で作成や変更を行う必要はありません。CNAME レコードは別名を定義するためのレコードであり、ネームサーバーの委任には使用しません。

| 項目 | 説明 |
| :--- | :--- |
| NS レコード | ドメインの権威ネームサーバーを指定するレコード |
| SOA レコード | DNS ゾーンの管理情報を含むレコード（自動生成） |
| ドメイン委任 | レジストラの NS レコードを Azure DNS に向けることで実現 |

**リファレンス**
* Azure DNS

---

**問題 229. Azure サブスクリプションに 10 台の仮想マシンと以下のリソースがあります。Bastion-A で 100 人の同時 SSH セッションをサポートする必要があります。管理労力を最小限に抑えるソリューションを実装します。最初に実行すべき操作を選択してください。（一つ選択）**

| 名前 | タイプ | 説明 |
| :--- | :--- | :--- |
| VNet-A | 仮想ネットワーク | なし |
| Bastion-A | Basic SKU Azure Bastion ホスト | サブネットサイズ /26 |

* **Bastion-A を Standard SKU にアップグレードする**
* Azure Bastion のサブネットを /24 に拡張する
* ネットワークセキュリティグループ (NSG) を作成する
* ホストのスケーリングを構成する

**解答例**
* **Bastion-A を Standard SKU にアップグレードする**

**解説**
Azure Bastion で 100 人の同時 SSH セッションをサポートするには、**まず Basic SKU から Standard SKU へのアップグレードが必要です。** Basic SKU は最大 25 の同時セッションしかサポートしないため、100 セッションの要件を満たせません。
Standard SKU にアップグレードすることで、ホストスケーリング機能が利用可能になります。ホストスケーリングでは、インスタンス数（スケールユニット）を 2 から 50 まで設定でき、各スケールユニットは約 25 の同時セッションをサポートします。100 セッションには 4 スケールユニット以上が必要です。
サブネットサイズ /26 (64 個の IP アドレス) は、Standard SKU とホストスケーリングに十分です。Azure Bastion サブネット (AzureBastionSubnet) の最小要件は /26 であり、現在の構成で問題ありません。NSG の作成は同時セッション数の増加には直接関係しません。

| 項目 | Basic SKU | Standard SKU |
| :--- | :--- | :--- |
| 最大同時セッション数 | 25 | スケールユニット × 25 |
| ホストスケーリング | 非対応 | 対応 (2-50 ユニット) |
| 最小サブネットサイズ | /26 | /26 |

作業手順としては、(1)Standard SKU へアップグレード、(2)ホストスケーリングで 4 以上のインスタンスを構成、という順序で実装します。

**リファレンス**
* Azure Bastion

---

**問題 230. Azure サブスクリプションに、storage という名前のストレージアカウントがあります。次の表に示すデバイスがあります。AzCopy を使用して storage1 にデータをコピーできるデバイスはどれですか。（一つ選択）**

| デバイス名 | オペレーティングシステム |
| :--- | :--- |
| Device1 | Windows 11 |
| Device2 | macOS |
| Device3 | Chrome OS |

* Device1 と Device3 のみ
* Device1、Device2、Device3 のすべて
* Device1 のみ
* **Device1 と Device2 のみ**

**解答例**
* **Device1 と Device2 のみ**

**解説**
AzCopy は、Azure ストレージアカウントとの間でデータを高速転送するためのコマンドラインユーティリティです。この問題では、各デバイスのオペレーティングシステムで AzCopy が動作するかを判断します。
**AzCopy は、Windows、Linux、macOS の各プラットフォームで実行可能なクロスプラットフォームツールです。** Device1 の Windows 11 と Device2 の macOS は、いずれも AzCopy の公式サポート対象プラットフォームであり、問題なく使用できます。一方、Device3 の Chrome OS は、Linux ベースではあるものの、AzCopy の公式サポート対象外です。Chrome OS では標準的な Linux コマンドラインツールの実行環境が制限されており、AzCopy を直接実行することはできません。
したがって、AzCopy を使用して storage1 にデータをコピーできるのは、Device1 と Device2 のみとなります。

| プラットフォーム | AzCopy サポート | 該当デバイス |
| :--- | :--- | :--- |
| Windows | 対応 | Device1 |
| macOS | 対応 | Device2 |
| Chrome OS | 非対応 | Device3 |

**リファレンス**
* AzCopy
* Azure Storage Account

---

**問題 231. Azure App Service で新しい Web アプリを展開します。要件として、カスタムドメイン名（app.hogehoge.com）の検証が可能であること、最大 8 インスタンスまでの自動スケーリングに対応すること、運用コストと管理の複雑さを最小限に抑えることが求められています。この要件を満たす最適な価格レベルを選択してください。（一つ選択）**
* Basic
* Free
* Premium
* **Standard**

**解答例**
* **Standard**

**解説**
この問題では、Azure App Service の価格レベルごとの機能差異を理解し、要件に最適なプランを選択する必要があります。
カスタムドメイン名の検証機能は、Basic レベルと Standard レベル以上で利用可能です。Free と Shared レベルではカスタムドメインの設定ができません。自動スケーリング機能については、**Standard レベル以上でのみサポートされており、** Basic レベルでは手動スケーリングのみとなります。
Standard レベルは最大 10 インスタンスまでの自動スケーリングに対応しており、要件の 8 インスタンスを満たします。Premium レベルも要件を満たしますが、より高度な機能（VNet 統合、より多くのインスタンス数など）を提供するため、コスト最小化の観点から最適ではありません。

| 価格レベル | カスタムドメイン | 自動スケーリング | 最大インスタンス数 |
| :--- | :--- | :--- | :--- |
| Free/Shared | 非対応 | 非対応 | 1 |
| Basic | 対応 | 非対応 | 3 |
| Standard | 対応 | 対応 | 10 |
| Premium | 対応 | 対応 | 30 |

したがって、カスタムドメインと自動スケーリングの両方の要件を満たし、かつコストを最小限に抑えるには Standard レベルが最適な選択となります。

**リファレンス**
* Azure App Service
* App Service Plan
* 自動スケーリング

---

**問題 232. WebApp-A という名前の Azure App Service アプリがあり、このアプリには Folder-A と Folder-B という名前の 2 つのフォルダーが含まれています。WebApp-A の毎日のバックアップを構成します。このソリューションでは、Folder-B がバックアップから確実に除外される必要があります。最初に作成する必要があるものを選択してください。（一つ選択）**
* **Azure Storage アカウント**
* Recovery Services コンテナー
* バックアップコンテナー
* Azure Backup Server

**解答例**
* **Azure Storage アカウント**

**解説**
Azure App Service のバックアップ機能を使用する場合、**バックアップデータの保存先として Azure Storage アカウントが必要です。** App Service のバックアップは、指定したストレージアカウント内の Blob コンテナーにバックアップファイルを保存します。
App Service のバックアップ構成では、特定のフォルダーやファイルを除外するために `_backup.filter` ファイルを使用します。このファイルをアプリのルートディレクトリ (`D:\home\site\wwwroot`) に配置し、除外したいフォルダーやファイルのパスを記述することで、バックアップ対象から除外できます。Folder-B を除外する場合は、`_backup.filter` ファイルに `\Folder-B` と記述します。
Recovery Services コンテナーは、Azure VM や SQL Database などのバックアップに使用されますが、App Service の標準バックアップ機能では使用しません。バックアップコンテナーは、Azure Backup Center で使用される新しいバックアップストレージの概念ですが、App Service の直接的なバックアップには使用されません。

| 項目 | 説明 |
| :--- | :--- |
| 必要なリソース | Azure Storage アカウント |
| 除外設定ファイル | `_backup.filter` |
| 配置場所 | `D:\home\site\wwwroot` |

| バックアップ対象 | 使用するリソース |
| :--- | :--- |
| App Service | Azure Storage アカウント |
| Azure VM | Recovery Services コンテナー |
| Azure Database | Recovery Services コンテナー |

**リファレンス**
* Azure App Service
* Azure Storage アカウント
* Azure Backup

---

**問題 233. あなたの会社では、仮想マシン VM5 の IP トラフィックフローログを保存するストレージアカウントを選定する必要があります。ログの保持要件として、90 日間のデータ保持が必須となっています。また、VM5 は東日本リージョンにデプロイされており、Network Watcher のフローログ機能を使用します。以下のストレージアカウントのうち、この要件を満たすものはどれですか。（一つ選択）**

| ストレージアカウント名 | リージョン | パフォーマンス層 | レプリケーション |
| :--- | :--- | :--- | :--- |
| storage1 | 東日本 | Standard | LRS |
| storage2 | 西日本 | Premium | ZRS |
| storage3 | 東日本 | Standard | GRS |
| storage4 | 米国東部 | Standard | LRS |

* storage3
* storage4
* **storage1**
* storage2

**解答例**
* **storage1**

**解説**
Network Watcher のフローログ機能を使用する際、**ストレージアカウントは監視対象の仮想マシンと同じリージョンに配置する必要があります。** VM5 は東日本リージョンにデプロイされているため、同じ東日本リージョンのストレージアカウントを選択する必要があります。
選択肢を確認すると、東日本リージョンに配置されているのは storage1 と storage3 です。storage2 は西日本リージョン、storage4 は米国東部リージョンに配置されているため、リージョン要件を満たしません。
次に、フローログの保存先として適切なパフォーマンス層を確認します。Network Watcher のフローログは、**Standard パフォーマンス層のストレージアカウントに保存する必要があります。** storage1 と storage3 はどちらも Standard パフォーマンス層ですが、フローログの保存には LRS (ローカル冗長ストレージ) または ZRS (ゾーン冗長ストレージ) が推奨されます。GRS (geo 冗長ストレージ) は不要なコストが発生するため、最適な選択ではありません。
したがって、リージョン要件とコスト効率の観点から、storage1 が最適な選択となります。

| 要件 | storage1 | storage2 | storage3 | storage4 |
| :--- | :--- | :--- | :--- | :--- |
| リージョン一致 | ○ | × | ○ | × |
| パフォーマンス層 | Standard | Premium | Standard | Standard |
| 推奨レプリケーション | ○ | × | △ | × |

**リファレンス**
* Network Watcher

---

**問題 234. あなたの会社は Microsoft Azure サブスクリプションを保有しています。ロサンゼルスとニューヨークにデータセンターがあり、サイト障害復旧のために 2 つのデータセンターを地理的にクラスター化されたサイトとして構成します。次のデータストレージ要件を満たす Azure ストレージ冗長性オプションを推奨します。データは複数のノードに保存される必要があり、異なる地理的な場所にあるノードに保存される必要があります。さらに、データはプライマリロケーションだけでなくセカンダリロケーションからも読み取り可能である必要があります。どの Azure ストレージ冗長性オプションを推奨しますか。（一つ選択）**
* Zone-redundant storage (ZRS)
* **Read-access geo-redundant storage (RA-GRS)**
* Locally redundant storage (LRS)
* Geo-zone-redundant storage (GZRS)

**解答例**
* **Read-access geo-redundant storage (RA-GRS)**

**解説**
この問題の最重要ポイントは、**セカンダリロケーションからのデータ読み取りアクセスが要件に含まれている点です。** Azure ストレージの冗長性オプションには複数の種類がありますが、セカンダリリージョンへのデータレプリケーションと読み取りアクセスの両方を提供するのは RA-GRS のみです。
GRS (Geo-redundant storage) は、プライマリリージョンから数百マイル離れたセカンダリリージョンにデータを非同期的にレプリケートしますが、セカンダリリージョンのデータは通常読み取り専用ではなく、フェイルオーバー時のみアクセス可能です。一方、**RA-GRS (Read-access geo-redundant storage) は、GRS の機能に加えて、セカンダリリージョンのデータへの読み取りアクセスを常時提供します。** これにより、プライマリリージョンで障害が発生した場合でも、アプリケーションはセカンダリリージョンからデータを読み取ることができます。
ZRS (Zone-redundant storage) は、単一リージョン内の 3 つの可用性ゾーンにデータを同期的にレプリケートしますが、地理的に離れた場所へのレプリケーションは行いません。LRS (Locally redundant storage) は、単一データセンター内でのみデータをレプリケートするため、地理的な冗長性は提供されません。GZRS (Geo-zone-redundant storage) は、ZRS と GRS を組み合わせたオプションで、プライマリリージョンでゾーン冗長性を提供し、セカンダリリージョンにもレプリケートしますが、読み取りアクセスには RA-GZRS (Read-access geo-zone-redundant storage) が必要です。

| 冗長性オプション | 地理的レプリケーション | セカンダリ読み取り |
| :--- | :--- | :--- |
| LRS | なし | 不可 |
| ZRS | なし | 不可 |
| GRS | あり | 不可 |
| RA-GRS | あり | 可能 |
| GZRS | あり | 不可 |

**リファレンス**
* Azure Storage 冗長性
* Availability Zone

---

**問題 235. Azure サブスクリプションに、VNET1 と VNET2 という 2 つの仮想ネットワークがあります。また、以下の表に示すユーザーが存在します。VNET1 と VNET2 の間でピアリングを構成できるユーザーを特定します。どのユーザーを選択しますか。（一つ選択）**

| ユーザー | ロール | スコープ |
| :--- | :--- | :--- |
| User1 | 所有者 | サブスクリプション |
| User2 | ネットワーク共同作成者 | VNET1 |
| User3 | ネットワーク共同作成者 | VNET2 |

* **User1 のみ**
* User2 と User3 のみ
* User1 と User3 のみ
* User1、User2、User3 のすべて
* User3 のみ

**解答例**
* **User1 のみ**

**解説**
仮想ネットワークピアリングを構成するには、**両方の仮想ネットワークに対して適切なアクセス許可が必要です。** ピアリングを確立するユーザーは、両方の VNET に対してネットワーク共同作成者ロール以上の権限を持つ必要があります。
**User1 はサブスクリプションレベルで所有者ロールを持っているため、サブスクリプション内のすべてのリソース（VNET1 と VNET2 の両方を含む）に対する完全な権限を持ちます。** 所有者ロールにはネットワーク共同作成者の権限が含まれるため、User1 は両方の VNET に対してピアリングを構成できます。
User2 は VNET1 に対してのみネットワーク共同作成者ロールを持ち、VNET2 に対する権限がありません。同様に、User3 は VNET2 に対してのみネットワーク共同作成者ロールを持ち、VNET1 に対する権限がありません。ピアリングは双方向の接続であり、両方の VNET に対する権限が必要なため、User2 と User3 は単独ではピアリングを構成できません。

| ユーザー | VNET1 への権限 | VNET2 への権限 | ピアリング構成可否 |
| :--- | :--- | :--- | :--- |
| User1 | あり（所有者） | あり（所有者） | 可能 |
| User2 | あり | なし | 不可 |
| User3 | なし | あり | 不可 |

仮想ネットワークピアリングを構成する際の重要なポイントは、ピアリングする両方の VNET に対して適切な権限を持つ必要があることです。サブスクリプションレベルの所有者または共同作成者ロールを持つユーザー、あるいは両方の VNET に対してネットワーク共同作成者ロールが割り当てられているユーザーのみがピアリングを確立できます。

**リファレンス**
* Virtual Network Peering
* Azure RBAC (Role-Based Access Control)

---

**問題 236. ある Azure サブスクリプションにストレージアカウントが存在します。このストレージアカウントに対してロールベースのアクセス制御 (RBAC) ロールを割り当てる際、条件付きロール割り当て (Attribute-Based Access Control) をサポートするストレージサービスを選択します。（一つ選択）**
* キューのみ
* ファイル共有とテーブルのみ
* **コンテナとキューのみ**
* テーブルのみ
* ファイル共有のみ

**解答例**
* **コンテナとキューのみ**

**解説**
Azure Storage Account の RBAC ロール割り当てにおいて、**条件付きアクセス制御 (ABAC: Attribute-Based Access Control) は、Blob Storage (コンテナ) と Queue Storage でのみサポートされています。** この機能により、リソースタグやメタデータなどの属性に基づいて、より細かいアクセス制御が可能になります。
条件付きロール割り当ては、Azure RBAC の拡張機能として提供されており、特定の条件が満たされた場合にのみアクセスを許可する仕組みです。例えば、特定のタグが付いた Blob コンテナにのみアクセスを許可したり、特定の時間帯のみアクセスを許可するといった制御が実現できます。
File Shares と Table Storage は、現時点では条件付きロール割り当てをサポートしていません。これらのサービスでは、従来の RBAC ロールによる標準的なアクセス制御のみが利用可能です。

| ストレージサービス | 条件付きロール割り当て対応 |
| :--- | :--- |
| Blob Storage (コンテナ) | 対応 |
| Queue Storage | 対応 |
| File Shares | 非対応 |
| Table Storage | 非対応 |

条件付きロール割り当てを使用する際は、Azure Portal の「アクセス制御 (IAM)」セクションから、ロール割り当ての追加時に「条件の追加」オプションを選択します。条件式は、リソースの属性、アクション、環境変数などを組み合わせて定義できます。

**リファレンス**
* Azure RBAC (Role-Based Access Control)
* ABAC (属性ベースのアクセス制御)
* Azure Storage Account

---

**問題 237. あなたの組織は、Azure サブスクリプション「Subscription-A」を所有しています。Subscription-A には、以下の表に記載のリソースが含まれています。**

仮想ネットワーク構成
| 名前 | サブネット |
| :--- | :--- |
| VNet-A | SubnetA-A, SubnetA-B |
| VNet-C | SubnetA-C |

仮想マシン構成
| 名前 | サブネット | 可用性セット |
| :--- | :--- | :--- |
| VM-A | SubnetA-A | AS-A |
| VM-B | SubnetA-A | AS-A |
| VM-C | SubnetA-A | なし |
| VM-D | SubnetA-A | なし |
| VM-E | SubnetA-B | なし |
| VM-F | SubnetA-B | なし |

ロードバランサー構成
| 項目 | 設定値 |
| :--- | :--- |
| 名前 | LB-A |
| SKU | Basic |
| タイプ | Internal |
| サブネット | SubnetA-B |
| 仮想ネットワーク | VNet-A |

**次の記述について、正しい場合は「はい」を選択し、正しくない場合は「いいえ」を選択します。（一つ選択）**

**LB-A は、VM-A と VM-B の間のトラフィックの負荷分散を行うことができる。**
* **いいえ**
* はい

**解答例**
* **いいえ**

**解説**
この設問の最重要ポイントは、Azure Load Balancer の Basic SKU における内部ロードバランサーの動作原理と、バックエンドプールに追加できる仮想マシンの条件を理解することです。
LB-A は内部ロードバランサー (Internal Load Balancer) として構成されており、SubnetA-B に配置されています。一方、VM-A と VM-B は両方とも SubnetA-A に配置されています。Azure Load Balancer は、同一仮想ネットワーク内の異なるサブネットに配置された仮想マシンをバックエンドプールに追加できますが、**Basic SKU の内部ロードバランサーには重要な制約があります。**
Basic SKU の内部ロードバランサーは、ロードバランサー自身が配置されているサブネットとは異なるサブネットの仮想マシンをバックエンドプールに追加することは可能です。しかし、VM-A と VM-B は可用性セット AS-A に所属しており、ロードバランサーのバックエンドプールに追加する際には、**同一の可用性セットまたは仮想マシンスケールセットに属する仮想マシンである必要があります。**
さらに重要な点として、Basic SKU のロードバランサーでは、バックエンドプールに追加できる仮想マシンは、ロードバランサーと同じ仮想ネットワーク内に存在する必要があります。この条件は満たされていますが、ロードバランサーが SubnetA-B に配置されているのに対し、VM-A と VM-B は SubnetA-A に配置されているため、適切なバックエンドプール構成とネットワークセキュリティグループの設定が必要です。

Basic SKU と Standard SKU の比較
| 項目 | Basic SKU | Standard SKU |
| :--- | :--- | :--- |
| バックエンドプールサイズ | 最大 300 インスタンス | 最大 1000 インスタンス |
| 可用性ゾーン対応 | 非対応 | 対応 |
| SLA | なし | 99.99% |

したがって、LB-A は VM-A と VM-B の間のトラフィックの負荷分散を行うことができますが、適切なバックエンドプール構成が必要です。ただし、設問の文脈では「VM-A と VM-B の間」という表現が、ロードバランサーがこれら 2 台の仮想マシン間で負荷分散を行うという意味であれば、正しい構成となります。

**リファレンス**
* Azure Load Balancer
* Availability Set





ご提示いただいたソース資料（PDFの抜粋）に含まれるすべての文章を、一文字も省略することなく、全文そのまま出力します。

---

**問題 238. Azure サブスクリプションに 10 個の仮想ネットワークがあり、それぞれ異なるリソースグループでホストされています。別の管理者がサブスクリプション内に複数のネットワークセキュリティグループ (NSG) を作成する予定です。NSG が作成されたときに、仮想ネットワーク間の TCP ポート 8080 を自動的にブロックする必要があります。解決策として、サブスクリプションに組み込みのポリシー定義を割り当てます。この解決策は要件を満たしていますか？（一つ選択）**

*   いいえ
*   はい

**解答例**

*   いいえ

**解説**
この解決策は要件を満たしていません。Azure Policy の組み込みポリシー定義には、NSG 作成時に特定のポート (TCP ポート 8080 など) を自動的にブロックするルールを追加する機能は含まれていません。

Azure Policy は主にリソースのコンプライアンス評価や作成の制御を行うものであり、NSG のセキュリティルールの内容を自動的に構成する機能は提供していません。組み込みポリシーでは、NSG の存在確認やタグ付けの強制などは可能ですが、特定のポートをブロックするセキュリティルールを自動追加することはできません。

この要件を満たすには、カスタムの Azure Policy 定義と DeployIfNotExists 効果を使用するか、Azure Automation や Azure Functions を使用して NSG 作成イベントをトリガーとした自動化スクリプトを実装する必要があります。また、ARM (Azure Resource Manager) テンプレートや Bicep テンプレートに事前定義されたセキュリティルールを含めてデプロイする方法も考えられます。

| アプローチ | 実現可能性 | 説明 |
| :--- | :--- | :--- |
| 組み込みポリシー定義 | 不可 | 特定ポートのブロックルール追加は非対応 |
| カスタムポリシー (DeployIfNotExists) | 可能 | ポリシーでセキュリティルールを自動デプロイ |
| Azure Automation または Functions | 可能 | イベント駆動でルールを自動追加 |

**リファレンス**

*   Azure Policy
*   Network Security Group

**問題 239. Azure Storage アカウント storageaccount1 に、機密情報を格納する BLOB コンテナー container1 があります。container1 内のコンテンツが最終変更日から 6 か月間、変更または削除されないようにします。何を構成しますか。（一つ選択）**

*   アクセス ポリシー
*   不変性ポリシー
*   ライフサイクル管理
*   変更フィード

**解答例**

*   不変性ポリシー

**解説**
BLOB データを一定期間変更や削除から保護する必要がある場合、不変性ポリシーを使用します。不変性ポリシーは、時間ベースの保持ポリシーまたは訴訟ホールドを設定でき、WORM (Write Once, Read Many) 状態でデータを保護します。

時間ベースの保持ポリシーでは、保持期間を日数単位で指定でき、この期間中は BLOB の変更や削除が禁止されます。本問では最終変更日から 6 か月間の保護が必要なため、180 日間の時間ベースの保持ポリシーを設定します。

他の選択肢が不適切な理由を整理します。

| 選択肢 | 説明 |
| :--- | :--- |
| アクセス ポリシー | アクセス権限の制御に使用するが、データの不変性は保証しない |
| ライフサイクル管理 | データの自動階層化や削除を管理するが、変更や削除の防止機能はない |
| 変更フィード | BLOB の変更履歴を記録する監査機能であり、変更自体を防止しない |

不変性ポリシーの設定は、コンテナー レベルまたはアカウント レベルで適用できます。ポリシーがロックされると、保持期間の延長のみが可能で、短縮や削除はできません。これにより、規制要件やコンプライアンス要件を満たすデータ保護が実現します。

**リファレンス**

*   Immutability Policy
*   Azure Blob Storage
*   WORM（Write Once Read Many）

**問題 240. Azure Resource Manager (ARM) テンプレートを使用してリソースグループを作成し、そのリソースグループに Azure Storage アカウントをデプロイします。このテンプレートをデプロイするために実行すべき PowerShell コマンドレットはどれですか。（一つ選択）**

*   New-AzSubscriptionDeployment
*   New-AzResourceGroupDeployment
*   New-AzDeployment
*   New-AzManagementGroupDeployment

**解答例**

*   New-AzDeployment

**解説**
ARM テンプレートのデプロイには、デプロイ先のスコープに応じた適切なコマンドレットを選択する必要があります。本問では「リソースグループを作成し、そのリソースグループに Storage アカウントをデプロイする」というシナリオです。

リソースグループ自体を作成する操作はサブスクリプションレベルのスコープで実行されます。したがって、サブスクリプションスコープでのデプロイを実行するコマンドレットが必要です。New-AzDeployment コマンドレットは、サブスクリプションスコープでの ARM テンプレートデプロイを実行するために使用されます。

New-AzResourceGroupDeployment は既存のリソースグループ内にリソースをデプロイする際に使用しますが、リソースグループ自体の作成には使用できません。New-AzSubscriptionDeployment はサブスクリプションレベルのデプロイに使用できますが、New-AzDeployment のエイリアスとして機能します。New-AzManagementGroupDeployment は管理グループスコープでのデプロイに使用されます。

各コマンドレットのデプロイスコープを以下に整理します。

| コマンドレット | デプロイスコープ | 用途 |
| :--- | :--- | :--- |
| New-AzDeployment | サブスクリプション | リソースグループの作成を含むデプロイ |
| New-AzResourceGroupDeployment | リソースグループ | 既存リソースグループ内へのデプロイ |
| New-AzManagementGroupDeployment | 管理グループ | 管理グループレベルのポリシー設定など |

**リファレンス**

*   Azure Resource Manager
*   Azure PowerShell コマンドレット
*   デプロイスコープ

**問題 241. Recovery Services コンテナーに対して Multi-User Authorization (MUA) を実装します。MUA を有効化するための最初の手順として実行する必要がある操作を選択してください。（一つ選択）**

*   Azure Key Vault でシークレットを作成する
*   Resource Guard リソースを作成する
*   カスタム Azure RBAC ロールを作成する
*   マネージド ID を有効化する

**解答例**

*   Resource Guard リソースを作成する

**解説**
Recovery Services コンテナーの Multi-User Authorization (MUA) は、バックアップデータの削除や保護の無効化などの重要な操作に対して追加の承認レイヤーを提供するセキュリティ機能です。MUA を実装する最初のステップは、Resource Guard リソースの作成です。

Resource Guard は、Recovery Services コンテナーとは別のサブスクリプションまたはテナントに配置することが推奨される専用の Azure リソースです。これにより、バックアップ管理者とは異なるセキュリティ管理者が重要な操作を承認する権限分離が実現されます。Resource Guard を作成した後、Recovery Services コンテナーに MUA 設定を適用し、保護対象の操作を指定します。

MUA の実装手順は以下の通りです。まず Resource Guard リソースを作成し、次に Recovery Services コンテナーで MUA を有効化して Resource Guard を関連付けます。その後、保護する重要な操作を選択し、適切な RBAC ロールを割り当てます。

| 手順 | 操作内容 |
| :--- | :--- |
| 1 | Resource Guard リソースを作成 |
| 2 | Recovery Services コンテナーで MUA を有効化 |
| 3 | 保護対象の操作を構成 |

マネージド ID やカスタムロールは、MUA 構成の後続ステップで使用される可能性がありますが、最初の必須手順ではありません。Azure Key Vault はバックアップの暗号化には関連しますが、MUA の有効化には直接必要ありません。

**リファレンス**

*   Recovery Services Vault
*   Resource Guard

**問題 242. あなたは、West US リージョンでホストされている VNet1 という仮想ネットワークを管理しています。VNet1 には、Windows Server を実行する 2 台の仮想マシン VM1 と VM2 がホストされています。3 時間にわたって VM1 から VM2 へのすべてのネットワークトラフィックを検査します。Azure Network Watcher からパケットキャプチャを作成することで、この目標を達成できますか。（一つ選択）**

*   いいえ、パケットキャプチャでは 3 時間の継続的な監視は実現できない
*   はい、パケットキャプチャで要件を満たすことができる
*   いいえ、Network Performance Monitor を使用する必要がある
*   いいえ、NSG Flow Logs を使用する必要がある

**解答例**

*   はい、パケットキャプチャで要件を満たすことができる

**解説**
Azure Network Watcher のパケットキャプチャ機能は、仮想マシン間のネットワークトラフィックを詳細に検査するための適切なツールです。この機能により、特定の仮想マシンから送受信されるパケットをキャプチャし、ネットワークの問題診断やトラフィック分析を実行できます。

パケットキャプチャは最大 5 時間まで継続して実行可能であり、3 時間という要件を十分に満たします。キャプチャしたデータはストレージアカウントまたはローカルファイルに保存され、後から詳細な分析が可能です。フィルター機能を使用して、特定の送信元 IP アドレス、宛先 IP アドレス、プロトコル、ポート番号などの条件でトラフィックを絞り込むこともできます。

VM1 から VM2 への通信を監視する場合、VM1 にパケットキャプチャを設定し、宛先 IP アドレスとして VM2 のプライベート IP アドレスを指定することで、両者間の通信のみを効率的にキャプチャできます。

| 機能 | 用途 | 最大キャプチャ時間 |
| :--- | :--- | :--- |
| パケットキャプチャ | 詳細なパケットレベルの分析 | 5 時間 |
| NSG Flow Logs | NSG ルールの適用状況の記録 | 継続的 |
| Connection Monitor | エンドツーエンドの接続監視 | 継続的 |

パケットキャプチャは、Network Watcher 拡張機能が仮想マシンにインストールされている必要があります。この拡張機能は、パケットキャプチャの作成時に自動的にインストールされます。

**リファレンス**

*   Azure Network Watcher
*   パケットキャプチャ
*   NSG Flow Logs

**問題 243. あなたは、Sub1 と Sub2 という 2 つの Azure サブスクリプションを管理しています。Sub1 には、仮想マシン VM1 とストレージアカウント storage1 が含まれています。VM1 には以下のリソースが関連付けられています：マネージドディスク Disk1、ネットワークインターフェイス NetInt1、仮想ネットワーク VNet1。VM1 を Sub2 に移動する必要があります。Sub2 に移動する必要があるリソースはどれですか。（一つ選択）**

*   VM1, Disk1, VNet1 のみ
*   VM1, Disk1, NetInt1, VNet1
*   VM1, Disk1, storage1 のみ
*   VM1, Disk1, NetInt1 のみ

**解答例**

*   VM1, Disk1, NetInt1, VNet1

**解説**
Azure で仮想マシンを別のサブスクリプションに移動する場合、仮想マシン本体だけでなく、その仮想マシンが依存しているリソースも同時に移動する必要があります。

VM1 を移動する際に必須となるリソースは、マネージドディスク (Disk1)、ネットワークインターフェイス (NetInt1)、仮想ネットワーク (VNet1) です。これらは仮想マシンの動作に直接必要な依存リソースであり、仮想マシンと同じサブスクリプション内に存在する必要があります。

一方、ストレージアカウント (storage1) は、診断ログやブートダイアグノスティクスなどで使用される可能性がありますが、仮想マシンの移動に必須ではありません。ストレージアカウントは元のサブスクリプションに残したまま、必要に応じて別途移動することが可能です。

仮想マシンの移動時に考慮すべき主要リソースを以下の表にまとめます。

| リソース | 移動の必要性 | 理由 |
| :--- | :--- | :--- |
| マネージドディスク | 必須 | OS ディスクとデータディスクは仮想マシンに直接アタッチされている |
| ネットワークインターフェイス | 必須 | 仮想マシンのネットワーク接続に必要 |
| 仮想ネットワーク | 必須 | ネットワークインターフェイスが所属するネットワーク環境 |
| ストレージアカウント | 任意 | 診断データなどの保存先だが仮想マシン本体の動作には不要 |

Azure Portal または az resource move コマンドを使用して、これらのリソースを一括で移動できます。移動操作中は仮想マシンが停止状態になるため、メンテナンスウィンドウを設定して実行することを推奨します。

**リファレンス**

*   Azure Resource Manager
*   Azure Virtual Network
*   Managed Disk

**問題 244. Subscription-A という名前の Azure サブスクリプションに以下のリソースが存在します。リソースグループ RG-A、メール送信先が admin@hogehoge.com のアクショングループ Action-A、メール送信先が user@foobar.com のアクショングループ Action-B が含まれています。Subscription-A には、スコープが Subscription-A 内のすべてのリソースグループ (将来のリソースをすべて含む)、条件がすべての管理操作、アクションが Action-A に設定されたアラートルール Alert-A が構成されています。さらに、Subscription-A には、スコープが Subscription-A、ルールの種類が通知を抑制する、ルール適用が特定の時間 (開始 2023 年 8 月 10 日、終了 2023 年 8 月 13 日) に設定されたアラート処理ルール Rule-A が含まれています。2023 年 9 月 11 日に Subscription-A に新しいリソースグループを作成した場合、Alert-A は Azure portal のアラート一覧に表示されますか。（一つ選択）**

*   いいえ、Alert-A は表示されない
*   はい、Alert-A は表示される

**解答例**

*   はい、Alert-A は表示される

**解説**
この問題は、Azure Monitor のアラートルールとアラート処理ルールの動作を理解しているかを確認する問題です。特にアラートの発火条件、スコープ設定、アラート処理ルールによる抑制期間の影響を正しく理解する必要があります。

Alert-A の構成を確認すると、スコープは Subscription-A 内のすべてのリソースグループで、将来のリソースをすべて含む設定になっています。条件はすべての管理操作となっており、リソースグループの作成という管理操作も監視対象に含まれます。アクションとして Action-A が設定されているため、条件に合致した場合はメール通知が送信され、アラートが Azure portal に表示されます。

次にアラート処理ルール Rule-A を確認します。このルールは通知を抑制する設定になっていますが、適用期間は 2023 年 8 月 10 日から 2023 年 8 月 13 日までの特定の時間に限定されています。問題で問われているのは 2023 年 9 月 11 日の動作であり、この日付は Rule-A の抑制期間外です。したがって、Rule-A による通知抑制は適用されません。

2023 年 9 月 11 日に新しいリソースグループを作成すると、これは管理操作に該当し、Alert-A の条件を満たします。Alert-A のスコープには将来のリソースがすべて含まれる設定があるため、新規作成されたリソースグループも監視対象となります。さらに、この時点ではアラート処理ルールによる抑制も適用されないため、Alert-A は Azure portal のアラート一覧に正常に表示されます。

Azure Monitor のアラート処理ルールは、メンテナンス期間中や計画的な変更作業中に不要なアラート通知を抑制するために使用されます。ルールの種類には通知を抑制する以外にも、アクショングループを追加する設定も可能です。適用期間は常時適用、特定の時間、定期的なスケジュールから選択でき、柔軟な運用が可能です。

以下の表で、アラートルールとアラート処理ルールの主要な違いを整理します。

| 項目 | アラートルール | アラート処理ルール |
| :--- | :--- | :--- |
| 目的 | 監視条件の定義と通知 | アラート通知の制御 |
| 主な機能 | リソース監視と条件判定 | 通知の抑制や追加 |
| 適用タイミング | リソース状態の変化時 | アラート発火後の処理 |

アラートルールは監視対象リソースの状態変化を検知してアラートを発火させる役割を持ち、アラート処理ルールは発火したアラートに対する通知動作を制御する役割を持ちます。両者を組み合わせることで、効果的なアラート管理が実現できます。

本問題では、アラート処理ルールの抑制期間が質問日時と一致しないため、通常通りアラートが表示されるという結論になります。実務では、計画的なメンテナンス作業の前にアラート処理ルールを適切に設定し、不要なアラート通知を防ぐことが重要です。

**リファレンス**

*   Azure Monitor
*   Alert Rule

**問題 245. あなたの会社では、複数の部門が Azure サブスクリプションを使用しています。別の管理者が単一の Azure Resource Manager テンプレートを使用して、仮想マシンとストレージアカウントをデプロイしました。このデプロイに使用されたテンプレートを確認する必要があります。どのブレードからテンプレートを表示できますか。（一つ選択）**

*   デプロイされた仮想マシンのブレード
*   リソースグループのブレード
*   Azure Portal のホームダッシュボード
*   サブスクリプションのブレード

**解答例**

*   リソースグループのブレード

**解説**
Azure Resource Manager (ARM) テンプレートを使用したデプロイの履歴は、リソースグループレベルで管理されます。リソースグループのブレードから「デプロイ」または「デプロイメント」セクションにアクセスすることで、過去に実行されたすべてのデプロイメントの履歴を確認でき、使用されたテンプレートの内容も表示できます。

個々のリソース (仮想マシンやストレージアカウント) のブレードからは、そのリソース自体の設定や状態は確認できますが、デプロイに使用された元のテンプレートを直接表示することはできません。サブスクリプションレベルでは、すべてのリソースグループにまたがる情報が表示されますが、特定のデプロイテンプレートを確認するには適していません。

ARM テンプレートによるデプロイでは、複数のリソースを一度に作成できます。デプロイ履歴には、テンプレートの内容、パラメータ、デプロイの成功・失敗状況、タイムスタンプなどの詳細情報が記録されます。

| 確認項目 | 確認場所 | 内容 |
| :--- | :--- | :--- |
| デプロイテンプレート | リソースグループ | 使用された ARM テンプレートの全体 |
| デプロイ履歴 | リソースグループ | 過去のデプロイ記録と状態 |
| リソース設定 | 個別リソース | 現在の構成と状態 |

**リファレンス**

*   ARM Template
*   Resource group

**問題 246. Azure に 100 台の仮想マシンをデプロイしています。これらの仮想マシンに対して CPU とメモリ使用率を監視する Azure Monitor アラートを構成しています。Azure Monitor アラートを確認したところ、50 件のアラートが「クローズ」状態になっていることを発見しました。アラート状態が「クローズ」になる原因として正しいものはどれですか。（一つ選択）**

*   アラートルールに関連付けられたアクショングループが、アラート条件を自動的に修復した
*   管理者がアラートの状態を手動で変更した
*   アラートが作成されてから 30 日以上経過した
*   アラートをトリガーした条件が解消された

**解答例**

*   アラートをトリガーした条件が解消された

**解説**
Azure Monitor アラートの状態遷移において、アラート状態が「クローズ」になるのは、アラートをトリガーした条件が解消され、システムが自動的にアラートを閉じた場合です。Azure Monitor は継続的にリソースを監視し、アラート条件が満たされなくなると自動的にアラート状態を「発生中」から「クローズ」に変更します。

Azure Monitor アラートには主に 3 つの状態があります。「新規」は条件が初めて検出された状態、「確認済み」は管理者が確認した状態、「クローズ」は条件が解消された状態を示します。アラートは条件の変化に応じて自動的に状態遷移し、管理者による手動操作は必須ではありません。

アクショングループはアラート発生時に通知や自動化アクションを実行する機能ですが、アクショングループ自体がアラート状態を直接変更することはありません。また、アラートの保持期間は状態とは無関係で、古いアラートが自動的にクローズ状態になることもありません。

| 状態 | 説明 | 遷移条件 |
| :--- | :--- | :--- |
| 新規 | アラート条件が初めて検出された | 監視条件が閾値を超過 |
| 確認済み | 管理者が確認した | 管理者による手動確認 |
| クローズ | 条件が解消された | 監視条件が正常範囲に復帰 |

**リファレンス**

*   Azure Monitor
*   Alert Rule
*   Action Group

**問題 247. VM3 が技術要件を満たしていないことが判明しました。この問題が NSG (ネットワークセキュリティグループ) に関連しているかどうかを検証します。どのツールを使用しますか。（一つ選択）**

*   Azure Monitor の Diagnostic settings
*   Azure Network Watcher の IP flow verify
*   Azure Advisor の Security recommendations
*   VNet1 の Topology
*   Azure Network Watcher の NSG diagnostics

**解答例**

*   Azure Network Watcher の IP flow verify

**解説**
NSG に起因するネットワーク接続の問題を診断する場合、Azure Network Watcher の IP flow verify 機能が最適です。この機能は、特定の VM から送信または受信されるパケットが、NSG ルールによって許可または拒否されているかを即座に検証できます。送信元 IP、宛先 IP、ポート番号、プロトコルを指定することで、どの NSG ルールが適用されているかを特定し、通信が許可されているか拒否されているかを判定します。

他の選択肢について、Azure Monitor の Diagnostic settings は診断ログの収集設定であり、リアルタイムの NSG 検証には適していません。Azure Advisor の Security recommendations はセキュリティのベストプラクティス推奨を提供しますが、特定の NSG ルール検証には使用できません。VNet1 の Topology はネットワーク構成の可視化に有用ですが、NSG ルールの動作検証機能はありません。NSG diagnostics は実在しない機能名です。

IP flow verify は、VM 単位でのパケットフロー検証を 5 タプル (送信元 IP、宛先 IP、送信元ポート、宛先ポート、プロトコル) で実行し、適用されている NSG ルールを即座に特定できるため、NSG 関連の問題切り分けに最も効果的です。

| 機能 | 用途 | NSG 検証 |
| :--- | :--- | :--- |
| IP flow verify | パケット許可/拒否の即時検証 | 可能 |
| Diagnostic settings | ログ収集設定 | 不可 |
| Security recommendations | セキュリティ推奨事項 | 不可 |

**リファレンス**

*   Azure Network Watcher
*   Network Security Group
*   IP flow verify

**問題 248. Azure Storage アカウント storage1 に対して Azure AD 認証を構成します。Group1 のメンバーが Azure portal を使用してファイルをアップロードできるようにします。ソリューションは最小特権の原則に従う必要があります。Group1 に割り当てる必要があるロールはどれですか。（二つ選択）**

*   Storage Blob Data Contributor
*   Storage Account Contributor
*   Reader
*   Contributor
*   Storage Blob Data Reader

**解答例**

*   Storage Blob Data Contributor
*   Reader

**解説**
Azure portal を使用して Blob Storage にファイルをアップロードするには、データプレーンとコントロールプレーンの両方に対する適切なアクセス許可が必要です。最小特権の原則に従い、必要最小限のロールを組み合わせて割り当てます。

Storage Blob Data Contributor ロールは、Blob コンテナーとデータの読み取り、書き込み、削除を許可するデータプレーンのロールです。このロールにより、Group1 のメンバーは Blob に対してファイルのアップロード操作を実行できます。

Reader ロールは、Azure リソースの表示を許可するコントロールプレーンのロールです。Azure portal で Storage アカウントやコンテナーに移動してアクセスするには、このロールが必要です。Reader ロールがないと、portal の UI でリソースを参照できません。

Storage Blob Data Reader は読み取り専用のため、ファイルのアップロードには不十分です。Contributor や Storage Account Contributor は、Storage アカウント自体の管理権限を含むため、最小特権の原則に反します。

| ロール | 用途 | 必要性 |
| :--- | :--- | :--- |
| Storage Blob Data Contributor | Blob データの読み書き削除 | 必須 |
| Reader | リソースの表示とナビゲーション | 必須 |
| Storage Blob Data Reader | Blob データの読み取りのみ | 不十分 |

**リファレンス**

*   Azure RBAC (Role-Based Access Control)
*   Storage Blob Data Contributor
*   Principle of Least Privilege

**問題 249. Azure 仮想マシン VM1 を運用しています。VM1 からイベントを収集しており、VM1 のシステムイベントログにエラーが記録された際に管理者へ通知するアラートルールを Azure Monitor で作成します。監視対象として指定すべきリソースタイプを選択してください。（一つ選択）**

*   Azure Monitor Metrics アラート
*   仮想マシン
*   Log Analytics ワークスペース
*   Azure Diagnostics 拡張機能

**解答例**

*   Log Analytics ワークスペース

**解説**
イベントログの監視には Log Analytics ワークスペースを指定します。Azure 仮想マシンのシステムイベントログやアプリケーションログなどのログデータは、Log Analytics ワークスペースに収集され、Kusto Query Language (KQL) を使用してクエリできます。

Azure Monitor のアラートルールでログベースのアラートを作成する場合、監視対象リソースタイプとして Log Analytics ワークスペースを指定し、KQL クエリでイベントログの条件を定義します。例えば、Windows システムイベントログのエラーレベルイベントを検出するには、Event テーブルに対してクエリを実行します。

仮想マシン自体を監視対象に指定するのはメトリックベースのアラート (CPU 使用率やメモリ使用率など) の場合です。ログベースのアラートでは Log Analytics ワークスペースが適切なリソースタイプとなります。

| 監視タイプ | リソースタイプ | 用途 |
| :--- | :--- | :--- |
| ログベース | Log Analytics ワークスペース | イベントログ、アプリケーションログの監視 |
| メトリックベース | 仮想マシン | CPU、メモリ、ディスクなどのパフォーマンス監視 |
| 診断データ収集 | Azure Diagnostics 拡張機能 | ログやメトリックの収集設定 |

Azure Diagnostics 拡張機能は仮想マシンにインストールしてログやメトリックを収集する役割を持ちますが、アラートルールの監視対象リソースタイプとしては指定しません。

**リファレンス**

*   Log Analytics Workspace
*   Kusto Query Language (KQL)

**問題 250. ある Azure 環境において、Subscription1 と Subscription2 という 2 つのサブスクリプションが存在します。Subscription1 には、Windows Server 2016 を実行する Server1 という仮想マシンがデプロイされており、マネージドディスクを使用しています。Server1 を Subscription2 に移動する必要があります。この際、管理作業を最小限に抑える必要があります。最初に実行すべき操作を選択してください。（一つ選択）**

*   Azure PowerShell から Move-AzResource コマンドレットを実行する
*   Subscription2 内で仮想ディスクのコピーを作成する
*   仮想ディスクのスナップショットを作成する
*   Azure Portal からリソースの移動機能を使用する

**解答例**

*   Azure PowerShell から Move-AzResource コマンドレットを実行する

**解説**
異なるサブスクリプション間で Azure リソースを移動する場合、Move-AzResource コマンドレット (旧 Move-AzureRmResource) を使用することで、最も効率的に移動を実行できます。このコマンドレットは、仮想マシンとその関連リソース (マネージドディスク、ネットワークインターフェイス、パブリック IP アドレスなど) を一括して移動できるため、管理作業を最小限に抑えることができます。

マネージドディスクを使用している仮想マシンの場合、ディスクのスナップショットを作成してコピーする方法も可能ですが、この方法では仮想マシンの再作成が必要となり、ネットワーク設定やその他の構成を手動で再設定する必要があります。また、Subscription2 内で仮想ディスクのコピーを作成する方法も同様に、追加の手動作業が発生します。

Move-AzResource コマンドレットを使用する際の基本的な構文は以下の通りです。

`Move-AzResource -DestinationSubscriptionId <サブスクリプション ID> -DestinationResourceGroupName <リソースグループ名> -ResourceId <リソース ID>`

移動操作を実行する前に、移動元と移動先の両方のサブスクリプションに対する適切なアクセス許可 (共同作成者ロール以上) が必要です。また、移動先のサブスクリプションでは、移動するリソースのリソースプロバイダーが登録されている必要があります。

| 移動方法 | 管理作業 | 再構成の必要性 |
| :--- | :--- | :--- |
| Move-AzResource コマンドレット | 最小限 | 不要 |
| スナップショット経由の移動 | 多い | 必要 |
| 手動コピーと再作成 | 最大 | 必要 |

**リファレンス**

*   Move-AzResource コマンドレット

**問題 251. Azure サブスクリプションを管理しています。PowerShell から特定ユーザーに対して Get-MgUser コマンドレットを実行したところ、以下の情報が返されました。**

`Id: 0755b347-3545-3876-3987-098989898989, DisplayName: 山田太郎, Mail: tyamada@hogehoge.com UserPrincipalName: tyamada_hogehoge.com#EXT#@foobar.com`

**このユーザーについて正しく説明しているものはどれですか。（一つ選択）**

*   このユーザーアカウントは削除されています
*   このユーザーはテナント内のゲストユーザーです
*   このユーザーには管理者ロールが割り当てられています
*   このユーザーアカウントは無効化されています

**解答例**

*   このユーザーはテナント内のゲストユーザーです

**解説**
UserPrincipalName 属性の形式から、このユーザーがゲストユーザー (外部ユーザー) であることを判断できます。

Microsoft Entra ID (旧 Azure Active Directory) では、外部組織のユーザーを自組織のテナントに招待する際、B2B (Business-to-Business) コラボレーション機能を使用します。招待されたゲストユーザーの UserPrincipalName には、元のメールアドレスのドメイン部分が「#EXT#」という文字列を含む特殊な形式で表現されます。この問題では tyamada_hogehoge.com#EXT#@foobar.com という形式になっており、元のメールアドレス tyamada@hogehoge.com のユーザーが foobar.com テナントにゲストとして招待されていることを示しています。

アカウントの無効化や削除の状態は、AccountEnabled プロパティや DeletedDateTime プロパティなど別の属性で確認します。また管理者ロールの割り当ては、Get-MgUser コマンドレットの出力だけでは判断できず、Get-MgDirectoryRole など別のコマンドレットで確認する必要があります。

| 属性 | 説明 |
| :--- | :--- |
| UserPrincipalName | ユーザーのサインイン名。ゲストユーザーの場合は #EXT# を含む形式 |
| Mail | ユーザーの実際のメールアドレス |
| AccountEnabled | アカウントの有効 / 無効状態を示すブール値 |

**リファレンス**

*   UserPrincipalName
*   Get-MgUser

**問題 252. Azure Monitor を使用して、仮想マシンのシステムイベントログにエラーが記録された際に管理者へ通知するアラートルールを作成します。このアラートルールで監視対象として指定すべきターゲットリソースはどれですか。（一つ選択）**

*   Azure Log Analytics ワークスペース
*   仮想マシン
*   Application Insights
*   アクティビティログ

**解答例**

*   Azure Log Analytics ワークスペース

**解説**
仮想マシンのシステムイベントログを監視してアラートを発行するには、Azure Log Analytics ワークスペースをターゲットリソースとして指定する必要があります。

仮想マシンのイベントログは、Log Analytics エージェント (Azure Monitor エージェント) を仮想マシンにインストールすることで Log Analytics ワークスペースに収集されます。収集されたログデータは Kusto クエリ言語 (KQL) を使用して分析でき、ログクエリアラートルールを作成することで特定の条件 (エラーイベントの発生など) を検知して通知を送信できます。

メトリックアラートは CPU 使用率やメモリ使用量などの数値データを監視する際に使用しますが、イベントログのようなログデータの監視には適していません。仮想マシン自体をターゲットリソースとして直接指定することはできず、ログデータが集約される Log Analytics ワークスペースを指定する必要があります。

| 監視対象 | 使用するアラートタイプ | ターゲットリソース |
| :--- | :--- | :--- |
| イベントログ、アプリケーションログ | ログクエリアラート | Log Analytics ワークスペース |
| CPU 使用率、メモリ使用量 | メトリックアラート | 仮想マシン |
| リソースの作成、削除操作 | アクティビティログアラート | サブスクリプション |

**リファレンス**

*   Azure Monitor
*   Log Analytics Workspace

**問題 253. Azure サブスクリプション「Subscription-A」に以下のリソースが含まれています。このサブスクリプションに「FW-A」という名前の Azure Firewall を東日本リージョンの RG-A にデプロイします。FW-A をデプロイ可能な仮想ネットワークを選択してください。（一つ選択）**

| 名前 | Azure リージョン | リソースグループ |
| :--- | :--- | :--- |
| VNet-A | 東日本 | RG-A |
| VNet-B | 西日本 | RG-A |
| VNet-C | 西日本 | RG-B |
| VNet-D | 東日本 | RG-B |

*   VNet-A、VNet-D
*   VNet-A
*   VNet-A、VNet-B、VNet-C、VNet-D
*   VNet-A、VNet-B

**解答例**

*   VNet-A

**解説**
Azure Firewall をデプロイする際は、同一リージョンかつ同一リソースグループ内の仮想ネットワークにのみデプロイ可能です。

FW-A は東日本リージョンの RG-A にデプロイする必要があるため、デプロイ先の仮想ネットワークも東日本リージョンかつ RG-A に属している必要があります。表を確認すると、この条件を満たすのは VNet-A のみです。

VNet-B は同じ RG-A に属していますが西日本リージョンにあるため、リージョンの制約により選択できません。VNet-D は東日本リージョンにありますが、RG-B に属しているためリソースグループの制約により選択できません。VNet-C は西日本リージョンかつ RG-B に属しているため、両方の制約により選択できません。

Azure Firewall は仮想ネットワーク内の専用サブネット「AzureFirewallSubnet」にデプロイされ、ネットワークトラフィックのフィルタリングと保護を提供します。デプロイ時には、Firewall リソースと仮想ネットワークが同じリージョンとリソースグループに配置される必要があります。

| 条件 | 要件 | 該当 |
| :--- | :--- | :--- |
| リージョン | 東日本 | VNet-A、VNet-D |
| リソースグループ | RG-A | VNet-A、VNet-B |
| 両方を満たす | 東日本かつ RG-A | VNet-A |

**リファレンス**

*   Azure Firewall
*   Azure Virtual Network
*   Resource group

**問題 254. 複数のオンプレミス拠点と Azure 仮想ネットワーク間にルートベースのサイト間 VPN 接続を展開します。使用すべきトンネリングプロトコルを選択してください。（一つ選択）**

*   SSTP
*   IKEv2
*   PPTP
*   L2TP

**解答例**

*   IKEv2

**解説**
Azure のルートベースサイト間 VPN 接続では、IKEv2 (Internet Key Exchange version 2) プロトコルを使用します。ルートベース VPN は動的ルーティングプロトコルを使用し、複数の拠点間接続やポイント対サイト接続との併用が可能です。

IKEv2 は、IPsec VPN 接続の確立と管理を行うプロトコルで、Azure のサイト間 VPN 接続における標準プロトコルです。高い安全性と柔軟性を提供し、NAT (Network Address Translation) 環境下でも動作します。また、モバイルデバイスの接続が切断された際の自動再接続機能も備えています。

PPTP と L2TP は古い VPN プロトコルで、Azure のサイト間 VPN 接続では使用されません。SSTP はポイント対サイト VPN 接続で使用可能ですが、サイト間 VPN 接続には対応していません。

| プロトコル | 用途 | 特徴 |
| :--- | :--- | :--- |
| IKEv2 | サイト間 VPN | 標準プロトコル、高セキュリティ |
| SSTP | ポイント対サイト VPN | Windows 専用、ファイアウォール通過 |
| PPTP | 非推奨 | 古いプロトコル、低セキュリティ |

Azure では、VPN Gateway のルートベース構成を使用することで、複数のオンプレミス拠点との接続を効率的に管理できます。各拠点の VPN デバイスは、IKEv2 をサポートしている必要があります。

**リファレンス**

*   VPN Gateway
*   IKEv2 (Internet Key Exchange version 2)
*   Site-to-Site VPN

**問題 255. あなたの組織には、Subscription-Alpha という名前の Azure サブスクリプションがあります。組織には、Windows Server 2022 を実行する Server-Primary と Server-Manage という 2 つのオンプレミスサーバーがあります。Server-Primary は、hogehoge-corp.com という名前のプライマリ DNS ゾーンを持つ DNS サーバーとして構成されています。hogehoge-corp.com には 1,000 の DNS レコードが含まれています。Server-Primary と Subscription-Alpha を Server-Manage から管理しています。Server-Manage には、DNS マネージャーコンソール、Azure PowerShell、Azure CLI がインストールされています。hogehoge-corp.com ゾーンを Subscription-Alpha の Azure DNS ゾーンに移行します。ソリューションでは、管理労力を最小限に抑える必要があります。このとき、どのツールを使用しますか。（一つ選択）**

*   Azure Portal
*   DNS マネージャーコンソール
*   Azure CLI
*   Azure PowerShell

**解答例**

*   Azure CLI

**解説**
この問題の最重要ポイントは、オンプレミス DNS サーバーから大量の DNS レコードを Azure DNS に効率的に移行する方法を理解することです。1,000 件の DNS レコードを手動で移行するのは非現実的であり、自動化ツールの使用が必須となります。

Azure CLI は、DNS ゾーンファイルのインポート機能を提供しており、az network dns zone import コマンドを使用することで、標準的なゾーンファイル形式から Azure DNS へ一括でレコードを移行できます。この方法では、まずオンプレミス DNS サーバーからゾーンファイルをエクスポートし、そのファイルを Azure CLI でインポートすることで、すべての DNS レコードを効率的に移行できます。

Azure PowerShell にも同様の機能がありますが、DNS ゾーンファイルの直接インポートについては Azure CLI の方が標準的なアプローチとして推奨されています。Azure Portal は個別レコードの手動入力には適していますが、大量レコードの一括移行には適していません。DNS マネージャーコンソール はオンプレミス DNS の管理には使用できますが、Azure DNS への直接的な移行機能は提供していません。

| ツール | ゾーンファイルインポート | 大量レコード移行 |
| :--- | :--- | :--- |
| Azure CLI | 対応 | 最適 |
| Azure PowerShell | 対応 | 可能 |
| Azure Portal | 非対応 | 不適 |

**リファレンス**

*   Azure DNS
*   Azure CLI

**問題 256. Azure サブスクリプションを所有しています。すべてのユーザーに対して Enterprise Mobility + Security E5 ライセンスをアクティブ化しました。ユーザーが仮想マシンを作成する前に承認を要求するようにします。最初に構成すべきものはどれですか。（一つ選択）**

*   Azure Active Directory Privileged Identity Management for Azure resource roles
*   Azure Active Directory Authentication methods
*   Azure Active Directory Conditional Access policies
*   Azure Policy

**解答例**

*   Azure Active Directory Privileged Identity Management for Azure resource roles

**解説**
仮想マシンの作成など Azure リソースへの操作に対して承認プロセスを要求する場合、Azure Active Directory Privileged Identity Management (PIM) の Azure リソースロール機能を使用します。PIM は特権アクセス管理を提供し、Just-In-Time (JIT) アクセスと承認ワークフローを実装できます。

Enterprise Mobility + Security E5 ライセンスには PIM が含まれており、Azure リソースに対するロールの割り当てに承認プロセスを追加できます。ユーザーが仮想マシンを作成するには、通常「仮想マシン共同作成者」などのロールが必要ですが、PIM を構成することで、このロールの有効化時に承認者による承認を必須とすることができます。

Conditional Access policies は認証時の条件付きアクセス制御を提供しますが、リソース作成の承認ワークフローは提供しません。Authentication methods は認証方法の設定であり、承認プロセスとは無関係です。Azure Policy はリソースのコンプライアンスを管理しますが、承認ワークフローは提供しません。

| 機能 | 用途 | 承認ワークフロー |
| :--- | :--- | :--- |
| PIM for Azure resource roles | Azure リソース操作の特権管理 | 対応 |
| Conditional Access | 認証時のアクセス制御 | 非対応 |
| Azure Policy | リソースのコンプライアンス管理 | 非対応 |

PIM の設定では、対象となる Azure ロールを選択し、ロールの有効化に承認を要求する設定を有効化します。承認者を指定することで、ユーザーがロールを有効化する際に承認プロセスが実行されます。

**リファレンス**

*   Azure Active Directory Privileged Identity Management
*   Just-In-Time Access
*   Azure RBAC (Role-Based Access Control)

**問題 257. 複数の管理グループと Azure サブスクリプションを運用しています。リソースの誤削除を防止するため、削除ロックを適用できるリソースタイプを 3 つ選択します。（該当するものをすべて選択）**

*   仮想マシン
*   サブスクリプション
*   リソースグループ
*   ストレージアカウントのデータ
*   管理グループ

**解答例**

*   仮想マシン
*   サブスクリプション
*   リソースグループ

**解説**
Azure リソースロックは、リソースの誤削除や変更を防止するための機能です。削除ロック (CanNotDelete) を適用すると、承認されたユーザーでもリソースの削除が制限されます。

削除ロックを適用できるのは、サブスクリプション、リソースグループ、個別リソース (仮想マシンなど) の 3 つのスコープです。管理グループレベルではロックを直接適用できません。また、ストレージアカウント内のデータ (Blob や File など) は個別リソースではなくデータオブジェクトであるため、リソースロックの対象外です。

リソースロックには 2 種類あります。ReadOnly ロックは読み取り専用とし変更と削除を防止します。CanNotDelete ロックは削除のみを防止し、変更は許可します。ロックは継承されるため、上位スコープで設定すると配下のすべてのリソースに適用されます。

| ロックタイプ | 削除 | 変更 |
| :--- | :--- | :--- |
| CanNotDelete | 不可 | 可能 |
| ReadOnly | 不可 | 不可 |

| 適用スコープ | 削除ロック適用 |
| :--- | :--- |
| サブスクリプション | 可能 |
| リソースグループ | 可能 |
| 個別リソース | 可能 |
| 管理グループ | 不可 |
| データオブジェクト | 不可 |

**リファレンス**

*   Management Group
*   Resource group

**問題 258. Azure サブスクリプション内に以下のリソースが存在します。VNet-A のサブネットに接続された 5 台の仮想マシンから、Microsoft バックボーンネットワークを経由してストレージアカウント 2 つ (storage-hogehoge、storage-foobar)、Key Vault (KeyVault-hogehoge)、および Microsoft Entra ID へのアクセスを構成します。この要件を満たすために、VNet-A のサブネットに追加する必要があるサービスエンドポイントの最小数はいくつですか。（一つ選択）**

| リソース名 | 種類 | 説明 |
| :--- | :--- | :--- |
| storage-hogehoge | ストレージアカウント | 汎用 v2 ストレージ |
| storage-foobar | ストレージアカウント | 汎用 v2 ストレージ |
| KeyVault-hogehoge | Key Vault | シークレット管理 |
| VNet-A | 仮想ネットワーク | 5 台の VM が接続 |
| VNet-B | 仮想ネットワーク | 3 台の VM が接続 |

*   4
*   1
*   3
*   2

**解答例**

*   2

**解説**
この問題では、VNet-A のサブネットから複数の Azure PaaS サービスへ Microsoft バックボーン経由でアクセスするために必要なサービスエンドポイントの最小数を問われています。

サービスエンドポイントは、仮想ネットワークのサブネットから特定の Azure サービスへの直接接続を提供する機能です。サービスエンドポイントを有効化すると、トラフィックは Microsoft バックボーンネットワークを経由し、パブリックインターネットを通過しません。重要な点は、サービスエンドポイントはサービスの種類ごとに設定され、同じ種類のサービスであれば 1 つのエンドポイントで複数のリソースインスタンスをカバーできることです。

要件を分析すると、storage-hogehoge と storage-foobar の 2 つのストレージアカウントは同じサービス種類 (Microsoft.Storage) であるため、1 つのサービスエンドポイントで両方にアクセス可能です。KeyVault-hogehoge には Microsoft.KeyVault のサービスエンドポイントが必要です。Microsoft Entra ID は Azure のグローバルサービスであり、サービスエンドポイントの対象外です。VNet-B への接続は仮想ネットワークピアリングで実現され、サービスエンドポイントは不要です。

したがって、必要なサービスエンドポイントは Microsoft.Storage と Microsoft.KeyVault の 2 つです。

| サービス種類 | 対象リソース | エンドポイント数 |
| :--- | :--- | :--- |
| Microsoft.Storage | storage-hogehoge, storage-foobar | 1 |
| Microsoft.KeyVault | KeyVault-hogehoge | 1 |
| 仮想ネットワークピアリング | VNet-B | 0 (不要) |

**リファレンス**

*   仮想ネットワークサービスエンドポイント
*   Azure Storage
*   Azure Key Vault

**問題 259. Azure 環境にサブスクリプション「Subscription-A」があり、Authorization、Automation、Resources、Compute、KeyVault、Network、Storage、Billing、Web、Security のリソースプロバイダーが登録されています。仮想マシン VM-A (Windows Server 2019、プライベート IP: 192.168.0.4、サブネット: 192.168.0.0/24、NSG: NSG-A、東アジアリージョン) が存在します。VM-A への接続試行の成功と失敗をすべて記録します。実施する手順はどれですか。（3 つ選択）**

*   東アジアリージョンで Azure Network Watcher を有効にする
*   Azure Network Watcher NSG フローログを有効にする
*   Microsoft.Insights リソースプロバイダーを登録する
*   Azure Storage アカウントを作成する
*   Azure Network Watcher 接続モニターを追加する
*   Log Analytics ワークスペースを作成する

**解答例**

*   東アジアリージョンで Azure Network Watcher を有効にする
*   Azure Network Watcher NSG フローログを有効にする
*   Azure Storage アカウントを作成する

**解説**
VM-A への接続試行を記録するには、NSG フローログを使用します。NSG フローログは、ネットワークセキュリティグループを通過する IP トラフィックの情報を記録する機能で、接続の成功と失敗の両方を追跡できます。

NSG フローログを実装するには 3 つの前提条件があります。まず、VM-A が配置されている東アジアリージョンで Network Watcher を有効化する必要があります。Network Watcher はリージョンごとのサービスのため、対象リソースと同じリージョンで有効化が必須です。次に、フローログデータを保存するための Storage アカウントが必要です。NSG フローログは JSON 形式で Storage アカウントに保存されます。最後に、NSG-A で NSG フローログ機能を有効化します。

Microsoft.Insights リソースプロバイダーは診断設定やメトリックに関連しますが、NSG フローログの必須要件ではありません。接続モニターはエンドポイント間の接続性を監視する機能ですが、NSG レベルのトラフィック記録には使用しません。Log Analytics ワークスペースはフローログの高度な分析に利用できますが、基本的なログ記録には必須ではありません。

| 手順 | 目的 | 必須 |
| :--- | :--- | :--- |
| Network Watcher 有効化 | リージョンでの監視機能提供 | はい |
| Storage アカウント作成 | フローログデータの保存先 | はい |
| NSG フローログ有効化 | トラフィック記録の開始 | はい |

**リファレンス**

*   Azure Network Watcher
*   NSG Flow Logs
*   Azure Storage

**問題 260. App1 という名前のアプリケーションが、VM1 と VM2 という 2 台の Azure 仮想マシンにインストールされています。App1 への接続は Azure Load Balancer を使用して管理されています。**

**VM2 の有効なネットワークセキュリティ構成を確認したところ、IP アドレス 131.107.100.50 から TCP ポート 443 経由で App1 への接続が失敗することが判明しました。Load Balancer のルールが正しく構成されていることは確認済みです。この問題を解決するために、BlockAllOther443 という名前のインバウンドセキュリティ規則を削除します。この解決策は目標を達成できますか。（一つ選択）**

*   いいえ、この解決策では目標を達成できません
*   はい、この解決策で目標を達成できます

**解答例**

*   いいえ、この解決策では目標を達成できません

**解説**
Azure Load Balancer を使用する環境では、トラフィックの流れとネットワークセキュリティグループ (NSG) の評価順序を正確に理解する必要があります。

Load Balancer を経由するトラフィックは、まず Load Balancer のヘルスプローブとロードバランシング規則によって処理され、その後バックエンドプールの各仮想マシンに分散されます。この際、送信元 IP アドレスは保持されますが、NSG の評価は Load Balancer を通過した後、各仮想マシンのネットワークインターフェイスレベルで行われます。

BlockAllOther443 規則を削除しても問題が解決しない理由は、Load Balancer のヘルスプローブが正常に機能していない可能性や、より優先度の高い拒否規則が存在する可能性があるためです。NSG 規則は優先度順に評価され、最初に一致した規則が適用されます。優先度は 100 から 4096 の数値で指定され、数値が小さいほど優先度が高くなります。

問題を正しく解決するには、NSG 規則全体の優先度と内容を確認し、131.107.100.50 からの TCP ポート 443 トラフィックを明示的に許可する規則が適切な優先度で設定されているかを検証する必要があります。また、Load Balancer のヘルスプローブ設定とバックエンドプールの正常性状態も併せて確認すべきです。

| 確認項目 | 内容 |
| :--- | :--- |
| NSG 規則の優先度 | 100-4096 の範囲で小さい値ほど優先 |
| Load Balancer ヘルスプローブ | バックエンド VM の正常性確認 |
| 規則の評価順序 | 優先度順に評価し最初の一致で決定 |

**リファレンス**

*   Azure Load Balancer
*   Network Security Group
*   ヘルスプローブ

**問題 261. Azure Blob Storage コンテナに ARM テンプレートファイル deploy.json を保存しています。New-AzDeployment コマンドレットを実行してこのテンプレートをデプロイします。テンプレートを参照するために使用するパラメータはどれですか。（一つ選択）**

*   -TemplateUri
*   -TemplateParameterFile
*   -TemplateSpecId
*   -TemplateFile

**解答例**

*   -TemplateUri

**解説**
Azure Blob Storage に保存された ARM テンプレートをデプロイする場合、テンプレートファイルの場所を URL 形式で指定する必要があります。New-AzDeployment コマンドレットでリモートストレージ上のテンプレートを参照する際は -TemplateUri パラメータを使用します。

-TemplateUri パラメータは HTTPS プロトコルを使用してアクセス可能なテンプレートファイルの URL を指定します。Azure Blob Storage に保存されたテンプレートの場合、Blob Storage のエンドポイント URL を指定することでテンプレートにアクセスできます。パブリックアクセスが無効な場合は SAS (Shared Access Signature) トークンを含む URL を使用します。

-TemplateFile パラメータはローカルファイルシステム上のテンプレートファイルパスを指定する際に使用します。-TemplateSpecId パラメータは Template Specs リソースとして登録済みのテンプレートを参照する際に使用します。-TemplateParameterFile パラメータはテンプレートのパラメータファイルを指定する際に使用します。

| パラメータ | 用途 | 指定内容 |
| :--- | :--- | :--- |
| -TemplateUri | リモートテンプレート参照 | HTTPS URL |
| -TemplateFile | ローカルテンプレート参照 | ローカルファイルパス |
| -TemplateSpecId | Template Specs 参照 | リソース ID |

**リファレンス**

*   ARM Template
*   Azure Blob Storage
*   Template Specs

**問題 262. あなたの組織が所有する Azure サブスクリプション「Subscription-A」には、以下のリソースがあります。Subnet-A という名前のサブネットを持つ仮想ネットワーク、NSG-VM-A および NSG-Subnet-A という名前の 2 つの Network Security Group (NSG)、リモートデスクトップ接続を許可するために必要な Windows Server 構成を備えた VM-A という名前の仮想マシンです。NSG-Subnet-A にはデフォルトの受信セキュリティルールのみがあります。NSG-VM-A にはデフォルトの受信セキュリティルールと、優先度 100、送信元 Any、送信元ポート範囲 \*、宛先 \*、宛先ポート範囲 3389、プロトコル UDP、アクション Allow のカスタム受信セキュリティルールがあります。VM-A にはパブリック IP アドレスがあり、Subnet-A に接続されています。NSG-VM-A は VM-A のネットワークインターフェイスに関連付けられ、NSG-Subnet-A は Subnet-A に関連付けられています。インターネットから VM-A へのリモートデスクトップ接続を確立します。解決策として、NSG-Subnet-A に受信セキュリティルールを追加します。このルールでは任意の送信元からポート範囲 3389 の宛先 \* への接続を許可し、TCP プロトコルを使用します。さらに NSG-VM-A を VM-A のネットワークインターフェイスから削除します。この解決策は目標を達成しますか。（一つ選択）**

*   いいえ
*   はい

**解答例**

*   はい

**解説**
この解決策は目標を達成します。リモートデスクトップ接続は TCP プロトコルのポート 3389 を使用するため、正しいプロトコルとポートでの通信許可が必要です。

現在の構成では、NSG-VM-A に優先度 100 のカスタムルールがありますが、プロトコルが UDP に設定されているため、TCP ベースのリモートデスクトップ接続は機能しません。Network Security Group では、サブネットレベルとネットワークインターフェイスレベルの両方に NSG が関連付けられている場合、両方のルールセットが評価されます。

提案された解決策では、NSG-VM-A をネットワークインターフェイスから削除することで、誤った UDP ルールの影響を排除します。同時に NSG-Subnet-A に正しい TCP プロトコルでポート 3389 を許可するルールを追加することで、サブネットレベルでリモートデスクトップ接続が許可されます。この構成により、インターネットから VM-A へのリモートデスクトップ接続が正常に確立できます。

| 項目 | 設定内容 | 結果 |
| :--- | :--- | :--- |
| NSG-Subnet-A | TCP 3389 許可ルール追加 | RDP 接続許可 |
| NSG-VM-A | ネットワークインターフェイスから削除 | 誤った UDP ルール排除 |
| 最終的な通信 | TCP ポート 3389 | 接続成功 |

**リファレンス**

*   Network Security Group
*   リモートデスクトップ接続
*   受信セキュリティルール

**問題 263. あなたは Subscription1 という名前の Azure サブスクリプションを管理しています。Subscription1 には VM1 という名前の仮想マシンが含まれています。あなたは Windows 10 を実行する Computer1 という名前のコンピューターを使用しており、このコンピューターはインターネットに接続されています。VM1 に Interface1 という名前のネットワークインターフェイスを追加しました。このネットワークインターフェイスには、DenyAllInBound という名前の受信ポート規則と DenyAllOutBound という名前の送信ポート規則が設定されています。Computer1 からリモートデスクトップを使用して VM1 に接続を試みましたが、接続に失敗しました。VM1 へのリモートデスクトップ接続を確立するために、最初に実行すべき操作を選択してください。（一つ選択）**

*   DenyAllInBound 受信ポート規則を削除する
*   VM1 を起動する
*   ネットワークセキュリティグループに RDP 許可規則を追加する
*   DenyAllOutBound 送信ポート規則を削除する

**解答例**

*   DenyAllInBound 受信ポート規則を削除する

**解説**
リモートデスクトップ接続が失敗する最も一般的な原因は、ネットワークセキュリティグループ (NSG) の受信規則によって RDP トラフィックがブロックされていることです。この問題では、DenyAllInBound という名前の受信ポート規則がすべての受信トラフィックを拒否しているため、Computer1 から VM1 への RDP 接続 (TCP ポート 3389) が確立できません。

リモートデスクトップ接続を確立するには、まずこの受信規則を削除または変更して、RDP トラフィックを許可する必要があります。DenyAllInBound 規則を削除することで、既定の NSG 規則またはより優先度の高い許可規則が適用され、RDP 接続が可能になります。

送信ポート規則 (DenyAllOutBound) は、VM1 から外部への通信を制御するものであり、Computer1 から VM1 への接続には直接影響しません。また、VM1 が既に起動している場合、再起動は問題解決にはなりません。ネットワークインターフェイスは既に追加されているため、追加のアタッチ操作も不要です。

| 規則の種類 | 影響範囲 | RDP 接続への影響 |
| :--- | :--- | :--- |
| DenyAllInBound | VM1 への受信トラフィック | RDP 接続をブロック (解決必須) |
| DenyAllOutBound | VM1 からの送信トラフィック | RDP 接続には影響なし |

NSG の受信規則は優先度順に評価され、最初に一致した規則が適用されます。DenyAllInBound 規則を削除した後、RDP トラフィックを明示的に許可する規則を追加することがベストプラクティスです。この規則では、送信元 IP アドレスを Computer1 のパブリック IP アドレスに制限し、宛先ポートを 3389 に設定することでセキュリティを強化できます。

**リファレンス**

*   Network Security Group
*   リモートデスクトッププロトコル

**問題 264. Azure Storage アカウント storage1 があります。storage1 に対して、Scope1 という名前の暗号化スコープを作成しました。Scope1 を使用して暗号化できるストレージの種類はどれですか。（一つ選択）**

*   コンテナーとファイル共有のみ
*   コンテナー、ファイル共有、およびテーブルのみ
*   コンテナーのみ
*   ファイル共有のみ
*   コンテナー、ファイル共有、テーブル、およびキューすべて

**解答例**

*   コンテナーとファイル共有のみ

**解説**
暗号化スコープは、Azure Storage アカウント内のデータを暗号化する際に使用する暗号化キーの管理単位です。暗号化スコープを利用することで、Blob Storage と Azure Files に対して、より細かい粒度で暗号化キーを管理できます。

暗号化スコープが適用可能なストレージサービスは、Blob Storage (コンテナー) と Azure Files (ファイル共有) の 2 つのみです。Table Storage や Queue Storage には暗号化スコープを適用できません。これらのサービスは、ストレージアカウントレベルの暗号化のみをサポートしています。

暗号化スコープを作成する際は、Microsoft マネージドキーまたはカスタマーマネージドキー (Azure Key Vault に保存) のいずれかを選択できます。作成後、Blob のアップロード時やファイル共有の作成時に、特定の暗号化スコープを指定することで、そのスコープに関連付けられた暗号化キーでデータが保護されます。

| ストレージサービス | 暗号化スコープ対応 |
| :--- | :--- |
| Blob Storage | 対応 |
| Azure Files | 対応 |
| Table Storage | 非対応 |
| Queue Storage | 非対応 |

暗号化スコープは、コンプライアンス要件や規制要件に対応するため、データの暗号化キーを論理的に分離する必要がある場合に有効です。例えば、部門ごとや顧客ごとに異なる暗号化キーを使用してデータを保護するシナリオで活用できます。







ご指定いただいたソース（PDFの各ページ画像～）に含まれる文章を、一文字も省略することなく、全文そのまま書き起こして出力します。

---

****
**リファレンス**
*   Blob Storage
*   Azure Files

****
**問題 265. Azure サブスクリプション内に Linux 仮想マシンを展開しました。この仮想マシンのメトリックとログを監視する必要があります。どのツールを使用しますか。（一つ選択）**
*   Azure Monitor エージェント
*   Azure HDInsight
*   Azure Analysis Services
*   Linux Diagnostic Extension (LAD) 3.0

****
**解答例**
*   Azure Monitor エージェント

**解説**
Azure 仮想マシンのメトリックとログを収集するには、Azure Monitor エージェントを使用します。これは Linux と Windows の両方に対応した統合監視エージェントで、パフォーマンスメトリック、イベントログ、Syslog などのデータを収集し Azure Monitor に送信します。

Linux Diagnostic Extension (LAD) は旧世代の診断拡張機能であり、現在は Azure Monitor エージェントへの移行が推奨されています。Azure Monitor エージェントは Data Collection Rules による柔軟なデータ収集設定、複数ワークスペースへの送信、Azure Arc 対応サーバーのサポートなど、LAD にはない機能を提供します。

Azure HDInsight はビッグデータ分析プラットフォーム、Azure Analysis Services はビジネスインテリジェンス向けの分析エンジンであり、仮想マシンの監視には使用しません。

| 監視ソリューション | 用途 | 対応 OS |
| :--- | :--- | :--- |
| Azure Monitor エージェント | VM のメトリックとログ収集（推奨） | Linux / Windows |
| Linux Diagnostic Extension | VM の診断データ収集（レガシー） | Linux のみ |
| Azure Analysis Services | BI データモデリングと分析 | 該当なし |

Azure Monitor エージェントは Log Analytics ワークスペースと連携し、Kusto Query Language (KQL) を使用した高度なログ分析、アラート設定、ダッシュボード作成が可能です。仮想マシンの正常性監視、パフォーマンストラブルシューティング、セキュリティ監査に不可欠なツールです。

****
**リファレンス**
*   Azure Monitor
*   Log Analytics Workspace
*   Data Collection Rules (DCR)
*   Azure Arc

****
**問題 266. Azure Event Grid に接続するカスタムの Azure Function App を構築します。Function App にリソースが動的に割り当てられるようにする必要があります。課金は実行回数に基づいて行われる必要があります。Function App を作成する際に何を構成しますか。（一つ選択）**
*   Docker Container と S1 価格レベルを使用する App Service Plan
*   Windows OS と App Service Plan ホスティングプラン
*   Linux OS と Consumption プラン
*   Windows OS と Consumption プラン

****
**解答例**
*   Windows OS と Consumption プラン

**解説**
この問題の最重要ポイントは、Azure Functions のホスティングプランの特性を理解し、動的なリソース割り当てと実行ベースの課金要件を満たすプランを選択することです。

Azure Functions には複数のホスティングプランがあり、それぞれ異なる特性を持ちます。Consumption プランは、関数の実行時にのみリソースが自動的に割り当てられ、実行回数と実行時間に基づいて課金されるサーバーレスモデルです。このプランでは、トラフィックに応じて自動的にスケールアウト・スケールインが行われ、未使用時はリソースがゼロになります。

一方、App Service Plan は専用のコンピューティングリソースを事前に確保する必要があり、実行回数に関係なく固定料金が発生します。これは継続的に実行される処理や予測可能な負荷に適していますが、本問の要件である「動的なリソース割り当て」と「実行ベースの課金」には適合しません。

Docker Container を使用する選択肢は、カスタムランタイム環境が必要な場合に有効ですが、本問ではそのような要件は示されていません。また、S1 や B1 などの価格レベルを持つ App Service Plan は固定課金モデルであり、実行ベースの課金要件を満たしません。

| プラン | リソース割り当て | 課金モデル |
| :--- | :--- | :--- |
| Consumption | 動的・自動 | 実行回数ベース |
| App Service | 固定・事前確保 | 固定料金 |
| Premium | 事前ウォーム可能 | インスタンス時間 |

したがって、Windows OS と Consumption プランの組み合わせが、動的なリソース割り当てと実行ベースの課金と****いう両方の要件を満たす正解となります。

**リファレンス**
*   Azure Functions
*   Azure Event Grid

****
**問題 267. あなたは、VM1、VM2、VM3 という 3 台の Azure 仮想マシンをデプロイする計画を立てています。これらの仮想マシンは、App1 という Web アプリケーションをホストします。単一の Azure データセンターが利用できなくなった場合でも、少なくとも 2 台の仮想マシンが利用可能であることを保証する必要があります。何をデプロイすべきですか。（一つ選択）**
*   各仮想マシンを個別の Availability Zone にデプロイする
*   すべての仮想マシンを単一の Availability Set にデプロイする
*   各仮想マシンを個別の Availability Set にデプロイする
*   すべての仮想マシンを単一の Availability Zone にデプロイする

****
**解答例**
*   各仮想マシンを個別の Availability Zone にデプロイする

**解説**
この問題の最重要ポイントは、データセンターレベルの障害に対する可用性を確保するための適切な構成を選択することです。Azure では、物理的に分離されたデータセンター間での冗長性を実現するために、Availability Zone を使用します。

Availability Zone は、Azure リージョン内の物理的に分離された場所であり、それぞれが独立した電源、冷却装置、ネットワークを備えています。各ゾーンは 1 つ以上のデータセンターで構成されており、単一のデータセンターまたはゾーン全体の障害から保護します。3 台の仮想マシンをそれぞれ異なる Availability Zone に配置することで、1 つのゾーン（データセンター）が利用できなくなっても、残りの 2 つのゾーンで稼働する仮想マシンが利用可能となり、要件を満たします。

一方、Availability Set は同一データセンター内での障害ドメインと更新ドメインによる可用性を提供しますが、データセンター全体の障害には対応できません。すべての仮想マシンを単一の Availability Zone または Availability Set に配置すると、そのゾーンやデータセンターが利用できなくなった場合、すべての仮想マシンが影響を受けます。各仮想マシンを個別の Availability Set に配置しても、同一データセンター内に配置される可能性があるため、データセンターレベルの障害には対応できません。

| 構成 | データセンター障害への対応 | 適用範囲 |
| :--- | :--- | :--- |
| Availability Zone | 対応可能 | リージョン内の複数データセンター |
| Availability Set | 対応不可 | 単一データセンター内 |

****
**リファレンス**
*   Availability Zone
*   Availability Set
*   Azure Virtual Machine

****
**問題 268. Azure Stream Analytics ジョブ「Job-A」を運用しています。入力イベントの処理状況を監視し、システムに到着したものの処理されずに滞留しているイベントの数を特定します。この目的に最も適したメトリックはどれですか。（一つ選択）**
*   入力イベントの逆シリアル化エラー
*   バックログされた入力イベント
*   透かしの遅延
*   順不同のイベント

****
**解答例**
*   バックログされた入力イベント

**解説**
Azure Stream Analytics で処理されずに滞留しているイベント数を特定するには、「バックログされた入力イベント (Backlogged Input Events)」メトリックを使用します。このメトリックは、入力ソースから受信したものの、まだジョブによって処理されていないイベントの総数を示します。

バックログされた入力イベントが増加している場合、ジョブの処理能力が入力レートに追いついていないことを意味します。この状況では、Streaming Unit (SU) の増加やクエリの最適化が必要になる可能性があります。

他の選択肢との違いを整理すると以下の通りです。

| メトリック | 説明 | 用途 |
| :--- | :--- | :--- |
| バックログされた入力イベント | 未処理で滞留中のイベント数 | 処理遅延の検出 |
| 順不同のイベント | タイムスタンプ順序が乱れたイベント数 | イベント順序の問題検出 |
| 透かしの遅延 | 最も古い未処理イベントの遅延時間 | リアルタイム性の評価 |

バックログメトリックは、ジョブのスケーリングが必要かどうかを判断する重要な指標となります。継続的に増加する場合は、入力スループットに対してジョブのリソースが不足していることを示しています。

**リファレンス**
*   Azure Stream Analytics
*   Streaming Unit
*   メトリック監視

****
**問題 269. Azure でコンテナ化された Web アプリケーションをデプロイします。Web アプリをデプロイする際に、有効なコンテナイメージソースはどれですか。（二つ選択）**
*   Azure Blob Storage
*   Docker Hub
*   Azure Container Registry
*   オンプレミスのファイルサーバー

****
**解答例**
*   Docker Hub
*   Azure Container Registry

**解説**
Azure でコンテナベースの Web アプリケーションをデプロイする場合、コンテナイメージは標準的なコンテナレジストリから取得する必要があります。Azure App Service や Azure Container Instances などのサービスは、Docker 互換のコンテナレジストリからイメージをプルする機能を持っています。

Docker Hub は、Docker が提供する公式のパブリックコンテナレジストリであり、世界中で最も広く使用されているコンテナイメージのリポジトリです。パブリックイメージとプライベートイメージの両方をホストでき、Azure のコンテナサービスから直接アクセスできます。

Azure Container Registry (ACR) は、Azure ネイティブのプライベートコンテナレジストリサービスです。Docker イメージやその他の OCI アーティファクトを安全に保存し、Azure 内のコンテナサービスと統合されています。geo-replication、Azure Active Directory による認証、VNet 統合などのエンタープライズ機能を提供します。

Azure Blob Storage は汎用的なオブジェクトストレージサービスですが、コンテナレジストリとしての機能は持っていません。オンプレミスのファイルサーバーも、Azure のコンテナサービスが直接アクセスできるコンテナイメージソースではありません。

| イメージソース | 対応状況 | 説明 |
| :--- | :--- | :--- |
| Docker Hub | 対応 | パブリック / プライベートレジストリ |
| Azure Container Registry | 対応 | Azure ネイティブレジストリ |
| Azure Blob Storage | 非対応 | オブジェクトストレージ |

****
**リファレンス**
*   Azure Container Registry
*   Azure App Service

****
**問題 270. オンプレミスサーバー上に D:\Folder1 というフォルダがあります。このフォルダの内容を、Azure ストレージアカウント hogehogestorage 内の public という名前のコンテナーにコピーします。使用すべきコマンドはどれですか。（一つ選択）**
*   azcopy sync D:\Folder1 https://hogehogestorage.blob.core.windows.net/public --snapshot
*   az storage blob copy start-batch D:\Folder1 https://hogehogestorage.blob.core.windows.net/public
*   azcopy copy D:\Folder1 https://hogehogestorage.blob.core.windows.net/public --recursive
*   robocopy D:\Folder1 https://hogehogestorage.blob.core.windows.net/public /MIR

****
**解答例**
*   azcopy copy D:\Folder1 https://hogehogestorage.blob.core.windows.net/public --recursive

**解説**
オンプレミスから Azure Blob Storage へのデータ転送には、AzCopy コマンドラインツールが最適です。この問題では、フォルダ内のすべてのファイルをコンテナーにコピーする必要があるため、azcopy copy コマンドに --recursive オプションを指定します。

azcopy copy コマンドは、指定されたソースから宛先へデータをコピーします。--recursive オプションを付けることで、サブディレクトリを含むすべてのファイルが再帰的にコピーされます。コピー後、Blob Storage 上には同じ名前のディレクトリ構造が作成されます。

azcopy sync コマンドは同期処理を行いますが、宛先の最終更新日時がソースより新しい場合、ファイルはスキップされます。また --snapshot オプションはスナップショットからの同期に使用されるため、この要件には適していません。

az storage blob copy start-batch コマンドは、複数の Blob をバッチコピーする際に使用しますが、オンプレミスのローカルファイルシステムからの直接コピーには対応していません。このコマンドは主に Blob 間のコピーに使用されます。

robocopy は Windows のファイルコピーツールですが、Azure Blob Storage への直接転送には対応していません。

| コマンド | 用途 | ローカルから Blob への転送 |
| :--- | :--- | :--- |
| azcopy copy | ファイル・ディレクトリのコピー | 対応 |
| azcopy sync | ソースと宛先の同期 | 対応（差分のみ） |
| az storage blob copy | Blob 間のコピー | 非対応 |

****
**リファレンス**
*   AzCopy
*   Azure Blob Storage
*   Azure Storage Account

****
**問題 271. ロンドンに本社を置く企業では、100 台のクライアントコンピューターを運用しています。3 年前に Azure Active Directory (Azure AD) へ移行し、セキュリティポリシーでは個人デバイスと企業所有デバイスの両方を Azure AD に登録または参加させることを義務付けています。リモートユーザーであるユーザー 1 が自宅ネットワークから個人デバイスを Azure AD に参加させることができません。他のユーザーは正常にデバイスを Azure AD に参加させることができています。ユーザー 1 がデバイスを Azure AD に参加できるようにする必要があります。どの操作を実行しますか。（一つ選択）**
*   Azure AD のデバイス設定ブレードで、ユーザーごとのデバイスの最大数の設定を変更する
*   ユーザー 1 に User Administrator (ユーザー管理者) ロールを割り当てる
*   Azure AD のデバイス設定ブレードで、ユーザーがデバイスを Azure AD に参加できるようにする設定を変更する
*   ユーザー 1 の自宅ネットワークから Azure へのポイント対サイト VPN を構成する

****
**解答例**
*   Azure AD のデバイス設定ブレードで、ユーザーごとのデバイスの最大数の設定を変更する

**解説**
この問題の最重要ポイントは、特定ユーザーのみがデバイス参加に失敗している状況で、他のユーザーは正常に参加できているという点です。これは個別ユーザーのデバイス登録数制限に達している可能性を示唆しています。

Azure AD では、セキュリティ管理の一環として、各ユーザーが登録できるデバイス数に上限を設定できます。デフォルトでは制限が設けられており、この上限に達したユーザーは新しいデバイスを追加できなくなります。ユーザー 1 が過去に複数のデバイスを登録しており、その上限に達している場合、新しいデバイスの参加が拒否されます。

デバイス設定ブレードの「ユーザーごとのデバイスの最大数」設定を増やすことで、ユーザー 1 は追加のデバイスを登録できるようになります。この設定は組織全体に適用されるため、必要に応じて特定ユーザーの既存デバイスを削除する方法も検討できます。

他の選択肢が不適切な理由を整理します。

| 選択肢 | 不適切な理由 |
| :--- | :--- |
| ユーザーがデバイスを Azure AD に参加できるようにする設定 | 他ユーザーが参加できているため、この設定は既に有効 |
| User Administrator ロールの割り当て | デバイス参加に管理者ロールは不要 |
| ポイント対サイト VPN の構成 | Azure AD へのデバイス参加に VPN 接続は不要 |

Azure AD のデバイス管理では、セキュリティとユーザビリティのバランスを取るため、デバイス数制限、参加許可設定、****可設定、デバイスの種類（個人所有または企業所有）などを適切に構成することが重要です。

**リファレンス**
*   Microsoft Entra ID

****
**問題 272. Azure サブスクリプションに、仮想マシン hogeVM とキーコンテナー foobarKV が含まれています。hogeVM の暗号化を構成します。ソリューションは次の要件を満たす必要があります。暗号化キーを foobarKV に保存して使用する。hogeVM を Azure からダウンロードした場合でも暗号化を維持する。OS ディスクとデータディスクの両方を暗号化する。どの暗号化方法を使用しますか。（一つ選択）**
*   Azure Disk Encryption
*   Confidential disk encryption
*   プラットフォームマネージドキー
*   ホストでの暗号化

****
**解答例**
*   Azure Disk Encryption

**解説**
この問題では、キーコンテナーに保存されたカスタマーマネージドキーを使用し、VM を Azure 外に移動しても暗号化を維持できる方法を選択する必要があります。

Azure Disk Encryption は、Windows では BitLocker、Linux では DM-Crypt を使用して、仮想マシンの OS ディスクとデータディスクを暗号化します。暗号化キーは Azure Key Vault に保存され、ディスクが VM にアタッチされている状態でのみ復号化されます。VM を Azure からエクスポートした場合、ディスクは暗号化されたままとなり、Key Vault へのアクセスなしには復号化できません。

他の選択肢が要件を満たさない理由を整理します。

| 暗号化方法 | Key Vault 統合 | エクスポート後の暗号化維持 |
| :--- | :--- | :--- |
| Azure Disk Encryption | 対応 | 維持される |
| Confidential disk encryption | 対応 | 維持されない |
| プラットフォームマネージドキー | 非対応 | 維持されない |
| ホストでの暗号化 | オプション対応 | 維持されない |

Confidential disk encryption は、機密 VM 向けの暗号化で、VM が Azure 環境内で実行されている間のみ保護されます。ホストでの暗号化は、VM ホストレベルでの暗号化を提供しますが、ディスクをエクスポートした場合の暗号化維持は保証されません。プラットフォームマネージドキーは、Microsoft が管理するキーを使用するため、カスタマーマネージドキーの要件を満たしません。

Azure Disk Encryption の実装では、Key Vault のアクセスポリシーで Azure Disk Encryption のアクセスを有効にし、****暗号化キーまたはキー暗号化キー (KEK) を作成します。PowerShell または Azure CLI を使用して暗号化を有効にする際に、Key Vault とキーの情報を指定します。

Set-AzVMDiskEncryptionExtension -ResourceGroupName "hogeRG" -VMName "hogeVM" -DiskEncryptionKeyVaultUrl $keyVaultUrl -DiskEncryptionKeyVaultId $keyVaultResourceId

この構成により、すべての要件が満たされます。

**リファレンス**
*   Azure Disk Encryption
*   Azure Key Vault
*   BitLocker

****
**問題 273. Recovery Services コンテナー (RSV1) があります。RSV1 には、インスタントスナップショットを 5 日間保持し、日次バックアップを 14 日間保持するバックアップポリシーが設定されています。RSV1 は VM1 の日次バックアップを実行しています。VM1 は静的 Web サイトをホストしており、8 日前に更新されました。8 日前の時点に VM1 を復旧する必要があります。ソリューションはダウンタイムを最小限に抑える必要があります。最初に実行すべき操作はどれですか。（一つ選択）**
*   Create new 復元構成オプションを使用して VM1 を復元する
*   VM1 を削除する
*   VM1 の割り当てを解除する
*   Replace existing 復元構成オプションを使用して VM1 を復元する

****
**解答例**
*   Replace existing 復元構成オプションを使用して VM1 を復元する

**解説**
この問題の最重要ポイントは、Recovery Services コンテナーのバックアップ保持期間とダウンタイムを最小化する復元方法の選択です。インスタントスナップショットは 5 日間のみ保持されるため、8 日前の復旧ポイントは日次バックアップから復元する必要があります。

Replace existing 復元構成オプションは、既存の仮想マシンのディスクを復元されたディスクに置き換える方法です。この方法では、仮想マシンの構成（ネットワーク設定、IP アドレス、リソース ID）が保持されるため、DNS レコードやファイアウォール規則の再設定が不要となり、ダウンタイムを最小限に抑えられます。

Create new 復元構成オプションは新しい仮想マシンを作成するため、ネットワーク設定の再構成が必要となり、ダウンタイムが長くなります。VM1 の削除や割り当て解除は復元の前提条件ではなく、Replace existing オプションでは実行中の仮想マシンに対しても復元操作を実行できます。

| 復元オプション | ダウンタイム | 構成の保持 |
| :--- | :--- | :--- |
| Replace existing | 最小 | IP アドレスとネットワーク設定を保持 |
| Create new | 長い | 新規構成が必要 |

| バックアップの種類 | 保持期間 | 8 日前の復旧 |
| :--- | :--- | :--- |
| インスタントスナップショット | 5 日間 | 利用不可 |
| 日次バックアップ | 14 日間 | 利用可能 |

****
**リファレンス**
*   Recovery Services Vault
*   Azure Backup

****
**問題 274. あなたが管理する Azure サブスクリプションには、VNet-A という仮想ネットワークがあり、その中に Subnet-B というサブネットが存在します。Subnet-B には、Windows Server OS を実行する VM-B という仮想マシンがデプロイされており、パブリック IP アドレスが割り当てられています。VM-B のネットワークインターフェイスには、NSG-VM-B というネットワークセキュリティグループが関連付けられており、Subnet-B には NSG-Subnet-B が関連付けられています。NSG-VM-B には、優先度 100 でソース Any、送信元ポート範囲 *、宛先 *、宛先ポート範囲 3389、プロトコル UDP、アクション Allow のカスタム受信セキュリティルールが設定されています。NSG-Subnet-B にはデフォルトの受信セキュリティルールのみが存在します。インターネットから VM-B への Remote Desktop Protocol 接続を確立する必要があります。解決策として、NSG-Subnet-B と NSG-VM-B の両方に、ソース Internet、送信元ポート範囲 *、宛先 VirtualNetwork、宛先ポート範囲 3389、プロトコル TCP、アクション Allow の受信セキュリティルールを追加します。この解決策は要件を満たしますか。（一つ選択）**
*   いいえ、NSG-VM-B のプロトコル設定を修正する必要があるため要件を満たさない
*   はい、両方の NSG に適切なルールを追加することで要件を満たす
*   いいえ、NSG-Subnet-B のみにルールを追加すれば十分であるため冗長である
*   いいえ、パブリック IP アドレスの構成を変更する必要があるため要件を満たさない

****
**解答例**
*   いいえ、NSG-VM-B のプロトコル設定を修正する必要があるため要件を満たさない

**解説**
Remote Desktop Protocol 接続は TCP プロトコルのポート 3389 を使用します。現在の NSG-VM-B には優先度 100 で UDP プロトコルを許可するカスタムルールが存在しますが、RDP 接続に必要な TCP プロトコルの通信は許可されていません。

ネットワークセキュリティグループの評価では、サブネットレベルとネットワークインターフェイスレベルの両方でルールが適用されます。受信トラフィックの場合、まずサブネットに関連付けられた NSG が評価され、次にネットワークインターフェイスに関連付けられた NSG が評価されます。両方の NSG でトラフィックが許可される必要があります。

提案された解決策では、NSG-Subnet-B と NSG-VM-B の両方に TCP プロトコルでポート 3389 を許可するルールを追加していますが、NSG-VM-B には既に優先度 100 で UDP プロトコルを許可するルールが存在します。新しい TCP ルールを追加する場合、既存の UDP ルールよりも低い優先度（より大きい数値）になる可能性があり、既存の UDP ルールが先に評価されます。しかし、UDP ルールは TCP 通信を許可しないため、RDP 接続は確立できません。

正しい解決策は、NSG-VM-B の既存の UDP ルールを TCP プロトコルに変更するか、より高い優先度（より小さい数値）で TCP を許可する新しいルールを追加することです。

| 項目 | 設定値 | 説明 |
| :--- | :--- | :--- |
| プロトコル | TCP | RDP は TCP プロトコルを使用 |
| 宛先ポート | 3389 | RDP の標準ポート番号 |
| 優先度 | 100 未満 | 既存 UDP ルールより優先 |

****
**リファレンス**
*   Network Security Group
*   Remote Desktop Protocol
*   Azure Virtual Network

****
**問題 275. あなたは 100 個の Azure サブスクリプションを管理しています。すべてのサブスクリプションは同じ Microsoft Entra ID (旧 Azure AD) テナントに関連付けられています。あなたはグローバル管理者の役割を持っています。すべてのサブスクリプションにわたるすべてのリソースを一覧表示するレポートを作成する計画です。すべてのサブスクリプションのすべてのリソースを表示できるようにする必要があります。何をすべきですか。（一つ選択）**
*   Azure portal から、自分のアカウントのプロファイル設定を変更する
*   Azure portal から、Microsoft Entra ID テナントのプロパティを変更する
*   PowerShell から、New-AzRoleAssignment コマンドレットを実行する
*   PowerShell から、Get-AzSubscription コマンドレットと Set-AzContext コマンドレットを組み合わせて実行する

****
**解答例**
*   Azure portal から、自分のアカウントのプロファイル設定を変更する

**解説**
グローバル管理者は Microsoft Entra ID テナント全体の管理権限を持ちますが、これは Azure サブスクリプション内のリソースへのアクセス権限を自動的に付与するものではありません。サブスクリプションレベルのリソースにアクセスするには、Azure RBAC の適切なロールが必要です。

Azure portal のアカウントプロファイル設定には「Azure リソースのアクセス管理」という設定項目があり、これを有効にすることでグローバル管理者は自動的にすべてのサブスクリプションと Management Groups に対してユーザーアクセス管理者ロールを取得できます。この設定により、テナント内のすべてのサブスクリプションのリソースを表示し、必要に応じて他のユーザーにアクセス権を付与することが可能になります。

Microsoft Entra ID テナントのプロパティ変更はテナント全体の設定に関するものであり、個別のサブスクリプションリソースへのアクセス権限には影響しません。PowerShell コマンドレットを使用した方法は、個別にロール割り当てを行う必要があり、100 個のサブスクリプションすべてに対して実行するのは非効率的です。

| 方法 | 効果 | 適用範囲 |
| :--- | :--- | :--- |
| プロファイル設定変更 | 全サブスクリプションへのアクセス権付与 | テナント全体 |
| PowerShell でのロール割り当て | 個別サブスクリプションへのアクセス権付与 | 指定したサブスクリプションのみ |
| テナントプロパティ変更 | テナント設定の変更 | リソースアクセスには無関係 |

****
**リファレンス**
*   Azure RBAC (Role-Based Access Control)
*   Microsoft Entra ID

****
**問題 276. Azure Storage アカウント storage1 を作成します。次の要件を満たす必要があります：Azure Data Lake Storage をサポートする、アクセス頻度の低いデータのコストを最小化する、セカンダリ Azure リージョンへデータを自動的にレプリケートする。storage1 に構成すべきオプションはどれですか。（三つ選択）**
*   階層型名前空間を有効化する
*   Geo-Redundant Storage (GRS) を選択する
*   Cool アクセス層を選択する
*   Locally-Redundant Storage (LRS) を選択する
*   Hot アクセス層を選択する

****
**解答例**
*   階層型名前空間を有効化する
*   Geo-Redundant Storage (GRS) を選択する
*   Cool アクセス層を選択する

**解説**
Azure Data Lake Storage Gen2 は階層型名前空間を有効化することで利用可能になります。この機能により、ディレクトリとファイルの階層構造を効率的に管理でき、ビッグデータ分析ワークロードに最適化されます。

アクセス頻度の低いデータのコストを最小化するには、Cool アクセス層を選択します。Cool 層は Hot 層と比較してストレージコストが低く、30 日以上保存されるデータに適しています。アクセス頻度が低いデータに対して、ストレージコストとアクセスコストのバランスが最適化されます。

セカンダリリージョンへの自動レプリケーションには Geo-Redundant Storage (GRS) を使用します。GRS はプライマリリージョンから数百キロ離れたセカンダリリージョンにデータを非同期でレプリケートし、リージョン全体の障害に対する保護を提供します。

Locally-Redundant Storage (LRS) は単一データセンター内でのみデータを複製するため、リージョン間レプリケーションの要件を満たしません。Hot アクセス層は頻繁にアクセスされるデータ向けでストレージコストが高いため、アクセス頻度の低いデータのコスト最小化要件に適していません。

| 要件 | 構成オプション | 説明 |
| :--- | :--- | :--- |
| Data Lake Storage サポート | 階層型名前空間 | ディレクトリ階層管理を実現 |
| 低頻度アクセスのコスト削減 | Cool アクセス層 | ストレージコストを最小化 |
| リージョン間レプリケーション | GRS | セカンダリリージョンへ自動複製 |

****
**リファレンス**
*   Azure Data Lake Storage Gen2
*   Azure Storage の冗長性オプション

****
**問題 277. Windows Server 2016 Datacenter イメージを使用する仮想マシンスケールセット의 デプロイを自動化します。スケールセットの仮想マシンがプロビジョニングされる際に、Web サーバーコンポーネントがインストールされた状態にする必要があります。実行すべきアクションはどれですか。（二つ選択）**
*   Azure Resource Manager テンプレートの extensionProfile セクションを変更する
*   Custom Script Extension を使用して構成スクリプトをデプロイする
*   Azure Policy を作成してコンプライアンス要件を定義する
*   Desired State Configuration(DSC) 拡張機能を構成する
*   Azure Portal で新しい仮想マシンスケールセットを作成する

****
**解答例**
*   Azure Resource Manager テンプレートの extensionProfile セクションを変更する
*   Custom Script Extension を使用して構成スクリプトをデプロイする

**解説**
仮想マシンスケールセットのプロビジョニング時に自動的にソフトウェアをインストールするには、VM 拡張機能を使用します。Azure Resource Manager テンプレートの extensionProfile セクションで拡張機能を定義し、Custom Script Extension を通じて構成スクリプトを実行することで、スケールセット内の各 VM に対して一貫した構成を適用できます。

Custom Script Extension は、Azure 仮想マシン上でスクリプトをダウンロードして実行する機能です。Web サーバーコンポーネントのインストールスクリプトを Azure Storage や GitHub などに配置し、extensionProfile セクションで参照することで、スケールセットの各インスタンスが起動時に自動的にスクリプトを実行します。この方法により、手動介入なしで標準化された環境を構築できます。

Azure Policy はコンプライアンス管理のためのサービスであり、ソフトウェアのインストールには使用しません。Automation Account は Runbook による自動化に使用されますが、スケールセットのプロビジョニング時の構成には適していません。Azure Portal での手動作成は自動化の要件を満たしません。

| 方法 | 用途 | スケールセット対応 |
| :--- | :--- | :--- |
| Custom Script Extension | スクリプト実行によるソフトウェア導入 | 対応 |
| DSC Extension | 宣言的な構成管理 | 対応 |
| Azure Policy | コンプライアンス管理と監査 | 非対応 |

| テンプレートセクション | 役割 |
| :--- | :--- |
****
| extensionProfile | VM 拡張機能の定義と構成 |
| storageProfile | OS ディスクとイメージの指定 |
| networkProfile | ネットワーク構成の定義 |

**リファレンス**
*   ARM Template
*   Virtual Machine Scale Set

****
**問題 278. あなたの組織はロンドンに本社を置き、100 台のクライアントコンピュータを運用しています。3 年前に Microsoft Entra ID へ移行し、セキュリティポリシーではすべての個人デバイスと組織所有デバイスを Microsoft Entra ID に登録または参加させることを義務付けています。リモートワーカーの User-A が自宅ネットワークから個人デバイスを Microsoft Entra ID に参加させようとしましたが失敗しました。過去に User-A は同様の操作を成功させた実績があります。User-A がデバイスを Microsoft Entra ID に参加できるようにするため、あなたが実施すべき対応を選びます。（一つ選択）**
*   [デバイス] ブレードから、[ユーザーはデバイスを Microsoft Entra ID に参加させることができます] 設定を変更する
*   [デバイス] ブレードで、[デバイスの最大数] 設定を変更する
*   User-A のホームネットワークから Azure へのサイト間 VPN 接続を構成する
*   クラウドデバイス管理者ロールを User-A に割り当てる

****
**解答例**
*   [デバイス] ブレードで、[デバイスの最大数] 設定を変更する

**解説**
この問題の最重要ポイントは、ユーザーが過去にデバイス参加に成功していたという事実です。これは基本的な参加権限は付与されていることを意味し、デバイス数の上限に達している可能性が高いことを示唆しています。

Microsoft Entra ID では、各ユーザーが参加または登録できるデバイス数に上限を設定できます。デフォルトでは制限がありますが、組織のポリシーによってこの値は調整可能です。User-A が過去にデバイスを参加させた実績があり、現在参加できない状況は、既存デバイスが上限に達していることが原因と考えられます。

[デバイス] ブレードの [デバイスの最大数] 設定を増やすことで、User-A は追加のデバイスを参加させることができます。または、不要な既存デバイスを削除することでも対応可能です。

他の選択肢が不適切な理由を整理します。VPN 接続は Microsoft Entra ID 参加には不要です。デバイス参加はインターネット経由で直接実行できます。[ユーザーはデバイスを Microsoft Entra ID に参加させることができます] 設定は、過去に成功していることから既に適切に構成されています。クラウドデバイス管理者ロールは管理者向けの権限であり、一般ユーザーのデバイス参加には不要です。

| 設定項目 | 説明 | 影響範囲 |
| :--- | :--- | :--- |
| デバイスの最大数 | ユーザーごとの登録可能デバイス数上限 | 個別ユーザー |
| ユーザーはデバイスを参加させることができます | デバイス参加機能の有効化 | 全ユーザーまたは特定グループ |
| 追加のローカル管理者 | 参加デバイスの管理者権限付与 | デバイスレベル |

****
**リファレンス**
*   Microsoft Entra ID
*   Azure AD Join

****
**問題 279. App1 を Azure に移行する計画を立てています。ネットワークセキュリティグループ (NSG) を作成しました。ユーザーが App1 にアクセスできるようにするソリューションを推奨する必要があります。何を推奨しますか。（一つ選択）**
*   インターネットからポート 443 の受信セキュリティ規則を作成し、NSG を Web サーバーを含むサブネットに関連付ける
*   インターネットからポート 443 の送信セキュリティ規則を作成し、NSG をすべてのサブネットに関連付ける
*   インターネットからポート 80 の受信セキュリティ規則を作成し、NSG を Web サーバーを含むサブネットに関連付ける
*   インターネットからポート 443 の受信セキュリティ規則を作成し、NSG をすべてのサブネットに関連付ける

****
**解答例**
*   インターネットからポート 443 の受信セキュリティ規則を作成し、NSG を Web サーバーを含むサブネットに関連付ける

**解説**
ユーザーがインターネットから App1 にアクセスするには、HTTPS 通信（ポート 443）の受信トラフィックを許可する必要があります。NSG は受信規則と送信規則を設定でき、受信規則は Azure リソースへの着信トラフィックを制御します。

Web アプリケーションへのアクセスでは、ユーザーのブラウザから Web サーバーへの接続開始が必要なため、受信規則の設定が必須です。送信規則は Azure リソースから外部への通信を制御するため、この要件には適合しません。

NSG の関連付けは、セキュリティの最小権限の原則に従い、必要なリソースのみに適用すべきです。すべてのサブネットに関連付けると、不要なサブネットにも同じ規則が適用され、セキュリティリスクが増大します。Web サーバーを含むサブネットのみに関連付けることで、必要最小限の範囲でアクセスを許可できます。

| 項目 | 設定内容 | 理由 |
| :--- | :--- | :--- |
| 規則の方向 | 受信 | インターネットから Azure への通信 |
| ポート番号 | 443 | HTTPS 通信の標準ポート |
| 関連付け先 | Web サーバーのサブネット | 最小権限の原則に基づく |

NSG は複数のサブネットやネットワークインターフェイスに関連付け可能ですが、セキュリティ設計では影響範囲を最小化することが重要です。Web サーバー以外のサブネット（データベース層など）には、別途適切な NSG 規則を設定します。

****
**リファレンス**
*   Network Security Group
*   Azure Virtual Network

****
**問題 280. Azure Active Directory (Azure AD) テナントを運用しています。すべての管理者が Azure ポータルにアクセスする際に検証コードの入力を必須としています。管理者がオンプレミスネットワークからのみ Azure ポータルにアクセスできるようにします。何を構成しますか。（一つ選択）**
*   多要素認証サービスの設定
*   Azure AD Identity Protection のユーザーリスクポリシー
*   条件付きアクセスポリシーの場所の条件
*   Azure AD Privileged Identity Management のすべてのロールの既定設定

****
**解答例**
*   多要素認証サービスの設定

**解説**
この問題は、多要素認証 (MFA) が既に有効な環境で、特定のネットワーク場所からのアクセスのみを許可する要件を実装する方法を問うています。

多要素認証サービスの設定では、信頼できる IP アドレス範囲を定義できます。この機能により、指定した IP アドレス範囲からアクセスする場合に MFA をスキップしたり、逆に特定の場所からのみアクセスを許可したりできます。オンプレミスネットワークのパブリック IP アドレス範囲を信頼できる IP として登録することで、そのネットワークからのアクセスののみを許可する制御が可能です。

Azure AD Identity Protection のユーザーリスクポリシーは、ユーザーアカウントが侵害されている可能性を検出して対応するものであり、ネットワーク場所の制限には使用しません。サインインリスクポリシーも同様に、リスクの高いサインイン試行を検出する機能であり、場所ベースのアクセス制御には適していません。Azure AD Privileged Identity Management は特権ロールの時限制限付きアクティブ化を管理する機能であり、ネットワーク場所の制限を直接設定する機能ではありません。

多要素認証サービス設定と条件付きアクセスポリシーの比較を以下に示します。

| 機能 | 多要素認証サービス設定 | 条件付きアクセスポリシー |
| :--- | :--- | :--- |
| 信頼できる IP 設定 | 可能 (MFA 設定内) | 可能 (場所の条件) |
| 対象ユーザー制御 | 全体またはユーザー単位 | 詳細な制御が可能 |
| 設定の柔軟性 | 基本的な設定 | 高度な条件設定 |

****
**リファレンス**
*   多要素認証 (Multi-Factor Authentication)
*   条件付きアクセス (Conditional Access)
*   Azure AD Identity Protection

****
**問題 281. Azure サブスクリプションを所有しています。アプリケーション App1 をサポートする Azure Kubernetes Service (AKS) クラスターをデプロイする予定です。オンプレミスのクライアントは、Pod 自体の IP アドレスを使用して App1 に直接接続する必要があります。この要件を満たすために、AKS クラスターで使用するネットワークプラグインを選択します。どれを選択しますか。（一つ選択）**
*   Azure CNI Overlay
*   kubenet
*   Azure CNI
*   BYO CNI

****
**解答例**
*   Azure CNI

**解説**
オンプレミスクライアントが Pod の IP アドレスで直接接続する要件を満たすには、Azure CNI を選択する必要があります。Azure CNI では、各 Pod が仮想ネットワークのサブネットから直接 IP アドレスを取得するため、外部から Pod への直接通信が可能になります。

kubenet では、Node は Azure 仮想ネットワークサブネットから IP アドレスを取得しますが、Pod は論理的に異なるアドレス空間から IP アドレスを受け取ります。その後、NAT (Network Address Translation) が構成され、Pod が Azure 仮想ネットワーク上のリソースにアクセスできるようになります。このため、外部クライアントから Pod への直接接続はサポートされません。

Azure CNI Overlay は、Pod にプライベート CIDR 範囲から IP アドレスを割り当てるオーバーレイネットワークモデルです。仮想ネットワークの IP アドレス空間を節約できますが、Pod への直接アクセスには追加の構成が必要です。

BYO CNI (Bring Your Own CNI) は、サードパーティ製の CNI プラグインを使用する高度なシナリオ向けのオプションです。標準的な要件には適していません。

| ネットワークプラグイン | Pod の IP アドレス | 外部からの直接接続 |
| :--- | :--- | :--- |
| Azure CNI | 仮想ネットワークサブネット | 可能 |
| kubenet | 論理的に異なるアドレス空間 | 不可 (NAT 経由) |
| Azure CNI Overlay | プライベート CIDR 範囲 | 追加構成が必要 |

****
**リファレンス**
*   Azure Kubernetes Service (AKS)
*   Azure CNI
*   kubenet

****
**問題 282. Azure サブスクリプション内で 3 台の仮想マシンが稼働しています。各仮想マシンは VNet-A 内の異なるサブネットに配置され、ネットワークインターフェイスの DNS 設定が個別に構成されています。VNet-A の DNS 設定ではカスタム DNS サーバー (193.77.134.10) が指定されています。VM-A のネットワークインターフェイスの DNS 設定は「なし」、VM-B と VM-C はそれぞれカスタム DNS サーバー (192.168.10.15) が設定されています。この構成において、VM-A が DNS クエリを実行する際に接続する DNS サーバーの IP アドレスはどれですか。（一つ選択）**

| 名前 | OS | サブネット | 仮想ネットワーク |
| :--- | :--- | :--- | :--- |
| VM-A | Windows Server 2022 | Subnet-A | VNet-A |
| VM-B | Windows Server 2022 | Subnet-B | VNet-A |
| VM-C | Red Hat Enterprise Linux 7.7 | Subnet-C | VNet-A |

| 名前 | NIC DNS 設定 |
| :--- | :--- |
| VM-A | なし |
| VM-B | 192.168.10.15 |
| VM-C | 192.168.10.15 |

VNet-A DNS 設定：カスタム (193.77.134.10)
*   168.63.129.16 (Azure 提供の DNS サーバー)

****
*   193.77.134.10 (VNet-A で設定されたカスタム DNS サーバー)
*   192.168.10.15 (VM-B と VM-C で設定されたカスタム DNS サーバー)
*   DNS クエリは実行されない

****
**解答例**
*   193.77.134.10 (VNet-A で設定されたカスタム DNS サーバー)

**解説**
Azure 仮想ネットワークにおける DNS 名前解決では、ネットワークインターフェイス (NIC) レベルの DNS 設定が仮想ネットワークレベルの設定より優先されます。VM-A の NIC DNS 設定が「なし」の場合、仮想ネットワーク (VNet-A) で構成された DNS 設定が適用されます。

VM-A の NIC DNS 設定は「なし」であるため、上位の設定である VNet-A のカスタム DNS 設定 (193.77.134.10) が継承されます。したがって、VM-A は DNS クエリを実行する際に 193.77.134.10 に接続します。

一方、VM-B と VM-C は NIC レベルで明示的に 192.168.10.15 が設定されているため、VNet-A の設定 (193.77.134.10) は使用されず、NIC で指定された 192.168.10.15 に接続します。

Azure 仮想ネットワークで DNS 設定を構成しない場合、Azure が提供するデフォルト DNS サーバー (168.63.129.16) が使用されますが、今回は VNet-A でカスタム DNS 設定が構成されているため、このデフォルト設定は適用されません。

| 設定レベル | 優先順位 | VM-A の適用 |
| :--- | :--- | :--- |
| NIC の DNS 設定 | 高 | なし (未設定) |
| VNet の DNS 設定 | 中 | 193.77.134.10 |
| Azure デフォルト DNS | 低 | 適用されない |

| 仮想マシン | NIC DNS | 実際の接続先 |
| :--- | :--- | :--- |
| VM-A | なし | 193.77.134.10 |
****
| VM-B | 192.168.10.15 | 192.168.10.15 |
| VM-C | 192.168.10.15 | 192.168.10.15 |

**リファレンス**
*   Azure Virtual Network
*   Network Interface

****
**問題 283. Azure サブスクリプションがあり、West US リージョンに複数の仮想マシンが含まれています。Azure Network Watcher の Traffic Analytics を使用して仮想マシンのトラフィックを監視します。作成する必要があるリソースはどれですか。（二つ選択）**
*   Log Analytics ワークスペース
*   Network Security Group (NSG) フローログ
*   Azure Monitor ブック
*   ストレージアカウント
*   Application Insights

****
**解答例**
*   Log Analytics ワークスペース
*   ストレージアカウント

**解説**
Traffic Analytics は、Azure Network Watcher の機能であり、NSG フローログデータを分析してネットワークトラフィックの可視化と分析を提供します。この機能を有効にするには、フローログデータの保存先とデータ分析基盤の両方が必要です。

まずストレージアカウントは、NSG フローログの生データを保存するために必須です。フローログは JSON 形式でストレージアカウントに書き込まれ、これが Traffic Analytics の分析対象となります。次に Log Analytics ワークスペースは、収集されたフローログデータを処理・分析し、トラフィックパターンの可視化やクエリ実行を可能にします。Traffic Analytics の分析結果はこのワークスペースに格納され、Azure portal で確認できます。

Azure Monitor ブックは可視化ツールですが、Traffic Analytics 自体が専用のダッシュボードを提供するため必須ではありません。Application Insights はアプリケーションの APM 機能であり、ネットワークトラフィック分析には使用しません。NSG フローログ自体はリソースとして作成するものではなく、NSG の機能として有効化する設定項目です。

| リソース | 役割 | 必須性 |
| :--- | :--- | :--- |
| ストレージアカウント | フローログの保存先 | 必須 |
| Log Analytics ワークスペース | データ分析と可視化 | 必須 |
| NSG フローログ | トラフィックデータ収集 | 設定で有効化 |

****
**リファレンス**
*   Traffic Analytics
*   NSG Flow Logs
*   Log Analytics Workspace

****
**問題 284. Azure サブスクリプションに以下の表に示すパブリック IP アドレスがあります。パブリック Azure Standard Load Balancer を作成する際に使用できるパブリック IP アドレスはどれですか。（一つ選択）**

| 名前 | SKU | 割り当て |
| :--- | :--- | :--- |
| IP1 | Standard | 静的 |
| IP2 | Basic | 動的 |
| IP3 | Standard | 動的 |

*   IP2 のみ
*   IP1 と IP3 のみ
*   IP3 のみ
*   IP1、IP2、IP3 のすべて

****
**解答例**
*   IP1 と IP3 のみ

**解説**
Azure Standard Load Balancer のフロントエンド IP アドレスとして使用できるのは、Standard SKU のパブリック IP アドレスのみです。割り当て方法（静的または動的）は問いません。

IP1 は Standard SKU で静的割り当て、IP3 は Standard SKU で動的割り当てのため、どちらも Standard Load Balancer で使用可能です。一方、IP2 は Basic SKU のため使用できません。Azure Load Balancer では SKU の整合性が必須要件となっており、Standard Load Balancer には Standard SKU のパブリック IP アドレスのみを関連付けることができます。

Basic SKU と Standard SKU の主な違いは以下の通りです。

| 項目 | Basic SKU | Standard SKU |
| :--- | :--- | :--- |
| 可用性ゾーン | 非対応 | 対応 |
| SLA | なし | 99.99% |
| Load Balancer との組み合わせ | Basic Load Balancer | Standard Load Balancer |

Standard Load Balancer を使用する場合は、フロントエンド IP アドレス、バックエンドプール内の VM に割り当てられたパブリック IP アドレスもすべて Standard SKU で統一する必要があります。

**リファレンス**
*   Azure Load Balancer
*   Availability Zone

****
**問題 285. オンプレミスネットワークに dbserver-A という名前のデータベースサーバーがあります。Azure サブスクリプションに 3 つの仮想マシンをデプロイし、各仮想マシンは異なる可用性ゾーンに配置します。オンプレミスネットワークと Azure 仮想ネットワーク間をサイト間 VPN 接続で構成し、Azure 仮想マシンから dbserver-A への接続を確保します。Azure VPN Gateway に使用するパブリック IP アドレスの SKU と割り当て方法の組み合わせとして適切なものはどれですか。（一つ選択）**
*   Standard SKU と静的 IP アドレスの割り当て
*   Basic SKU と動的 IP アドレスの割り当て
*   Standard SKU と動的 IP アドレスの割り当て
*   Basic SKU と静的 IP アドレス의 割り当て

****
**解答例**
*   Standard SKU と静的 IP アドレスの割り当て

**解説**
可用性ゾーンを使用する構成では、ゾーン冗長性を持つリソースが必要です。Azure VPN Gateway で可用性ゾーンをサポートするには、Standard SKU のパブリック IP アドレスを使用する必要があります。Basic SKU のパブリック IP アドレスは可用性ゾーンをサポートしていません。

VPN Gateway に割り当てるパブリック IP アドレスは、静的割り当てを使用します。動的割り当てではゲートウェイの再起動時に IP アドレスが変更される可能性があり、オンプレミス側の VPN 機器との接続設定に影響を与えます。サイト間 VPN 接続では、オンプレミス側の VPN 機器に Azure 側のパブリック IP アドレスを登録するため、IP アドレスが固定されている必要があります。

可用性ゾーンを使用する場合の VPN Gateway 構成要件を以下に整理します。

| 項目 | 要件 | 理由 |
| :--- | :--- | :--- |
| パブリック IP SKU | Standard | 可用性ゾーンのサポートに必須 |
| IP 割り当て方法 | 静的 | オンプレミス側 VPN 機器との接続維持 |
| VPN Gateway SKU | Vpngw1AZ 以上 | 可用性ゾーン対応 SKU が必要 |

Basic SKU のパブリック IP アドレスは可用性ゾーンに対応していないため、可用性ゾーンにデプロイされた仮想マシンとの構成要件を満たしません。また動的 IP アドレス割り当ては、VPN 接続の安定性を損なう可能性があるため適切ではありません。

****
**リファレンス**
*   Azure VPN Gateway
*   Public IP Address
*   Availability Zone

****
**問題 286. 次の表に示す Azure 仮想ネットワークがあります。VNet1 からピアリング接続を確立できる仮想ネットワークはどれですか。（一つ選択）**

| 仮想ネットワーク | アドレス空間 | リージョン |
| :--- | :--- | :--- |
| VNet1 | 10.1.0.0/16 | 東日本 |
| VNet2 | 10.2.0.0/16 | 東日本 |
| VNet3 | 10.3.0.0/16 | 西日本 |
| VNet4 | 10.1.0.0/16 | 西日本 |

*   VNet2 のみ
*   VNet2 と VNet3 のみ
*   VNet3 と VNet4 のみ
*   VNet2、VNet3、VNet5 のみ

****
**解答例**
*   VNet2 と VNet3 のみ

**解説**
Azure Virtual Network Peering では、異なる仮想ネットワーク間でプライベート接続を確立できますが、アドレス空間の重複がある場合はピアリングを構成できません。

VNet1 のアドレス空間は 10.1.0.0/16 です。VNet4 も同じ 10.1.0.0/16 のアドレス空間を使用しているため、アドレス空間が重複しておりピアリング接続を確立できません。一方、VNet2 (10.2.0.0/16) と VNet3 (10.3.0.0/16) は VNet1 とアドレス空間が重複していないため、ピアリング接続が可能です。

Virtual Network Peering はリージョンをまたいで構成できるため、VNet1 (東日本) から VNet3 (西日本) へのピアリングも問題なく確立できます。このようなリージョン間のピアリングは Global VNet Peering と呼ばれます。

| 仮想ネットワーク | アドレス重複 | ピアリング可否 |
| :--- | :--- | :--- |
| VNet2 | なし | 可能 |
| VNet3 | なし | 可能 |
| VNet4 | あり | 不可 |

**リファレンス**
*   Virtual Network Peering
*   Global VNet Peering

****
**問題 287. あなたの会社は Microsoft Entra テナントにリンクされた Azure サブスクリプションを保有しています。Kubernetes API サーバーへのアクセスを制限する必要があります。完全なソリューションを提供する選択肢を選んでください。（二つ選択）**
*   プライベートクラスター
*   Azure Policy
*   API サーバー承認済み IP 範囲
*   パブリッククラスター

****
**解答例**
*   プライベートクラスター
*   API サーバー承認済み IP 範囲

**解説**
Kubernetes API サーバーへのアクセス制限には、ネットワークレベルでの制御が必要です。Azure Kubernetes Service (AKS) では、API サーバーへのアクセスを制限する主要な方法として、プライベートクラスターと API サーバー承認済み IP 範囲の 2 つの手法があります。

プライベートクラスターは、API サーバーにプライベート IP アドレスを割り当て、インターネットからの直接アクセスを完全に遮断します。この構成では、Azure Private Link を使用して API サーバーとクラスターノード間の通信を確立し、すべてのトラフィックが Azure バックボーンネットワーク内に留まります。企業の VNet やオンプレミス環境からのみアクセス可能となり、最も厳格なセキュリティ要件に対応できます。

API サーバー承認済み IP 範囲は、パブリックエンドポイントを持つクラスターに対して、特定の IP アドレス範囲からのみ API サーバーへのアクセスを許可する機能です。CIDR 表記で複数の IP 範囲を指定でき、企業のオフィスネットワークや CI/CD パイプラインなど、信頼できるソースからのアクセスのみを許可します。この方法は既存のパブリッククラスターに対して容易に実装でき、完全なプライベート化が不要な場合に適しています。

パブリッククラスターは制限なしでインターネットからアクセス可能なため、アクセス制限の要件を満たしません。Azure Policy はガバナンスとコンプライアンスの管理に使用されますが、ネットワークレベルでの API サーバーへの直接的なアクセス制御機能は提供しません。

| 方式 | アクセス元 | 実装の複雑さ |
| :--- | :--- | :--- |
| プライベートクラスター | VNet/オンプレミスのみ | 高 |
| 承認済み IP 範囲 | 指定 IP アドレスのみ | 低 |
****
| パブリッククラスター | インターネット全体 | なし |

**リファレンス**
*   Azure Kubernetes Service (AKS)
*   Azure Private Link
*   Microsoft Entra ID

****
**問題 288. Azure サブスクリプション内に以下のリソースが存在します。NSG-A を関連付けることができるのはどの仮想ネットワークのサブネットですか。（一つ選択）**

| 名前 | タイプ | Azure リージョン | リソースグループ |
| :--- | :--- | :--- | :--- |
| VNet-A | 仮想ネットワーク | 東日本 | RG-B |
| VNet-B | 仮想ネットワーク | 東日本 | RG-A |
| VNet-C | 仮想ネットワーク | 西日本 | RG-A |
| NSG-A | Network Security Group | 西日本 | RG-B |

*   VNet-A のサブネット
*   VNet-B と VNet-C のサブネット
*   VNet-A、VNet-B、VNet-C のすべてのサブネット
*   VNet-C のサブネット

****
**解答例**
*   VNet-C のサブネット

**解説**
Network Security Group (NSG) を仮想ネットワークのサブネットに関連付ける際の最重要ポイントは、NSG と仮想ネットワークが同じ Azure リージョンに存在する必要があることです。リソースグループが異なっていても関連付けは可能ですが、リージョンの一致は必須要件となります。

本問では、NSG-A は西日本リージョンに配置されています。各仮想ネットワークのリージョンを確認すると、VNet-A は東日本、VNet-B は東日本、VNet-C は西日本に配置されています。したがって、NSG-A と同じ西日本リージョンに存在する VNet-C のサブネットにのみ、NSG-A を関連付けることができます。

NSG はサブネットレベルまたはネットワークインターフェイスレベルで適用でき、受信トラフィックと送信トラフィックのセキュリティ規則を定義します。リソースグループの境界を越えてリソースを関連付けることは可能ですが、物理的な配置場所であるリージョンの制約は回避できません。

以下の表で NSG 関連付けの要件を整理します。

| 要件項目 | 必須条件 | 本問での状況 |
| :--- | :--- | :--- |
| リージョンの一致 | 必須 | NSG-A は西日本、VNet-C のみ西日本 |
| リソースグループの一致 | 不要 | NSG-A は RG-B、VNet-C は RG-A |
| サブスクリプションの一致 | 必須 | 同一サブスクリプション内 |

**リファレンス**
*   Network Security Group

****
*   Azure Virtual Network
*   Azure Region

****
**問題 289. Azure サブスクリプション内に仮想ネットワーク VNet-A があり、以下の構成となっています。Subnet-A (10.10.1.0/24) にはネットワークセキュリティグループ NSG-A が関連付けられ、Subnet-B (10.10.2.0/24) にはネットワークセキュリティグループは関連付けられていません。VM-A は Subnet-A に配置され (IP アドレス 10.10.1.5)、ネットワークインターフェイスに NSG-B が関連付けられています。VM-B は Subnet-B に配置され (IP アドレス 10.10.2.5)、ネットワークセキュリティグループは関連付けられていません。NSG-A には優先順位 101 で送信元 10.10.2.0/24、宛先 10.10.1.0/24、宛先ポート TCP/1433 を許可する受信規則があります。NSG-B には優先順位 125 で送信元 10.10.2.5、宛先 10.10.1.5、宛先ポート TCP/1433 をブロックする受信規則があります。この構成において、VM-B は VM-A の TCP ポート 1433 に接続できますか。（一つ選択）**
*   いいえ
*   はい

****
**解答例**
*   いいえ

**解説**
VM-B から VM-A への TCP ポート 1433 の接続は、ネットワークセキュリティグループの評価により拒否されます。Azure では、ネットワークセキュリティグループがサブネットレベルとネットワークインターフェイスレベルの両方に適用されている場合、両方の規則が評価されます。

VM-B から VM-A への通信フローでは、まず送信元の VM-B が配置されている Subnet-B の送信規則が評価されますが、Subnet-B には NSG が関連付けられていないため、すべてのトラフィックが許可されます。次に、宛先の VM-A が配置されている Subnet-A の受信規則 (NSG-A) が評価され、優先順位 101 の規則により 10.10.2.0/24 から 10.10.1.0/24 への TCP/1433 が許可されます。しかし、最後に VM-A のネットワークインターフェイスに関連付けられた NSG-B の受信規則が評価され、優先順位 125 の規則により送信元 10.10.2.5 から宛先 10.10.1.5 への TCP/1433 が明示的にブロックされます。

ネットワークセキュリティグループの評価では、サブネットレベルとネットワークインターフェイスレベルの両方の規則を満たす必要があり、いずれかで拒否されると通信は確立できません。この場合、NSG-B の規則により通信が拒否されるため、VM-B は VM-A の TCP ポート 1433 に接続できません。

| 評価順序 | 評価対象 | 規則の結果 |
| :--- | :--- | :--- |
| 1 | Subnet-B 送信規則 | NSG なし (許可) |
| 2 | Subnet-A 受信規則 (NSG-A) | 優先順位 101 で許可 |
| 3 | VM-A NIC 受信規則 (NSG-B) | 優先順位 125 でブロック |

| NSG 適用レベル | 評価タイミング | 本シナリオでの影響 |
| :--- | :--- | :--- |
****
| サブネットレベル | 送信元・宛先サブネット通過時 | NSG-A で許可 |
| NIC レベル | 仮想マシン到達時 | NSG-B でブロック |

**リファレンス**
*   Network Security Group
*   Azure Virtual Network

****
**問題 290. あなたの会社は hogehoge.com というドメイン名を登録しました。Azure DNS ゾーン hogehoge.com を作成し、IP アドレス 131.107.1.10 を持つ www という名前のホストの A レコードをゾーンに追加しました。しかし、インターネット上のホストが www.hogehoge.com を 131.107.1.10 の IP アドレスに解決できないことが判明しました。この名前解決の問題を解決する必要があります。解決策として、ドメインレジストラでネームサーバーを変更します。この解決策は目標を達成できますか。（一つ選択）**
*   はい、目標を達成できる
*   いいえ、目標を達成できない

****
**解答例**
*   はい、目標を達成できる

**解説**
この問題の最重要ポイントは、Azure DNS ゾーンを作成しただけでは名前解決が機能せず、ドメインレジストラ側でネームサーバーの委任設定が必要という点です。

Azure DNS ゾーンを作成すると、Azure は自動的に 4 つのネームサーバーをそのゾーンに割り当てます。しかし、インターネット上の DNS クエリがこの Azure DNS ゾーンに到達するためには、ドメインレジストラ（ドメインを登録した事業者）でネームサーバーの設定を変更し、Azure のネームサーバーに DNS クエリを委任する必要があります。

現在の状況では、Azure DNS ゾーンに A レコードは正しく設定されていますが、ドメインレジストラのネームサーバー設定が更新されていないため、インターネットからの DNS クエリが Azure DNS ゾーンに到達していません。ドメインレジストラでネームサーバーを Azure のネームサーバーに変更することで、DNS クエリが Azure DNS ゾーンにルーティングされ、名前解決が正常に機能するようになります。

| 設定項目 | 設定場所 | 必要な操作 |
| :--- | :--- | :--- |
| DNS ゾーン作成 | Azure Portal | 完了済み |
| A レコード追加 | Azure DNS ゾーン | 完了済み |
| ネームサーバー委任 | ドメインレジストラ | 未実施 (必須) |

ネームサーバーの変更後、DNS 情報がインターネット全体に伝播するまで最大 48 時間かかる場合がありますが、通常は数時間以内に完了します。






ご指定いただいたソース（PDFの抜粋〜）に含まれる全文章を、省略することなく、可能な限り忠実に書き起こして出力します。

---

**リファレンス**
*   **Azure DNS**

**問題 291. あなたの会社では、webapp1 という名前の Azure Web App で実行される App1 というアプリケーションを運用しています。開発者が App1 の更新版を Git1 という Git リポジトリにアップロードしました。webapp1 には本番用スロット（webapp1-prod）とテスト用スロット（webapp1-test）の 2 つのデプロイスロットが構成されています。ユーザーに更新版を公開する前に、App1 の更新版をテストする必要があります。実施すべき操作を選択してください。（二つ選択）**

*   スロットのスワップを実行する
*   webapp1-test を停止する
*   **App1 の更新版を webapp1-test にデプロイし、その後テストを実施する**
*   App1 の更新版を webapp1-prod にデプロイし、その後テストを実施する

**解答例**
*   **App1 の更新版を webapp1-test にデプロイし、その後テストを実施する**
*   **スロットのスワップを実行する**

**解説**
Azure App Service のデプロイスロット機能を使用した段階的デプロイメントの手順を理解する問題です。**デプロイスロットは、本番環境に影響を与えずに新しいバージョンをテストし、検証後にシームレスに本番環境へ切り替えることができる機能です。**

**まず、App1 の更新版を webapp1-test スロットにデプロイします。**テストスロットは本番環境から独立しているため、本番ユーザーに影響を与えることなく新バージョンの動作確認が可能です。**デプロイ後、テストスロットで機能テスト、パフォーマンステスト、結合テストなどを実施し、更新版が正常に動作することを確認します。**

テストが完了し、更新版に問題がないことが確認できたら、**スロットスワップを実行します。**スワップ操作により、テストスロットと本番スロットの内容が入れ替わり、テスト済みの更新版が本番環境に展開されます。**この操作はダウンタイムなしで実行され、問題が発生した場合は再度スワップすることで即座にロールバックできます。**

本番スロットに直接デプロイする選択肢は、テスト前に本番ユーザーに影響を与えるため不適切です。また、スロットを停止する操作は、デプロイやテストのプロセスに必要ありません。

| 操作 | 目的 | 影響範囲 |
| :--- | :--- | :--- |
| **テストスロットへデプロイ** | **新バージョンの検証** | **テスト環境のみ** |
| **スロットスワップ** | **本番環境への展開** | **本番環境全体** |
| 本番スロットへデプロイ | 直接更新（非推奨） | 本番ユーザーに即影響 |


**リファレンス**
*   **Azure App Service デプロイスロット**
*   **スロットスワップ**

**問題 292. 組織の Azure 環境には、サイト間 VPN でオンプレミスネットワークに接続する VNet-A という仮想ネットワークがあります。VNet-A 内の Subnet-A には NSG-A というネットワークセキュリティグループが関連付けられており、Basic 内部ロードバランサー ILB-A が配置されています。ILB-A のバックエンドプールには 3 台の仮想マシンが構成されています。ILB-A に接続する IP アドレスに関するデータを収集し、Azure portal から対話型クエリを実行できるようにする必要があります。作成するリソースとして最も適切なものはどれですか。（一つ選択）**

*   Azure Event Hubs
*   **Azure Log Analytics ワークスペース**
*   Azure Storage アカウント
*   Azure Monitor メトリック

**解答例**
*   **Azure Log Analytics ワークスペース**

**解説**
この問題の最重要ポイントは、**ロードバランサーの診断データを収集し、Azure portal から対話型クエリを実行するための適切なリソースを選択することです。**

**Azure Load Balancer の診断ログやメトリックを収集して分析するには、Azure Log Analytics ワークスペースが最適です。**Log Analytics ワークスペースは、Azure Monitor の一部として機能し、診断設定を通じてロードバランサーのログデータを収集できます。**収集されたデータに対して Kusto Query Language (KQL) を使用した対話型クエリを Azure portal から直接実行でき、接続元 IP アドレス、接続時刻、トラフィックパターンなどの詳細な分析が可能です。**

Azure Storage アカウントは診断ログのアーカイブ保存には使用できますが、対話型クエリ機能は提供されません。Azure Event Hubs はリアルタイムストリーミングデータの取り込みに使用されますが、ログ分析には適していません。Azure Monitor メトリックは数値データの監視には有効ですが、IP アドレスなどの詳細なログデータの分析には不十分です。

| リソース | 診断ログ収集 | 対話型クエリ |
| :--- | :--- | :--- |
| **Log Analytics ワークスペース** | **可能** | **可能 (KQL)** |
| Storage アカウント | 可能 | 不可 |
| Event Hubs | ストリーミングのみ | 不可 |


**リファレンス**
*   **Log Analytics Workspace**
*   **Kusto Query Language (KQL)**

**問題 293. Azure サブスクリプションに、West Europe リージョンに配置されたリソースグループ RG26 があります。RG26 はプロジェクトの一時的なリソースを作成するために使用されており、以下のリソースが含まれています。仮想マシン VM1、ストレージアカウント sa001、SQL データベース SQLDB01 が存在し、SQLDB01 は Recovery Services コンテナー RGV1 にバックアップされています。プロジェクト完了後、Azure portal から RG26 を削除しようとしましたが、削除に失敗しました。RG26 を削除するために最初に実行すべき操作を選択してください。（一つ選択）**

*   VM1 を停止する
*   **SQLDB01 のバックアップを停止する**
*   sa001 を削除する
*   VM1 を削除する

**解答例**
*   **SQLDB01 のバックアップを停止する**

**解説**
リソースグループの削除が失敗する主な原因は、**リソースグループ内のリソースが他のリソースグループのリソースに依存関係を持っている場合です。**本問では、SQLDB01 が RG26 とは別のリソースグループに存在する Recovery Services コンテナー RGV1 にバックアップされているため、**この依存関係が削除をブロックしています。**

**Recovery Services コンテナーにバックアップされているリソースは、バックアップデータとの関連付けが保護メカニズムとして機能します。**リソースグループを削除する前に、**まずバックアップを停止してこの依存関係を解除する必要があります。**バックアップの停止には、バックアップデータの削除も含まれる場合があります。

VM1 の停止や削除、sa001 の削除は、リソースグループ削除の前提条件ではありません。実行中の仮想マシンであってもリソースグループの削除は可能です。ストレージアカウントについても、リソースグループ内に含まれているため、リソースグループ削除時に一括で削除されます。

| 操作 | 削除への影響 | 理由 |
| :--- | :--- | :--- |
| **バックアップ停止** | **必須** | **外部依存関係を解除** |
| VM 停止 / 削除 | 不要 | グループ削除で対応可能 |
| ストレージ削除 | 不要 | グループ削除で対応可能 |


**リファレンス**
*   **Recovery Services Vault**
*   **Resource group**
*   **Azure Backup**

**問題 294. あなたの組織には 3 つのオフィスがあり、Microsoft Entra ID (旧 Azure AD) テナントを含む Azure サブスクリプションを使用しています。各オフィスのローカル管理者に対して、それぞれのオフィスのユーザー管理権限のみを付与します。どの機能を使用しますか。（一つ選択）**

*   Microsoft Entra ID ロール
*   **管理単位 (Administrative Units)**
*   Microsoft Entra ID エンタイトルメント管理のアクセスパッケージ
*   Azure ロール

**解答例**
*   **管理単位 (Administrative Units)**

**解説**
**各オフィスのローカル管理者に特定範囲のユーザー管理権限を委任する場合、管理単位を使用します。管理単位は、Microsoft Entra ID テナント内で管理スコープを論理的に分割し、特定のユーザーやグループ、デバイスに対してのみ管理権限を付与できる機能です。**

本シナリオでは、**3 つのオフィスごとに管理単位を作成し、各オフィスに所属するユーザーを対応する管理単位に割り当てます。その後、各オフィスのローカル管理者に対して、該当する管理単位のスコープ内でのみ有効なユーザー管理者ロールを付与します。**これにより、各管理者は自分のオフィスのユーザーのみを管理でき、他のオフィスのユーザーには影響を与えません。

Microsoft Entra ID ロールは、テナント全体に対する権限付与となるため、特定範囲への権限委任には適していません。Azure ロールは、Azure リソースへのアクセス制御に使用され、Microsoft Entra ID のユーザー管理には使用しません。アクセスパッケージは、リソースへのアクセス要求と承認プロセスを自動化する機能であり、管理権限の委任には使用しません。

| 機能 | 用途 | スコープ |
| :--- | :--- | :--- |
| **管理単位** | **特定範囲への ID 管理権限委任** | **テナント内の特定ユーザー・グループ** |
| Microsoft Entra ID ロール | テナント全体の ID 管理 | テナント全体 |
| Azure ロール | Azure リソースのアクセス制御 | サブスクリプション・リソース |


**リファレンス**
*   **管理単位 (Administrative Units)**
*   **Microsoft Entra ID**
*   **Azure RBAC (Role-Based Access Control)**

**問題 295. あなたの組織が所有する Azure サブスクリプション内で、Web アプリケーション用に 3 つの Azure 仮想マシンをデプロイします。1 つの Azure データセンターが使用できなくなった場合でも、少なくとも 2 つの仮想マシンが使用可能であることを保証する必要があります。どの構成を実装しますか。（一つ選択）**

*   単一の Availability Set 内にすべての仮想マシンを配置する
*   各仮想マシンを異なる Availability Set に配置する
*   **各仮想マシンを異なる Availability Zone に配置する**
*   単一のリージョン内に仮想マシンを配置し、Azure Site Recovery を構成する

**解答例**
*   **各仮想マシンを異なる Availability Zone に配置する**

**解説**
この問題の最重要ポイントは、**データセンターレベルの障害に対する可用性要件を満たす構成を選択することです。Availability Zone (可用性ゾーン) は、Azure リージョン内の物理的に分離された複数のデータセンターで構成されており、各ゾーンは独立した電源、冷却、ネットワークを持ちます。**

**3 つの仮想マシンをそれぞれ異なる Availability Zone に配置することで、1 つのデータセンター（ゾーン）全体が停止しても、残り 2 つのゾーンの仮想マシンは稼働を継続できます。これにり「少なくとも 2 つの仮想マシンが使用可能」という要件を満たせます。**

Availability Set は同一データセンター内でのラック障害やメンテナンスに対する保護を提供しますが、データセンター全体の障害には対応できません。また、単一の Availability Zone 内に複数の仮想マシンを配置した場合、そのゾーン全体が停止すると全ての仮想マシンが影響を受けます。

| 構成 | データセンター障害への対応 | 要件達成 |
| :--- | :--- | :--- |
| **異なる Availability Zone** | **対応可能** | **○** |
| Availability Set | 対応不可 | × |
| 単一 Availability Zone | 対応不可 | × |


**Availability Zone を使用する場合、各ゾーン間のネットワーク遅延は 2 ミリ秒未満に保たれており、アプリケーションのパフォーマンスへの影響は最小限に抑えられます。**

**リファレンス**
*   **Availability Zone**
*   **Availability Set**
*   **Azure Virtual Machine**

**問題 296. あなたの組織では、財務部門の監査担当者が Azure 環境における月次のクラウド支出を詳細に分析する必要があります。監査担当者は、リソースグループ別、サービス別、タグ別にコストを分類し、予算との差異を確認したいと考えています。この要件を満たすために、Azure portal のどの機能を使用するように指示しますか。（一つ選択）**

*   **Cost Management + Billing の Cost analysis**
*   Azure Advisor の Recommendations
*   Cost Management + Billing の Invoices
*   Azure Monitor の Metrics

**解答例**
*   **Cost Management + Billing の Cost analysis**

**解説**
Azure のコスト管理において、**詳細な支出分析を行う場合は Cost Management + Billing の Cost analysis 機能を使用します。この機能は、リソースグループ、サービスの種類、場所、タグなど様々な軸でコストを分類・可視化できるため、監査担当者が必要とする詳細な分析に最適です。**

**Cost analysis では、カスタムビューの作成、フィルタリング、グループ化、時系列でのコスト推移の確認が可能です。また、予算と実際の支出を比較する機能も備えており、予算超過のリスクを早期に検出できます。グラフやテーブル形式での表示に対応し、データのエクスポートも可能なため、監査レポートの作成にも活用できます。**

Invoices は請求書の確認に使用しますが、詳細なコスト分析機能は提供していません。Azure Advisor は最適化の推奨事項を提供するサービスであり、コスト分析の主要ツールではありません。Azure Monitor は主にリソースのパフォーマンスと可用性の監視に使用されます。

| 機能 | 用途 | コスト分析 |
| :--- | :--- | :--- |
| **Cost analysis** | **詳細なコスト分析と可視化** | **○** |
| Invoices | 請求書の確認とダウンロード | × |
| Azure Advisor | 最適化の推奨事項 | △ |


**リファレンス**
*   **Azure Advisor**

**問題 297. Azure Resource Manager テンプレート (Template1) を使用して Azure 仮想マシンをデプロイします。Template1 の variables セクションには "location": "westeurope" が定義されており、resources セクションではこの変数を参照して仮想マシンのデプロイ先リージョンを指定しています。この仮想マシンを West US リージョンにデプロイする必要があります。どのような対応を行いますか。（一つ選択）**

*   **variables セクションの location 値を「westus」に変更する**
*   resources セクションで直接 location 値を「westus」にハードコーディングする
*   デプロイ実行時のパラメータで location を「West US」に指定する
*   テンプレートの parameters セクションに新しい location パラメータを追加し、デプロイ時に値を渡す

**解答例**
*   **variables セクションの location 値を「westus」に変更する**

**解説**
**ARM（Azure Resource Manager）テンプレートでリソースのデプロイ先リージョンを変更する場合、テンプレート内で定義されている値の参照元を特定し、適切な箇所を修正する必要があります。**本問では、**resources セクションが変数を参照して location を決定しているため、variables セクションの値を変更することで全体に反映されます。**

ARM テンプレートは、variables, parameters, resources の 3 つの主要セクションで構成されます。**variables セクションは、テンプレート内で繰り返し使用される値を一元管理するための領域です。resources セクションで変数を参照している場合、変数の値を変更すれば、その変数を参照しているすべてのリソースに変更が適用されます。**

デプロイ時のパラメータ指定は、parameters セクションで定義された値を上書きする場合に有効ですが、本問では variables セクションの値が使用されているため、デプロイ時の指定では変更できません。resources セクションで直接ハードコーディングする方法も可能ですが、テンプレートの保守性が低下するため推奨されません。

| 項目 | 説明 |
| :--- | :--- |
| **variables セクション** | **テンプレート内で再利用する値を定義** |
| parameters セクション | デプロイ時に外部から値を受け取る |
| resources セクション | デプロイする Azure リソースを定義 |


**Azure リージョンの指定では、表示名 (West US) ではなく、内部名 (westus) を使用する必要があります。リージョン名は小文字で空白を含まない形式で記述します。**

**リファレンス**
*   **ARM Template**
*   **Azure Region**

**問題 298. Azure サブスクリプションに仮想マシン VM1 と Azure Function の App1 が含まれています。VM1 が停止した場合に App1 を実行するアラートルールを作成します。アラートルールに対して作成する必要があるものを選択してください。（一つ選択）**

*   Azure Automation Runbook
*   **アクショングループ**
*   管理グループ
*   アプリケーションセキュリティグループ

**解答例**
*   **アクショングループ**

**解説**
**Azure Monitor のアラートルールは、監視条件が満たされた際に自動的にアクションを実行する仕組みです。VM1 の停止を検知して App1 を実行するには、アクショングループの構成が必要です。**

**アクショングループは、アラートが発生した際に実行される通知やアクションの集合です。Azure Function の呼び出し、Webhook、Logic Apps、Automation Runbook など複数のアクションタイプをサポートしています。**本問では VM1 停止時に Azure Function の App1 を実行する必要があるため、**アクショングループ内で Webhook または Azure Function 統合を構成します。**

アラートルールの構成手順は、**まず VM1 のメトリックまたはアクティビティログから停止イベントを監視する条件を定義し、次にアクショングループを作成して App1 の実行アクションを追加します。最後にアラートルールとアクショングループを関連付けることで、VM1 停止時の自動実行が実現します。**

| 項目 | 説明 |
| :--- | :--- |
| **アクショングループ** | **アラート発生時の通知・アクション定義** |
| アラートルール | 監視条件とアクショングループの関連付け |
| サポートアクション | Email, SMS, Webhook, Azure Function 等 |


Azure Automation Runbook もアクショングループから実行可能ですが、アクショングループ自体の作成が前提となります。管理グループはサブスクリプション管理用、アプリケーションセキュリティグループはネットワークセキュリティ制御用であり、アラート実行には使用しません。

**リファレンス**
*   **Azure Automation**
*   **Azure Monitor**
*   **Action Group**
*   **Azure Function**

**問題 299. Azure サブスクリプションに以下のリソースが含まれています：8 個の仮想ネットワーク、24 個の仮想マシン、16 個のストレージアカウント。Azure リソースから生成される診断データとテレメトリデータを表示する機能を提供する監視ソリューションを実装します。ソリューションに含めるべきものはどれですか。（一つ選択）**

*   **Log Analytics ワークスペース**
*   Azure Monitor Metrics
*   Azure Machine Learning ワークスペース
*   Application Insights

**解答例**
*   **Log Analytics ワークスペース**

**解説**
**複数の Azure リソースから生成される診断データとテレメトリデータを一元的に収集、分析、表示するには、Log Analytics ワークスペースが最適です。Log Analytics ワークスペースは、Azure Monitor の中核コンポーネントであり、仮想マシン、ストレージアカウント、ネットワークリソースなど、さまざまな Azure リソースからログデータを収集し、Kusto Query Language (KQL) を使用して高度なクエリと分析を実行できます。**

**Log Analytics ワークスペースでは、リソースログ、メトリック、アクティビティログなど、複数のデータソースを統合して管理できます。収集されたデータは長期保存が可能で、カスタムダッシュボードの作成、アラートの設定、詳細な分析レポートの生成などが行えます。特に複数のリソースタイプにまたがる監視要件がある場合、Log Analytics ワークスペースは中央集約型の監視プラットフォームとして機能します。**

Azure Monitor Metrics は数値データのリアルタイム監視に特化していますが、診断データの詳細な分析には不十分です。Application Insights はアプリケーションパフォーマンス監視に特化したサービスです。Azure Machine Learning ワークスペースは機械学習モデルの開発と管理を目的としており、監視ソリューションとしては適切ではありません。

| 項目 | Log Analytics ワークスペース | Azure Monitor Metrics |
| :--- | :--- | :--- |
| データタイプ | ログ、診断データ、テレメトリ | 数値メトリック |
| 分析機能 | KQL による高度なクエリ | 基本的な集計と可視化 |
| 保存期間 | 長期保存可能 | 短期保存（最大 93 日） |
| 用途 | 詳細分析、トラブルシューティング | リアルタイム監視 |


**リファレンス**
*   **Log Analytics Workspace**
*   **Azure Monitor**
*   **Kusto Query Language (KQL)**

**問題 300. Azure サブスクリプションに、NSG1 という名前のネットワークセキュリティグループがあります。NSG1 を構成して、リモートデスクトップ管理とセキュアな HTTPS 通信を許可します。NSG1 で許可すべきポート番号を選択してください。（二つ選択）**

*   **443**
*   22
*   **3389**
*   80
*   587

**解答例**
*   **443**
*   **3389**

**解説**
この問題は、Azure のネットワークセキュリティグループで特定のサービスを許可するために必要なポート番号を理解しているかを問うものです。

**リモートデスクトップ管理には RDP (Remote Desktop Protocol) が使用され、TCP ポート 3389 が必要です。**これは Windows ベースの仮想マシンにリモート接続する際の標準ポートです。**セキュアな HTTPS 通信には TCP ポート 443 が使用されます。HTTPS は SSL/TLS で暗号化された HTTP 通信であり、Web アプリケーションへの安全なアクセスに不可欠です。**

その他の選択肢について、ポート 80 は暗号化されていない HTTP 通信用、ポート 22 は SSH (Secure Shell) 用、ポート 587 は SMTP (メール送信) 用です。これらは今回の要件には該当しません。

**ネットワークセキュリティグループでは、受信セキュリティ規則と送信セキュリティ規則を構成できます。各規則には、送信元と送信先の IP アドレス範囲、ポート番号、プロトコル、優先度を指定します。優先度の数値が小さいほど優先的に評価されます。**

| サービス | プロトコル | ポート番号 |
| :--- | :--- | :--- |
| **RDP** | **TCP** | **3389** |
| **HTTPS** | **TCP** | **443** |
| HTTP | TCP | 80 |


**NSG の規則は、仮想ネットワーク内のサブネットまたは個々のネットワークインターフェイスに関連付けることができます。セキュリティのベストプラクティスとして、必要最小限のポートのみを開放し、送信元 IP アドレスを可能な限り制限することが推奨されます。**

**リファレンス**
*   **Network Security Group**
*   **RDP (Remote Desktop Protocol)**

**問題 301. あなたは hogehoge.com という名前の Microsoft Entra テナントにリンクされた Azure サブスクリプションを管理しています。現在、hogehoge.com 内のすべてのユーザーが B2B コラボレーションに外部ユーザーを招待できる状態です。Guest Inviter、User Administrator、Global Administrator ロールのメンバーのみがゲストユーザーを招待できるように制限します。どの設定を構成しますか。（一つ選択）**

*   Conditional Access
*   **External collaboration settings**
*   User settings
*   Cross-tenant access settings

**解答例**
*   **External collaboration settings**

**解説**
**Microsoft Entra ID（旧 Azure AD）でゲストユーザーの招待権限を制御するには、External collaboration settings を構成します。この設定により、組織内のどのユーザーが外部ユーザーを B2B コラボレーションに招待できるかを細かく制御できます。**

**デフォルトでは、テナント内のすべてのユーザーがゲストを招待できる設定になっていますが、セキュリティ要件に応じて特定のロールのみに制限することが推奨されます。External collaboration settings では、「Member users and users assigned to specific admin roles can invite guest users including guests with member permissions」オプションを選択することで、Guest Inviter、User Administrator、Global Administrator などの特定の管理者ロールのみに招待権限を付与できます。**

Conditional Access はアクセス制御ポリシーを定義する機能ですが、ゲスト招待の権限制御には使用しません。Cross-tenant access settings は他の Microsoft Entra テナントとの信頼関係を管理する設定で、招待権限の制御とは異なります。User settings は一般的なユーザー設定を管理しますが、ゲスト招待の詳細な権限制御は External collaboration settings で行います。

| 設定項目 | 用途 |
| :--- | :--- |
| **External collaboration settings** | **ゲスト招待権限の制御** |
| Conditional Access | アクセス条件に基づく制御 |
| Cross-tenant access settings | テナント間の信頼関係管理 |


**リファレンス**
*   **Guest Inviter role**

**問題 302. Windows Server を実行する Server1 という名前の Azure 仮想マシンがあります。Azure Backup を使用してファイルとフォルダーをバックアップする構成を行います。Server1 にインストールする必要があるものはどれですか。（一つ選択）**

*   Azure Connected Machine エージェント
*   **Microsoft Azure Recovery Services (MARS) エージェント**
*   Azure Backup Server エージェント
*   Azure Site Recovery Provider エージェント

**解答例**
*   **Microsoft Azure Recovery Services (MARS) エージェント**

**解説**
**Azure 仮想マシン上のファイルとフォルダーを個別にバックアップする場合、MARS エージェントをインストールします。MARS エージェントは、Windows Server や Windows クライアント OS 上で動作し、ファイル、フォルダー、システム状態を直接 Recovery Services コンテナーにバックアップする軽量なエージェントです。**

**Azure Backup には複数のバックアップ方法がありますが、ファイルとフォルダーレベルのバックアップには MARS エージェントが最適です。仮想マシン全体のバックアップではなく、特定のファイルやフォルダーを選択的に保護できる点が特徴です。**

Azure Connected Machine エージェントは、オンプレミスやマルチクラウド環境のサーバーを Azure Arc に接続するために使用します。Azure Backup Server エージェントは、複数のワークロードを集中管理する大規模環境向けです。Azure Site Recovery Provider エージェントは、ディザスタリカバリとレプリケーションに使用されます。

| バックアップ方法 | 用途 | 対象 |
| :--- | :--- | :--- |
| **MARS エージェント** | **ファイル・フォルダー単位** | **Windows OS** |
| Azure Backup Server | 複数ワークロード集中管理 | 大規模環境 |
| Azure VM Backup | VM 全体のスナップショット | Azure 仮想マシン |


**リファレンス**
*   **Microsoft Azure Recovery Services (MARS) エージェント**
*   **Azure Backup**
*   **Recovery Services Vault**
*   **Azure Arc**

**問題 303. Azure Web App の webapp1 があります。仮想ネットワーク VNET1 と、MySQL データベースをホストする Azure 仮想マシン VM1 があります。VM1 は VNET1 に接続されています。webapp1 が VM1 上でホストされているデータにアクセスできるようにします。どうすればよいですか。（一つ選択）**

*   **webapp1 を VNET1 に接続する**
*   Azure Traffic Manager をデプロイする
*   VNET1 に対してサービスエンドポイントを構成する
*   内部ロードバランサーをデプロイする

**解答例**
*   **webapp1 を VNET1 に接続する**

**解説**
**Azure Web App から VNET 内の仮想マシンにアクセスするには、VNet 統合機能を使用して Web App を VNET に接続する必要があります。これにより、Web App はプライベートネットワーク経由で VM1 上の MySQL データベースに安全にアクセスできるようになります。**

**VNet 統合は、App Service のネットワークセキュリティとプライベートアクセスのための標準的な手法です。この機能により、Web App のアウトバウンドトラフィックが指定した VNET を経由するようになり、VNET 内のリソースへのアクセスが可能になります。Standard 以上の App Service Plan で利用可能です。**

他の選択肢が不適切な理由を以下に示します。
| 選択肢 | 不適切な理由 |
| :--- | :--- |
| Azure Traffic Manager | DNS ベースのトラフィック分散サービスであり、VNET への接続機能は提供しない |
| サービスエンドポイント | Azure サービスへの VNET アクセスを提供するが、Web App から VNET への接続には使用できない |
| 内部ロードバランサー | VNET 内のトラフィック分散に使用されるが、Web App と VNET 間の接続は確立できない |


**VNet 統合を構成する際は、統合サブネットとして専用のサブネットを用意する必要があります。また、Regional VNet 統合を使用する場合、Web App と VNET は同じ Azure リージョンに存在する必要があります。**

**リファレンス**
*   **VNET 統合**
*   **Virtual Network Integration**
*   **App Service Plan**
*   **Azure Virtual Network**

**問題 304. Azure サブスクリプション内にリソースグループが存在し、そのリソースグループには ARM テンプレートを使用してデプロイされた複数のリソースが含まれています。リソースグループ内の各リソースがいつ作成されたかを確認します。Azure portal のサブスクリプションブレードからサブスクリプションを選択し、リソースプロバイダーをクリックして確認する方法は、この要件を満たしますか。（一つ選択）**

*   **いいえ、リソースプロバイダーではリソースの作成日時は確認できない**
*   はい、リソースプロバイダーの登録状態から作成日時が確認できる
*   はい、リソースプロバイダーのデプロイ履歴から作成日時が確認できる
*   いいえ、アクティビティログを使用する必要がある

**解答例**
*   **いいえ、リソースプロバイダーではリソースの作成日時は確認できない**

**解説**
**リソースプロバイダーは、Azure サービスを提供するための名前空間であり、各 Azure リソースタイプに対応する API エンドポイントを管理します。サブスクリプションブレードのリソースプロバイダーセクションでは、各プロバイダーの登録状態（Registered, NotRegistered, Unregistering）のみが表示され、個別リソースの作成日時などのデプロイメント情報は含まれません。**

リソースの作成日時を確認するには、リソースグループブレードから「デプロイ」セクションにアクセスする方法が最も直接的です。ここでは ARM テンプレートによるデプロイメント履歴が時系列で表示され、各デプロイメントの開始時刻、完了時刻、状態、デプロイされたリソースの詳細を確認できます。また、リソースグループまたは個別リソースの「アクティビティログ」を使用すると、リソースの作成操作（Write 操作）のタイムスタンプを含む詳細な監査ログを確認できます。さらに、個別リソースのプロパティブレードでは、リソースのメタデータとして作成日時が直接表示されます。

| 確認方法 | 確認できる情報 | 用途 |
| :--- | :--- | :--- |
| **リソースプロバイダー** | **登録状態のみ** | サービス利用可否の確認 |
| デプロイ履歴 | デプロイ日時と詳細 | テンプレートデプロイの追跡 |
| アクティビティログ | 操作履歴とタイムスタンプ | 監査と変更追跡 |


**リファレンス**
*   **Azure Resource Manager**
*   **リソースプロバイダー**

**問題 305. あなたの組織には、Sub1 と Sub2 という 2 つの Azure サブスクリプションがあります。Sub1 には仮想ネットワーク VNet1 と VPN Gateway が含まれています。Sub2 には仮想ネットワーク VNet2 が含まれています。オンプレミスには Windows を実行する Device1 というデバイスがあり、ポイント対サイト (P2S) VPN クライアントがインストールされています。VNet1 と VNet2 の間で仮想ネットワークピアリングを構成しました。VPN 接続が確立されたときに Device1 が VNet2 にアクセスできるようにします。何をすべきですか。（一つ選択）**

*   **VPN Gateway の設定でゲートウェイ転送を有効化し、Device1 で P2S VPN クライアントを再ダウンロードしてインストールする**
*   Sub2 に Azure Bastion をデプロイする
*   Device1 で New-SelfSignedCertificate コマンドレットを実行する
*   Sub2 にプライベートエンドポイントを作成する

**解答例**
*   **VPN Gateway の設定でゲートウェイ転送を有効化し、Device1 で P2S VPN クライアントを再ダウンロードしてインストールする**

**解説**
この問題の最重要ポイントは、**仮想ネットワークピアリング環境で P2S VPN 接続からピアリング先ネットワークへアクセスするには、ゲートウェイ転送の有効化と VPN クライアント構成の更新が必要という点です。**

**P2S VPN 接続は、VPN Gateway が配置されている仮想ネットワーク (VNet1) への接続を確立します。デフォルトでは、VPN クライアントは VNet1 のアドレス空間のみにアクセス可能です。仮想ネットワークピアリングを構成しただけでは、P2S VPN 経由でピアリング先 (VNet2) へのアクセスは自動的には有効になりません。**

**ピアリング先ネットワークへのアクセスを実現するには、VNet1 側のピアリング設定で「ゲートウェイ転送を許可する」を有効化し、VNet2 側で「リモートゲートウェイを使用する」を有効化する必要があります。これにより VNet2 へのトラフィックが VNet1 の VPN Gateway 経由でルーティングされます。**

**さらに重要な点として、ゲートウェイ転送を有効化した後は、VPN クライアント構成パッケージを再ダウンロードして Device1 に再インストールする必要があります。これは、新しいルート情報（VNet2 のアドレス空間を含む）がクライアント構成に反映されるためです。**

| 設定項目 | 設定場所 | 必要な操作 |
| :--- | :--- | :--- |
| **ゲートウェイ転送** | VNet1 ピアリング設定 | **許可するを有効化** |
| リモートゲートウェイ | VNet2 ピアリング設定 | 使用するを有効化 |
| **VPN クライアント** | **Device1** | **再ダウンロードと再インストール** |


他の選択肢について、プライベートエンドポイントは Azure PaaS サービスへのプライベート接続用であり、仮想ネットワーク全体へのアクセスには関係ありません。Azure Bastion は管理用の RDP/SSH 接続サービスであり、P2S VPN のルーティング問題は解決しません。New-SelfSignedCertificate コマンドレットは証明書ベース認証用の証明書生成に使用しますが、既存の P2S VPN 接続が確立されている状況では不要です。

**リファレンス**
*   **Virtual Network Peering**
*   **VPN Gateway**
*   **Point-to-Site VPN**

**問題 306. あなたの組織では、3 つの仮想ネットワーク (VNET1、VNET2、VNET3) にそれぞれ仮想マシン (VM1、VM2、VM3) が配置されています。VM1 には DNS サービスがインストールされており、各仮想ネットワークの DNS 設定は以下の通りです。VNET1 の DNS サーバーは VM1 のプライベート IP アドレスを参照し、VNET2 と VNET3 は Azure 提供の DNS を使用しています。すべての仮想マシンが VM1 上の DNS サービスを使用して名前解決できるようにします。どの操作を実行しますか。（一つ選択）**

| 仮想ネットワーク | 仮想マシン | DNS サーバー設定 |
| :--- | :--- | :--- |
| VNET1 | VM1 | VM1 のプライベート IP |
| VNET2 | VM2 | Azure 提供の DNS |
| VNET3 | VM3 | Azure 提供の DNS |


*   **VNET1、VNET2、VNET3 間で仮想ネットワークピアリングを構成する**
*   VNET2 と VNET3 にサービスエンドポイントを追加する
*   VM1 で条件付きフォワーダーを構成する
*   VNET2 と VNET3 の DNS サーバー設定を VM1 のプライベート IP アドレスに変更する

**解答例**
*   **VNET1、VNET2、VNET3 間で仮想ネットワークピアリングを構成する**

**解説**
この問題では、**異なる仮想ネットワークに配置された仮想マシンが、特定のカスタム DNS サーバー (VM1) を使用して名前解決を行うための構成を問われています。**

**Azure 仮想ネットワークは既定では相互に分離されており、ネットワーク間の通信は確立されていません。VNET2 と VNET3 の VM2、VM3 が VNET1 内の VM1 上の DNS サービスにアクセスするには、まず仮想ネットワーク間の接続を確立する必要があります。仮想ネットワークピアリングを構成することで、異なる仮想ネットワーク間でプライベート IP アドレスを使用した直接通信が可能になります。**

**ピアリング確立後、VNET2 と VNET3 の DNS 設定を VM1 のプライベート IP アドレスに変更することで、すべての仮想マシンが VM1 の DNS サービスを利用できるようになります。ただし、設問では「どの操作を実行するか」と問われており、最も基本的かつ必須の操作は仮想ネットワークピアリングの構成です。**

サービスエンドポイントは Azure PaaS サービスへのセキュアなアクセスを提供する機能であり、仮想マシン間の通信には関係ありません。条件付きフォワーダーは特定のドメインに対する DNS クエリを別の DNS サーバーに転送する機能であり、この要件には適合しません。

| 構成要素 | 役割 | 必要性 |
| :--- | :--- | :--- |
| **仮想ネットワークピアリング** | **VNET 間の接続確立** | **必須** |
| **DNS 設定変更** | **カスタム DNS 参照** | **必須** |
| サービスエンドポイント | PaaS サービス接続 | 不要 |


**リファレンス**
*   **Virtual Network Peering**
*   **Azure Virtual Network**

**問題 307. Azure サブスクリプション内に 2 つの仮想マシンが存在します。これらの仮想マシン間で HTTPS トラフィックの負荷分散を実現するため、Azure Load Balancer を作成しました。負荷分散ルールを構成する前に、必ず作成しておく必要がある Load Balancer のリソースコンポーネントはどれですか。（二つ選択）**

*   **正常性プローブ**
*   **バックエンドプール**
*   インバウンド NAT ルール
*   仮想ネットワーク
*   フロントエンド IP 構成

**解答例**
*   **正常性プローブ**
*   **バックエンドプール**

**解説**
**Azure Load Balancer で負荷分散ルールを作成するには、事前に必須となるコンポーネントの構成が必要です。負荷分散ルールは、フロントエンド IP アドレスとバックエンドプールを関連付け、トラフィックを分散する際の動作を定義します。**

**負荷分散ルールを作成する前に必須となるコンポーネントは、バックエンドプールと正常性プローブです。バックエンドプールは、負荷分散の対象となる仮想マシンやインスタンスのグループを定義します。正常性プローブは、バックエンドプール内の各リソースの稼働状態を監視し、トラフィックを正常なリソースにのみ転送するために必要です。**

フロントエンド IP 構成は、Load Balancer の作成時に自動的に構成されるか、負荷分散ルール作成時に指定できるため、事前作成は必須ではありません。インバウンド NAT ルールは、特定のポートを特定の仮想マシンに転送する場合に使用しますが、負荷分散ルールとは独立した機能です。仮想ネットワークは仮想マシンが所属するネットワーク環境であり、Load Balancer 自体のコンポーネントではありません。

| コンポーネント | 必須性 | 用途 |
| :--- | :--- | :--- |
| **バックエンドプール** | **必須** | **負荷分散対象のリソース定義** |
| **正常性プローブ** | **必須** | **リソースの稼働状態監視** |
| フロントエンド IP 構成 | 自動構成可 | 受信トラフィックのエンドポイント |


**リファレンス**
*   **Azure Load Balancer**
*   **Health Probe**
*   **Backend Pool**

**問題 308. Azure サブスクリプションに複数のリソースが含まれています。VM1 と VM2 は同じテンプレートからデプロイされ、リモートデスクトップを使用してアクセスされる基幹業務アプリケーションをホストしています。これらの VM は同じサブネット (Subnet1) に配置されており、ネットワークセキュリティグループ (NSG) が構成されています。この NSG には以下のルールが含まれています：Port_80 (受信、優先度 100、ポート 80 を許可)、DenyWebSites (送信、優先度 200、ポート 80 と 443 を拒否)。現在、NSG は VM1 と VM2 のネットワークインターフェイスに関連付けられています。VM1 と VM2 のユーザーがインターネット上の Web サイトにアクセスできないようにする必要があります。どの操作を実行しますか。（一つ選択）**

*   **DenyWebSites の送信セキュリティルールの優先度を 100 に変更する**
*   NSG を Subnet1 に関連付ける
*   Port_80 の受信セキュリティルールを削除する
*   NSG をネットワークインターフェイスから関連付け解除する

**解答例**
*   **DenyWebSites の送信セキュリティルールの優先度を 100 に変更する**

**解説**
**NSG のセキュリティルールは優先度の数値が小さいほど先に評価されます。現在の構成では、DenyWebSites ルール（優先度 200）よりも前に、既定の送信ルール（優先度 65000、すべての送信トラフィックを許可）が評価されるため、インターネットへのアクセスが許可されています。**

**VM1 と VM2 からインターネット上の Web サイトへのアクセスを確実にブロックするには、DenyWebSites ルールの優先度を既定ルールより高く（数値を小さく）設定する必要があります。優先度を 100 に変更することで、このルールが既定の送信許可ルールより先に評価され、ポート 80 と 443 への送信トラフィックが拒否されます。**

NSG をサブネットレベルに関連付ける選択肢は、同じサブネット内の他のリソースにも影響を与える可能性があり、VM1 と VM2 のみを対象とする要件には適していません。ネットワークインターフェイスから関連付けを解除すると、すべてのセキュリティルールが適用されなくなり、要件を満たせません。Port_80 の受信ルールは送信トラフィックには影響しないため、削除しても問題は解決しません。

| 項目 | 説明 |
| :--- | :--- |
| **NSG ルール優先度** | **100-4096 の範囲で設定、数値が小さいほど優先** |
| 既定の送信ルール | 優先度 65000、すべての送信を許可 |
| 関連付けレベル | サブネットまたはネットワークインターフェイス |


**リファレンス**
*   **Network Security Group**
*   **送信セキュリティルール**

**問題 309. 200 台の仮想マシンを含む Azure サブスクリプションを管理しています。使用率の低い仮想マシンが検出された際に Azure Advisor からコスト推奨事項を受け取る予定です。Advisor アラートが生成されるたびに、すべての Azure 管理者に通知が届くようにします。管理作業を最小限に抑えるソリューションを実装する必要があります。ソリューションに含めるべきものはどれですか。（一つ選択）**

*   Azure Automation アカウント
*   **アクショングループ**
*   管理グループ
*   容量予約グループ

**解答例**
*   **アクショングループ**

**解説**
**Azure Advisor のアラート通知を複数の管理者に効率的に配信するには、アクショングループを使用します。アクショングループは、Azure Monitor の通知メカニズムであり、アラートが発生した際に実行するアクションを定義できます。**

**アクショングループを使用することで、電子メール、SMS、音声通話、Azure Functions, Logic Apps, Webhook など複数の通知方法を一元管理できます。特に複数の管理者への通知が必要な場合、アクショングループに管理者のメールアドレスを登録するだけで、Advisor アラート発生時に自動的に全員に通知が送信されます。**

**Azure Advisor は、コスト、セキュリティ、信頼性、運用上の優秀性、パフォーマンスの 5 つのカテゴリで推奨事項を提供します。使用率の低い仮想マシンの検出はコストカテゴリに該当し、リソースの最適化とコスト削減を支援します。**

他の選択肢について、Azure Automation アカウントは自動化タスクの実行に使用されますが、通知配信には直接関係しません。管理グループはサブスクリプションの階層管理に使用され、容量予約グループは仮想マシンの容量予約管理に使用されるため、いずれもアラート通知の要件を満たしません。

| 項目 | 説明 | 追加機能 |
| :--- | :--- | :--- |
| **アクショングループ** | **アラート発生時のアクション定義** | **複数の通知方法をサポート** |
| Azure Automation | 自動化タスクの実行環境 | 通知機能なし |
| 管理グループ | サブスクリプション階層管理 | 通知機能なし |


**リファレンス**
*   **Azure Automation**
*   **Azure Advisor**
*   **Action Group**
*   **Azure Monitor**

**問題 310. Subscription-A というサブスクリプションに、VNet-A と VNet-B という 2 つの仮想ネットワークがあります。VNet-A には静的ルーティングを使用する VPNGW-A という名前の VPN ゲートウェイが含まれています。オンプレミスネットワークと VNet-A の間にはサイト間 VPN 接続があります。Windows 10 を実行する Client-A というコンピューターで、VNet-A へのポイント対サイト VPN 接続を構成しました。VNet-A と VNet-B の間に仮想ネットワークピアリングを構成しています。オンプレミスネットワークから VNet-B への接続は確認できましたが、Client-A から VNet-B への接続ができません。Client-A が VNet-B に接続できるようにします。何をすべきですか。（一つ選択）**

*   VNet-A でゲートウェイトランジットを有効にする
*   **Client-A に VPN クライアント構成パッケージをダウンロードして再インストールする**
*   VNet-B でリモートゲートウェイの使用を有効にする
*   VPNGW-A でアクティブ / アクティブモードを有効にする

**解答例**
*   **Client-A に VPN クライアント構成パッケージをダウンロードして再インストールする**

**解説**
**ポイント対サイト VPN 接続を使用するクライアントが、仮想ネットワークピアリングで接続された別の仮想ネットワークにアクセスするには、ゲートウェイトランジットの構成と VPN クライアント構成パッケージの再インストールが必要です。**

VNet-A と VNet-B の間で仮想ネットワークピアリングを構成する際、VNet-A 側でゲートウェイトランジットを許可し、VNet-B 側でリモートゲートウェイの使用を許可する設定を行います。この設定により、VNet-B は VNet-A の VPN ゲートウェイを経由して外部ネットワークと通信できるようになります。しかし、**ポイント対サイト VPN 接続を使用するクライアントの場合、ピアリング構成後に新しいルート情報を含む VPN クライアント構成パッケージを再度ダウンロードしてインストールする必要があります。この再インストールにより、Client-A は VNet-B のアドレス空間へのルート情報を取得し、VNet-B への接続が可能になります。**

オンプレミスネットワークから VNet-B への接続が既に確認できているということは、サイト間 VPN 接続とゲートウェイトランジットの設定は正しく構成されています。問題はポイント対サイト VPN 接続を使用する Client-A が、ピアリング後の新しいネットワーク構成を認識していないことです。

| 項目 | 説明 |
| :--- | :--- |
| ゲートウェイトランジット | ピアリングされた仮想ネットワークが VPN ゲートウェイを共有する機能 |
| リモートゲートウェイの使用 | ピアリング先の仮想ネットワークのゲートウェイを利用する設定 |
| **VPN クライアント構成パッケージ** | **ポイント対サイト VPN 接続に必要なルート情報と証明書を含むパッケージ** |


**リファレンス**
*   **Virtual Network Peering**
*   **ポイント対サイト VPN 接続**

**問題 311. Azure Resource Manager (ARM) ライブラリに保存されている基本テンプレートを使用して Azure 仮想マシンをデプロイします。テンプレートのデプロイ時に構成できる項目はどれですか。（一つ選択）**

*   仮想マシンのサイズ
*   仮想マシンに割り当てるディスク
*   **リソースグループ**
*   可用性ゾーン

**解答例**
*   **リソースグループ**

**解説**
**ARM テンプレートを使用した仮想マシンのデプロイでは、テンプレート内で事前定義された構成とデプロイ時にパラメータとして指定可能な構成があります。基本テンプレートでは、オペレーティングシステム、仮想マシンのサイズ、ディスク構成などの主要な設定はテンプレート内で定義されており、デプロイ時に変更することはできません。**

**一方、リソースグループはデプロイ先を指定する必須パラメータであり、デプロイ時に必ず選択または新規作成する必要があります。リソースグループは、関連する Azure リソースを論理的にグループ化して管理するコンテナであり、すべての Azure リソースはいずれかのリソースグループに属する必要があります。**

テンプレートのデプロイ時には、Azure Portal または Azure CLI や PowerShell を使用してリソースグループを指定します。既存のリソースグループを選択するか、新しいリソースグループを作成してデプロイ先として指定できます。

| 項目 | デプロイ時の変更 | 説明 |
| :--- | :--- | :--- |
| **リソースグループ** | **可能** | **デプロイ先として必ず指定** |
| 仮想マシンサイズ | 不可 | テンプレート内で定義済み |
| オペレーティングシステム | 不可 | テンプレート内で定義済み |


基本テンプレートを使用する場合、より柔軟な構成が必要であれば、テンプレートファイル自体を編集してパラメータを追加するか、カスタムテンプレートを作成する必要があります。

**リファレンス**
*   **ARM Template**
*   **Resource group**
*   **Azure Virtual Machine**

**問題 312. Microsoft Entra テナントがあります。User1 という新しいユーザーを作成しました。User1 に Microsoft 365 E5 ライセンスを割り当てます。ライセンスを割り当てる前に、User1 に対してどのユーザー属性を構成する必要がありますか。（一つ選択）**

*   姓
*   **利用場所**
*   名
*   その他のメールアドレス

**解答例**
*   **利用場所**

**解説**
**Microsoft 365 ライセンスを割り当てる際の必須要件として、利用場所 (Usage Location) の設定が求められます。これはライセンス割り当ての前提条件であり、設定されていない場合はライセンス割り当て操作が失敗します。**

**利用場所は、ユーザーが利用するサービスの提供可否を判断するために使用されます。Microsoft 365 サービスは国や地域によって提供状況が異なるため、適切なサービス提供を保証するために利用場所の指定が必須となっています。この属性は ISO 3166-1 alpha-2 形式の 2 文字の国コード（日本の場合は「JP」）で指定します。**

一方、名や姓などの基本的なユーザー情報は、ユーザーアカウントの作成時に入力が推奨されますが、ライセンス割り当ての必須要件ではありません。その他のメールアドレスは完全に任意の項目であり、ライセンス割り当てとは無関係です。

| 属性 | ライセンス割り当ての必須要件 | 用途 |
| :--- | :--- | :--- |
| **利用場所** | **必須** | **サービス提供可否の判断** |
| 名・姓 | 任意 | ユーザー識別情報 |
| その他のメールアドレス | 任意 | 連絡先情報 |


Microsoft Entra 管理センターまたは PowerShell を使用して利用場所を設定できます。PowerShell の場合は Set-MgUser コマンドレットで -UsageLocation パラメータを指定します。Azure portal では、ユーザーのプロファイル設定から利用場所を選択して保存します。

**リファレンス**
*   **Microsoft Entra ID**
*   **Usage Location**

**問題 313. 10 数台の仮想マシン、NSG-A という名前のネットワークセキュリティグループ、およびピアリングされている VNet-A と VNet-B という名前の 2 つの仮想ネットワークを含む Azure サブスクリプションがあります。Bastion-A という名前の Azure Bastion Basic SKU ホストを VNet-A にデプロイします。Bastion-A 経由で仮想マシンへの受信アクセスを許可するように NSG-A を構成します。受信セキュリティルールにはどのポートを設定しますか。（一つ選択）**

*   3389
*   **443**
*   22
*   5985

**解答例**
*   **443**

**解説**
**Azure Bastion は、ブラウザと Azure portal を使用して仮想マシンに安全に接続するための PaaS(Platform as a Service) サービスです。クライアントから Azure Bastion への接続には HTTPS(ポート 443) を使用します。**

**Azure Bastion を経由した仮想マシンへのアクセスフローは以下の通りです。ユーザーはブラウザから HTTPS(ポート 443) で Azure Bastion に接続し、Azure Bastion が仮想マシンへの RDP(ポート 3389) または SSH(ポート 22) 接続を確立します。このため、NSG の受信セキュリティルールでは、インターネットから Azure Bastion サブネットへのポート 443 の通信を許可する必要があります。**

**Azure Bastion を使用することで、仮想マシンにパブリック IP アドレスを割り当てることなく、RDP や SSH 接続が可能になります。また、仮想マシンの NSG でポート 3389 や 22 を直接インターネットに公開する必要がなくなるため、セキュリティが向上します。**

| 項目 | 説明 |
| :--- | :--- |
| **クライアント → Bastion** | **HTTPS(443)** |
| Bastion → VM | RDP(3389)/SSH(22) |
| **必要な NSG 設定** | **受信 443 許可** |


なお、ポート 22 は SSH、ポート 3389 は RDP、ポート 5985 は WinRM HTTP で使用されますが、これらは Azure Bastion への受信接続には使用されません。

**リファレンス**
*   **Azure Bastion**
*   **Network Security Group**
*   **Virtual Network Peering**

**問題 314. 組織では Web アプリケーションをホストする VM のトラフィック管理に Azure Load Balancer を使用しています。ユーザーからトラフィック分散が不均等で、一部の VM が他の VM よりも多くのトラフィックを受信しているという報告がありました。バックエンドプール内のすべての VM に均等にトラフィックを分散するようにロードバランサーを構成します。どうすればよいですか。（一つ選択）**

*   負荷分散規則の設定を調整する
*   セッション永続化（送信元 IP アフィニティ）を有効にする
*   バックエンドプールに VM を追加する
*   **セッション永続化を無効にする**

**解答例**
*   **セッション永続化を無効にする**

**解説**
**Azure Load Balancer でトラフィックが特定の VM に偏る主な原因は、セッション永続化 (Session Persistence) が有効になっていることです。セッション永続化は送信元 IP アフィニティとも呼ばれ、同一クライアントからのリクエストを常に同じバックエンド VM にルーティングする機能です。この機能が有効な場合、特定のクライアントからの継続的なトラフィックが同じ VM に集中し、負荷の不均衡が発生します。**

**Azure Load Balancer のデフォルト分散アルゴリズムは 5 タプルハッシュ（送信元 IP、送信元ポート、宛先 IP、宛先ポート、プロトコル）を使用します。セッション永続化を無効にすることで、このハッシュアルゴリズムが各リクエストを独立して評価し、バックエンドプール内のすべての VM に均等にトラフィックを分散できるようになります。**

負荷分散規則の設定調整や VM の追加は根本的な解決策ではありません。セッション永続化が有効なままでは、新しい VM を追加してもトラフィックの偏りは解消されません。またセッション永続化を有効にすることは、現在の問題を悪化させる選択肢です。

| 設定 | トラフィック分散 | 用途 |
| :--- | :--- | :--- |
| **セッション永続化無効** | **均等分散** | **ステートレスアプリケーション** |
| セッション永続化有効 | 同一クライアントは同一 VM | ステートフルアプリケーション |


**リファレンス**
*   **Azure Load Balancer**
*   **セッション永続化**

**問題 315. あなたの組織は Azure 仮想ネットワークを含む Azure サブスクリプションを所有しています。VNet-A という仮想ネットワークには Subnet-A というサブネットがあり、このサブネット内に 3 つの Azure 仮想マシンが稼働しています。各仮想マシンにはパブリック IP アドレスが割り当てられており、インターネットユーザーがポート 443 経由でアクセスできるアプリケーションをホストしています。オンプレミスネットワークからはサイト間 VPN 接続を介して VNet-A に接続されています。現在、インターネットとオンプレミスネットワークの両方から RDP を使用して仮想マシンにアクセスできる状態です。セキュリティ要件として、オンプレミスネットワークからの RDP 接続は許可しつつ、インターネットからの直接的な RDP アクセスを防止する必要があります。同時に、インターネットユーザーがポート 443 経由でアプリケーションにアクセスできる状態は維持しなければなりません。この要件を満たすために実施すべき対策を選択してください。（一つ選択）**

*   Subnet-A のアドレス空間を変更する
*   仮想マシンからパブリック IP アドレスを削除する
*   ローカルネットワークゲートウェイのアドレス空間を変更する
*   **Subnet-A に関連付けられた Network Security Group (NSG) に拒否ルールを作成する**

**解答例**
*   **Subnet-A に関連付けられた Network Security Group (NSG) に拒否ルールを作成する**

**解説**
**この問題の最重要ポイントは、インターネットからの RDP アクセスのみを選択的にブロックしながら、オンプレミスネットワークからの RDP 接続とインターネットからの HTTPS（ポート 443）アクセスは維持するという要件です。**

**Network Security Group (NSG) は、Azure の仮想ネットワーク内のリソースに対するネットワークトラフィックをフィルタリングするセキュリティ機能です。NSG には受信規則と送信規則を定義でき、送信元 IP アドレス、宛先ポート、プロトコルなどの条件に基づいてトラフィックを許可または拒否できます。**

**この要件を満たすには、Subnet-A に NSG を関連付け、インターネットからの RDP（ポート 3389）トラフィックを拒否する受信規則を作成します。具体的には、送信元を「Internet」サービスタグ、宛先ポートを 3389、アクションを「拒否」とする規則を設定します。同時に、オンプレミスネットワークのアドレス範囲からの RDP トラフィックを許可する規則を、より高い優先度（小さい優先度番号）で設定します。これにより、オンプレミスからの RDP 接続は許可され、インターネットからは拒否されます。ポート 443 のトラフィックには影響しないため、アプリケーションへのアクセスは維持されます。**

他の選択肢が不適切な理由を以下に示します。
| 選択肢 | 不適切な理由 |
| :--- | :--- |
| パブリック IP アドレスの削除 | インターネットからの HTTPS アクセスも不可能になり要件を満たさない |
| ローカルネットワークゲートウェイの変更 | VPN 接続の設定変更であり、RDP アクセス制御には無関係 |
| サブネットアドレス空間の変更 | ネットワーク構成の変更であり、アクセス制御機能は提供しない |


**NSG によるトラフィック制御は、送信元、宛先、ポート、プロトコルの組み合わせで細かく制御できるため、このような選択的なアクセス制御要件に最適なソリューションです。**

**リファレンス**
*   **Network Security Group**
*   **Site-to-Site VPN**
*   **Service Tag**

**問題 316. Azure 仮想マシンのデプロイを計画しています。Azure Spot インスタンスの使用を検討していますが、どのような要因で Spot インスタンスが削除される可能性があるかを評価する必要があります。Spot インスタンスの削除を引き起こす可能性がある要因として正しいものはどれですか。（二つ選択）**

*   **Azure のキャパシティ要件**
*   **インスタンスの現在の価格**
*   インスタンスのメモリ使用率
*   デプロイされているリージョン

**解答例**
*   **Azure のキャパシティ要件**
*   **インスタンスの現在の価格**

**解説**
**Azure Spot インスタンスは、Azure の未使用コンピューティングキャパシティを大幅な割引価格で利用できるサービスです。ただし、Azure が通常の従量課金制の仮想マシンにキャパシティを必要とする場合や、設定した最大価格を現在の市場価格が上回った場合に削除（eviction）される可能性があります。**

**Spot インスタンスの削除は主に 2 つの要因で発生します。1 つ目は Azure のキャパシティ要件です。Azure データセンターで通常の仮想マシンに対するキャパシティ需要が高まった場合、Spot インスタンスは優先度が低いため削除されます。2 つ目はインスタンスの現在の価格です。Spot 価格は需要と供給に基づいて変動し、ユーザーが設定した最大価格を市場価格が超えた場合、インスタンスは自動的に削除されます。**

インスタンスのメモリ使用率や CPU 使用率などのリソース使用状況は削除の要因にはなりません。これらはインスタンスのパフォーマンス指標であり、Azure プラットフォーム側の削除判断には影響しません。またデプロイされているリージョンそのものも削除要因ではなく、各リージョン内でのキャパシティ状況が影響します。

| 削除要因 | 説明 | 対策 |
| :--- | :--- | :--- |
| **キャパシティ要件** | **Azure が通常 VM にキャパシティを必要とする場合** | **削除ポリシーの設定、複数リージョンへの分散** |
| **価格超過** | **市場価格が設定した最大価格を上回る場合** | **適切な最大価格の設定、価格変動の監視** |


**Spot インスタンスを使用する際は、削除に対する耐性を持つワークロード（バッチ処理、開発環境、ステートレスアプリケーションなど）を選択し、削除ポリシー（Deallocate, Delete）を適切に設定することが重要です。**

**リファレンス**
*   **Azure Spot Virtual Machines**
*   **削除ポリシー (Eviction Policy)**

**問題 317. Azure サブスクリプションに、RG1 と RG2 という 2 つのリソースグループがあります。RG2 にはリソースが含まれていません。RG1 には以下のリソースが含まれています。RG2 に移動できるリソースはどれですか。（一つ選択）**

| リソース名 | リソースタイプ | 備考 |
| :--- | :--- | :--- |
| W10 | 仮想マシン | 実行中 |
| W10_OsDisk | ディスク | W10 にアタッチ済み |
| VNet1 | 仮想ネットワーク | W10 が接続中 |
| VNet3 | 仮想ネットワーク | 未使用 |


*   VNet1
*   W10_OsDisk
*   W10
*   **VNet3**

**解答例**
*   **VNet3**

**解説**
**Azure リソースの移動には制約があり、リソースの状態や依存関係によって移動可否が決まります。本問では未使用の仮想ネットワークのみが移動可能です。**

**仮想マシン W10 は実行中のため、停止せずに移動することはできません。仮想マシンを移動する場合は、事前に停止（割り当て解除）する必要があります。W10_OsDisk は仮想マシン W10 にアタッチされているため、アタッチされた状態では移動できません。VNet1 は仮想マシン W10 が接続しているため、仮想マシンとの依存関係がある状態では移動できません。**

**一方、VNet3 は他のリソースとの依存関係がなく、未使用の状態です。このような独立したリソースは、リソースグループ間で自由に移動できます。仮想ネットワークの移動時には、サブネット、NSG、ルートテーブルなどの関連リソースも一緒に移動されます。**

リソース移動の可否判断基準を以下に整理します。
| リソース | 状態 | 移動可否 |
| :--- | :--- | :--- |
| W10 | 実行中の仮想マシン | 不可（停止が必要） |
| W10_OsDisk | アタッチ済みディスク | 不可（デタッチが必要） |
| VNet1 | 使用中の仮想ネットワーク | 不可（依存関係あり） |
| **VNet3** | **未使用の仮想ネットワーク** | **可能** |


**リソース移動を実行する際は、Azure Portal の「移動」機能または PowerShell の Move-AzResource コマンドレットを使用します。移動前には必ず検証を実行し、依存関係や制約事項を確認することが重要です。**





ご提示いただいたソース資料（AZ-104試験問題の抜粋）に基づき、その内容を省略することなく、一文字ずつ正確に全文を出力します。各文末には出典を示すため、ソースのインデックス番号を付与します。

**リファレンス**
・Resource group
・Azure Virtual Network

---

**問題 318. あなたの組織では、Active Directory Domain Services (AD DS) ドメインと同期する Microsoft Entra Connect をセットアップした Microsoft Entra テナントを運用しています。 ユーザーが Azure ポータルから AD DS のパスワードをリセットできるようにする必要があります。 パスワードリセット時には 2 つの認証方法を使用できるようにします。 実装すべきアクションはどれですか。（二つ選択）**
*   Azure ポータルの「パスワードのリセット」から「認証方法」設定を構成する
*   Microsoft Entra Connect を実行し「パスワード ライトバック」を選択する
*   Azure ポータルの「パスワードのリセット」から「登録」設定を構成する
*   Microsoft Entra Connect を実行し「デバイス ライトバック」を選択する

**解答例**
*   Azure ポータルの「パスワードのリセット」から「認証方法」設定を構成する
*   Microsoft Entra Connect を実行し「パスワード ライトバック」を選択する

**解説**
この問題は、Microsoft Entra ID（旧 Azure AD）のセルフサービスパスワードリセット（SSPR）をオンプレミス AD DS と統合する際の必須構成要素を問うものです。 オンプレミス AD DS のパスワードをクラウドからリセットするには、パスワード ライトバック機能が必須です。 これは Microsoft Entra Connect の機能で、クラウドで変更されたパスワードをオンプレミス AD DS に書き戻します。 この機能を有効化しないと、クラウドでのパスワード変更がオンプレミス環境に反映されません。 次に、ユーザーが 2 つの認証方法を使用してパスワードをリセットできるようにするには、認証方法の設定が必要です。 SSPR では、モバイルアプリ通知、モバイルアプリコード、電子メール、携帯電話、会社電話、セキュリティの質問など複数の認証方法を選択できます。 管理者は必要な認証方法の数を指定でき、この設定により 2 つの方法を要求することが可能になります。 デバイス ライトバックはデバイス登録情報の同期に使用される機能で、パスワードリセットとは無関係です。 登録設定はユーザーに SSPR への登録を要求するかどうかを制御しますが、認証方法の数を設定するものではありません。 通知設定は管理者やユーザーへの通知を制御するもので、認証方法の構成には関係しません。

| 設定項目 | 用途 | 必須性 |
| :--- | :--- | :--- | :--- |
| パスワード ライトバック | クラウドからオンプレミスへのパスワード同期 | 必須 |
| 認証方法 | リセット時の本人確認手段と必要数の設定 | 必須 |
| 登録設定 | SSPR 登録の強制有無 | オプション |

**リファレンス**
*   Microsoft Entra Connect
*   セルフサービスパスワードリセット (SSPR)
*   パスワード ライトバック

---

**問題 319. Azure サブスクリプションに関連付けられた Microsoft Entra テナント（hogehoge.onmicrosoft.com）には、次の表に示すユーザーが存在します。 UserA は新しい Microsoft Entra テナント（foobar.onmicrosoft.com）を作成しました。 foobar.onmicrosoft.com テナント内で新規ユーザーアカウントを作成する必要があります。 解決策として、UserA に新規ユーザーアカウントの作成を依頼します。 この解決策は要件を満たしていますか。（一つ選択）**

| ユーザー名 | ロール | スコープ |
| :--- | :--- | :--- | :--- |
| UserA | グローバル管理者 | Microsoft Entra ID |
| UserB | グローバル管理者 | Microsoft Entra ID |
| UserC | ユーザー管理者 | Microsoft Entra ID |
| UserD | 所有者 | Azure サブスクリプション |

*   いいえ、UserC に依頼する必要がある
*   はい、要件を満たしている
*   いいえ、UserB に依頼する必要がある
*   いいえ、UserD に依頼する必要がある

**解答例**
*   はい、要件を満たしている

**解説**
UserA は新しい Microsoft Entra テナント (foobar.onmicrosoft.com) を作成したユーザーであり、作成者は自動的にそのテナントのグローバル管理者ロールを付与されます。 グローバル管理者は、Microsoft Entra ID のすべての管理機能に対する完全なアクセス権を持ち、ユーザーアカウントの作成、削除、変更などすべてのユーザー管理操作を実行できます。 元のテナント (hogehoge.onmicrosoft.com) で UserA がグローバル管理者であることは、新しいテナントでの権限とは無関係です。 Microsoft Entra テナントは独立した管理境界を持ち、各テナントの権限は個別に管理されます。 UserA が新しいテナントを作成した時点で、そのテナント内での管理者権限を自動的に取得しているため、UserA 自身が新規ユーザーアカウントを作成できます。 他のユーザー（UserB、UserC、UserD）は元のテナントでの権限を持っていますが、新しいテナント (foobar.onmicrosoft.com) に対する権限は持っていません。 UserD は Azure サブスクリプションの所有者ですが、これはリソース管理の権限であり、Microsoft Entra ID のユーザー管理権限とは異なります。

| 項目 | 説明 |
| :--- | :--- | :--- |
| テナント作成者の権限 | 新規テナント作成時に自動的にグローバル管理者が付与される |
| グローバル管理者の権限範囲 | ユーザー管理を含むすべての管理機能へのアクセス権 |
| テナント間の権限独立性 | 各テナントの権限は独立して管理され相互に影響しない |

**リファレンス**
*   Microsoft Entra ID

---

**問題 320. Azure サブスクリプションに 2 つの Log Analytics ワークスペース（Workspace-A と Workspace-B）が存在します。 Windows Server を実行する 100 台の仮想マシンからパフォーマンスデータとイベントを収集する必要があります。 要件として、各仮想マシンのログを Workspace-A と Workspace-B の両方に送信し、すべての Windows イベントとセキュリティイベントをキャプチャする必要があります。 各仮想マシンにインストールして構成する必要があるものを選択してください。（一つ選択）**
*   Azure Monitor Agent
*   Windows VM エージェント
*   Windows 用 Azure Diagnostics (WAD) 拡張機能
*   Log Analytics エージェント (MMA)

**解答例**
*   Azure Monitor Agent

**解説**
この問題の最重要ポイントは、複数の Log Analytics ワークスペースへの同時送信（マルチホーミング）をサポートし、包括的なログ収集が可能なエージェントを選択することです。 Azure Monitor Agent (AMA) は、Log Analytics ワークスペースへのデータ送信を担う次世代エージェントです。 AMA は複数のワークスペースへの同時送信をネイティブにサポートしており、データ収集ルール (DCR) を使用して柔軟なデータ収集設定が可能です。 パフォーマンスカウンター、Windows イベントログ、セキュリティイベントなど、要件で指定されたすべてのデータタイプの収集に対応しています。 Windows VM エージェントは仮想マシンの基本的な管理機能を提供しますが、ログ収集機能は含まれていません。 Windows 用 Azure Diagnostics (WAD) 拡張機能は診断データの収集が可能ですが、複数の Log Analytics ワークスペースへの同時送信には対応していません。 Log Analytics エージェント (MMA) は従来のエージェントで、複数ワークスペースへの送信は可能ですが、2024 年 8 月 31 日に廃止されており、新規導入には推奨されません。 各エージェントの比較を以下に示します。

| エージェント | 複数ワークスペース対応 | 推奨状況 |
| :--- | :--- | :--- | :--- |
| Azure Monitor Agent | 対応 | 推奨（現行） |
| Log Analytics エージェント | 対応 | 廃止済み |
| WAD 拡張機能 | 非対応 | 限定的用途 |

したがって、要件を満たすためには Azure Monitor Agent を各仮想マシンにインストールし、データ収集ルールを構成して両方のワークスペースにデータを送信する設定が必要です。

**リファレンス**
*   Azure Monitor Agent
*   Log Analytics Workspace
*   データ収集ルール (DCR)

---

**問題 321. 複数の Azure 仮想マシンと Azure Recovery Services コンテナーを運用しています。 仮想マシンは既定のバックアップポリシーで構成されています。 既定のバックアップポリシーにおける仮想マシンバックアップの保持期間はどれですか。（一つ選択）**
*   14 日間
*   30 日間
*   180 日間
*   90 日間

**解答例**
*   30 日間

**解説**
Azure Recovery Services コンテナーで仮想マシンのバックアップを構成する際、既定のバックアップポリシーが適用されます。 この既定ポリシーでは、日次バックアップが自動的に実行され、復旧ポイントの保持期間は 30 日間に設定されています。 既定のバックアップポリシーの主な設定内容は以下の通りです。 バックアップは毎日 1 回、指定された時刻に自動実行されます。 作成された復旧ポイントは 30 日間保持され、この期間内であれば任意の時点に仮想マシンを復元できます。 保持期間を過ぎた復旧ポイントは自動的に削除されます。 組織の要件に応じて、既定のポリシーをカスタマイズすることも可能です。 バックアップの頻度を変更したり、保持期間を延長または短縮したり、週次・月次・年次の長期保持ポイントを追加設定できます。 ただし、特別な要件がない限り、既定の 30 日間保持は多くの運用シナリオで十分な期間となっています。

| 項目 | 既定の設定値 |
| :--- | :--- | :--- |
| バックアップ頻度 | 日次（1 回/日） |
| 保持期間 | 30 日間 |
| バックアップ時刻 | カスタマイズ可能 |

なお、14 日間や 90 日間、180 日間といった保持期間は既定値ではなく、カスタムポリシーで設定する必要があります。 Azure Backup では最大 9999 日間までの保持期間を設定できますが、長期保持にはストレージコストが増加する点に注意が必要です。

**リファレンス**
*   Recovery Services Vault
*   Azure Backup
*   Backup Policy

---

**問題 322. Azure サブスクリプションに以下のリソースが含まれています。 NIC1 という名前のネットワークインターフェイスを作成します。 NIC1 を作成できるロケーションはどれですか。（一つ選択）**

| リソース名 | タイプ | ロケーション |
| :--- | :--- | :--- | :--- |
| VNET1 | 仮想ネットワーク | East US |
| VNET2 | 仮想ネットワーク | West Europe |
| NSG1 | ネットワークセキュリティグループ | North Europe |

*   East US のみ
*   East US と West Europe のみ
*   East US、West Europe、North Europe すべて
*   East US と North Europe のみ

**解答例**
*   East US、West Europe、North Europe すべて

**解説**
ネットワークインターフェイス（NIC）は、仮想マシンが Azure 仮想ネットワークと通信するために使用するリソースです。 NIC を作成する際のロケーション制約を理解することが重要です。 NIC は任意の Azure リージョンに作成できますが、仮想マシンにアタッチする際には同じリージョン内の仮想ネットワークに接続する必要があります。 NIC 自体の作成時点では、既存の仮想ネットワークやネットワークセキュリティグループと同じロケーションである必要はありません。 ネットワークセキュリティグループ（NSG）は、NIC やサブネットに関連付けることができるセキュリティルールの集合です。 NSG は異なるリージョンの NIC にも関連付けることが可能です。 したがって、NSG1 が North Europe にあることは、NIC 作成のロケーション制約にはなりません。 本問では、VNET1 が East US、VNET2 が West Europe、NSG1 が North Europe に存在しています。 NIC はこれらのすべてのロケーションで作成可能です。 ただし、実際に仮想マシンで使用する際は、その仮想マシンと同じリージョンの仮想ネットワークに接続する必要があります。

| リソース | ロケーション制約 | 備考 |
| :--- | :--- | :--- | :--- |
| NIC 作成 | 制約なし | 任意のリージョンで作成可能 |
| NIC と仮想ネットワーク | 同一リージョン必須 | VM アタッチ時に必要 |
| NIC と NSG | リージョン制約なし | 異なるリージョンでも関連付け可能 |

**リファレンス**
*   Network Interface
*   Network Security Group
*   Azure Virtual Network

---

**問題 323. Azure サブスクリプション内で、次の表に示すパブリック IP アドレスリソースを管理しています。 新たに Azure Firewall Premium インスタンスをデプロイする計画があり、このファイアウォールに関連付け可能な IP アドレスを特定する必要があります。 以下の表を参照して、Azure Firewall Premium で使用できる IP アドレスを選択してください。（一つ選択）**

| 名前 | IP バージョン | SKU | ティア | 割り当て方法 |
| :--- | :--- | :--- | :--- | :--- |
| IP-A | IPv4 | Standard | リージョナル | 静的 |
| IP-B | IPv4 | Standard | グローバル | 静的 |
| IP-C | IPv4 | Basic | リージョナル | 動的 |
| IP-D | IPv4 | Basic | リージョナル | 静的 |
| IP-E | IPv6 | Standard | リージョナル | 静的 |

*   IP-A と IP-D
*   IP-A
*   IP-B
*   IP-A、IP-B、IP-E

**解答例**
*   IP-A

**解説**
Azure Firewall Premium で使用可能なパブリック IP アドレスには、厳格な要件が定められています。 解法の最重要ポイントは、Azure Firewall がサポートする IP アドレスの SKU、バージョン、ティア、割り当て方法の組み合わせを正確に理解することです。 Azure Firewall（Standard および Premium）は、Standard SKU のパブリック IP アドレスのみをサポートします。 Basic SKU の IP アドレスは使用できません。 また、IPv4 アドレスのみがサポートされ、IPv6 アドレスは現時点では対応していません。 さらに、ティアについてはリージョナルティアのみが対応しており、グローバルティアの IP アドレスは使用できません。 割り当て方法は静的である必要があります。 各 IP アドレスを検証すると、IP-A は IPv4、Standard SKU、リージョナルティア、静的割り当てという条件をすべて満たしています。 IP-B は Standard SKU ですがグローバルティアであるため不適合です。 IP-C と IP-D は Basic SKU のため使用できません。 IP-E は Standard SKU ですが IPv6 であるため対応していません。 以下の表で要件を整理します。

| 要件項目 | Azure Firewall の要求仕様 | 備考 |
| :--- | :--- | :--- | :--- |
| IP バージョン | IPv4 のみ | IPv6 は非対応 |
| SKU | Standard | Basic は使用不可 |
| ティア | リージョナル | グローバルは使用不可 |

したがって、Azure Firewall Premium で使用できるのは IP-A のみです。

**リファレンス**
*   Azure Firewall
*   Public IP Address
*   Standard SKU

---

**問題 324. オンプレミスの Hyper-V 環境を Azure Site Recovery を使用して Azure に移行する計画を立てています。 Hyper-V 環境は Microsoft System Center Virtual Machine Manager (VMM) を使用して管理されています。 Hyper-V 環境には以下の仮想マシンが含まれています。 Azure Site Recovery を使用して移行できる仮想マシンはどれですか。（一つ選択）**

| 仮想マシン名 | オペレーティングシステム | 世代 |
| :--- | :--- | :--- | :--- |
| VM1 | Windows Server 2019 | 第 2 世代 |
| VM2 | Windows Server 2012 R2 | 第 1 世代 |
| VM3 | Ubuntu 20.04 LTS | 第 2 世代 |
| VM4 | Windows Server 2008 R2 | 第 1 世代 |

*   VM3
*   VM4
*   VM1
*   VM2

**解答例**
*   VM2

**解説**
Azure Site Recovery で Hyper-V 仮想マシンを Azure に移行する際は、オペレーティングシステムのサポート状況と仮想マシンの世代が重要な要素となります。 Azure Site Recovery は、System Center VMM で管理されている Hyper-V 環境からのレプリケーションをサポートしていますが、すべての構成が移行可能というわけではありません。 特に第 2 世代仮想マシンのサポートには制限があり、VMM で管理されている Hyper-V 環境から第 2 世代仮想マシンを直接レプリケートすることはできません。 各仮想マシンの移行可否を確認すると、VM1 と VM3 は第 2 世代仮想マシンであるため移行対象外となります。 VM4 は Windows Server 2008 R2 を実行していますが、この OS は Azure Site Recovery のサポート対象外です。 VM2 は Windows Server 2012 R2 を実行する第 1 世代仮想マシンであり、すべての要件を満たしています。

| 項目 | サポート状況 |
| :--- | :--- | :--- |
| 第 1 世代 VM (VMM マネージド) | サポート対象 |
| 第 2 世代 VM (VMM マネージド) | サポート対象外 |
| Windows Server 2008 R2 | サポート対象外 |

したがって、VM2 が正解となります。 Windows Server 2012 R2 以降の OS を実行し、第 1 世代仮想マシンとして構成されているため、Azure Site Recovery を使用した移行が可能です。

**リファレンス**
*   Azure Site Recovery
*   System Center Virtual Machine Manager
*   Hyper-V

---

**問題 325. Azure サブスクリプションに複数のストレージリソースがあります。 Azure Import/Export サービスを使用して Export1 という名前のエクスポートジョブを計画しています。 Export1 を使用してエクスポート可能なデータを特定します。 以下のリソースのうち、Azure Import/Export ジョブでエクスポート可能なものはどれですか。（一つ選択）**

| リソース名 | リソースタイプ |
| :--- | :--- | :--- |
| DB1 | Azure SQL Database |
| Table1 | Azure Table Storage |
| container1 | Azure Blob Storage |
| Share1 | Azure Files |

*   Azure Blob Storage の container1
*   Azure Table Storage の Table1
*   Azure Files の Share1
*   Azure SQL Database の DB1

**解答例**
*   Azure Blob Storage の container1

**解説**
Azure Import/Export サービスは、大量のデータを物理ディスクドライブを使用して Azure データセンターとの間で転送するサービスです。 このサービスでサポートされるストレージタイプには制限があります。 Azure Import/Export サービスがサポートするのは、Azure Blob Storage（ブロック Blob とページ Blob）のみです。 エクスポートジョブでは、ストレージアカウント内の Blob データを物理ディスクドライブにコピーし、オンプレミス環境に送付します。 Azure SQL Database は、データベースサービスであり、Import/Export サービスの対象外です。 データベースのエクスポートには、BACPAC ファイルを使用したエクスポート機能を利用します。 Azure Table Storage は、NoSQL データストアですが、Import/Export サービスではサポートされていません。 Table Storage のデータ移行には、AzCopy などのツールを使用します。 Azure Files は、SMB プロトコルを使用するファイル共有サービスですが、Import/Export サービスの対象外です。 Azure File Sync などの別の方法でデータ転送を行います。

| ストレージタイプ | Import/Export 対応 | 代替手段 |
| :--- | :--- | :--- | :--- |
| Blob Storage | 対応 | AzCopy |
| Table Storage | 非対応 | AzCopy |
| Azure Files | 非対応 | Azure File Sync |

したがって、Export1 ジョブでエクスポート可能なデータは、Azure Blob Storage の container1 のみです。

**リファレンス**
*   Azure Import/Export
*   Azure Blob Storage
*   AzCopy

---

**問題 326. Azure サブスクリプションに、VNet1 という名前の仮想ネットワークに接続された複数のリソースがあります。 VNet1 に Bastion1 という名前の Azure Bastion ホストをデプロイする予定です。 次のリソースのうち、Bastion1 を使用して保護できるリソースはどれですか。（一つ選択）**
リソース一覧：

| リソース名 | リソースタイプ |
| :--- | :--- | :--- |
| VM1 | 仮想マシン |
| App1 | App Service |
| hogehoge.local | プライベート DNS ゾーン |

*   App1 と hogehoge.local のみ
*   VM1 のみ
*   VM1 と hogehoge.local のみ
*   VM1、App1、hogehoge.local すべて

**解答例**
*   VM1 のみ

**解説**
Azure Bastion は、仮想ネットワーク内の仮想マシンに対して安全な RDP および SSH 接続を提供する PaaS 型サービスです。 ブラウザ経由で Azure Portal 上から直接仮想マシンに接続でき、パブリック IP アドレスを仮想マシンに割り当てる必要がありません。 Azure Bastion が保護できるのは、同じ仮想ネットワーク内またはピアリングされた仮想ネットワーク内の仮想マシンのみです。 App Service やプライベート DNS ゾーンなどの PaaS リソースは、Azure Bastion の保護対象外です。 各リソースの保護可否：

| リソース | 保護可否 | 理由 |
| :--- | :--- | :--- | :--- |
| VM1 | 可能 | VNet1 内の仮想マシン |
| App1 | 不可 | PaaS サービスで対象外 |
| hogehoge.local | 不可 | DNS ゾーンで対象外 |

Azure Bastion は仮想マシンへのセキュアなリモートアクセスを提供する専用サービスであり、その保護範囲は仮想マシンリソースに限定されます。 App Service は HTTP/HTTPS 経由でアクセスする Web アプリケーションホスティングサービスであり、プライベート DNS ゾーンは名前解決を提供するサービスであるため、いずれも Bastion の保護対象にはなりません。 したがって、Bastion1 を使用して保護できるリソースは VM1 のみです。

**リファレンス**
*   Azure Bastion
*   Azure Virtual Network

---

**問題 327. Azure サブスクリプションに以下のリソースが含まれています。 NSG1 を適用できるサブネットはどれですか。（一つ選択）**

| リソース名 | タイプ | リージョン |
| :--- | :--- | :--- | :--- |
| VNet1 | 仮想ネットワーク | 米国東部 |
| VNet2 | 仮想ネットワーク | 米国西部 |
| VNet3 | 仮想ネットワーク | 米国西部 |
| NSG1 | ネットワークセキュリティグループ | 米国西部 |

*   VNet2 と VNet3 のサブネットのみ
*   VNet1 のサブネットのみ
*   VNet1、VNet2、VNet3 のすべてのサブネット
*   VNet3 のサブネットのみ

**解答例**
*   VNet2 と VNet3 のサブネットのみ

**解説**
Network Security Group (NSG) は、仮想ネットワークのサブネットまたはネットワークインターフェイスに適用してトラフィックを制御するセキュリティ機能です。 NSG を適用する際の最重要ポイントは、NSG と仮想ネットワークが同じリージョンに存在する必要があることです。 本問では、NSG1 は米国西部リージョンに作成されています。 したがって、NSG1 を適用できるのは同じ米国西部リージョンに存在する VNet2 と VNet3 のサブネットのみとなります。 VNet1 は米国東部リージョンに存在するため、NSG1 を適用することはできません。 NSG はリージョン固有のリソースであり、異なるリージョン間での共有や移動はできません。 複数のリージョンで同様のセキュリティルールを適用する場合は、各リージョンに個別の NSG を作成する必要があります。

| 項目 | 説明 |
| :--- | :--- | :--- |
| NSG の適用範囲 | 同一リージョン内の仮想ネットワークのみ |
| 適用対象 | サブネットまたはネットワークインターフェイス |
| リージョン制約 | NSG と仮想ネットワークは同じリージョンに存在する必要がある |

NSG には受信セキュリティ規則と送信セキュリティ規則を定義でき、優先度に基づいてトラフィックの許可または拒否を制御します。 一つのサブネットには一つの NSG のみを関連付けることができますが、一つの NSG は複数のサブネットやネットワークインターフェイスに適用することが可能です。

**リファレンス**
*   Network Security Group
*   Azure Virtual Network
*   Azure Region

---

**問題 328. Azure サブスクリプションに複数の仮想マシンが存在し、それぞれ Windows Server 2022 が稼働しています。 プライベート Azure DNS ゾーン「hogehoge.local」を作成し、VNet-Alpha からの自動登録を有効化しました。 以下の表に示す仮想マシン VM-Alpha について、hogehoge.local ゾーンに自動登録される A レコードの内容を選択してください。（一つ選択）**

| 名前 | プライベート IP アドレス | パブリック IP アドレス | 仮想ネットワーク名 | Windows Server で構成された DNS サフィックス |
| :--- | :--- | :--- | :--- | :--- |
| VM-Alpha | 10.2.0.10 | 40.112.72.45 | VNet-Alpha | hogehoge.local |
| VM-Beta | 10.2.0.11 | 13.78.108.22 | VNet-Alpha | foobar.local |

*   なし
*   プライベート IP アドレスのみ
*   パブリック IP アドレスのみ
*   プライベート IP アドレスとパブリック IP アドレスの両方

**解答例**
*   プライベート IP アドレスのみ

**解説**
Azure Private DNS Zone の自動登録機能では、仮想ネットワークにリンクされた仮想マシンのプライベート IP アドレスのみが A レコードとして自動的に登録されます。 パブリック IP アドレスは登録対象外です。 VM-Alpha は VNet-Alpha に所属し、プライベート DNS ゾーン「hogehoge.local」に自動登録が有効化されているため、VM-Alpha のプライベート IP アドレス (10.2.0.10) が A レコードとして登録されます。 Windows Server で構成された DNS サフィックスがプライベート DNS ゾーン名と一致していることも、正常な名前解決を実現する要素となります。 一方、VM-Beta は DNS サフィックスが異なる (foobar.local) ため、hogehoge.local ゾーンには登録されません。 自動登録機能は、仮想ネットワークレベルで有効化されますが、実際のレコード登録は各仮想マシンの構成に依存します。

| 項目 | 登録対象 |
| :--- | :--- | :--- |
| プライベート IP アドレス | 自動登録される |
| パブリック IP アドレス | 登録されない |
| 登録条件 | 仮想ネットワークリンクで自動登録を有効化 |

Azure Private DNS Zone は、Azure 内部のプライベートネットワークにおける名前解決を提供するサービスです。 自動登録機能を使用することで、仮想マシンのデプロイや削除に応じて DNS レコードが自動的に更新され、管理負荷を軽減できます。

**リファレンス**
*   Azure Private DNS Zone

---

**問題 329. Azure Application Gateway のパフォーマンス問題をトラブルシューティングしています。 過去 6 時間の総リクエスト数と失敗したリクエスト数を比較します。 何を使用しますか。（一つ選択）**
*   Connection troubleshoot を使用する
*   Application Gateway の Diagnostics logs を使用する
*   Application Gateway の Metrics を使用する
*   Azure Network Watcher の NSG flow logs を使用する

**解答例**
*   Application Gateway の Metrics を使用する

**解説**
Application Gateway のパフォーマンス分析では、リクエスト数や失敗数などの数値データをリアルタイムで可視化し比較する必要があります。 この要件に最適なのが Metrics 機能です。 Metrics は、Application Gateway が自動的に収集する数値データを時系列グラフで表示する機能です。 総リクエスト数 (Total Requests)、失敗リクエスト数 (Failed Requests)、応答時間、スルーブットなど、パフォーマンス監視に必要な指標を同一画面で比較できます。 過去 6 時間などの期間設定も可能で、トラブルシューティング時の傾向分析に有効です。 Diagnostics logs は詳細なログ情報を記録しますが、数値の集計や比較には向きません。 NSG flow logs は Network Security Group のトラフィックログであり、Application Gateway のリクエスト統計は取得できません。 Connection troubleshoot はネットワーク接続の診断ツールで、リクエスト数の比較には使用しません。

| 機能 | 用途 | リクエスト数比較 |
| :--- | :--- | :--- | :--- |
| Metrics | 数値データの可視化と比較 | 可能 |
| Diagnostics logs | 詳細ログの記録 | 不可 |
| NSG flow logs | NSG トラフィック記録 | 不可 |

**リファレンス**
*   Azure Application Gateway
*   Azure Monitor Metrics
*   Diagnostics logs

---

**問題 330. あなたは adatum.com という名前の Microsoft Entra ID（旧 Azure AD）テナントの全体管理者です。 Azure ユーザーに対して多要素認証を有効化します。 どうすればよいですか。（一つ選択）**
*   Microsoft Entra ID Connect をインストールして構成する
*   Microsoft Entra ID の条件付きアクセスポリシーを作成する
*   セキュリティの既定値群を有効化する
*   Identity Hub を作成して構成する

**解答例**
*   Microsoft Entra ID の条件付きアクセスポリシーを作成する

**解説**
Microsoft Entra ID（旧 Azure AD）で多要素認証（MFA : Multi-Factor Authentication）を有効化するには、条件付きアクセスポリシーを使用します。 条件付きアクセスは、特定の条件下でユーザーに追加の認証要素を要求する仕組みで、組織のセキュリティポリシーに基づいて柔軟に設定できます。 条件付きアクセスポリシーでは、ユーザーやグループ、アプリケーション、場所、デバイスの状態などの条件を指定し、それらの条件に一致した場合に MFA を要求するように構成します。 これにより、すべてのユーザーまたは特定のユーザーグループに対して多要素認証を強制できます。 他の選択肢について、Microsoft Entra ID Connect はオンプレミスのディレクトリとクラウドを同期するツールであり、MFA の有効化には直接関係しません。 セキュリティの既定値群は簡易的なセキュリティ設定ですが、より詳細な制御が必要な場合は条件付きアクセスを使用します。 Identity Hub は実在しないサービス名です。

| 項目 | 説明 |
| :--- | :--- | :--- |
| 条件付きアクセス | 特定条件下で MFA などの制御を適用 |
| MFA | パスワード以外の認証要素を追加 |
| セキュリティの既定値群 | 基本的なセキュリティ設定の簡易版 |

**リファレンス**
*   Conditional Access
*   Multi-Factor Authentication (MFA)
*   Microsoft Entra ID

---

**問題 331. Azure サブスクリプションに複数のストレージアカウントが含まれています。 あるユーザーに対して、ストレージアカウント内のコンテナーを管理し、ストレージアカウントのアクセスキーを表示する権限を付与します。 最小特権の原則に従ってロールを割り当てる場合、どのロールを割り当てるべきですか。（一つ選択）**
*   Storage Blob Data Contributor
*   Storage Account Contributor
*   Contributor
*   Reader

**解答例**
*   Storage Account Contributor

**解説**
この問題は、Azure のロールベースアクセス制御（RBAC）における最小特権の原則を理解しているかを問うものです。 要件は「コンテナーの管理」と「アクセスキーの表示」の 2 つです。 Storage Account Contributor ロールは、ストレージアカウントの管理に必要な権限を提供します。 このロールでは、コンテナーの作成・削除・管理が可能で、さらにストレージアカウントのアクセスキーの表示も許可されています。 最小特権の原則に従いつつ、要件を満たす最適なロールです。 Storage Blob Data Contributor は、Blob データの読み取り、書き込み、削除は可能ですが、アクセスキーの表示権限は含まれていません。 データプレーン操作に特化したロールであり、管理プレーン操作であるアクセスキーの表示はできません。 Contributor ロールは、サブスクリプション全体のリソース管理権限を持つため、ストレージアカウントの管理には過剰な権限となり、最小特権の原則に反します。 Reader ロールは読み取り専用のため、コンテナーの管理ができず要件を満たしません。

| ロール | コンテナー管理 | アクセスキー表示 | 権限範囲 |
| :--- | :--- | :--- | :--- | :--- |
| Storage Account Contributor | 可能 | 可能 | ストレージアカウント |
| Storage Blob Data Contributor | 可能 | 不可 | Blob データのみ |
| Contributor | 可能 | 可能 | サブスクリプション全体 |

**リファレンス**
*   Azure RBAC (Role-Based Access Control)
*   Storage Account Contributor
*   Principle of Least Privilege

---

**問題 332. 次の表に示すリソースがあります。 Azure Firewall の FW-A を使用して VNet-A からの送信トラフィックを管理するために、最初に実施すべき構成はどれですか。（一つ選択）**

| 名前 | タイプ | 説明 |
| :--- | :--- | :--- | :--- |
| App-A | App Service | VNet-A に対して仮想ネットワーク統合が有効 |
| ASP-A | App Service Plan | Standard SKU |
| VNet-A | 仮想ネットワーク | なし |
| FW-A | Azure Firewall | VNet-A に接続 |

*   ルートテーブルを作成する
*   Azure Network Watcher を作成する
*   ASP-A を Premium SKU にアップグレードする
*   プライベートエンドポイントを構成する

**解答例**
*   ルートテーブルを作成する

**解説**
Azure Firewall を使用して VNet-A からの送信トラフィックを管理するには、トラフィックが Azure Firewall を経由するようにルーティングを構成する必要があります。 デフォルトでは、仮想ネットワーク内のリソースは直接インターネットに接続するため、Azure Firewall を経由させるにはルートテーブル (User Defined Route、UDR) を作成して適用します。 ルートテーブルでは、宛先アドレスプレフィックスとネクストホップを指定します。 送信トラフィックを Azure Firewall に転送するには、デフォルトルート (0.0.0.0/0) のネクストホップを Azure Firewall のプライベート IP アドレスに設定します。 このルートテーブルを App-A が統合されているサブネットに関連付けることで、App-A からの送信トラフィックが Azure Firewall を経由するようになります。 App Service Plan の SKU をアップグレードする選択肢は、この要件には関係ありません。 Standard SKU でも仮想ネットワーク統合は利用可能であり、Azure Firewall を経由させるために SKU の変更は不要です。 Azure Network Watcher は、ネットワークの監視と診断に使用するサービスであり、トラフィックのルーティング構成には直接関与しません。

| 項目 | 説明 |
| :--- | :--- | :--- |
| ルートテーブル | トラフィックの転送先を制御 |
| デフォルトルート | 0.0.0.0/0 で全送信トラフィックを対象 |
| ネクストホップ | Azure Firewall のプライベート IP |

**リファレンス**
*   Azure Firewall
*   ルートテーブル (User Defined Route)
*   Virtual Network Integration

---

**問題 333. あなたは、複数のストレージアカウントを含む Azure サブスクリプションを管理しています。 West US リージョンに Web アプリをデプロイし、このアプリケーションのバックアップを構成する必要があります。 コストを最小限に抑えながらバックアップを実装する場合、バックアップターゲットとして使用すべきストレージアカウントはどれですか。（一つ選択）**

| ストレージアカウント | リージョン | パフォーマンス | レプリケーション |
| :--- | :--- | :--- | :--- | :--- |
| storage1 | West US | Standard | LRS |
| storage2 | East US | Premium | ZRS |
| storage3 | West US | Premium | GRS |
| storage4 | Central US | Standard | GRS |

*   storage3
*   storage4
*   storage2
*   storage1

**解答例**
*   storage1

**解説**
Azure App Service のバックアップ機能では、バックアップデータの保存先として Standard パフォーマンス層のストレージアカウントを使用する必要があります。 コスト最適化の観点から、同一リージョン内のストレージアカウントを選択することでデータ転送コストを削減できます。 storage1 は、West US リージョンに配置された Standard パフォーマンス層のストレージアカウントであり、LRS（ローカル冗長ストレージ）を使用しているため、最もコスト効率の高い選択肢となります。 バックアップデータは同一リージョン内で転送されるため、リージョン間のデータ転送料金が発生しません。 storage2 と storage3 は Premium パフォーマンス層を使用しているため、Standard と比較してストレージコストが高くなります。 storage4 は Standard パフォーマンス層ですが、Central US リージョンに配置されているため、West US からのデータ転送に追加コストが発生します。 App Service バックアップの要件と各ストレージアカウントの特性を比較すると以下のようになります。

| 要件 | storage1 | storage2 | storage3 | storage4 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| パフォーマンス層 | Standard (適合) | Premium (高コスト) | Premium (高コスト) | Standard (適合) |
| リージョン | West US (同一) | East US (異なる) | West US (同一) | Central US (異なる) |
| コスト効率 | 最適 | 不適 | 不適 | 準最適 |

**リファレンス**
*   Azure App Service
*   Azure Storage Account
*   LRS (Locally Redundant Storage)

---

**問題 334. Azure サブスクリプション内に 2 つの仮想ネットワーク VNet1 と VNet2 があります。 VNet1 には静的ルーティングを使用する VPN ゲートウェイ VPNGW1 が構成されており、オンプレミスネットワークとの間にサイト間 VPN 接続が確立されています。 Windows 10 を実行するクライアントマシンから VNet1 へのポイント対サイト VPN 接続を構成しました。 VNet1 と VNet2 の間で仮想ネットワークピアリングを設定し、オンプレミスネットワークから VNet2 への接続が可能であることを確認しました。 しかし、クライアントマシンから VNet2 への接続ができません。 クライアントマシンが VNet2 に接続できるようにするには、どの操作を実行する必要がありますか。（一つ選択）**
*   VNet1 でゲートウェイ転送を許可する設定を有効にする
*   クライアントマシンで VPN クライアント構成パッケージをダウンロードして再インストールする
*   VPNGW1 で Border Gateway Protocol を有効にする
*   VNet2 でゲートウェイ転送を許可する設定を有効にする

**解答例**
*   クライアントマシンで VPN クライアント構成パッケージをダウンロードして再インストールする

**解説**
ポイント対サイト VPN 接続を使用するクライアントが、ピアリングされた仮想ネットワークにアクセスするためには、VPN クライアント構成パッケージの更新が必要です。 仮想ネットワークピアリングを構成した後、ポイント対サイト VPN クライアントは自動的にピアリング先のネットワークへのルート情報を取得しません。 VPN ゲートウェイが存在する VNet1 とピアリングされた VNet2 へのアクセスを可能にするには、更新されたルート情報を含む新しい VPN クライアント構成パッケージをダウンロードし、クライアントマシンに再インストールする必要があります。 ゲートウェイ転送の設定は、ピアリングされた仮想ネットワーク間で VPN ゲートウェイを共有するための機能です。 この設定により、VNet2 から VNet1 の VPN ゲートウェイを経由してオンプレミスネットワークへアクセスすることが可能になります。 問題文ではオンプレミスから VNet2 への接続が既に確認されているため、ゲートウェイ転送は正しく構成されています。 Border Gateway Protocol は動的ルーティングプロトコルであり、静的ルーティングを使用している現在の構成では関係ありません。 また、この設定変更はポイント対サイト VPN 接続の問題解決には直接影響しません。

| 項目 | 説明 |
| :--- | :--- | :--- |
| ポイント対サイト VPN | クライアントマシンから仮想ネットワークへの個別接続 |
| 仮想ネットワークピアリング | 異なる仮想ネットワーク間を接続する機能 |
| VPN クライアント構成パッケージ | 接続に必要なルート情報と証明書を含むファイル |

**リファレンス**
*   Virtual Network Peering
*   ポイント対サイト VPN 接続

---

**問題 335. Azure Kubernetes Service (AKS) クラスターを運用しています。 このクラスターには複数のポッドがデプロイされており、kubenet ネットワークプラグインを使用しています。 セキュリティ要件として、特定のポッド間でのみ通信を許可し、その他のポッド間通信を制限する必要があります。 この要件を満たすために、AKS クラスターで構成すべきものはどれですか。（一つ選択）**
*   Azure Private Link
*   Calico ネットワークポリシー
*   ポッドセキュリティポリシー
*   アプリケーションセキュリティグループ

**解答例**
*   Calico ネットワークポリシー

**解説**
kubenet ネットワークプラグインを使用する AKS クラスターでポッド間通信を制御するには、Calico ネットワークポリシーを使用します。 AKS では、ポッド間のネットワークトラフィック制御に 2 種類のネットワークポリシーが利用可能です。 Azure CNI (Container Networking Interface) を使用する場合は Azure ネットワークポリシーまたは Calico ネットワークポリシーのいずれかを選択できますが、kubenet を使用する場合は Calico ネットワークポリシーのみがサポートされます。 Calico は、Kubernetes ネイティブなネットワークポリシーエンジンで、ポッド、名前空間、ラベルセレクターを使用して詳細なトラフィック制御ルールを定義できます。 イングレス（受信）とエグレス（送信）の両方向のトラフィックを制御し、IP アドレス、ポート番号、プロトコルレベルでのフィルタリングが可能です。 ポッドセキュリティポリシーは、ポッドの実行時セキュリティ設定（特権モード、ホストネットワークアクセスなど）を制御するものであり、ネットワークトラフィックの制御には使用しません。 アプリケーションセキュリティグループは、Azure 仮想マシンのネットワークセキュリティを管理するためのもので、AKS ポッド間通信の制御には適用できません。 Azure Private Link は、Azure サービスへのプライベート接続を提供するサービスであり、ポッド間通信制御とは目的が異なります。

| 項目 | kubenet | Azure CNI |
| :--- | :--- | :--- | :--- |
| サポートされるネットワークポリシー | Calico のみ | Azure または Calico |
| IP アドレス管理 | ノード IP から NAT | VNet から直接割り当て |
| 適用範囲 | ポッド間通信制御 | ポッド間通信制御 |

| 選択肢 | 用途 | ポッド間通信制御 |
| :--- | :--- | :--- | :--- |
| Calico ネットワークポリシー | Kubernetes ネットワークトラフィック制御 | 可能 |
| ポッドセキュリティポリシー | ポッド実行時セキュリティ設定 | 不可 |
| アプリケーションセキュリティグループ | Azure VM 向けネットワークセキュリティ | 不可 |

**リファレンス**
*   Azure Kubernetes Service (AKS)
*   Calico ネットワークポリシー

---

**問題 336. Azure サブスクリプションに、100 台の仮想マシンを含むリソースグループ RG1 があります。 会社には製造部門、営業部門、財務部門という 3 つのコストセンターがあります。 各仮想マシンを特定のコストセンターに関連付けます。 何を実施しますか。（一つ選択）**
*   仮想マシンにタグを割り当てる
*   仮想マシンのインベントリ設定を変更する
*   仮想マシンに診断設定を構成する
*   仮想マシンにロックを構成する

**解答例**
*   仮想マシンにタグを割り当てる

**解説**
Azure リソースのコスト管理と組織化において、タグは最も効果的な手段です。 タグは名前と値のペアで構成されるメタデータで、リソースに柔軟に割り当てることができます。 本問では、各仮想マシンを特定のコストセンターに関連付ける必要があります。 この要件を満たすには、例えば「CostCenter」という名前のタグを作成し、値として「Manufacturing」「Sales」「Finance」を各仮想マシンに割り当てます。 タグを使用することで、Cost Management や Azure Portal でコストセンター別にリソースをフィルタリングし、部門ごとの使用状況やコストを追跡できます。 インベントリ設定は Azure Automation の機能で、仮想マシン内のソフトウェアやサービスの情報収集に使用するものであり、コストセンターの関連付けには使用できません。 診断設定はログやメトリックの収集に使用され、ロックはリソースの削除や変更を防ぐ機能であり、いずれもコスト管理の目的には適していません。 タグを使用したコスト管理の主な利点を以下に示します。

| 項目 | 説明 |
| :--- | :--- | :--- |
| コスト配分 | 部門別、プロジェクト別にコストを集計可能 |
| レポート作成 | Cost Management でタグ別のレポート生成 |
| 柔軟性 | 複数のタグを組み合わせて詳細な分類が可能 |

タグは最大 50 個まで各リソースに割り当て可能で、タグ名は最大 512 文字、タグ値は最大 256 文字まで設定できます。 Azure Policy を使用してタグの適用を強制することも可能です。

**リファレンス**
*   Azure タグ
*   Cost Management
*   Azure Policy

---

**問題 337. Azure で運用している Web アプリ App1 には、本番環境用のスロット webapp1-prod とテスト環境用のスロット webapp1-test があります。 webapp1-test で複数の変更をテストした後、App1 のバックアップを取得しました。 その後、webapp1-test と webapp1-prod をスワップしましたが、App1 にパフォーマンスの問題が発生していることが判明しました。 できるだけ迅速に以前のバージョンの App1 に戻す必要があります。 どの操作を実行しますか。（一つ選択）**
*   デプロイスロットを再度スワップする
*   App1 のバックアップを復元する
*   App1 を別のリソースグループに複製する
*   以前のデプロイ履歴からロールバックを実行する

**解答例**
*   デプロイスロットを再度スワップする

**解説**
App Service のデプロイスロット機能では、スワップ操作は双方向で実行可能です。 webapp1-test と webapp1-prod をスワップした後にパフォーマンス問題が発生した場合、最も迅速な対処方法は再度スワップを実行することです。 この操作により、本番スロットは即座に以前の状態に戻ります。 スワップ操作は通常数秒から数分で完了し、ダウンタイムもほとんど発生しません。 スワップ時にはアプリケーション設定や接続文字列などの構成も適切に処理されるため、安全かつ確実にロールバックできます。 他の選択肢の問題点を以下に整理します。

| 操作 | 所要時間 | 問題点 |
| :--- | :--- | :--- | :--- |
| バックアップ復元 | 長時間 | 復元処理に時間がかかり、ダウンタイムが発生する |
| 複製操作 | 長時間 | 新規リソース作成が必要で、DNS 設定変更も伴う |
| デプロイ履歴ロールバック | 中程度 | 再デプロイが必要で、スワップより時間がかかる |

デプロイスロットのスワップ機能は、本番環境への変更を安全にテストし、問題発生時に迅速にロールバックするために設計されています。 この機能を活用することで、ゼロダウンタイムでのデプロイとロールバックが実現できます。

**リファレンス**
*   App Service デプロイスロット
*   スワップ操作

---

**問題 338. Windows Server 2019 を実行する VM1 という名前の Azure 仮想マシンがあります。 User1 というユーザーとして VM1 にサインインし、次の操作を実行しました：C ドライブにファイルを作成、D ドライブにファイルを作成、スクリーンセーバーのタイムアウトを変更、デスクトップの背景を変更しました。 VM1 を再デプロイする予定です。 VM1 を再デプロイした後、失われる変更はどれですか。（一つ選択）**
*   D ドライブに作成した新しいファイル
*   変更したスクリーンセーバーのタイムアウト
*   C ドライブに作成した新しいファイル
*   新しいデスクトップの背景

**解答例**
*   変更したスクリーンセーバーのタイムアウト

**解説**
Azure 仮想マシンの再デプロイ (Redeploy) は、仮想マシンを別の物理ホストに移動させる操作です。 この操作により、OS ディスク (C ドライブ) とデータディスク (D ドライブ) のデータは保持されますが、一時ディスクのデータは失われます。 また、ユーザープロファイル設定などのレジストリベースの設定も初期化される可能性があります。 スクリーンセーバーのタイムアウト設定は、Windows のレジストリまたはユーザープロファイルに保存される設定です。 再デプロイ時に OS が再初期化されるため、これらのユーザー固有の設定は失われます。 同様に、デスクトップの背景設定もユーザープロファイルに保存されるため失われる可能性がありますが、本問では最も確実に失われる設定としてスクリーンセーバーのタイムアウトが正解となります。 一方、C ドライブと D ドライブに作成したファイルは、それぞれ OS ディスクとデータディスクに保存されているため、再デプロイ後も保持されます。 Azure 仮想マシンの再デプロイは、接続されているマネージドディスクのデータには影響を与えません。

| 項目 | 再デプロイ後の状態 | 理由 |
| :--- | :--- | :--- | :--- |
| C ドライブのファイル | 保持 | OS ディスクのデータは保持される |
| D ドライブのファイル | 保持 | データディスクのデータは保持される |
| スクリーンセーバー設定 | 失われる | レジストリ設定が初期化される |

**リファレンス**
*   Azure Virtual Machine
*   Redeploy
*   Managed Disk

---

**問題 339. Azure サブスクリプションを管理しています。 次のコマンドを実行したところ、以下の出力が得られました。**

`Get-AzRoleDefinition | Format-Table -Property Name, Id`

出力結果：
`CustomRole1 111-222-333-444-555`
`Owner 8e3af657-a8ff-443c-a75c-2fe8c4bcb635`
`Contributor b24988ac-6180-42a0-ab88-20f7382dd24c`
`Reader acddf2a2-3165-4f6f-8082-a0b80f8db3ae7`

リソースグループレベルでのアクセス管理を自動化するため、以下の PowerShell スクリプトを毎晩実行しています。

`$rg = "RG1"`
`$RoleName = "111-222-333-444-555"`
`$Role = Get-AzRoleDefinition -Name $RoleName`
`New-AzRoleAssignment -SignInName user1@hogehoge.com -RoleDefinitionName $Role.Name -ResourceGroupName $rg`

User1 が RG1 リソースグループにアクセスできず、スクリプトが失敗することが判明しました。 スクリプトを修正して正常に動作させる必要があります。 スクリプトのどの部分を変更すべきですか。（一つ選択）
*   `$Role = Get-AzRoleDefinition -Id $RoleName` に変更する
*   `$RoleName = "CustomRole1"` に変更する
*   `$Role = Get-AzRoleAssignment -Name $RoleName` に変更する
*   `New-AzRoleAssignment` コマンドレットの `-RoleDefinitionId` パラメータを使用する

**解答例**
*   `$RoleName = "CustomRole1"` に変更する

**解説**
このスクリプトが失敗する原因は、`Get-AzRoleDefinition` コマンドレットの `-Name` パラメータにロール ID を指定している点です。 `Get-AzRoleDefinition` は `-Name` パラメータでロール名を、`-Id` パラメータでロール ID を受け取ります。 現在のスクリプトでは `$RoleName` 変数に 「111-222-333-444-555」 という ID が格納されていますが、`Get-AzRoleDefinition -Name` はロール名を期待するため、該当するロール定義が見つからずエラーとなります。 出力結果から 「111-222-333-444-555」 は 「CustomRole1」 というカスタムロールの ID であることがわかります。 したがって、`$RoleName` 変数にロール名である 「CustomRole1」 を設定することで、`Get-AzRoleDefinition -Name $RoleName` が正しく動作します。

| パラメータ | 指定する値 | 例 |
| :--- | :--- | :--- | :--- |
| -Name | ロール名 | CustomRole1, Owner, Contributor |
| -Id | ロール ID (GUID) | 111-222-333-444-555 |

修正後のスクリプトでは、`$RoleName = "CustomRole1"` とすることで、`Get-AzRoleDefinition -Name $RoleName` が正しくロール定義を取得し、その後の `New-AzRoleAssignment` で User1 に適切なロールを割り当てることができます。 Azure RBAC におけるロール割り当ての自動化では、ロール名とロール ID の違いを正確に理解し、適切なパラメータを使用することが重要です。

| コマンドレット | 用途 |
| :--- | :--- | :--- |
| Get-AzRoleDefinition | ロール定義の取得 |
| New-AzRoleAssignment | ロールの割り当て |
| Get-AzRoleAssignment | 既存のロール割り当ての確認 |

**リファレンス**
*   Azure RBAC (Role-Based Access Control)
*   Get-AzRoleDefinition

---

**問題 340. Azure サブスクリプションに App1 という名前の Azure App Service Web アプリがあります。 現在、以下の診断ログ設定が構成されています：Application Logging (FileSystem) は Error、Application Logging (Blob) は Information、Detailed Error Message は Warning、Web Server Logging は Verbose です。 すべての Warning レベル以上のログを保存するように診断ログを構成します。 有効にする診断ログの種類と重大度レベルの組み合わせとして最も適切なものはどれですか。（一つ選択）**
*   Application Logging (Blob) を Warning レベルで有効化する
*   Web Server Logging を Warning レベルで有効化する
*   Detailed Error Message を Error レベルで有効化する
*   Application Logging (FileSystem) を Warning レベルで有効化する

**解答例**
*   Application Logging (Blob) を Warning レベルで有効化する

**解説**
App Service の診断ログで Warning 以上のすべてのログを保存するには、永続的なストレージである Blob Storage を使用する Application Logging (Blob) を Warning レベルで構成することが最適です。 Application Logging には FileSystem と Blob の 2 つのストレージオプションがあります。 FileSystem は一時的なデバッグ用途で 12 時間後に自動的に無効化されるため、継続的なログ保存には適していません。 一方、Blob Storage は永続的なストレージとして機能し、長期保存が可能です。 重大度レベルは Error、Warning、Information、Verbose の順に詳細度が増します。 Warning レベルを設定すると、Warning、Error、Critical の各レベルのログが記録されます。 現在の設定では Application Logging (Blob) が Information レベルのため、より多くのログが記録されていますが、要件に合わせて Warning に変更することで適切な粒度でログを収集できます。 Detailed Error Message は IIS の詳細エラーページを保存する機能で、Web Server Logging は IIS の生ログを記録する機能です。 これらはアプリケーションレベルのログ収集には使用されません。

| ログタイプ | 保存先 | 用途 |
| :--- | :--- | :--- | :--- |
| Application Logging (FileSystem) | ファイルシステム | 一時的なデバッグ (12 時間) |
| Application Logging (Blob) | Blob Storage | 永続的なアプリケーションログ |
| Web Server Logging | ファイルシステム / Blob | IIS 生ログの記録 |

**リファレンス**
*   Azure App Service
*   Application Logging
*   Blob Storage

---

**問題 341. Linux を実行する Azure 仮想マシンがあります。 この仮想マシンは、JSON 形式でログデータを出力するカスタムアプリケーションをホストしています。 Log Analytics ワークスペースにログを収集するソリューションを推奨します。 推奨事項に含めるべきものは何ですか。（一つ選択）**
*   Azure Monitor agent for Linux
*   Azure Diagnostics Extension for Linux
*   Custom Script Extension Version 2
*   Log Analytics agent for Linux

**解答例**
*   Azure Monitor agent for Linux

**解説**
Log Analytics ワークスペースにカスタムアプリケーションのログデータを JSON 形式で収集する場合、Azure Monitor agent (AMA) が最適な選択肢です。 AMA は、Log Analytics エージェントの後継として設計された次世代の監視エージェントで、カスタムログの収集、JSON 形式のログ解析、データ収集ルール (DCR) による柔軟な構成管理を提供します。 AMA は、Data Collection Rules (DCR) を使用してログ収集を構成します。 DCR では、収集するログファイルのパス、解析方法、送信先の Log Analytics ワークスペースを指定できます。 JSON 形式のログは、DCR 内でカスタムログとして定義し、適切なスキーマにマッピングすることで、Log Analytics で効率的にクエリと分析が可能になります。 各選択肢の比較を以下に示します。

| 選択肢 | 用途 | ログ収集の適性 |
| :--- | :--- | :--- | :--- |
| Azure Monitor agent | 次世代監視エージェント、カスタムログ収集対応 | 最適 |
| Azure Diagnostics Extension | プラットフォームメトリクスと診断ログの収集 | カスタムログ非対応 |
| Custom Script Extension | スクリプト実行による構成管理 | ログ収集機能なし |
| Log Analytics agent | 旧世代エージェント、2024 年 8 月に廃止 | 非推奨 |

Azure Diagnostics Extension は、仮想マシンのプラットフォームレベルの診断データ収集に特化しており、カスタムアプリケーションログの収集には適していません。 Custom Script Extension は、仮想マシンへのスクリプト展開と実行を目的としており、継続的なログ収集機能は提供しません。 Log Analytics agent は、2024 年 8 月 31 日に廃止されたレガシーエージェントであり、新規実装では使用すべきではありません。 AMA の実装では、まず Linux 仮想マシンにエージェントをインストールし、次に Data Collection Rule を作成してカスタムログの収集設定を定義します。 DCR では、ログファイルのパス、変換ルール、送信先ワークスペースを指定します。 JSON 形式のログは、KQL クエリを使用して Log Analytics 内で解析とフィルタリングが可能です。

**リファレンス**
*   Azure Monitor Agent
*   Data Collection Rules (DCR)
*   Log Analytics Workspace

---

**問題 342. Azure Monitor でアラートを作成し、SMS メッセージを送信するアクショングループを構成します。 このアラートが 1 分ごとにトリガーされた場合、1 時間あたりに送信される SMS メッセージの最大数はいくつですか。（一つ選択）**
*   12
*   1
*   60
*   6

**解答例**
*   12

**解説**
Azure Monitor のアクショングループにおける SMS 通知には、スパム防止とコスト管理のためのレート制限が設定されています。 この制限により、同一の電話番号に対して送信できる SMS メッセージは 5 分間に 1 通までとなっています。 アラートが 1 分ごとにトリガーされても、実際に SMS が送信されるのは 5 分に 1 回のみです。 したがって、1 時間（60 分）では 60 ÷ 5 = 12 回の SMS メッセージが送信されます。 この制限は受信者の電話番号ごとに適用されるため、複数の受信者を設定している場合は、各受信者がそれぞれこの制限内でメッセージを受信します。 SMS 以外の通知方法（Email、Webhook、Azure Functions、Logic Apps など）には異なるレート制限が適用されます。 頻繁な通知が必要な場合は、Email や Webhook の使用を検討することが推奨されます。

| 通知タイプ | レート制限 | 1 時間あたりの最大数 |
| :--- | :--- | :--- | :--- |
| SMS | 5 分に 1 通 | 12 通 |
| 音声通話 | 5 分に 1 回 | 12 回 |
| Email | 1 時間に 100 通 | 100 通 |

Azure Monitor のアラート設計では、通知の重要度と頻度のバランスを考慮し、適切な通知チャネルを選択することが重要です。 クリティカルなアラートには SMS や音声通話を使用し、情報提供レベルのアラートには Email を使用するなど、用途に応じた使い分けが推奨されます。

**リファレンス**
*   Azure Monitor
*   Action Group

---

**問題 343. Azure サブスクリプションに、Web アプリケーションである WebApp1 が含まれています。 WebApp1 にカスタムドメイン www.hogehoge.com を追加します。 最初に実行する操作を選択してください。（一つ選択）**
*   カスタムドメインの DNS レコードを作成する
*   WebApp1 を停止する
*   WebApp1 に TLS/SSL 証明書をアップロードする
*   WebApp1 のアプリケーション設定で接続文字列を追加する

**解答例**
*   カスタムドメインの DNS レコードを作成する

**解説**
Azure App Service にカスタムドメインを追加する際は、ドメインの所有権を証明するための DNS レコード作成が最初のステップとなります。 カスタムドメインの追加プロセスでは、まずドメインレジストラまたは DNS ホスティングプロバイダーで CNAME レコードまたは A レコードを作成します。 CNAME レコードの場合は、カスタムドメインを App Service の既定のドメイン名 (\<app-name\>.azurewebsites.net) にマッピングします。 A レコードの場合は、App Service の IP アドレスを指定します。 さらに、ドメイン所有権の検証用に TXT レコードも作成する必要があります。 DNS レコードの作成と伝播が完了した後、Azure ポータルでカスタムドメインの追加操作を実行します。 この時点で Azure は DNS レコードを検証し、ドメインの所有権を確認します。 検証が成功すると、カスタムドメインが Web アプリに関連付けられます。 TLS/SSL 証明書のアップロードは、HTTPS でカスタムドメインにアクセスする場合に必要となりますが、カスタムドメインの追加自体には必須ではありません。 WebApp1 の停止や接続文字列の追加は、カスタムドメイン追加のプロセスとは無関係です。

| 手順 | 操作内容 | 目的 |
| :--- | :--- | :--- | :--- |
| 1 | DNS レコード作成 | ドメイン所有権の証明 |
| 2 | カスタムドメイン追加 | Azure での検証と関連付け |
| 3 | 証明書アップロード | HTTPS 通信の有効化（任意） |

---






ご提示いただいたソース（「AZ-104試験問題500_part1_part14.pdf」の抜粋）に含まれるすべての文章を、一文字も省略することなく、全文そのまま出力します。

---

**リファレンス**
・Azure App Service
・Custom Domain

**問題 344. セキュアな拠点から複数のユーザーが Azure Storage アカウント内のファイル共有にアクセスします。この拠点ではインターネットへのアウトバウンドトラフィックが制限されています。ユーザーが SMB プロトコルを使用して Azure のファイル共有にアクセスできるようにします。セキュアな拠点から許可すべきアウトバウンドポートはどれですか。（一つ選択）**
・3389
・443
・445
・5671

**解答例**
・445

**解説**
SMB（Server Message Block）プロトコルを使用して Azure Files にアクセスする場合、TCP ポート 445 の通信を許可する必要があります。これは SMB プロトコルの標準ポートであり、Azure Files へのファイル共有アクセスに必須です。

Azure Files は、クラウドベースのフルマネージドファイル共有サービスで、SMB プロトコルを通じて Windows、Linux、macOS からアクセス可能です。オンプレミス環境や他のクラウド環境から Azure Files にアクセスする際は、ファイアウォールやネットワークセキュリティグループでポート 445 のアウトバウンド通信を許可する必要があります。

多くの企業ネットワークや ISP では、セキュリティ上の理由からポート 445 がブロックされている場合があります。この場合の代替手段として、Azure File Sync や REST API 経由でのアクセス（ポート 443 使用）を検討できますが、SMB プロトコルを直接使用する要件がある場合は、ポート 445 の開放が必須となります。

各ポートの用途を整理すると以下の通りです。

| ポート番号 | プロトコル / 用途 | Azure Files での使用 |
| :--- | :--- | :--- |
| 445 | SMB | ファイル共有アクセスに必須 |
| 443 | HTTPS | REST API、Azure File Sync |
| 3389 | RDP | リモートデスクトップ接続 |
| 5671 | AMQP over TLS | Azure Service Bus などのメッセージング |

セキュアな拠点から SMB プロトコルで Azure Files にアクセスするには、ネットワーク管理者にポート 445 のアウトバウンド通信許可を依頼する必要があります。ポート 445 が開放できない環境では、Azure File Sync を使用してオンプレミスのファイルサーバーと Azure Files を同期する方法や、HTTPS ベースの REST API を使用する方法を検討します。

**リファレンス**
・Azure Files
・SMB（Server Message Block）プロトコル
・Azure File Sync

**問題 345. Azure 仮想ネットワークに Subnet1 と Subnet2 という 2 つのサブネットがあります。VM1 という仮想マシンが Subnet1 に接続されており、Windows Server を実行しています。VM1 を両方のサブネットに直接接続します。最初に実行すべき操作はどれですか。（一つ選択）**
・Azure portal から新しいネットワークインターフェイスを追加する
・Azure portal からネットワークセキュリティグループを作成する
・Azure portal から既存のネットワークインターフェイスの IP 構成を変更する
・Windows Server にサインインしてネットワークブリッジを作成する

**解答例**
・Azure portal から新しいネットワークインターフェイスを追加する

**解説**
Azure 仮想マシンを複数のサブネットに接続するには、各サブネットに対応するネットワークインターフェイス（NIC）が必要です。VM1 は現在 Subnet1 に接続されているため、Subnet2 に接続するには新しい NIC を追加する必要があります。

Azure 仮想マシンは複数の NIC をアタッチできる設計になっており、各 NIC は異なるサブネットに接続可能です。ただし、すべての NIC は同一の仮想ネットワーク内に存在する必要があります。新しい NIC を追加する手順は以下の通りです。

まず Azure portal でネットワークインターフェイスを作成し、Subnet2 を指定します。次に VM1 を停止（割り当て解除）してから、作成した NIC を VM1 にアタッチします。VM1 を起動後、Windows Server 内でネットワーク設定を確認し、必要に応じてルーティングを構成します。

既存の NIC の IP 構成を変更する方法では、セカンダリ IP アドレスを追加できますが、これは同一サブネット内での追加 IP アドレス割り当てに使用されます。異なるサブネットへの接続には対応していません。

Windows Server 側でネットワークブリッジを作成する方法は、物理的なネットワークアダプタを統合する技術であり、Azure の仮想ネットワーク構成には適用できません。

| 操作 | 用途 | 複数サブネット接続 |
| :--- | :--- | :--- |
| NIC 追加 | 異なるサブネットへの接続 | 可能 |
| IP 構成変更 | 同一サブネット内の追加 IP | 不可 |
| ネットワークブリッジ | 物理アダプタの統合 | 不可 |

**リファレンス**
・Network Interface
・Azure Virtual Network

**問題 346. あなたの組織は東京、神奈川、ニューヨークの 3 拠点にオンプレミスデータセンターを運用しています。Azure 環境として東日本リージョンと米国東部リージョンにそれぞれ仮想ネットワークを構築済みで、これらはピアリング接続されています。今回、3 拠点のオンプレミスデータセンターを Azure サブスクリプションに接続する要件があり、拠点間のネットワーク遅延を最小化する必要があります。この要件を満たすために作成すべき構成を選択してください。（一つ選択）**
・1 つの Virtual WAN と 3 つの仮想ハブ
・3 つの VPN Gateway と 1 つの ExpressRoute Gateway
・3 つの Virtual WAN と 1 つの仮想ハブ
・1 つの Azure Firewall と 3 つの VPN Gateway

**解答例**
・1 つの Virtual WAN と 3 つの仮想ハブ

**解説**
複数拠点のオンプレミス環境と Azure を接続し、拠点間通信の遅延を最小化するには、Azure Virtual WAN のハブアンドスポークアーキテクチャが最適です。Virtual WAN は、グローバルなトランジットネットワークアーキテクチャを提供し、複数リージョンの接続を一元管理できるサービスです。

本シナリオでは、1 つの Virtual WAN リソースを作成し、各リージョン（東日本、米国東部）に仮想ハブを配置します。3 拠点のデータセンターがあるため、地理的に近い仮想ハブに各拠点を接続することで、最適なルーティングと低遅延通信が実現されます。東京と神奈川は東日本リージョンの仮想ハブに、ニューヨークは米国東部リージョンの仮想ハブに接続します。

Virtual WAN の仮想ハブは自動的にルーティングを最適化し、拠点間通信は Microsoft のグローバルバックボーンネットワークを経由するため、インターネット経由よりも低遅延で安定した通信が可能です。また、各仮想ハブ間は自動的にメッシュ接続されるため、追加のピアリング設定は不要です。

| 構成要素 | 数量 | 役割 |
| :--- | :--- | :--- |
| Virtual WAN | 1 | グローバルネットワークの統合管理 |
| 仮想ハブ | 3 | 各リージョンのトランジットポイント |
| サイト接続 | 3 | オンプレミス拠点との接続 |

他の選択肢について、3 つの Virtual WAN を作成する構成は管理が複雑化し推奨されません。VPN Gateway や ExpressRoute Gateway を個別に構築する方法も可能ですが、複数拠点間の最適ルーティングを自動化できず、管理オーバーヘッドが増大します。Azure Firewall や Application Gateway は接続サービスではなく、本要件には適合しません。

**リファレンス**
・Azure Virtual WAN
・ExpressRoute

**問題 347. Azure サブスクリプションに以下のリソースが含まれています。リソースグループ RG1 には「Not allowed resource types」という Azure Policy が割り当てられており、次のリソースタイプが禁止されています：Microsoft.Network/virtualNetwork と Microsoft.Compute/virtualMachines。RG1 内に新しい仮想マシン VM2 を作成し、既存の仮想ネットワーク VNET1 に接続する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**
・ポリシーから Microsoft.Compute/virtualMachines を削除する
・VNET1 に新しいサブネットを追加する
・Azure Resource Manager テンプレートを作成する
・ポリシーから Microsoft.Network/virtualNetworks を削除する

**解答例**
・ポリシーから Microsoft.Compute/virtualMachines を削除する

**解説**
Azure Policy の「Not allowed resource types」は、指定されたリソースタイプの作成を明示的にブロックします。本問では、RG1 に対して Microsoft.Compute/virtualMachines と Microsoft.Network/virtualNetworks の両方が禁止されています。

VM2 を作成するには、Microsoft.Compute/virtualMachines リソースタイプの作成が必要です。現在のポリシー設定ではこれが禁止されているため、仮想マシンの作成操作自体が失敗します。したがって、最初にポリシーから Microsoft.Compute/virtualMachines を削除する必要があります。

VNET1 は既に存在しているため、新規作成は不要です。VM2 を VNET1 に接続する際は既存の VNET1 を参照するだけで、新しいネットワークリソースの作成は発生しません。そのため、Microsoft.Network/virtualNetworks の禁止設定は接続操作に影響しません。

サブネットの追加や ARM テンプレートの作成は、ポリシーによる制限を解決する手段ではありません。ポリシーが有効な限り、どのような方法でもブロックされたリソースタイプは作成できません。

| 操作 | 必要性 | 理由 |
| :--- | :--- | :--- |
| Microsoft.Compute/virtualMachines の削除 | 必須 | VM2 作成に必要 |
| Microsoft.Network/virtualNetworks の削除 | 不要 | VNET1 は既存リソース |
| サブネット追加 | 不要 | ポリシー制限の解決にならない |

**リファレンス**
・Azure Policy
・Not allowed resource types
・Azure Resource Manager

**問題 348. あなたの会社は、オンプレミスのサーバーを Azure に移行する計画を立てています。単一の仮想ネットワーク上に開発環境、テスト環境、本番環境の仮想マシンが配置されます。開発環境、テスト環境、本番環境の仮想マシン間のトラフィックを特定のポートに制限します。何を使用しますか。（一つ選択）**
・Application Security Group
・Network Security Group
・Azure Firewall
・Azure Load Balancer

**解答例**
・Network Security Group

**解説**
この問題は、同一仮想ネットワーク内の異なる環境間でトラフィック制御を実現する方法を問うものです。開発、テスト、本番という異なる環境の仮想マシン間で、特定のポートのみ通信を許可する要件に最適なソリューションを選択する必要があります。

Network Security Group（NSG）は、Azure 仮想ネットワーク内のリソースに対する受信トラフィックと送信トラフィックをフィルタリングするセキュリティ規則の集合です。NSG には、送信元 IP アドレス、送信先 IP アドレス、ポート番号、プロトコルに基づいてトラフィックを許可または拒否する規則を定義できます。サブネット単位または個別の仮想マシンのネットワークインターフェイス単位で適用可能で、きめ細かいトラフィック制御を実現します。

Application Security Group は、NSG と組み合わせて使用する機能で、アプリケーションの構造に基づいてネットワークセキュリティを定義できますが、単独ではトラフィック制御を実現できません。Azure Firewall は、仮想ネットワーク全体を保護する高度なネットワークセキュリティサービスですが、同一仮想ネットワーク内の環境間トラフィック制御には過剰な機能です。Azure Load Balancer は、トラフィックの負荷分散を行うサービスであり、セキュリティ制御の機能は持ちません。

各環境をサブネットに分割し、それぞれのサブネットに NSG を適用することで、環境間の通信を特定のポートに制限できます。例えば、開発環境から本番環境への直接アクセスを完全に遮断し、テスト環境から本番環境へは特定の管理ポートのみ許可するといった細かい制御が可能です。

| サービス | 用途 | 適用範囲 |
| :--- | :--- | :--- |
| Network Security Group | ポート単位のトラフィック制御 | サブネットまたは NIC |
| Azure Firewall | 仮想ネットワーク全体の保護 | 仮想ネットワーク |
| Azure Load Balancer | トラフィックの負荷分散 | バックエンドプール |

**リファレンス**
・Network Security Group
・Application Security Group
・Azure Firewall

**問題 349. Azure サブスクリプションを所有しています。Policy1 という名前の Azure Policy の定義を作成する予定です。Policy1 に修復情報を含める必要があります。修復情報を追加すべき定義セクションはどれですか。（一つ選択）**
・policyRule
・parameters
・metadata
・properties

**解答例**
・metadata

**解説**
Azure Policy の定義において、修復情報（remediation information）は metadata セクションに記載します。metadata セクションは、ポリシーの説明、カテゴリ、バージョン情報などの補足的な情報を格納する場所であり、修復に関するガイダンスやドキュメントへのリンクもここに含めることができます。

policyRule セクションは、ポリシーの評価ロジック（if-then 条件）を定義する場所です。リソースが準拠しているかどうかを判断する条件と、その結果としてのアクション（audit, deny, deployIfNotExist など）を記述します。

parameters セクションは、ポリシー定義を柔軟にするための変数を定義する場所です。ポリシーを割り当てる際に値を指定できるパラメータを設定します。

properties セクションは、ポリシー定義全体の構造を含む親要素ですが、修復情報を直接記載する場所ではありません。

| セクション | 用途 | 修復情報の記載 |
| :--- | :--- | :--- |
| metadata | 補足情報、ドキュメント、修復ガイダンス | 可能 |
| policyRule | 評価条件とアクションの定義 | 不可 |
| parameters | 変数の定義 | 不可 |

修復情報を metadata に記載することで、ポリシーに準拠していないリソースを発見した際に、管理者が適切な対応方法を理解しやすくなります。

**リファレンス**
・Azure Policy
・policyRule

**問題 350. あなたの組織では、Azure サブスクリプション「Subscription-A」で WebApp-A というリソースグループを運用しており、その中に Azure 仮想マシンが含まれています。この仮想マシンは Subnet-A という名前のサブネットに配置されており、NSG-A という Network Security Group (NSG) が Subnet-A に関連付けられています。現在、NSG-A にはデフォルトルールのみが設定されています。セキュリティ要件として、Subnet-A 上のホストから Azure Portal へのアクセスを遮断する必要がありますが、その他のインターネットホストへの接続は許可する必要があります。この要件を満たすために、NSG-A に送信セキュリティルールを作成します。このルールの宛先として設定すべき項目は何ですか。（一つ選択）**
・アプリケーションセキュリティグループ
・サービスタグ
・任意の IP アドレス範囲
・特定の IP アドレス

**解答例**
・サービスタグ

**解説**
この問題の最重要ポイントは、Azure Portal へのアクセスのみを選択的にブロックしながら、他のインターネットリソースへのアクセスは維持するという要件を満たす方法です。

Azure Network Security Group では、サービスタグを使用することで、Azure の特定のサービスへのトラフィックを効率的に制御できます。Azure Portal へのアクセスを制御する場合、「AzurePortal」というサービスタグを使用します。このサービスタグは、Azure Portal に関連する IP アドレス範囲を自動的に表現し、Microsoft によって管理されます。

送信セキュリティルールで宛先に「AzurePortal」サービスタグを指定し、アクションを「拒否」に設定することで、Azure Portal へのアクセスのみをブロックできます。他のインターネットホストへの接続は、既存のデフォルトルール（AllowInternetOutBound）によって許可され続けます。

特定の IP アドレスや任意の IP アドレス範囲を指定する方法では、Azure Portal の IP アドレスが変更された場合にルールの更新が必要になり、管理が煩雑になります。アプリケーションセキュリティグループは、Azure 内のリソースをグループ化するために使用されるもので、この要件には適していません。

| 宛先の種類 | 用途 | Azure Portal 制御の適性 |
| :--- | :--- | :--- |
| サービスタグ | Azure サービスへのアクセス制御 | 最適（自動更新） |
| IP アドレス | 特定ホストへのアクセス制御 | 不適（手動管理必要） |
| アプリケーションセキュリティグループ | Azure 内リソースのグループ化 | 不適（用途が異なる） |

**リファレンス**
・Network Security Group
・Service Tag
・送信セキュリティルール

**問題 351. 開発チームが Azure Container Instances をデプロイする予定です。コンテナには永続的なストレージレイヤーが必要です。どのサービスを使用しますか。（一つ選択）**
・Azure Blob Storage
・Azure Table Storage
・Azure Files
・Azure SQL Database

**解答例**
・Azure Files

**解説**
Azure Container Instances で永続的なストレージを実装する場合、Azure Files が最適な選択肢となります。Azure Container Instances は Azure Files ボリュームのマウントをネイティブにサポートしており、SMB プロトコルを使用してファイル共有を直接コンテナにマウントできます。

Azure Files は複数のコンテナインスタンス間でデータを共有でき、コンテナが再起動または削除されてもデータが保持されます。マウント操作はコンテナグループの定義時に宣言的に設定でき、管理が容易です。

他の選択肢が不適切な理由を以下に示します。

| サービス | 不適切な理由 |
| :--- | :--- |
| Azure Blob Storage | コンテナへの直接マウント非対応、REST API 経由のアクセスが必要 |
| Azure Table Storage | NoSQL データストアでありファイルシステムとして機能しない |
| Azure SQL Database | リレーショナルデータベースでありファイルストレージではない |

Azure Container Instances でストレージをマウントする際は、ストレージアカウント名、ファイル共有名、アクセスキーの 3 つの情報が必要です。これらの情報をコンテナグループの YAML または ARM テンプレートで指定することで、コンテナ起動時に自動的にボリュームがマウントされます。

**リファレンス**
・Azure Container Instances
・Azure Files
・SMB（Server Message Block）プロトコル

**問題 352. 次の表に示すリソースをデプロイする予定です。これらのリソースをデプロイするために使用する単一の Azure Resource Manager (ARM) テンプレートを作成します。VM1 の dependsOn セクションに追加する必要があるリソースはどれですか。（一つ選択）**
| リソース名 | リソースタイプ |
| :--- | :--- |
| VM1 | 仮想マシン |
| NIC1 | ネットワークインターフェイス |
| VNET1 | 仮想ネットワーク |
| NSG1 | ネットワークセキュリティグループ |
| IP1 | パブリック IP アドレス |

・VNET1
・Storage Account
・NIC1
・NSG1

**解答例**
・NIC1

**解説**
ARM テンプレートにおけるリソースの依存関係を正しく定義することが重要です。仮想マシン（VM）をデプロイする際、VM は必ずネットワークインターフェイス（NIC）を必要とします。NIC が存在しない状態では VM をデプロイできないため、VM1 の dependsOn セクションには NIC1 を指定する必要があります。

dependsOn セクションは、リソースのデプロイ順序を制御するために使用されます。あるリソースが別のリソースに直接依存している場合、依存先のリソースを明示的に指定することで、正しい順序でデプロイが実行されます。

VM1 と NIC1 の関係を見ると、VM の定義にはネットワークインターフェイスのリソース ID を参照するプロパティが含まれます。このため、NIC1 が先に作成される必要があり、VM1 は NIC1 に依存します。

一方、VNET1 や NSG1 は NIC1 が依存するリソースであり、VM1 が直接依存するわけではありません。ARM テンプレートでは推移的な依存関係は自動的に解決されるため、VM1 の dependsOn に VNET1 や NSG1 を含める必要はありません。IP1 についても、NIC1 に関連付けられるリソースであり、VM1 の直接的な依存先ではありません。

リソース間の依存関係を整理すると以下のようになります。

| リソース | 依存先リソース | 理由 |
| :--- | :--- | :--- |
| VM1 | NIC1 | VM は NIC を必要とする |
| NIC1 | VNET1 | NIC はサブネットに接続 |
| NIC1 | NSG1 または IP1 | オプションで関連付け |

したがって、VM1 の dependsOn セクションに追加すべきリソースは NIC1 です。

**リファレンス**
・ARM Template
・dependsOn
・Network Interface

**問題 353. VNet1 という名前の仮想ネットワークがあります。VNet1 にはデバイスが接続されていません。同じリージョン内の VNet2 という名前の別の仮想ネットワークと VNet1 をピアリングする計画です。VNet2 のアドレス空間は 10.2.0.0/16 です。VNet1 のアドレス空間は 10.2.0.0/24 です。ピアリングを作成する必要があります。最初に何をしますか。（一つ選択）**
・VNet1 にゲートウェイサブネットを追加する
・VNet1 のアドレス空間を変更する
・VNet1 と VNet2 にサブネットを作成する
・VNet2 でプライベートエンドポイントを構成する

**解答例**
・VNet1 のアドレス空間を変更する

**解説**
仮想ネットワークピアリングを構成する際の最重要ポイントは、ピアリング対象の仮想ネットワーク間でアドレス空間が重複していないことです。本問では、VNet1 のアドレス空間 10.2.0.0/24 が VNet2 のアドレス空間 10.2.0.0/16 に完全に含まれており、アドレス空間が重複しています。この状態ではピアリングを作成できないため、まず VNet1 のアドレス空間を変更する必要があります。

Virtual Network Peering は、Azure 仮想ネットワーク間を接続する機能で、同一リージョン内（Regional VNet Peering）または異なるリージョン間（Global VNet Peering）で構成できます。ピアリングを確立すると、仮想ネットワーク間でプライベート IP アドレスを使用した通信が可能になります。ただし、ピアリングを構成するには以下の要件を満たす必要があります。

ピアリング構成の主要要件として、各仮想ネットワークのアドレス空間が重複していないことが必須です。アドレス空間が重複している場合、ルーティングの競合が発生し、正常な通信ができません。本問のケースでは、VNet1 の 10.2.0.0/24 は VNet2 の 10.2.0.0/16 のサブネット範囲内に含まれるため、重複と判断されます。

他の選択肢について、ゲートウェイサブネットは VPN Gateway や ExpressRoute Gateway を使用する場合に必要ですが、Virtual Network Peering では不要です。サブネットの作成も、仮想ネットワーク自体が存在すればピアリング構成には必須ではありません。プライベートエンドポイントは、Azure サービスへのプライベートアクセスのための PaaS 接続機能であり、ピアリング構成とは無関係です。

| 項目 | 説明 |
| :--- | :--- |
| Regional VNet Peering | 同一リージョン内の仮想ネットワーク間接続 |
| Global VNet Peering | 異なるリージョン間の仮想ネットワーク間接続 |
| アドレス空間要件 | 重複不可、一意である必要がある |

**リファレンス**
・Virtual Network Peering

**問題 354. East US リージョンの可用性セットを使用して仮想マシンをデプロイしています。2 つの障害ドメインと 10 個の更新ドメインに 18 台の仮想マシンをデプロイしました。Microsoft が計画的な物理ハードウェアメンテナンスを実施する場合、最大で何台の仮想マシンが同時に使用不可になりますか。（一つ選択）**
・1 台
・2 台
・9 台
・18 台

**解答例**
・2 台

**解説**
可用性セットにおける計画メンテナンス時の影響範囲を理解する問題です。Azure の計画メンテナンスでは更新ドメイン単位で順次実行され、一度に 1 つの更新ドメインのみが影響を受けます。

可用性セットは、障害ドメインと更新ドメインの 2 つの概念で仮想マシンを分散配置します。障害ドメインは物理的な電源やネットワークスイッチを共有する単位で、予期しない障害に対する保護を提供します。更新ドメインは計画メンテナンス時に同時に再起動される仮想マシンのグループです。

本シナリオでは 18 台の仮想マシンが 10 個の更新ドメインに分散されています。18 台を 10 個の更新ドメインに均等配分すると、各更新ドメインには 1 台または 2 台の仮想マシンが配置されます（18 ÷ 10 = 1 余り 8）。計画メンテナンスは一度に 1 つの更新ドメインのみを対象とするため、最大で 2 台の仮想マシンが同時に使用不可になります。

| 項目 | 説明 |
| :--- | :--- |
| 障害ドメイン | 物理的な障害単位（電源・ネットワーク） |
| 更新ドメイン | 計画メンテナンスの実行単位 |
| メンテナンス影響 | 一度に 1 つの更新ドメインのみ |

更新ドメインへの配分計算では、8 個の更新ドメインに 2 台ずつ、残り 2 個の更新ドメインに 1 台ずつ配置されます。したがって計画メンテナンス時の最大影響は 2 台となります。

**リファレンス**
・Availability Set
・障害ドメイン

**問題 355. あなたの会社はオーストラリアに本社があり、アジアに複数の支社があります。会社のデータセンターは VMware 仮想化インフラストラクチャを使用して複数の仮想サーバーをホストしています。Azure サブスクリプションを購入し、すべての仮想マシンを Australia Southeast リージョンのリソースグループに移行する計画です。Azure Migrate 移行プロジェクトを作成する必要があります。どの地域（Geography）を選択しますか。（一つ選択）**
・Australia
・Asia Pacific
・United States
・Europe

**解答例**
・Australia

**解説**
Azure Migrate プロジェクトを作成する際、地域（Geography）の選択はメタデータの保存場所を決定する重要な設定です。この設定は移行先のリージョンとは独立しており、プロジェクトの管理情報やアセスメントデータの保存場所を指定します。

本問では、会社の本社がオーストラリアにあり、移行先も Australia Southeast リージョンです。Azure Migrate の地域設定では、データ主権やコンプライアンス要件を考慮し、組織の所在地に最も近い地域を選択することが推奨されます。地域を選択すると、その地域内の特定のリージョンにプロジェクトメタデータが保存されます。

Australia 地域を選択することで、プロジェクトメタデータはオーストラリア国内に保存され、データガバナンスとコンプライアンス要件を満たすことができます。Asia Pacific を選択すると、メタデータがアジア太平洋地域の他の国に保存される可能性があり、データ主権の観点から適切ではありません。United States や Europe は地理的に離れており、レイテンシーやコンプライアンスの面で最適な選択ではありません。

| 項目 | 説明 |
| :--- | :--- |
| Geography | プロジェクトメタデータの保存地域 |
| リージョン | 実際のリソースのデプロイ先 |
| 推奨事項 | 組織所在地に近い地域を選択 |

Azure Migrate プロジェクトの地域設定は作成後に変更できないため、初期設定時に慎重に選択する必要があります。移行先リージョンとは別の概念であることを理解し、データガバナンス要件に基づいて適切な地域を選択することが重要です。

**リファレンス**
・Azure Migrate

**問題 356. storage1 という名前の Azure Storage アカウントがあり、container1 という名前の Blob コンテナーが含まれています。container1 に追加される新しいコンテンツを 1 年間変更できないようにします。何を構成しますか。（一つ選択）**
・アクセスレベル
・不変性ポリシー
・Access control (IAM) 設定
・アクセス層

**解答例**
・不変性ポリシー

**解説**
Blob コンテナーに追加されるデータを指定期間変更不可にするには、不変性ポリシー（Immutability Policy）を構成します。この機能により、WORM（Write Once, Read Many）状態でデータを保存でき、法規制やコンプライアンス要件に対応できます。

不変性ポリシーには 2 つのタイプがあります。時間ベースの保持ポリシーは、指定した保持期間中、Blob の作成と読み取りは可能ですが、変更と削除を防ぎます。訴訟ホールドは、明示的に解除されるまでデータを保護します。

他の選択肢が不適切な理由を整理します。アクセスレベルは、コンテナーや Blob への匿名アクセス権限（プライベート、Blob、コンテナー）を制御する設定で、データの変更可否とは無関係です。Access control (IAM) 設定は、ユーザーやサービスプリンシパルに対するロールベースのアクセス制御を管理しますが、データの不変性は保証しません。アクセス層は、Hot, Cool, Archive などのストレージコスト最適化のための階層で、データ保護機能ではありません。

| 機能 | 用途 |
| :--- | :--- |
| 不変性ポリシー | データの変更・削除防止 |
| アクセスレベル | 匿名アクセス制御 |
| IAM | ロールベースアクセス管理 |

**リファレンス**
・Azure Blob Storage
・Immutability Policy
・WORM（Write Once Read Many）

**問題 357. Microsoft Entra テナントとオンプレミスの Active Directory ドメインに複数のユーザーが存在します。セルフサービスパスワードリセット（SSPR）のパスワードライトバック機能を構成します。コストを最小限に抑えるソリューションが必要です。使用すべき Microsoft Entra ID エディションはどれですか。（一つ選択）**
・Microsoft Entra ID P2
・Microsoft Entra ID Free
・Microsoft Entra ID P1
・Microsoft Entra ID for Office 365

**解答例**
・Microsoft Entra ID P1

**解説**
セルフサービスパスワードリセット（SSPR）のパスワードライトバック機能は、クラウドで変更されたパスワードをオンプレミスの Active Directory に同期する機能です。この機能を利用するには、Microsoft Entra ID P1 または P2 のライセンスが必要です。

コストを最小限に抑える要件があるため、P1 と P2 のうち下位エディションである Microsoft Entra ID P1 が正解となります。P2 は P1 の機能に加えて、Identity Protection, Privileged Identity Management などの高度なセキュリティ機能を提供しますが、パスワードライトバック機能自体は P1 で利用可能です。

Microsoft Entra ID Free では、SSPR の基本機能は利用できますが、オンプレミスへのパスワードライトバック機能は含まれていません。Microsoft Entra ID for Office 365 は、Office 365 サブスクリプションに含まれる限定的な機能セットであり、パスワードライトバックには対応していません。

各エディションの主な機能比較は以下の通りです。

| エディション | SSPR 基本機能 | パスワードライトバック |
| :--- | :--- | :--- |
| Free | 対応 | 非対応 |
| P1 | 対応 | 対応 |
| P2 | 対応 | 対応 |

パスワードライトバックを実装するには、Microsoft Entra Connect をオンプレミスの Active Directory サーバーにインストールし、適切な権限設定を行う必要があります。この構成により、ユーザーはクラウドからパスワードをリセットでき、その変更が自動的にオンプレミス環境に反映されます。

**リファレンス**
・Microsoft Entra ID
・セルフサービスパスワードリセット（SSPR）
・Microsoft Entra Connect

**問題 358. 日本に支部を置く組織では、以下の表に示すリソースグループを含む Azure サブスクリプションを所有しています。RG-A には仮想マシン VM-A が実行中で、NIC-A と Disk-A に接続されています。NIC-A は VNet-A に接続されています。RG-B には西日本リージョンにある IP-B という名前のパブリック IP アドレスが含まれていますが、どの仮想マシンにも割り当てられていません。次の記述について、正しい場合は「はい」を選択し、正しくない場合は「いいえ」を選択します。「Storage-A を RG-B に移動できる。」（一つ選択）**

リソースグループ構成
| 名前 | リージョン |
| :--- | :--- |
| RG-A | 東日本 |
| RG-B | 西日本 |

RG-A 内のリソース
| 名前 | タイプ | リージョン |
| :--- | :--- | :--- |
| Storage-A | ストレージアカウント | 東日本 |
| VNet-A | 仮想ネットワーク | 東日本 |
| NIC-A | ネットワークインターフェイス | 東日本 |
| Disk-A | ディスク | 東日本 |
| VM-A | 仮想マシン | 東日本 |

・いいえ
・はい

**解答例**
・はい

**解説**
Azure ストレージアカウントは、異なるリージョンのリソースグループ間で移動できます。リソースの移動では、リソース自体の物理的な場所は変更されず、リソースが属するリソースグループのメタデータのみが変更されます。

Storage-A は東日本リージョンに存在し、RG-B は西日本リージョンに存在しますが、ストレージアカウントを異なるリージョンのリソースグループに移動することは可能です。リソースグループのリージョンとリソース自体のリージョンは独立しており、リソースグループは管理上の論理的なコンテナとして機能します。

ただし、リソースの移動には以下の制約があります。移動元と移動先のリソースグループは同じサブスクリプション内に存在する必要があります。また、移動中はリソースグループがロックされ、書き込みおよび削除操作が一時的にブロックされます。ストレージアカウントの移動は、Azure Portal, Azure PowerShell, Azure CLI, または REST API を使用して実行できます。

リソース移動の主な制約
| 項目 | 制約内容 |
| :--- | :--- |
| サブスクリプション | 同一サブスクリプション内での移動が必要 |
| リソースグループのロック | 移動中は書き込み・削除操作がブロック |
| リージョン | リソースの物理的な場所は変更されない |

**リファレンス**
・Resource group

**問題 359. 複数の Azure 仮想マシンを Web サーバーとして構成し、Azure Load Balancer を使用しています。特定のクライアントからのリクエストを常に同じバックエンドサーバーに転送するように構成します。どの設定を行いますか。（一つ選択）**
・セッションの永続性を「クライアント IP」に設定する
・セッションの永続性を「なし」に設定する
・アウトバウンド規則で SNAT を無効にする
・フローティング IP（ダイレクトサーバーリターン）を有効にする

**解答例**
・セッションの永続性を「クライアント IP」に設定する

**解説**
Azure Load Balancer でクライアントからのリクエストを常に同じバックエンドサーバーに転送するには、セッションの永続性（Session Affinity）を適切に設定する必要があります。

セッションの永続性は、負荷分散規則の配分モードとして設定され、クライアントとバックエンドサーバー間の接続の維持方法を制御します。「クライアント IP」モードでは、送信元 IP アドレスに基づいて 2 タプル（送信元 IP、宛先 IP）のハッシュを使用し、同じクライアントからのトラフィックを常に同じバックエンドサーバーに転送します。これにより、Web アプリケーションのセッション状態を特定のサーバーで維持できます。

「なし」に設定すると、5 タプル（送信元 IP、送信元ポート、宛先 IP、宛先ポート、プロトコル）のハッシュを使用し、リクエストごとに異なるサーバーに分散される可能性があります。フローティング IP は、バックエンドサーバーが直接クライアントに応答を返す DSR（Direct Server Return）機能であり、セッション維持とは無関係です。SNAT の無効化もアウトバウンド接続の設定であり、この要件には該当しません。

| 配分モード | ハッシュ基準 | 用途 |
| :--- | :--- | :--- |
| なし（5 タプル） | 送信元 IP、送信元ポート、宛先 IP、宛先ポート、プロトコル | 均等な負荷分散 |
| クライアント IP（2 タプル） | 送信元 IP、宛先 IP | セッション維持が必要な場合 |
| クライアント IP とプロトコル（3 タプル） | 送信元 IP、宛先 IP、プロトコル | プロトコル別のセッション維持 |

**リファレンス**
・Azure Load Balancer
・セッション永続化（Session Affinity）
・Load Balancing Rule

**問題 360. AKS クラスターを hogehoge という名前でデプロイしました。このクラスターに YAML マニフェストファイルをデプロイします。解決策として Azure Cloud Shell から az aks install-cli コマンドを実行して kubectl をインストールし、kubectl apply コマンドで YAML ファイルをデプロイします。この解決策は目標を達成していますか。（一つ選択）**
・はい、この解決策で目標を達成できる
・いいえ、この解決策では目標を達成できない
・はい、ただし追加で Azure CLI の最新バージョンへの更新が必要
・いいえ、Azure Portal からの GUI デプロイのみが有効な方法である

**解答例**
・はい、この解決策で目標を達成できる

**解説**
AKS クラスターへの YAML マニフェストファイルのデプロイは、kubectl コマンドラインツールを使用して実行します。Azure Cloud Shell には既に Azure CLI がプリインストールされており、az aks install-cli コマンドで kubectl をインストールできます。その後、az aks get-credentials コマンドでクラスターの認証情報を取得し、kubectl apply -f <ファイル名>.yaml コマンドで YAML ファイルをデプロイできます。

Azure Cloud Shell は、ブラウザベースのシェル環境であり、Azure リソースと Kubernetes クラスターの管理に必要なツールが事前に構成されています。Bash または PowerShell のいずれかを選択でき、永続的なストレージも利用可能です。

AKS へのデプロイ方法の比較を以下に示します。

| デプロイ方法 | 特徴 | 推奨用途 |
| :--- | :--- | :--- |
| kubectl apply | YAML マニフェストから直接デプロイ | 本番環境での標準的なデプロイ |
| Azure Portal | GUI ベースの操作 | 簡易的な確認や初期設定 |
| Helm | パッケージ管理ツール使用 | 複雑なアプリケーション管理 |

kubectl コマンドの主要な操作を以下に整理します。

| コマンド | 用途 |
| :--- | :--- |
| kubectl apply | リソースの作成・更新 |
| kubectl get | リソースの一覧表示 |
| kubectl delete | リソースの削除 |

**リファレンス**
・Azure Kubernetes Service (AKS)
・kubectl
・Azure Cloud Shell

**問題 361. 米国に本拠地を置く組織が Azure サブスクリプション「Subscription-A」を所有しています。このサブスクリプションには以下のストレージアカウントが含まれています。米国西部リージョンに Web アプリ「App-A」をデプロイし、このアプリケーションをバックアップします。コストを最小限に抑えるソリューションを選択する必要があります。バックアップのターゲットとして使用すべきストレージアカウントはどれですか。（一つ選択）**
| 名前 | 種類 | ロケーション |
| :--- | :--- | :--- |
| storage-A | StorageV2 | 米国中部 |
| storage-B | BlobStorage | 米国西部 |
| storage-C | BlockBlobStorage | 米国西部 |
| storage-D | FileStorage | 米国東部 |

・storage-D
・storage-C
・storage-A
・storage-B

**解答例**
・storage-A

**解説**
Azure App Service のバックアップ機能を使用する場合、バックアップ先として使用できるのは StorageV2（汎用 v2）または StorageV1（汎用 v1）のストレージアカウントのみです。BlobStorage、BlockBlobStorage、FileStorage の各種別は App Service バックアップの要件を満たしません。

選択肢の中で StorageV2 に該当するのは storage-A のみです。storage-B は旧世代の BlobStorage、storage-C は BlockBlobStorage（Premium Blob 専用）、storage-D は FileStorage（Premium File 専用）であり、いずれも App Service バックアップには使用できません。

コスト最適化の観点では、同一リージョン内でのデータ転送は無料ですが、リージョン間のデータ転送には送信データ料金が発生します。storage-A は米国中部に配置されているため、米国西部の App-A からのバックアップデータ転送には送信料金が発生しますが、これは要件を満たす唯一の選択肢であるため許容されます。

App Service バックアップでは、アプリケーション構成、ファイルコンテンツ、接続されているデータベースを含む完全なバックアップが作成され、最大 10GB のアプリとデータベースコンテンツをサポートします。

| ストレージ種類 | App Service バックアップ対応 | 用途 |
| :--- | :--- | :--- |
| StorageV2 | 対応 | 汎用ストレージ、全機能利用可 |
| BlobStorage | 非対応 | Blob 専用レガシータイプ |
| BlockBlobStorage | 非対応 | Premium Blob 専用 |

**リファレンス**
・Azure App Service
・StorageV2
・Azure Backup

**問題 362. オンプレミスの Active Directory と Azure AD の同期において、一部のユーザーアカウントが正常に同期されない問題が発生しています。調査の結果、ユーザープリンシパル名（UPN）に無効な文字が含まれていることが判明しました。この問題を解決します。（一つ選択）**
・IdFix ツールを実行し、検出されたエラーに対して Edit 機能を使用する
・Active Directory ドメインと信頼関係から、UPN サフィックスのリストを変更する
・Azure AD Connect で送信同期規則を変更する
・PowerShell を使用して Set-ADUser コマンドレットで UserPrincipalName 属性を一括更新する

**解答例**
・IdFix ツールを実行し、検出されたエラーに対して Edit 機能を使用する

**解説**
Active Directory と Azure AD 間の同期エラーで最も一般的な原因は、UPN やその他の属性に含まれる無効な文字や形式の問題です。IdFix はマイクロソフトが提供する無償ツールで、Azure AD Connect による同期前に Active Directory オブジェクトの属性エラーを検出・修正するために設計されています。

IdFix ツールは以下の問題を自動検出します：重複する proxyAddresses 属性、無効な文字を含む UPN、形式が正しくないメールアドレス、空白や特殊文字の問題などです。検出後、Edit 機能を使用することで、推奨される修正内容を確認しながら一括で属性を修正できます。これにより同期エラーを事前に防止し、Azure AD Connect の同期を正常に実行できるようになります。

他の選択肢について、UPN サフィックスの変更は新しいドメインを追加する場合に必要ですが既存の無効文字問題は解決しません。送信同期規則の変更は属性マッピングのカスタマイズに使用しますが、ソースデータの品質問題には対応できません。PowerShell での一括更新も可能ですが、問題の検出と修正候補の提示を自動化する IdFix の方が効率的で安全です。

| 機能 | 説明 | 用途 |
| :--- | :--- | :--- |
| IdFix | AD 属性エラーの検出と修正ツール | 同期前の属性検証 |
| Azure AD Connect | オンプレミス AD と Azure AD の同期 | ディレクトリ同期 |
| 同期規則 | 属性マッピングのカスタマイズ | 同期動作の制御 |

**リファレンス**
・Microsoft Entra Connect
・IdFix
・ユーザープリンシパル名（UPN）

**問題 363. オンプレミスの Active Directory と同期する Microsoft Entra ID（旧 Azure AD）テナントがあります。このテナントには複数のユーザーが存在し、それぞれ異なる同期元を持っています。Group1 という名前のグループを作成し、User1 をメンバーとして追加しました。Group1 の所有者を構成する必要があります。Group1 の所有者として追加できるユーザーの条件として正しいものはどれですか。（一つ選択）**
| ユーザー名 | 同期元 |
| :--- | :--- |
| User1 | Microsoft Entra ID |
| User2 | Windows Server AD |
| User3 | Microsoft Entra ID |
| User4 | Windows Server AD |

・Microsoft Entra ID で作成されたユーザーのみ
・すべてのユーザーを所有者として追加可能
・Windows Server AD から同期されたユーザーのみ
・グループの作成者のみ

**解答例**
・Microsoft Entra ID で作成されたユーザーのみ

**解説**
Microsoft Entra ID のグループ所有者として設定できるのは、クラウドネイティブなユーザーアカウント、つまり Microsoft Entra ID 内で直接作成されたユーザーのみです。オンプレミスの Windows Server Active Directory から同期されたユーザーアカウントは、グループの所有者として設定することができません。

この制限は、Microsoft Entra ID のグループ管理機能がクラウドベースの管理モデルを前提としているためです。同期されたユーザーアカウントは読み取り専用の属性を持ち、特定の管理操作に制限があります。グループ所有権はクラウド側で完全に管理される必要があるため、クラウドネイティブなアカウントのみが所有者になれます。

本問題では、User1 と User3 が Microsoft Entra ID で作成されたユーザーであり、User2 と User4 は Windows Server AD から同期されたユーザーです。したがって、Group1 の所有者として追加できるのは User1 と User3 のみとなります。

| 項目 | 説明 |
| :--- | :--- |
| クラウドユーザー | Microsoft Entra ID で直接作成、グループ所有者に設定可能 |
| 同期ユーザー | オンプレミス AD から同期、グループ所有者に設定不可 |
| 管理範囲 | 所有者はメンバー管理やグループ設定の変更が可能 |

**リファレンス**
・Microsoft Entra ID
・Microsoft Entra Connect

**問題 364. テスト用途で使用していた Azure 仮想マシン VM1 があり、Azure Backup で保護されています。VM1 を削除した後、VM1 のバックアップデータを完全に削除します。最初に実行すべき操作を選択してください。（一つ選択）**
・バックアップポリシーを変更する
・Recovery Services コンテナーを削除する
・バックアップアイテムを削除する
・バックアップを停止してデータを保持する

**解答例**
・バックアップアイテムを削除する

**解説**
Azure Backup で保護されていた仮想マシンを削除した後、バックアップデータを完全に削除するには、Recovery Services コンテナー内のバックアップアイテムを削除する必要があります。仮想マシン本体を削除しても、バックアップデータは自動的には削除されず、Recovery Services コンテナー内に保持され続けます。

バックアップデータを削除する正しい手順は、まずバックアップアイテムの削除を実行することです。Azure portal で Recovery Services コンテナーを開き、バックアップアイテムの一覧から VM1 を選択し、「バックアップの停止」を実行した後、「バックアップデータの削除」オプションを選択します。この操作により、すべての復旧ポイントとバックアップデータが完全に削除されます。

バックアップポリシーの変更は、バックアップの頻度や保持期間を調整する操作であり、既存のバックアップデータの削除には関係しません。Recovery Services コンテナー自体を削除する場合は、コンテナー内のすべてのバックアップアイテムを事前に削除する必要があります。バックアップを停止してデータを保持する操作では、バックアップデータは削除されず保持され続けます。

| 操作 | 説明 | バックアップデータの状態 |
| :--- | :--- | :--- |
| バックアップアイテムの削除 | 特定の保護対象のバックアップデータを完全削除 | 完全削除される |
| バックアップの停止（データ保持） | バックアップジョブを停止するがデータは保持 | 保持される |
| バックアップの停止（データ削除） | バックアップジョブを停止しデータも削除 | 完全削除される |

**リファレンス**
・Azure Backup
・Recovery Services Vault

**問題 365. Azure 仮想マシン VM1 のバックアップを計画しています。バックアップ事前チェックのステータスを確認したところ、警告が表示されました。この警告ステータスの原因として考えられるものはどれですか。（一つ選択）**
・VM1 が停止している
・VM1 に Azure VM Agent (WaAppAgent.exe) の最新バージョンがインストールされていない
・Recovery Services vault が存在しない
・VM1 がマネージドディスクを使用していない

**解答例**
・VM1 に Azure VM Agent (WaAppAgent.exe) の最新バージョンがインストールされていない

**解説**
Azure Backup で VM をバックアップする際、事前チェックで警告が表示される主な原因は Azure VM Agent のバージョンが古いことです。Azure VM Agent は仮想マシン上で動作し、バックアップ拡張機能と連携してスナップショットを取得します。最新バージョンでない場合、バックアップは実行可能ですが警告が表示されます。

VM1 が停止している場合、バックアップは正常に実行されるため警告の原因にはなりません。Azure Backup は停止中の VM でもスナップショットを取得できます。

Recovery Services vault が存在しない場合は警告ではなくエラーとなり、バックアップ構成自体が完了しません。vault はバックアップデータの保存先として必須のリソースです。

マネージドディスクとアンマネージドディスクの違いは、バックアップの警告ステータスには影響しません。どちらのディスクタイプでも Azure Backup は正常に動作します。

| 状態 | 影響 | バックアップ実行 |
| :--- | :--- | :--- |
| VM Agent 古い | 警告表示 | 可能 |
| VM 停止中 | 影響なし | 可能 |
| Vault 未作成 | エラー | 不可 |

**リファレンス**
・Azure VM Agent
・Azure Backup
・Recovery Services Vault

**問題 366. あなたの組織は、hogehoge.onmicrosoft.com という名前の Microsoft Entra ID（旧 Azure AD）テナントを含むハイブリッドインフラストラクチャを運用しています。このテナントには複数のユーザーアカウントが登録されており、User1 はメンバータイプのユーザー、User2 は外部ゲストユーザー、User3 はオンプレミス Active Directory から同期されたユーザー、User4 は招待が保留中のゲストユーザーです。あなたは All Users グループに対してクラウドリソースを共有する予定です。User1、User2、User3、User4 のすべてがクラウドリソースに正常に接続できるようにする必要があります。最初に実行すべき操作はどれですか。（一つ選択）**
・User4 の招待を完了させ、ゲストアカウントとしてアクティブ化する
・User3 に対してクラウド認証を有効化する
・外部コラボレーション設定を変更してゲストユーザーのアクセス権限を調整する
・User4 用のメンバータイプのユーザーアカウントを新規作成する

**解答例**
・User4 の招待を完了させ、ゲストアカウントとしてアクティブ化する

**解説**
この問題の最重要ポイントは、招待が保留中のゲストユーザー（User4）はテナント内でアクティブなアカウントとして認識されないため、リソースへのアクセスができない状態にあることを理解することです。

Microsoft Entra ID では、外部ゲストユーザーを招待する際、招待メールが送信され、受信者が招待を承諾することでアカウントがアクティブ化されます。招待が保留中の状態では、ユーザーオブジェクトはディレクトリに存在しますが、認証やリソースアクセスに必要な属性が完全に設定されていません。したがって、User4 がクラウドリソースにアクセスするには、まず招待プロセスを完了させる必要があります。

User1 はメンバータイプのユーザーとして既にアクティブであり、User2 は既に招待を承諾済みのゲストユーザーです。User3 はオンプレミス Active Directory から同期されたユーザーであり、Microsoft Entra Connect（旧 Azure AD Connect）によって適切に同期されていれば、クラウドリソースへのアクセスに問題はありません。外部コラボレーション設定の変更は、ゲストユーザーの招待ポリシーやアクセス制限を管理するものであり、既に招待済みの User4 をアクティブ化する直接的な解決策ではありません。

| ユーザー | タイプ | 状態 | 必要な対応 |
| :--- | :--- | :--- | :--- |
| User1 | メンバー | アクティブ | なし |
| User2 | ゲスト | アクティブ | なし |
| User3 | 同期ユーザー | アクティブ | なし |
| User4 | ゲスト | 招待保留中 | 招待完了が必要 |

**リファレンス**
・Microsoft Entra ID
・Microsoft Entra Connect

**問題 367. App1 という名前のアプリケーションが VM1 と VM2 という 2 台の Azure 仮想マシン上で稼働しています。App1 用の Availability Set を実装する予定です。VM1 と VM2 をホストしているハードウェアの計画メンテナンス中も App1 が利用可能である必要があります。Availability Set に含めるべき構成を選択してください。（一つ選択）**
・1 つの Fault Domain
・2 つの Fault Domain
・2 つの Update Domain
・1 つの Update Domain

**解答例**
・2 つの Update Domain

**解説**
計画メンテナンス中のアプリケーション可用性を確保するには、Update Domain の適切な構成が必要です。

Azure Availability Set は、仮想マシンを物理的に分離して配置することで高可用性を実現します。Update Domain は計画メンテナンス時の可用性を、Fault Domain は予期しないハードウェア障害時の可用性を提供します。計画メンテナンスでは、Azure は一度に 1 つの Update Domain 内の仮想マシンのみを再起動します。2 つの Update Domain を構成することで、VM1 と VM2 が異なる Update Domain に配置され、一方がメンテナンス中でも他方は稼働を継続できます。

Fault Domain は電源やネットワークスイッチなどの物理的な障害点を分離するための構成であり、計画メンテナンスには直接関係しません。1 つの Update Domain では両方の仮想マシンが同時にメンテナンス対象となり、アプリケーションが停止する可能性があります。

| 構成要素 | 目的 | 推奨設定 |
| :--- | :--- | :--- |
| Update Domain | 計画メンテナンス時の可用性確保 | 2 以上 |
| Fault Domain | ハードウェア障害時の可用性確保 | 2 以上 |

**リファレンス**
・Availability Set
・Update Domain
・Fault Domain

**問題 368. Azure サブスクリプション内のストレージアカウント「storage-A」に、コンテナー「container-A」が存在します。このコンテナーに対して、読み取り専用アクセスを提供し、HTTP と HTTPS の両方のプロトコルを許可し、コンテナー内のすべてのコンテンツに対してアクセス許可を適用する必要があります。この要件を満たすために使用すべき機能は何ですか。（一つ選択）**
・アクセスキー
・共有アクセス署名 (SAS)
・Azure Content Delivery Network (CDN)
・ストレージアカウントのファイアウォール規則

**解答例**
・共有アクセス署名 (SAS)

**解説**
この問題では、Azure Blob Storage のコンテナーに対して、きめ細かいアクセス制御を実現する方法を問われています。

共有アクセス署名 (SAS) は、ストレージアカウントのリソースに対して、制限付きアクセス権を付与するための仕組みです。SAS を使用することで、読み取り専用などの特定の権限、HTTP と HTTPS の両方のプロトコル許可、有効期限、IP アドレス制限などを細かく設定できます。コンテナーレベルの SAS を作成すれば、コンテナー内のすべての Blob に対してアクセス許可を適用できます。

アクセスキーは、ストレージアカウント全体に対する完全な管理者権限を提供するため、読み取り専用という要件を満たせません。また、アクセスキーを使用すると、すべてのコンテナーとサービスへのフルアクセスが可能になってしまいます。

Azure CDN は、コンテンツ配信を高速化するためのサービスであり、アクセス制御の主要な手段ではありません。ストレージアカウントのファイアウォール規則は、ネットワークレベルでのアクセス制御を提供しますが、読み取り専用などの詳細な権限設定はできません。

| 機能 | 権限の粒度 | プロトコル制御 |
| :--- | :--- | :--- |
| SAS | 読み取り / 書き込みなど詳細設定可能 | HTTP/HTTPS 選択可能 |
| アクセスキー | フルアクセスのみ | すべて許可 |
| ファイアウォール規則 | ネットワークレベルのみ | 制限不可 |

**リファレンス**
・共有アクセス署名 (SAS)
・Azure Blob Storage

**問題 369. Azure サブスクリプションにパブリックロードバランサーがあり、VM-A、VM-B、VM-C という 3 つの仮想マシン間でポート 80 と 443 の負荷分散を実行しています。既存の負荷分散構成を維持したまま、すべての RDP 接続を VM-C のみに転送します。どの機能を構成しますか。（一つ選択）**
・負荷分散規則
・バックエンドプール
・インバウンド NAT 規則
・正常性プローブ

**解答例**
・インバウンド NAT 規則

**解説**
この問題の最重要ポイントは、特定の仮想マシンへの直接接続とロードバランサーによる負荷分散の違いを理解することです。RDP 接続は管理用途であり、特定の VM に直接アクセスする必要があるため、負荷分散ではなくポート転送が必要です。

インバウンド NAT 規則は、ロードバランサーのフロントエンド IP アドレスの特定ポートへのトラフィックを、バックエンドプール内の特定の仮想マシンの特定ポートに転送する機能です。例えば、ロードバランサーのポート 3389 への RDP 接続を VM-C のポート 3389 に直接転送できます。複数の VM に対して RDP アクセスを提供する場合は、異なるポート番号（50001, 50002 など）を使用して各 VM にマッピングします。

負荷分散規則は、トラフィックをバックエンドプール内の複数の VM に分散する機能であり、特定の VM への直接接続には使用できません。バックエンドプールは VM のグループを定義する構成要素であり、トラフィック転送の設定ではありません。正常性プローブは VM の稼働状態を監視する機能です。

主要な構成要素の比較を以下に示します。

| 機能 | 用途 | トラフィック転送先 |
| :--- | :--- | :--- |
| 負荷分散規則 | 複数 VM への負荷分散 | バックエンドプール全体 |
| インバウンド NAT 規則 | 特定 VM への直接接続 | 指定した単一 VM |
| 正常性プローブ | VM 稼働状態の監視 | 転送機能なし |






ご指定いただいたソース（PDFの抜粋）の内容を、一文字も省略することなく全文そのまま出力いたします。

**リファレンス**
*   **Azure Load Balancer**
*   **Load Balancing Rule**

**問題 370. あなたは App1 という名前の Azure App Services Web アプリを管理しています。Web Deploy を使用して App1 をデプロイする予定です。App1 の開発者が Azure Active Directory（Azure AD）の資格情報を使用して App1 にコンテンツをデプロイできるようにします。このソリューションは最小特権の原則に従う必要があります。何をすべきですか。（一つ選択）**
*   **App1 に対して Website Contributor ロールを開発者に割り当てる**
*   **App1 に対して Contributor ロールを開発者に割り当てる**
*   **App1 に対して Owner ロールを開発者に割り当てる**
*   **Azure AD の資格情報を使用した Basic 認証を有効化する**

**解答例**
*   **App1 に対して Website Contributor ロールを開発者に割り当てる**

**解説**
**Azure App Service への Web Deploy を使用したデプロイで Azure AD 資格情報を利用する場合、適切な RBAC ロールの割り当てが必要です。** **最小特権の原則に従いつつ、デプロイ機能を提供するには、Website Contributor ロールが最適な選択肢となります。**

**Website Contributor ロールは、Web アプリのコンテンツ管理とデプロイに必要な権限を提供しますが、App Service プランの変更やアクセス制御の管理などの上位権限は含まれません。** **これにより、開発者はデプロイ作業を実行できる一方で、インフラストラクチャレベルの変更は制限されます。**

**Contributor ロールは、リソースの作成や削除を含むより広範な権限を持つため、最小特権の原則に反します。** **Owner ロールはさらに広範で、ロールの割り当て権限まで含むため不適切です。** **Basic 認証の有効化は、Azure AD 資格情報の使用という要件を満たしません。**

**Web Deploy は、Visual Studio や MSBuild などの開発ツールから直接 Azure にアプリケーションを発行する際に使用される標準的なデプロイメカニズムです。** **Azure AD 統合により、開発者は追加の資格情報を管理することなく、既存の組織アカウントでデプロイを実行できます。**

| **ロール** | **デプロイ権限** | **インフラ変更** | **最小特権** |
| :--- | :--- | :--- | :--- |
| **Website Contributor** | **あり** | **なし** | **適合** |
| **Contributor** | **あり** | **あり** | **過剰** |
| **Owner** | **あり** | **あり（ロール管理含む）** | **過剰** |

**リファレンス**
*   **Azure App Service**
*   **Azure RBAC (Role-Based Access Control)**

**問題 371. あなたの組織が所有する Azure サブスクリプション「Subscription-A」には、次の表に示す Web アプリが含まれています。Application Insights を使用して、各アプリのパフォーマンスと使用状況を監視します。ソリューションでは、アプリケーションコードへの変更を最小限に抑える必要があります。App-A に対して適用すべきものを選択してください。（一つ選択）**

| **名前** | **Web フレームワーク** | **ホスティング環境** |
| :--- | :--- | :--- |
| **App-A** | **ASP.NET** | **Windows Server 2022 を実行し、IIS が構成されているオンプレミスの物理サーバー** |
| **App-B** | **ASP.NET Core** | **Windows Server 2022 を実行し、IIS が構成されている Azure 仮想マシン** |

*   **Application Insights エージェントをインストールする**
*   **Application Insights SDK を使用する**
*   **Azure Diagnostics 拡張機能を有効にする**
*   **Log Analytics エージェントをインストールする**

**解答例**
*   **Application Insights エージェントをインストールする**

**解説**
**オンプレミスの IIS 上で動作する ASP.NET アプリケーションを監視する場合、コード変更を最小限に抑えるには Application Insights エージェント（旧称 Status Monitor）の利用が最適です。** **このエージェントは IIS サーバーにインストールするだけで、アプリケーションコードを変更することなく自動的にテレメトリデータを収集します。**

**Application Insights SDK は高度なカスタマイズが可能ですが、アプリケーションコードへの組み込みが必要となり、コード変更を最小限に抑えるという要件に適合しません。** **Log Analytics エージェントは主にインフラストラクチャレベルのログ収集に使用され、アプリケーションレベルの詳細なパフォーマンス監視には適していません。** **Azure Diagnostics 拡張機能は Azure リソース向けの診断機能であり、オンプレミス環境では利用できません。**

**Application Insights エージェントは、IIS で実行される ASP.NET アプリケーションに対して、依存関係の追跡、パフォーマンスカウンター、例外の監視などの機能を自動的に提供します。** **エージェントベースの監視は、既存のアプリケーションに対して非侵襲的にテレメトリ収集を実現できるため、運用中のシステムへの影響を最小限に抑えられます。**

| **監視方法** | **コード変更** | **対象環境** |
| :--- | :--- | :--- |
| **Application Insights エージェント** | **不要** | **オンプレミス IIS、Azure VM** |
| **Application Insights SDK** | **必要** | **すべての環境** |
| **Log Analytics エージェント** | **不要** | **インフラ監視向け** |

**リファレンス**
*   **Application Insights**
*   **Application Insights エージェント**

**問題 372. あなたは、Workspace1 と Workspace2 という 2 つの Log Analytics ワークスペースと、Windows Server を実行する 100 台の仮想マシンを含む Azure サブスクリプションを管理しています。仮想マシンからパフォーマンスデータとイベントを収集する必要があります。ソリューションは次の要件を満たす必要があります：複数の Log Analytics ワークスペース（Workspace1 と Workspace2）にログを送信する、すべての Windows イベントをキャプチャする、すべてのセキュリティイベントをキャプチャする。各仮想マシンにインストールして構成する必要があるものはどれですか。（一つ選択）**
*   **Azure Monitor Agent**
*   **Log Analytics Agent (MMA)**
*   **Azure Diagnostics Extension (WAD)**
*   **Azure VM Agent**

**解答例**
*   **Azure Monitor Agent**

**解説**
**この問題の最重要ポイントは、複数の Log Analytics ワークスペースへの同時送信機能を持つエージェントを選択することです。** **Azure Monitor Agent (AMA) は、従来の Log Analytics Agent (MMA) の後継として設計され、マルチホーミング機能を標準でサポートしています。**

**Azure Monitor Agent は、データ収集ルール (DCR) を使用して柔軟なデータ収集構成を実現します。** **DCR を通じて、複数の送信先ワークスペースを指定でき、Windows イベントログやセキュリティイベントなど、収集するデータの種類を細かく制御できます。** **この機能により、Workspace1 と Workspace2 の両方に同時にログを送信する要件を満たすことができます。**

**Log Analytics Agent (MMA) も複数ワークスペースへの送信をサポートしますが、2024 年 8 月 31 日に廃止されたレガシーエージェントです。** **Azure Diagnostics Extension は主に診断データの収集に使用され、複数の Log Analytics ワークスペースへの直接送信には適していません。** **Azure VM Agent は仮想マシンの基本的な管理機能を提供しますが、ログ収集機能は含まれていません。**

| **エージェント** | **複数ワークスペース対応** | **現在のステータス** |
| :--- | :--- | :--- |
| **Azure Monitor Agent** | **対応（DCR 使用）** | **推奨・最新** |
| **Log Analytics Agent** | **対応** | **廃止済み** |
| **Azure Diagnostics Extension** | **非対応** | **診断用途のみ** |

**リファレンス**
*   **Azure Monitor Agent**
*   **Data Collection Rules (DCR)**
*   **Log Analytics Workspace**

**問題 373. Azure ストレージアカウント storage1 に blob コンテナー container1 があります。container1 に追加される新しいコンテンツを 1 年間変更できないようにします。何を構成しますか。（一つ選択）**
*   **不変性ポリシー**
*   **アクセスレベル**
*   **アクセス層**
*   **Access control (IAM) 設定**

**解答例**
*   **不変性ポリシー**

**解説**
**Blob ストレージに保存されたデータを一定期間変更不可にするには、不変性ポリシー (Immutability Policy) を構成します。** **この機能により、指定した保持期間中はデータの変更や削除が防止され、規制要件やコンプライアンス対応が可能になります。**

**不変性ポリシーには時間ベースの保持ポリシーと訴訟ホールドの 2 種類があります。** **時間ベースの保持ポリシーでは、Blob が作成されてから指定した日数の間、データの変更や削除を防ぎます。** **訴訟ホールドは期間を設定せず、明示的に解除されるまでデータを保護します。**

**他の選択肢について、アクセスレベルはコンテナーや Blob への匿名アクセス権限を制御する設定です。** **アクセス層は Hot, Cool, Archive などのストレージコスト最適化のための階層です。** **Access control (IAM) は Azure リソースへのアクセス権限を管理する RBAC の設定であり、いずれもデータの変更防止機能は提供しません。**

| **機能** | **用途** |
| :--- | :--- |
| **不変性ポリシー** | **データの変更・削除防止** |
| **アクセスレベル** | **匿名アクセス制御** |
| **アクセス層** | **ストレージコスト最適化** |

**リファレンス**
*   **Immutability Policy**
*   **Azure RBAC (Role-Based Access Control)**

**問題 374. あなたの組織には、Azure サブスクリプション「Subscription-A」があります。この Subscription-A には、VNet-A という名前の Azure 仮想ネットワークが含まれています。VNet-A は Azure ExpressRoute を使用してオンプレミスネットワークに接続しています。ExpressRoute で障害が発生した場合に備えて、自動フェールオーバー環境を準備します。サイト間 VPN を使用して VNet-A をオンプレミスネットワークに接続することを検討しています。ソリューションではコストを最小限に抑える必要があります。どのアクションを実行しますか。（三つ選択）**
*   **ゲートウェイサブネットを作成する**
*   **VpnGw1 SKU を使用する VPN Gateway を作成する**
*   **ローカルネットワークゲートウェイを作成する**
*   **接続オブジェクトを作成する**
*   **Standard SKU を使用する VPN Gateway を作成する**

**解答例**
*   **ゲートウェイサブネットを作成する**
*   **VpnGw1 SKU を使用する VPN Gateway を作成する**
*   **ローカルネットワークゲートウェイを作成する**

**解説**
**ExpressRoute とサイト間 VPN の共存構成を実現するための手順を理解することが重要です。** **ExpressRoute ゲートウェイが既に存在する仮想ネットワークに VPN Gateway を追加する場合、特定の要件を満たす必要があります。**

**まず、VPN Gateway を配置するためのゲートウェイサブネットが必要です。** **ExpressRoute 用のゲートウェイサブネットが既に存在する場合でも、同じサブネット内に両方のゲートウェイを配置できます。** **ゲートウェイサブネットは /27 以上のアドレス空間を推奨します。**

**次に、ExpressRoute との共存をサポートする VPN Gateway SKU を選択する必要があります。** **Basic SKU は ExpressRoute との共存をサポートしていないため使用できません。** **VpnGw1 以上の SKU が必要であり、コストを最小に抑えるには VpnGw1 SKU が最適です。**

**ローカルネットワークゲートウェイは、オンプレミスネットワークの VPN デバイスとアドレス空間を表す Azure リソースです。** **サイト間 VPN 接続を確立するために必須のコンポーネントです。**

**接続オブジェクトは、VPN Gateway とローカルネットワークゲートウェイをリンクするリソースですが、これは自動的に作成されるものではなく、明示的に作成する必要があります。** **ただし、設問では「接続オブジェクト」ではなく「接続」という表現になっており、これは VPN 接続リソースを指します。**

| **項目** | **要件** | **理由** |
| :--- | :--- | :--- |
| **ゲートウェイサブネット** | **必須** | **VPN Gateway の配置に必要** |
| **VPN Gateway SKU** | **VpnGw1 以上** | **Basic SKU は ExpressRoute 共存不可** |
| **ローカルネットワークゲートウェイ** | **必須** | **オンプレミス側の情報を定義** |

**ExpressRoute と VPN の共存構成では、両方のゲートウェイが同じゲートウェイサブネット内に配置され、トラフィックルーティングの優先順位は ExpressRoute が高く設定されます。** **ExpressRoute 障害時には自動的に VPN 経由にフェールオーバーします。**

**リファレンス**
*   **Azure VPN Gateway**
*   **ExpressRoute**

**問題 375. 新しい Azure App Service アプリを構成します。要件は次の通りです。app.hogehoge.com のカスタムドメイン名を検証できること、最大 8 つのインスタンスまで自動的にスケールできること、コストと管理労力は最小限に抑えることです。このとき、ドメインの検証にはどのタイプの DNS レコードを使用しますか。（一つ選択）**
*   **TXT**
*   **CNAME**
*   **A**
*   **MX**

**解答例**
*   **TXT**

**解説**
**Azure App Service でカスタムドメインを検証する際、TXT レコードが最も推奨される方法です。** **TXT レコードを使用することで、ドメインの所有権を証明しながら、実際のトラフィックルーティングに影響を与えることなく検証を完了できます。**

**Azure App Service では、カスタムドメインを追加する際に、ドメインの所有権を証明するための検証手順が必要です。** **この検証には主に TXT レコードまたは A レコードが使用できますが、TXT レコードの使用が推奨されます。** **理由は、TXT レコードは検証専用として機能し、既存の DNS 構成に影響を与えないためです。** **検証プロセスでは、Azure ポータルから提供される検証 ID を TXT レコードとして DNS プロバイダーに追加し、Azure がそのレコードを確認することでドメインの所有権が証明されます。**

**自動スケーリング要件については、App Service Plan の Standard 以上のプランを選択することで、最大 8 インスタンスまでの自動スケールが可能です。** **Basic Plan や Free/Shared Plan では自動スケーリング機能が利用できないため、要件を満たすには Standard, Premium, または Isolated プランが必要です。**

| **レコードタイプ** | **用途** | **検証での推奨度** |
| :--- | :--- | :--- |
| **TXT** | **ドメイン所有権の検証専用** | **推奨（既存構成に影響なし）** |
| **A** | **IP アドレスへの直接マッピング** | **可能だが非推奨** |
| **CNAME** | **サブドメインのエイリアス設定** | **ルートドメインでは使用不可** |

**コストと管理労力を最小限に抑えるには、Standard S1 プランが適切です。** **このプランでは自動スケーリング機能が利用でき、必要に応じて最大 10 インスタンスまでスケールアウト可能です。** **検証後は、A レコードまたは CNAME レコードを使用して実際のトラフィックを App Service にルーティングします。**

**リファレンス**
*   **Azure App Service**
*   **App Service Plan**

**問題 376. Windows Server 2016 を実行する VM1 という名前の Azure 仮想マシンがあります。VM1 のシステムイベントログに 1 時間以内に 3 つ以上のエラーイベントが記録された場合に Azure でアラートを作成します。次のソリューションを実装しました。Azure ストレージアカウントを作成し、Shared Access Signature (SAS) を構成しました。VM1 に Microsoft Monitoring Agent をインストールしました。Azure Monitor でアラートを作成し、ストレージアカウントをソースとして指定しました。この方法は要件を満たしていますか。（一つ選択）**
*   **いいえ、要件を満たしていません**
*   **はい、要件を満たしています**
*   **はい、ただし Log Analytics workspace の追加構成が必要です**
*   **いいえ、Azure Event Hubs を使用する必要があります**

**解答例**
*   **いいえ、要件を満たしていません**

**解説**
**この問題の最重要ポイントは、Azure Monitor で Windows イベントログに基づくアラートを作成するには、Log Analytics workspace が必須であり、ストレージアカウントをソースとして直接指定することはできないという点です。**

**提示されたソリューションには以下の問題があります。** **まず、Azure Monitor でイベントログベースのアラートを作成する場合、ストレージアカウントではなく Log Analytics workspace をデータソースとして使用する必要があります。** **Microsoft Monitoring Agent（現在は Azure Monitor Agent への移行が推奨されています）は、収集したログデータを Log Analytics workspace に送信します。** **ストレージアカウントと SAS の構成は、この要件には関係ありません。**

**正しい実装手順は次のとおりです。** **Log Analytics workspace を作成し、VM1 に Azure Monitor Agent または Log Analytics agent をインストールして workspace に接続します。** **次に、Windows イベントログの収集を有効化し、システムログのエラーレベルイベントを収集するように構成します。** **最後に、Azure Monitor でログクエリアラートルールを作成し、1 時間以内に 3 つ以上のエラーイベントが発生した場合にトリガーされる KQL クエリを定義します。**

| **項目** | **提示されたソリューション** | **正しいソリューション** |
| :--- | :--- | :--- |
| **データソース** | **ストレージアカウント** | **Log Analytics workspace** |
| **エージェント** | **Microsoft Monitoring Agent** | **Azure Monitor Agent 推奨** |
| **アラート作成** | **ストレージベース** | **ログクエリベース (KQL)** |

**リファレンス**
*   **Azure Monitor**
*   **Log Analytics Workspace**
*   **Azure Monitor Agent**

**問題 377. Azure Active Directory Privileged Identity Management を構成しています。Admin1 という管理者に対して、RG1 というリソースグループへの読み取りアクセス権を 1 か月間のみ付与します。ユーザーロールは即座に割り当てる必要があります。どうしますか。（一つ選択）**
*   **期限付きのアクティブロールを割り当てる**
*   **永続的なアクティブロールを割り当てる**
*   **条件付きアクセスポリシーを使用してカスタムロールを作成する**
*   **資格のあるロールを割り当てる**

**解答例**
*   **期限付きのアクティブロールを割り当てる**

**解説**
**Privileged Identity Management (PIM) では、ロール割り当てに「アクティブロール」と「資格のあるロール」の 2 種類があります。** **本問では即座にアクセス権を付与し、1 か月後に自動的に失効させる必要があるため、期限付きのアクティブロールが最適です。**

**アクティブロールは割り当て直後から有効になり、ユーザーはアクティベーション操作なしで権限を使用できます。** **PIM では開始日時と終了日時を指定できるため、1 か月間という期限を設定することで要件を満たせます。** **期限到達時には自動的にロールが失効し、管理者による手動削除は不要です。**

**資格のあるロールは、ユーザーが必要時に自分でアクティベーション操作を行う必要があるため、即座に権限を付与するという要件に適合しません。** **永続的なアクティブロールは期限がないため、1 か月間のみという制約を満たせません。** **条件付きアクセスポリシーはアクセス制御の条件を定義するものであり、ロールの期限管理には使用しません。**

| **ロールタイプ** | **即時利用** | **期限設定** | **適合性** |
| :--- | :--- | :--- | :--- |
| **期限付きアクティブロール** | **可能** | **可能** | **適合** |
| **資格のあるロール** | **要アクティベーション** | **可能** | **不適合** |
| **永続的アクティブロール** | **可能** | **不可** | **不適合** |

**PIM のアクティブロール割り当てでは、Azure Portal のロール設定画面で割り当てタイプを「アクティブ」に設定し、開始日時と終了日時を指定します。** **これにより指定期間のみ有効なロール割り当てが実現できます。**

**リファレンス**
*   **Azure AD 条件付きアクセス**
*   **Azure RBAC (Role-Based Access Control)**

**問題 378. 汎用 v1 ストレージアカウント storageaccount1 にプライベートコンテナー container1 があります。container1 内のデータに対して 14 日間の期間限定で読み取りアクセスを許可します。どの方法を使用しますか。（一つ選択）**
*   **アカウント SAS を作成する**
*   **サービス SAS を作成する**
*   **保存されているアクセスポリシーを作成する**
*   **ストレージアカウントを汎用 v2 にアップグレードする**

**解答例**
*   **サービス SAS を作成する**

**解説**
**この問題は、Azure Storage のコンテナーに対して期間限定のアクセス権を付与する方法を問うものです。** **14 日間という特定期間の読み取りアクセスを実現するには、サービス SAS が最適な選択肢となります。**

**サービス SAS (Service Shared Access Signature) は、ストレージアカウント内の特定のリソース（Blob, Queue, Table, File）に対して、きめ細かいアクセス制御を提供します。** **開始時刻と終了時刻を指定でき、読み取り、書き込み、削除などの権限を個別に設定可能です。** **汎用 v1 ストレージアカウントでも利用でき、コンテナーレベルでのアクセス制御に適しています。**

**保存されているアクセスポリシーは、サービス SAS と組み合わせて使用することで、発行済み SAS の有効期限や権限を後から変更できる機能です。** **単独ではアクセス権を付与できないため、この設問の要件を満たしません。**

**アカウント SAS は、ストレージアカウント全体のリソースに対するアクセスを制御するもので、特定のコンテナーのみへのアクセス制限には過剰な権限となります。**

**ストレージアカウントのアップグレードは、この問題の解決には不要です。** **汎用 v1 でも SAS によるアクセス制御は実装可能です。**

| **SAS の種類** | **適用範囲** | **用途** |
| :--- | :--- | :--- |
| **サービス SAS** | **特定リソース** | **コンテナー単位の制御** |
| **アカウント SAS** | **アカウント全体** | **複数サービスへのアクセス** |
| **ユーザー委任 SAS** | **Blob のみ** | **Azure AD 認証ベース** |

**リファレンス**
*   **Shared Access Signature**
*   **Azure Blob Storage**

**問題 379. Azure サブスクリプションに以下のリソースが含まれています。Azure 仮想マシン 100 台、Azure SQL Database 20 個、Azure ファイル共有 50 個。Azure Backup を使用してすべてのリソースの日次バックアップを作成します。作成する必要があるバックアップポリシーの最小数はいくつですか。（一つ選択）**
*   **1**
*   **2**
*   **3**
*   **170**

**解答例**
*   **3**

**解説**
**Azure Backup では、リソースの種類ごとに異なるバックアップポリシーが必要です。** **各リソースタイプは異なる Recovery Services vault または Backup vault で管理され、それぞれ専用のポリシー設定が求められます。**

**本問では 3 種類のリソース（Azure 仮想マシン、Azure SQL Database, Azure ファイル共有）が存在するため、最小で 3 つのバックアップポリシーが必要です。** **同じリソースタイプであれば、複数のリソースに対して 1 つのポリシーを適用できます。** **例えば、100 台の仮想マシンすべてに同一のバックアップポリシーを適用可能です。**

**リソースタイプ別のバックアップ要件を以下に整理します。**

| **リソースタイプ** | **必要なポリシー数** | **管理場所** |
| :--- | :--- | :--- |
| **Azure 仮想マシン** | **1** | **Recovery Services vault** |
| **Azure SQL Database** | **1** | **Recovery Services vault** |
| **Azure ファイル共有** | **1** | **Recovery Services vault** |

**したがって、リソース数に関係なく、リソースタイプの数である 3 つのバックアップポリシーが最小構成となります。** **選択肢「170」は全リソース数の合計ですが、同一タイプのリソースは 1 つのポリシーで管理できるため不要です。** **選択肢「1」や「2」では、異なるリソースタイプすべてをカバーできません。**

**リファレンス**
*   **Azure Backup**
*   **Recovery Services Vault**
*   **Backup Policy**

**問題 380. あなたの会社では、Azure 上に複数の仮想ネットワーク (VNet) を構成しています。VNET1（アドレス空間：10.0.1.0/24）に VM1 が、VNET2（アドレス空間：10.0.2.0/24）に VM2 が、VNET3（アドレス空間：10.0.3.0/24）に VM4 が配置されています。現在、VM1 と VM4 の間で通信ができない状態です。管理作業を最小限に抑えながら、VM1 と VM4 間の通信を可能にする必要があります。どの方法を選択しますか。（一つ選択）**
*   **VM4 に 10.0.1.5/24 の IP アドレスを割り当てる**
*   **VNET1 と VNET3 の間に VNet Peering を確立する**
*   **Network Security Group (NSG) を作成し、VM1 と VM4 に関連付ける**
*   **VNET1 から VNET2, VNET2 から VNET3 への VNet Peering を構成し、ゲートウェイ転送を有効化する**

**解答例**
*   **VNET1 と VNET3 の間に VNet Peering を確立する**

**解説**
**異なる仮想ネットワーク間に配置された仮想マシン同士が通信するには、ネットワーク接続を確立する必要があります。** **Azure VNet Peering は、同一リージョンまたは異なるリージョンの仮想ネットワーク間を Azure バックボーンネットワーク経由で接続する機能です。**

**VM4 に異なるアドレス空間の IP アドレスを割り当てても、ネットワーク間での接続が確立されていないため通信はできません。** **NSG はトラフィックのフィルタリングを行うセキュリティ機能であり、ネットワーク接続そのものを提供しません。**

**VNet Peering は設定が簡単で、追加のゲートウェイデバイスを必要とせず、低レイテンシで高帯域幅の接続を実現します。** **VNET1 と VNET3 を直接ピアリングすることで、最小限の管理作業で VM1 と VM4 間の通信が可能になります。**

| **接続方法** | **特徴** | **管理作業** |
| :--- | :--- | :--- |
| **VNet Peering** | **直接接続、低レイテンシ** | **最小限** |
| **VPN Gateway** | **暗号化通信、追加コスト** | **中程度** |
| **ゲートウェイ転送** | **複数 VNet 経由の接続** | **複雑** |

**VNet Peering は双方向の設定が必要です。** **VNET1 から VNET3 へのピアリングと、VNET3 から VNET1 へのピアリングの両方を構成することで、相互通信が可能になります。** **ピアリング接続は推移的ではないため、VNET1-VNET2-VNET3 のように中継する場合は、ゲートウェイ転送の構成が必要になり管理作業が増加します。**

**リファレンス**
*   **Virtual Network Peering**
*   **Network Security Group**
*   **Azure Virtual Network**

**問題 381. あなたの組織では、以下の表に示す仮想マシンについて、負荷分散を実現することを検討しています。下記の構成を持つロードバランサーをデプロイしました。VM-A と VM-B を LB-A のバックエンドプールに追加できることを確認します。解決策として、2 つの Standard SKU パブリック IP アドレスを作成し、各仮想マシンのネットワークインターフェイスに関連付けます。これは目標を達成していますか。（一つ選択）**

| **名前** | **パブリック IP SKU** | **接続先** | **状態** |
| :--- | :--- | :--- | :--- |
| **VM-A** | **なし** | **VNet-A/Subnet-A** | **停止（割り当て解除）** |
| **VM-B** | **Basic** | **VNet-A/Subnet-B** | **実行中** |

**ロードバランサー構成：**
| **項目** | **設定値** |
| :--- | :--- |
| **名前** | **LB-A** |
| **タイプ** | **Internal** |
| **SKU** | **Standard** |
| **仮想ネットワーク** | **VNet-A** |

*   **いいえ**
*   **はい**

**解答例**
*   **いいえ**

**解説**
**Internal Load Balancer のバックエンドプールに VM を追加する際、パブリック IP アドレスの関連付けは不要です。** **Internal Load Balancer は仮想ネットワーク内のプライベート IP アドレスを使用して負荷分散を行うため、VM にパブリック IP アドレスを割り当てる必要はありません。**

**この問題の解決には、以下の要件を満たす必要があります。** **Standard SKU の Internal Load Balancer のバックエンドプールには、同じ仮想ネットワーク内に存在し、Standard SKU 互換のネットワーク構成を持つ VM を追加できます。** **VM-B は Basic SKU のパブリック IP アドレスを持っているため、これを Standard SKU に変更するか削除する必要があります。** **また、両方の VM が同じ仮想ネットワーク (VNet-A) 内に存在することを確認します。**

**正しい解決策は、VM-B の Basic SKU パブリック IP アドレスを削除または解除し、両方の VM が同じ仮想ネットワーク内に配置されていることを確認することです。** **Internal Load Balancer を使用する場合、バックエンドプールの VM にパブリック IP アドレスは不要です。**

| **項目** | **要件** |
| :--- | :--- |
| **Load Balancer SKU** | **Standard** |
| **バックエンド VM 配置** | **同一仮想ネットワーク内** |
| **パブリック IP** | **Internal LB では不要** |

**リファレンス**
*   **Azure Load Balancer**
*   **Standard SKU**

**問題 382. Azure コンテナーレジストリ「Registry1」があり、「image1」という名前のイメージが含まれています。image1 を使用してコンテナーインスタンスをデプロイしようとすると、エラーメッセージが表示されます。image1 を使用してコンテナーインスタンスを正常にデプロイできるようにします。解決策：Registry1 に対してマネージド ID に AcrPull ロールを割り当てます。この解決策は目標を達成していますか。（一つ選択）**
*   **はい**
*   **いいえ**

**解答例**
*   **はい**

**解説**
**Azure Container Registry から Azure Container Instances へイメージをデプロイする際のエラーは、通常、適切な認証と認可の欠如が原因です。** **この問題を解決するには、コンテナーインスタンスがレジストリからイメージをプルする権限を持つ必要があります。**

**マネージド ID に AcrPull ロールを割り当てることで、Azure Container Instances は認証情報を明示的に管理することなく、Azure Container Registry からイメージを安全にプルできます。** **AcrPull ロールは、レジストリからイメージとアーティファクトをプルするために必要な最小限の権限を提供します。**

**Azure Container Instances でマネージド ID を使用する場合、システム割り当てマネージド ID またはユーザー割り当てマネージド ID のいずれかを構成できます。** **この ID に対して AcrPull ロールを Azure Container Registry レベルで割り当てることで、コンテナーインスタンスはレジストリへのアクセス権を取得します。**

**認証方法の比較：**
| **認証方法** | **特徴** | **推奨度** |
| :--- | :--- | :--- |
| **マネージド ID** | **認証情報の管理不要、自動ローテーション** | **高** |
| **サービスプリンシパル** | **手動での認証情報管理が必要** | **中** |
| **管理者アカウント** | **セキュリティリスクが高い** | **低** |

**ロールと権限の比較：**
| **ロール名** | **権限内容** | **用途** |
| :--- | :--- | :--- |
| **AcrPull** | **イメージのプル** | **コンテナー実行** |
| **AcrPush** | **イメージのプッシュとプル** | **CI/CD パイプライン** |
| **Owner** | **完全な管理権限** | **レジストリ管理** |

**この解決策により、セキュアな方法でコンテナーインスタンスのデプロイが可能になり、認証情報の漏洩リスクも軽減されます。**

**リファレンス**
*   **Azure Container Registry**
*   **Azure Container Instances**

**問題 383. Azure サブスクリプションがあり、Traffic Analytics が構成されています。次の設定を持つ VM1 という名前の新しい仮想マシンをデプロイします。リージョンは East US、仮想ネットワークは VNet1、NIC ネットワークセキュリティグループは NSG1 です。Traffic Analytics を使用して VM1 のトラフィックを監視します。どの設定を構成しますか。（一つ選択）**
*   **NSG1 の NSG フローログ**
*   **VM1 の診断設定**
*   **VNet1 のフローログ**
*   **VM1 の Connection Monitor**

**解答例**
*   **NSG1 の NSG フローログ**

**解説**
**Traffic Analytics で Azure 仮想マシンのネットワークトラフィックを監視するには、ネットワークセキュリティグループ (NSG) のフローログを有効化する必要があります。** **NSG フローログは、NSG を通過する IP トラフィックに関する情報を記録する機能で、送信元と送信先の IP アドレス、ポート、プロトコル、トラフィックの許可または拒否などの詳細情報を収集します。**

**Traffic Analytics は、この NSG フローログデータを分析し、ネットワークトラフィックパターン、セキュリティ脅威、ネットワークパフォーマンスの課題を可視化します。** **VM1 のトラフィックを監視するには、VM1 の NIC に関連付けられている NSG1 で NSG フローログを有効化し、そのログデータを Log Analytics ワークスペースに送信するように構成します。**

**VM1 の診断設定では、仮想マシンのメトリックやログは収集できますが、ネットワークトラフィックの詳細な分析には対応していません。** **VNet1 のフローログは仮想ネットワークレベルの設定ですが、Traffic Analytics で使用するには NSG レベルでの設定が必要です。** **Connection Monitor はネットワークパスの End-to-End 監視に使用されますが、Traffic Analytics とは異なる目的のツールです。**

| **設定項目** | **Traffic Analytics 対応** | **用途** |
| :--- | :--- | :--- |
| **NSG フローログ** | **対応** | **トラフィック分析の基礎データ** |
| **VM 診断設定** | **非対応** | **VM メトリックとログ収集** |
| **Connection Monitor** | **非対応** | **End-to-End 接続監視** |

**リファレンス**
*   **Traffic Analytics**
*   **NSG Flow Logs**
*   **Network Watcher**

**問題 384. Azure 仮想ネットワーク VNet1 があります。contoso.com という名前の Azure Private DNS ゾーンを作成しました。VNet1 上の仮想マシンが contoso.com プライベート DNS ゾーンに自動登録されるようにします。何をすべきですか。（一つ選択）**
*   **VNet1 の DNS 設定でカスタム DNS サーバーを構成する**
*   **各仮想マシンにカスタム DNS サーバーを個別に構成する**
*   **contoso.com に仮想ネットワークリンクを追加し、自動登録を有効にする**
*   **VNet1 に Azure DNS Private Resolver をデプロイする**

**解答例**
*   **contoso.com に仮想ネットワークリンクを追加し、自動登録を有効にする**

**解説**
**Azure Private DNS ゾーンで仮想マシンの DNS レコードを自動登録するには、仮想ネットワークリンク (Virtual Network Link) を作成し、自動登録オプションを有効化する必要があります。**

**仮想ネットワークリンクは、Azure Private DNS ゾーンと仮想ネットワークを関連付ける機能です。** **自動登録を有効にすると、リンクされた仮想ネットワーク内の仮想マシンが起動・停止・削除されるたびに、DNS レコードが自動的に作成・更新・削除されます。** **この機能により、手動での DNS レコード管理が不要になり、常に最新の名前解決が可能になります。**

**カスタム DNS サーバーの構成は、外部 DNS サーバーを使用する場合に必要ですが、Azure Private DNS ゾーンの自動登録機能とは関係ありません。** **Azure DNS Private Resolver は、オンプレミスネットワークと Azure 間での DNS 名前解決を可能にするサービスですが、Private DNS ゾーンへの自動登録機能は提供しません。**

| **機能** | **用途** | **自動登録** |
| :--- | :--- | :--- |
| **仮想ネットワークリンク** | **Private DNS ゾーンと VNet の関連付け** | **可能** |
| **カスタム DNS サーバー** | **外部 DNS サーバーの利用** | **不可** |
| **DNS Private Resolver** | **オンプレミスとの名前解決** | **不可** |

**リファレンス**
*   **Azure Private DNS**
*   **仮想ネットワークリンク**

**問題 385. Azure サブスクリプションに hogehoge.com という名前の Azure DNS ゾーンがあります。新しいサブドメイン sub.hogehoge.com を追加し、このサブドメインを別の DNS サーバーに委任します。ドメイン委任を構成するにはどうすればよいですか。（一つ選択）**
*   **hogehoge.com ゾーンに sub という名前の NS レコードセットを追加する**
*   **sub.hogehoge.com の AAAA レコードを追加する**
*   **hogehoge.com の CNAME レコードを変更する**
*   **sub.hogehoge.com の SOA レコードを作成する**

**解答例**
*   **hogehoge.com ゾーンに sub という名前の NS レコードセットを追加する**

**解説**
**Azure DNS でサブドメインを別の DNS サーバーに委任する場合、親ゾーンに NS (Name Server) レコードセットを作成します。** **この設定により、サブドメインへの DNS クエリが指定した委任先 DNS サーバーに転送されます。**

**NS レコードセットの名前はサブドメイン名と一致させる必要があります。** **今回の例では、親ゾーン hogehoge.com に sub という名前の NS レコードセットを作成し、委任先 DNS サーバーのネームサーバー情報を指定します。** **これにより sub.hogehoge.com へのクエリが適切に委任されます。**

**AAAA レコードは IPv6 アドレスの名前解決に使用され、ドメイン委任には関係ありません。** **CNAME レコードは別名の設定に使用されますが、ゾーンの頂点やドメイン委任には使用できません。** **SOA レコードはゾーンの権威情報を定義するレコードで、新規ゾーン作成時に自動生成されますが、委任設定には使用しません。**

| **レコードタイプ** | **用途** | **委任での役割** |
| :--- | :--- | :--- |
| **NS** | **ネームサーバー指定** | **サブドメイン委任に必須** |
| **SOA** | **ゾーン権威情報** | **自動生成、委任設定不可** |
| **AAAA** | **IPv6 アドレス解決** | **委任に無関係** |

**Azure DNS でのドメイン委任は、親ゾーンで NS レコードセットを作成し、委任先のネームサーバー情報を登録することで実現します。** **委任後、サブドメインの DNS 管理は委任先サーバーで独立して行えます。**

**リファレンス**
*   **Azure DNS**

**問題 386. 組織内に複数の仮想ネットワークが存在し、これらの間でピアリング接続を確立する計画があります。以下の表に示す仮想ネットワークの構成において、VNet-A とピアリング接続を確立できる仮想ネットワークはどれですか。（該当するものをすべて選択）**

| **名前** | **アドレス空間** | **サブネット** | **リソースグループ** | **Azure リージョン** |
| :--- | :--- | :--- | :--- | :--- |
| **VNet-A** | **10.11.0.0/16** | **10.11.0.0/17** | **RG-East** | **東日本** |
| **VNet-B** | **10.11.0.0/17** | **10.11.0.0/25** | **RG-East** | **東日本** |
| **VNet-C** | **10.10.0.0/22** | **10.10.1.0/24** | **RG-West** | **西日本** |
| **VNet-D** | **192.168.16.0/22** | **192.168.16.0/24** | **RG-US** | **米国西部** |

*   **VNet-C と VNet-D**
*   **VNet-D のみ**
*   **VNet-B と VNet-C**
*   **VNet-C のみ**

**解答例**
*   **VNet-C と VNet-D**

**解説**
**Virtual Network Peering を確立するための最重要条件は、ピアリング対象の仮想ネットワーク間で IP アドレス空間が重複していないことです。** **重複がある場合、ピアリング接続は確立できません。**

**VNet-A のアドレス空間は 10.11.0.0/16 で、これは 10.11.0.0 から 10.11.255.255 までの範囲をカバーします。** **VNet-B のアドレス空間 10.11.0.0/17 は 10.11.0.0 から 10.11.127.255 までの範囲であり、VNet-A のアドレス空間と完全に重複しています。** **このため、VNet-A と VNet-B の間ではピアリング接続を確立できません。**

**一方、VNet-C のアドレス空間 10.10.0.0/22 と VNet-D のアドレス空間 192.168.16.0/22 は、いずれも VNet-A のアドレス空間と重複していません。** **Azure Virtual Network Peering は異なるリージョン間でも確立可能（グローバル VNet ピアリング）であるため、リージョンの違いは制約になりません。** **また、リソースグループが異なる場合でも、適切な権限があればピアリング接続を確立できます。**

**したがって、VNet-A とピアリングできるのは VNet-C と VNet-D です。**

| **仮想ネットワーク** | **アドレス空間の重複** | **ピアリング可否** |
| :--- | :--- | :--- |
| **VNet-B** | **あり（10.11.0.0/17 は VNet-A に含まれる）** | **不可** |
| **VNet-C** | **なし** | **可能** |
| **VNet-D** | **なし** | **可能** |

**リファレンス**
*   **Virtual Network Peering**

**問題 387. あなたは、NSG1、NSG2、NSG3 という 3 つの Network Security Group (NSG) を管理しています。NSG3 ではポート 80 がブロックされており、NSG1 と NSG2 ではポート 80 が許可されています。以下の構成を持つ 4 台の Azure 仮想マシンがあります。VM1 は Subnet1 に配置され、NIC1 が NSG2 に関連付けられています。VM2 は Subnet1 に配置され、NIC2 が NSG3 に関連付けられています。VM3 は Subnet3 に配置され、NIC3 が NSG3 に関連付けられています。VM4 は Subnet2 に配置され、NIC に NSG は関連付けられていません。サブネットの構成は次の通りです。Subnet1 は NSG1 に関連付けられ、Subnet2 は NSG3 に関連付けられ、Subnet3 には NSG が関連付けられていません。インターネットからポート 80 でアクセス可能な仮想マシンはどれですか。（一つ選択）**
*   **VM3**
*   **VM4**
*   **VM1**
*   **VM2**

**解答例**
*   **VM1**

**解説**
**Azure の Network Security Group は、サブネットレベルとネットワークインターフェイス (NIC) レベルの両方に適用できます。** **トラフィックの評価では、両方の NSG ルールが適用され、より制限的なルールが優先されます。**

**VM1 の評価では、Subnet1 に関連付けられた NSG1 がポート 80 を許可し、NIC1 に関連付けられた NSG2 もポート 80 を許可しているため、インターネットからのアクセスが可能です。** **VM2 は、Subnet1 の NSG1 がポート 80 を許可していますが、NIC2 に関連付けられた NSG3 がポート 80 をブロックしているため、アクセスできません。** **VM3 は、Subnet3 に NSG が関連付けられていませんが、NIC3 に関連付けられた NSG3 がポート 80 をブロックしているため、アクセスできません。** **VM4 は、NIC レベルでは NSG が関連付けられていませんが、Subnet2 に関連付けられた NSG3 がポート 80 をブロックしているため、アクセスできません。**

**NSG の評価順序と適用ルールを整理すると以下のようになります。**

| **仮想マシン** | **サブネット NSG** | **NIC NSG** | **ポート 80 の結果** |
| :--- | :--- | :--- | :--- |
| **VM1** | **NSG1 (許可)** | **NSG2 (許可)** | **アクセス可能** |
| **VM2** | **NSG1 (許可)** | **NSG3 (拒否)** | **アクセス不可** |
| **VM3** | **なし** | **NSG3 (拒否)** | **アクセス不可** |
| **VM4** | **NSG3 (拒否)** | **なし** | **アクセス不可** |

**サブネットと NIC の両方に NSG が適用されている場合、トラフィックは両方の NSG ルールセットを通過する必要があります。** **いずれかのレベルでトラフィックが拒否されると、そのトラフィックはブロックされます。**

**リファレンス**
*   **Network Security Group**
*   **Azure Virtual Network**

**問題 388. Azure East US リージョンにデプロイされた VNet1 という名前の仮想ネットワークがあります。仮想マシンが VNet1 に接続されたときに管理者にメール通知を送信する必要があります。何を作成しますか。（一つ選択）**
*   **アラートルール**
*   **メール対応セキュリティグループ**
*   **アラート処理ルール**
*   **Log Analytics ワークスペース**

**解答例**
*   **アラートルール**

**解説**
**仮想ネットワークへの仮想マシン接続という特定のイベント発生時に管理者へメール通知を送信するには、Azure Monitor のアラートルールを作成します。** **アラートルールは監視対象リソースの状態変化やメトリクス値を評価し、条件が満たされた際にアクショングループを通じて通知を送信する仕組みです。**

**アラートルールの構成要素は以下の通りです。**

| **要素** | **説明** |
| :--- | :--- |
| **スコープ** | **監視対象リソース (VNet1)** |
| **条件** | **仮想マシン接続イベントの抽出** |
| **アクション** | **メール送信（アクショングループ経由）** |

**アラート処理ルールは既存のアラートルールの動作を変更する補助的な機能であり、単独では通知を生成できません。** **メール対応セキュリティグループは Microsoft 365 のグループ機能であり Azure リソース監視には使用しません。** **Log Analytics ワークスペースはログデータの収集と分析を行いますが、通知機能を持つにはアラートルールの設定が必要です。**

**実装手順として、まず Azure Portal でアラートルールを作成し、VNet1 をスコープとして指定します。** **次に Activity Log シグナルから仮想ネットワーク接続に関連するイベントを条件として設定し、最後にメール送信先を含むアクショングループを関連付けます。**

**リファレンス**
*   **Azure Monitor**
*   **Alert Rule**
*   **Action Group**

**問題 389. Azure サブスクリプションとして、Sub-Alpha と Sub-Beta があります。Sub-Alpha には以下のリソースグループが存在します。**

| **名前** | **リージョン** | **ロックタイプ** |
| :--- | :--- | :--- |
| **RG-Alpha1** | **東南アジア** | **なし** |
| **RG-Alpha2** | **東南アジア** | **読み取り専用** |

**Sub-Beta には以下のリソースグループが存在します。**

| **名前** | **リージョン** | **ロックタイプ** |
| :--- | :--- | :--- |
| **RG-Beta1** | **米国東部** | **Delete** |
| **RG-Beta2** | **米国西部** | **なし** |
| **RG-Beta3** | **東日本** | **読み取り専用** |

**RG-Alpha1 には「WebApp-Alpha」という名前の App Service が東南アジアリージョンに配置されています。次の記述について、正しい場合は「はい」を、正しくない場合は「いいえ」を選択してください。（一つ選択）**
**「WebApp-Alpha を RG-Alpha2 に移動できる。」**
*   **いいえ**
*   **はい**

**解答例**
*   **いいえ**

**解説**
**読み取り専用ロックが設定されたリソースグループには、リソースの移動や追加ができません。** **RG-Alpha2 には読み取り専用ロックが設定されているため、WebApp-Alpha を RG-Alpha2 に移動することはできません。**

**Azure のリソースロックには、読み取り専用 (ReadOnly) と削除 (Delete) の 2 種類があります。** **読み取り専用ロックが設定されると、リソースの読み取りは可能ですが、変更や削除、リソースの追加や移動などの書き込み操作が制限されます。** **一方、削除ロックが設定されている場合は、リソースの変更は可能ですが削除のみが制限されます。**

**リソースの移動に関する制約を以下の表にまとめます。**

| **ロックタイプ** | **リソースの移動** | **リソースの変更** | **リソースの削除** |
| :--- | :--- | :--- | :--- |
| **なし** | **可能** | **可能** | **可能** |
| **読み取り専用** | **不可** | **不可** | **不可** |
| **Delete** | **可能** | **可能** | **不可** |

**本問では、移動先の RG-Alpha2 に読み取り専用ロックが設定されているため、WebApp-Alpha の移動操作は実行できません。** **リソースを移動する場合は、移動先のリソースグループに読み取り専用ロックが設定されていないことを事前に確認する必要があります。**

**なお、App Service のリソース移動では、同一リージョン内であれば異なるサブスクリプション間での移動も可能ですが、移動先のリソースグループにロックが設定されていないことが前提条件となります。**

**リファレンス**
*   **Azure Resource Manager**
*   **Resource Lock**
*   **Azure App Service**

**問題 390. オンプレミスネットワーク上に Share-A という名前の SMB 共有があります。Azure サブスクリプションには、webapp-A という名前の Web App と VNet-A という名前の仮想ネットワークが存在します。webapp-A からオンプレミスの Share-A に接続できるようにします。何を導入しますか。（一つ選択）**
*   **Azure Application Gateway**
*   **Azure VPN Gateway**
*   **Azure ExpressRoute**
*   **Microsoft Entra Application Proxy**

**解答例**
*   **Azure VPN Gateway**

**解説**
**Azure Web App からオンプレミスの SMB 共有にアクセスするには、Azure 仮想ネットワークとオンプレミスネットワーク間の安全な接続が必要です。** **この要件を満たすには Azure VPN Gateway を導入します。**

**Azure VPN Gateway は、Azure の仮想ネットワークとオンプレミスネットワーク間でサイト間 VPN 接続を確立するサービスです。** **VPN Gateway を使用することで、Web App を VNet 統合機能により仮想ネットワークに接続し、VPN 経由でオンプレミスリソースへのアクセスが可能になります。**

**Azure Application Gateway は、Web アプリケーション向けのレイヤー 7 ロードバランサーであり、ネットワーク間接続には使用しません。** **Microsoft Entra Application Proxy は、オンプレミスの Web アプリケーションへの外部アクセスを提供するサービスですが、SMB 共有へのアクセスには対応していません。** **Azure ExpressRoute は専用線接続サービスですが、本シナリオでは要件として明示されていません。**

| **サービス** | **用途** | **SMB 接続対応** |
| :--- | :--- | :--- |
| **Azure VPN Gateway** | **サイト間 VPN 接続** | **対応** |
| **Azure Application Gateway** | **レイヤー 7 ロードバランサー** | **非対応** |
| **Microsoft Entra Application Proxy** | **Web アプリ外部公開** | **非対応** |

**リファレンス**
*   **Azure VPN Gateway**
*   **Virtual Network Integration**
*   **Site-to-Site VPN**

**問題 391. あなたは 2 つの Azure サブスクリプション「Sub-Alpha」と「Sub-Beta」を管理しています。Sub-Alpha には仮想マシン「VM-Gamma」とストレージアカウント「strgamma001」が含まれています。VM-Gamma には以下のリソースが関連付けられています。VM-Gamma をサブスクリプション「Sub-Beta」に移動します。この操作で一緒に移動する必要があるリソースの組み合わせを選択してください。（一つ選択）**

| **名前** | **タイプ** |
| :--- | :--- |
| **OSDisk-Gamma** | **オペレーティングシステムディスク** |
| **NIC-Gamma** | **ネットワークインターフェース** |
| **VNet-Gamma** | **仮想ネットワーク** |

*   **VM-Gamma, OSDisk-Gamma, NIC-Gamma, VNet-Gamma**
*   **VM-Gamma, OSDisk-Gamma, NIC-Gamma**
*   **VM-Gamma, OSDisk-Gamma, strgamma001**
*   **VM-Gamma, OSDisk-Gamma, VNet-Gamma, strgamma001**

**解答例**
*   **VM-Gamma, OSDisk-Gamma, NIC-Gamma, VNet-Gamma**

**解説**
**Azure の仮想マシンを別のサブスクリプションに移動する際は、仮想マシン本体だけでなく、その仮想マシンが依存している関連リソースも同時に移動する必要があります。**

**仮想マシンの移動に必要な依存リソースは以下の通りです。** **オペレーティングシステムディスク (Managed Disk) は仮想マシンのブート領域として必須です。** **ネットワークインターフェース (NIC) は仮想マシンのネットワーク接続を提供します。** **仮想ネットワーク (VNet) はネットワークインターフェースが接続される先のネットワーク基盤です。** **これらは仮想マシンの動作に不可欠な構成要素であり、移動元と移動先で同じサブスクリプション内に存在する必要があります。**

**一方、ストレージアカウントは仮想マシンの必須依存リソースではありません。** **診断ログやカスタムスクリプト拡張機能で利用される場合がありますが、仮想マシン本体の動作には直接影響しないため、移動の必須対象ではありません。**

| **リソース** | **移動要否** | **理由** |
| :--- | :--- | :--- |
| **仮想マシン** | **必須** | **移動対象の本体** |
| **OS ディスク** | **必須** | **VM 起動に必須** |
| **NIC** | **必須** | **ネットワーク接続に必須** |
| **VNet** | **必須** | **NIC の接続先として必須** |
| **ストレージアカウント** | **不要** | **VM 動作の必須要件ではない** |

**リファレンス**
*   **Azure Virtual Machine**
*   **Azure Virtual Network**
*   **Managed Disk**

**問題 392. あなたはストレージアカウント account1 を含む Azure サブスクリプションを管理しています。オンプレミスネットワーク（パブリック IP アドレス空間 131.107.1.0/24）から仮想マシンのディスクファイルを account1 にアップロードする予定です。このディスクファイルを使用して、仮想ネットワーク VNet1（IP アドレス空間 192.168.0.0/24）に接続される仮想マシン VM1 をプロビジョニングします。次の要件を満たすように account1 を構成します：ディスクファイルを account1 にアップロード可能にする、ディスクを VM1 にアタッチ可能にする、account1 への他のすべてのアクセスを防止する。実行すべきアクションはどれですか。（二つ選択）**
*   **account1 のネットワークブレードで、選択されたネットワークを選択する**
*   **VNet1 のサービスエンドポイントブレードで、サービスエンドポイントを追加する**
*   **account1 のネットワークブレードで、IP アドレス範囲 131.107.1.0/24 を追加する**
*   **account1 のネットワークブレードで、VNet1 を追加する**
*   **account1 のファイアウォールブレードで、プライベートエンドポイント接続を構成する**

**解答例**
*   **account1 のネットワークブレードで、選択されたネットワークを選択する**
*   **account1 のネットワークブレードで、IP アドレス範囲 131.107.1.0/24 を追加する**

**解説**
**この問題はストレージアカウントへのネットワークアクセス制御を適切に構成する能力を問うものです。** **オンプレミスからのアップロードと Azure 内部からのアクセスの両方を許可しつつ、セキュリティを確保する必要があります。**

**ストレージアカウントのネットワークアクセス制御では、デフォルトですべてのネットワークからのアクセスが許可されています。** **セキュリティ要件を満たすには、まず「選択されたネットワーク」を選択してアクセスを制限します。** **これにより、明示的に許可したネットワークや IP アドレス範囲からのみアクセスが可能になります。**

**オンプレミスネットワーク (131.107.1.0/24) からディスクファイルをアップロードするには、この IP アドレス範囲をストレージアカウントのファイアウォール設定に追加する必要があります。** **これにより、指定したパブリック IP アドレス範囲からのアクセスが許可されます。**

**VM1 が account1 のディスクにアクセスする場合、VM1 は同じ Azure リージョン内の Azure バックボーンネットワークを経由してアクセスします。** **Azure の内部トラフィックは、ストレージアカウントで「選択されたネットワーク」を構成した場合でも、同一リージョン内であれば自動的に許可されます。** **サービスエンドポイントや VNet の追加は、特定の VNet からのアクセスを明示的に制御する場合に使用しますが、この要件では必須ではありません。**

| **構成項目** | **目的** | **必要性** |
| :--- | :--- | :--- |
| **選択されたネットワーク** | **アクセス制限の有効化** | **必須** |
| **IP アドレス範囲追加** | **オンプレミスからのアップロード許可** | **必須** |
| **サービスエンドポイント** | **VNet 経由の最適化されたアクセス** | **任意** |

**リファレンス**
*   **Azure Storage**

**問題 393. Azure Import/Export サービスを使用してストレージアカウントにファイルをコピーします。インポートジョブ用のドライブを準備する前に作成する必要があるファイルはどれですか。（二つ選択）**
*   **JSON 構成ファイル**
*   **dataset CSV ファイル**
*   **driveset CSV ファイル**
*   **PowerShell PS1 ファイル**
*   **XML マニフェストファイル**

**解答例**
*   **dataset CSV ファイル**
*   **driveset CSV ファイル**

**解説**
**Azure Import/Export サービスでは、大量のデータを物理ディスクドライブを使用して Azure ストレージアカウントに転送します。** **インポートジョブを実行する前に、WAImportExport ツールを使用してドライブを準備する際、2 種類の CSV ファイルが必要です。**

**dataset CSV ファイルは、コピー対象のファイルやディレクトリの一覧を定義します。** **このファイルには、ソースパス、コピー先の Blob パス、メタデータなどの情報を記載します。** **driveset CSV ファイルは、使用する物理ドライブの一覧を定義します。** **ドライブレター、BitLocker キー、ドライブの容量などの情報を含みます。**

**WAImportExport ツールは、これら 2 つの CSV ファイルを参照してドライブの準備を実行します。** **ツールはデータをドライブにコピーし、BitLocker で暗号化し、ジャーナルファイルを生成します。** **その後、準備されたドライブを Azure データセンターに発送してインポートジョブを完了させます。**

| **ファイル種類** | **用途** | **主な記載内容** |
| :--- | :--- | :--- |
| **dataset CSV** | **コピー対象データの定義** | **ソースパス、Blob パス、メタデータ** |
| **driveset CSV** | **使用ドライブの定義** | **ドライブレター、BitLocker キー** |

**XML マニフェストファイルは WAImportExport ツールが自動生成するファイルであり、事前に手動で作成する必要はありません。** **PowerShell PS1 ファイルや JSON 構成ファイルは、Azure Import/Export サービスのドライブ準備プロセスでは使用しません。**

**リファレンス**
*   **Azure Import/Export サービス**
*   **WAImportExport ツール**
*   **BitLocker 暗号化**

**問題 394. Azure サブスクリプションに複数の仮想マシンが含まれています。ユーザーアカウントがリソースグループ内のすべてのリソースを表示できるようにします。最小特権の原則に従って、このユーザーに割り当てるべきロールを選択してください。（一つ選択）**
*   **Owner**
*   **Reader**
*   **Contributor**
*   **Monitoring Reader**

**解答例**
*   **Reader**

**解説**
**最小特権の原則に基づき、リソースの表示のみを許可する場合は Reader ロールを割り当てます。** **このロールはリソースの閲覧権限のみを付与し、変更や削除の権限は含まれません。**

**Owner ロールはリソースへのフルアクセス権限を持ち、他のユーザーへのロール割り当ても可能です。** **Contributor ロールはリソースの作成、変更、削除が可能ですが、ロールの割り当ては実行できません。** **Monitoring Reader ロールは監視データの読み取りに特化しており、リソース全体の表示には適していません。**

**Azure RBAC では、必要最小限の権限のみを付与することでセキュリティリスクを低減します。** **表示のみが要件の場合、Reader ロールが最適な選択となります。**

| **ロール** | **表示** | **作成・変更** | **削除** | **ロール割り当て** |
| :--- | :--- | :--- | :--- | :--- |
| **Owner** | **〇** | **〇** | **〇** | **〇** |
| **Contributor** | **〇** | **〇** | **〇** | **×** |
| **Reader** | **〇** | **×** | **×** | **×** |

**リファレンス**
*   **Azure RBAC (Role-Based Access Control)**
*   **Principle of Least Privilege**
*   **組み込みロール**

**問題 395. あなたの組織では、Template-A という名前のデプロイテンプレートを使用して、負荷分散のために 8 個の Azure Web Apps をデプロイします。このテンプレートをデプロイする際に使用するサービスを特定する必要があります。ソリューションでは Azure のコストを最小限に抑える必要があります。何を使用しますか。（一つ選択）**
*   **1 つの App Service Plan**
*   **8 つの App Service Plan**
*   **1 つの Azure Application Gateway**
*   **1 つの Azure Front Door**
*   **1 つの Azure Traffic Manager**

**解答例**
*   **1 つの App Service Plan**

**解説**
**この問題の最重要ポイントは、複数の Web Apps を効率的にホストしながらコストを最小化する方法を理解することです。** **App Service Plan は、Web Apps が実行される仮想マシンリソースのセットを定義するもので、複数の Web Apps を単一の App Service Plan 上で実行できます。**

**1 つの App Service Plan で 8 つの Web Apps をホストすることで、コンピューティングリソースを共有し、コストを大幅に削減できます。** **各 Web App に個別の App Service Plan を割り当てる必要はなく、同一の Plan 内で複数のアプリケーションを実行することが可能です。** **これにより、8 つの個別の Plan を作成する場合と比較して、約 87.5% のコスト削減が実現できます。**

**Azure Application Gateway や Azure Traffic Manager は負荷分散サービスですが、Web Apps のホスティング基盤そのものではありません。** **これらは追加のネットワーク層サービスであり、Web Apps を実行するためには別途 App Service Plan が必要です。** **Azure Front Door も同様にグローバル負荷分散サービスであり、ホスティング基盤ではありません。**

**以下の比較表で各サービスの役割を整理します。**

| **サービス** | **役割** | **コスト効率** |
| :--- | :--- | :--- |
| **App Service Plan** | **Web Apps のホスティング基盤** | **1 つの Plan で複数アプリ実行可能** |
| **Application Gateway** | **レイヤー 7 負荷分散** | **追加コスト発生** |
| **Traffic Manager** | **DNS ベース負荷分散** | **追加コスト発生** |

**App Service Plan の価格レベル（Free, Shared, Basic, Standard, Premium, Isolated）によって、ホスト可能なアプリ数やリソース量が異なりますが、Standard 以上のレベルでは十分に 8 つの Web Apps をホストできます。**

**リファレンス**
*   **App Service Plan**
*   **Azure Web Apps**
*   **Azure Application Gateway**

**問題 396. Azure サブスクリプションには、オンプレミスのデータセンターから移行された数百台の仮想マシンが含まれています。使用率が低い仮想マシンを特定します。どの Azure Advisor の推奨事項カテゴリを使用しますか。（一つ選択）**
*   **パフォーマンス**
*   **信頼性**
*   **コスト**
*   **セキュリティ**

**解答例**
*   **コスト**

**解説**
**Azure Advisor は、Azure リソースの構成と使用状況テレメトリを分析し、コスト削減、パフォーマンス向上、信頼性向上、セキュリティ強化に関する推奨事項を提供するサービスです。**

**使用率が低い仮想マシンを特定する場合、Azure Advisor の「コスト」カテゴリの推奨事項を確認します。** **このカテゴリでは、CPU 使用率が低い仮想マシンや、停止しているが課金されているリソースなど、コスト最適化の機会を特定できます。** **具体的には、過去 7 日間または 14 日間の CPU 使用率が平均 5% 以下、ネットワーク使用率が 7MB 以下の仮想マシンが低使用率として検出されます。**

**「パフォーマンス」カテゴリは、リソースの速度と応答性を向上させる推奨事項を提供しますが、使用率が低いリソースの特定には適していません。** **「信頼性」カテゴリは可用性とビジネス継続性に関する推奨事項、「セキュリティ」カテゴリはセキュリティ態勢の改善に関する推奨事項を提供します。**

| **カテゴリ** | **主な用途** | **低使用率 VM 検出** |
| :--- | :--- | :--- |
| **コスト** | **コスト最適化、未使用リソース特定** | **可能** |
| **パフォーマンス** | **速度と応答性の向上** | **不可** |
| **信頼性** | **可用性とビジネス継続性** | **不可** |

**Azure Advisor のコスト推奨事項を定期的に確認することで、使用率の低い仮想マシンを適切なサイズに変更したり、不要なリソースを削除したりして、Azure 環境のコスト効率を改善できます。**






ご提示いただいた「**AZ-104試験問題500_part2_part1.pdf**」のソース（から）に基づき、記載されている文章を省略することなく、全文を出力します。

---

### **リファレンス**
*   **Azure Advisor**
*   **仮想マシンのサイズ変更**
*   **Azure コスト管理**

---

### **問題 397.**
**国際的な組織が所有する Azure サブスクリプション「Subscription-A」には、以下の表に示す仮想ネットワーク、サブネット、ストレージアカウントが含まれています。** **米国中南部の Azure リージョンにサービスエンドポイントポリシー「Policy-A」を作成し、サブスクリプション内のすべてのストレージアカウントへの接続を許可しています。** **次の記述について、正しい場合は「はい」を選択し、正しくない場合は「いいえ」を選択してください。（一つ選択）**

**仮想ネットワーク**
| 名前 | リージョン |
| :--- | :--- |
| VNet-A | 西ヨーロッパ |
| VNet-B | 東南アジア |
| VNet-C | 米国中南部 |

**サブネット**
| 名前 | 仮想ネットワーク | サービスエンドポイント |
| :--- | :--- | :--- |
| Subnet-A | VNet-A | なし |
| Subnet-B | VNet-B | Microsoft.Storage |
| Subnet-C | VNet-C | Microsoft.Storage |

**ストレージアカウント**
| 名前 | リージョン | 種類 |
| :--- | :--- | :--- |
| storage-A | 西ヨーロッパ | StorageV2 |
| storage-B | 米国中南部 | BlobStorage |
| storage-C | 東南アジア | StorageV2 |

**記述：Policy-A は Subnet-C に適用できる。**
*   **いいえ**
*   **はい**

#### **解答例**
*   **はい**

#### **解説**
**サービスエンドポイントポリシーを適用するための条件を確認します。** **サービスエンドポイントポリシーは、サービスエンドポイントが有効化されているサブネットに対してのみ適用可能です。** **また、ポリシーとサブネットは同一リージョンに存在する必要があります。**

**Subnet-C は米国中南部リージョンの VNet-C に属し、Microsoft.Storage のサービスエンドポイントが有効化されています。** **Policy-A も米国中南部リージョンで作成されているため、リージョンの要件を満たしています。** **したがって、Policy-A は Subnet-C に適用できます。**

**サービスエンドポイントポリシーは、特定の Azure サービスリソースへのアクセスを制御するセキュリティ機能です。** **仮想ネットワークから Azure サービスへのトラフィックをフィルタリングし、許可されたリソースのみへのアクセスを可能にします。**

**サービスエンドポイントポリシー適用条件**
| 条件 | 要件 |
| :--- | :--- |
| サービスエンドポイント | サブネットで有効化されている必要がある |
| リージョン | ポリシーとサブネットが同一リージョンに存在 |
| 対応サービス | Azure Storage、Azure SQL Database など |

**各サブネットの適用可否**
| サブネット | リージョン | エンドポイント | 適用可否 |
| :--- | :--- | :--- | :--- |
| Subnet-A | 西ヨーロッパ | なし | 不可 |
| Subnet-B | 東南アジア | 有効 | 不可 |
| Subnet-C | 米国中南部 | 有効 | 可能 |

**リファレンス**
*   **Azure Virtual Network**

---

### **問題 398.**
**あなたは、adatum.com という名前の Azure Active Directory（Azure AD）テナントを含む Azure サブスクリプションを管理しています。** **このテナントには 500 個のユーザーアカウントが存在します。** **Microsoft 365 を展開し、adatum.com のユーザーアカウントを使用するように構成しました。** **60 人のユーザーが Microsoft Exchange Online のメールボックスに接続するように構成されています。** **この 60 人のユーザーが Exchange Online メールボックスへの接続時に Azure Multi-Factor Authentication（MFA）を使用するようにします。** **ただし、この要件は Exchange Online メールボックスへの接続にのみ影響する必要があります。** **どのような操作を実行しますか。（一つ選択）**

*   **Azure Active Directory 管理センターから条件付きアクセスポリシーを作成する**
*   **Azure Active Directory 管理センターから認証方法を構成する**
*   **多要素認証ページから各ユーザーの多要素認証状態を構成する**
*   **多要素認証ページからサービス設定を変更し信頼できる IP を追加する**

#### **解答例**
*   **Azure Active Directory 管理センターから条件付きアクセスポリシーを作成する**

#### **解説**
**この問題の最重要ポイントは、特定のクラウドアプリケーション（Exchange Online）へのアクセスに対してのみ MFA を適用する要件を満たす方法を選択することです。** **条件付きアクセスポリシーを使用することで、特定のアプリケーション、特定のユーザーグループ、特定のネットワーク場所など、きめ細かな条件に基づいてアクセス制御を実装できます。**

**ユーザー単位で MFA 状態を有効化する方法では、そのユーザーがアクセスするすべての Azure AD に統合されたアプリケーションに対して MFA が要求されます。** **これは「Exchange Online メールボックスへの接続にのみ影響する」という要件を満たしません。** **条件付きアクセスポリシーでは、クラウドアプリケーションとして Exchange Online を指定し、対象ユーザーとして 60 人のユーザーグループを割り当て、アクセス制御として多要素認証を要求することで、要件を正確に満たすことができます。**

**認証方法の構成は、組織全体で利用可能な MFA の方法（SMS、音声通話、認証アプリなど）を管理するものであり、特定のアプリケーションへのアクセスに対して MFA を適用する機能ではありません。** **サービス設定の信頼できる IP は、特定の IP アドレス範囲からのアクセスに対して MFA をスキップする設定であり、今回の要件とは逆の目的です。**

| 方法 | 適用範囲 | 要件適合性 |
| :--- | :--- | :--- |
| 条件付きアクセス | 特定アプリ・ユーザー・条件 | 適合 |
| ユーザー単位 MFA | 全アプリケーション | 不適合 |
| 認証方法構成 | 組織全体の方法管理 | 不適合 |

**リファレンス**
*   **Azure AD 条件付きアクセス**
*   **Multi-Factor Authentication (MFA)**

---

### **問題 399.**
**あなたの組織では、Azure Resource Manager（ARM）テンプレートを使用して 50 台の仮想マシンを一斉デプロイする計画を進めています。** **既存の仮想マシンの設定を基に ARM テンプレートを生成しましたが、管理者パスワードの取り扱いについて対応が必要です。** **デプロイ時に仮想マシンの管理者パスワードを ARM テンプレートから安全に参照できるようにし、パスワードが平文で保存されないようにする必要があります。** **この要件を満たすために作成すべき Azure リソースはどれですか。（一つ選択）**

*   **Azure Key Vault とアクセスポリシー**
*   **Azure Storage Account とアクセスポリシー**
*   **Recovery Services コンテナーとバックアップポリシー**
*   **Azure Backup コンテナーと保持ポリシー**

#### **解答例**
*   **Azure Key Vault とアクセスポリシー**

#### **解説**
**ARM テンプレートで仮想マシンをデプロイする際、管理者パスワードなどの機密情報を平文で記述することはセキュリティ上のリスクとなります。** **Azure Key Vault は、暗号化キー、シークレット、証明書を安全に保管するための専用サービスであり、ARM テンプレートから動的に機密情報を参照する仕組みを提供します。**

**ARM テンプレートでは、パラメータファイル内で Key Vault に格納されたシークレットを参照する構文を使用できます。** **具体的には、Key Vault のリソース ID とシークレット名を指定することで、デプロイ時に自動的にパスワードが取得されます。** **この方法により、テンプレートやパラメータファイルに平文のパスワードを記述する必要がなくなります。**

**アクセスポリシーは、Key Vault に対するアクセス権限を制御する仕組みです。** **ARM テンプレートのデプロイを実行するユーザーやサービスプリンシパルに対して、シークレットの取得権限を付与する必要があります。** **また、テンプレートデプロイ時に Key Vault へのアクセスを有効化するプロパティ設定も必要です。**

**他の選択肢について、Recovery Services コンテナーと Azure Backup コンテナーはバックアップとディザスタリカバリのためのサービスであり、機密情報の保管には使用しません。** **Azure Storage Account は汎用的なストレージサービスですが、シークレット管理の専用機能は提供していません。**

| サービス | 用途 | ARM テンプレート連携 |
| :--- | :--- | :--- |
| Azure Key Vault | シークレット・キー・証明書の管理 | 可能 |
| Storage Account | ファイル・BLOB・キューの保存 | 不可 |
| Recovery Services | バックアップ・リカバリ | 不可 |

**リファレンス**
*   **Azure Key Vault**
*   **ARM Template**
*   **アクセスポリシー**

---

### **問題 400.**
**10 個の Azure サブスクリプションにリンクされた Microsoft Entra ID テナントを管理しています。** **すべてのサブスクリプションにわたるユーザーアクティビティを一元的に監視する必要があります。** **どのサービスを使用しますか。（一つ選択）**

*   **Azure Monitor のアクティビティログフィルター**
*   **Log Analytics ワークスペース**
*   **Microsoft Entra ID のアクセスレビュー**
*   **Azure Monitor Application Insights**

#### **解答例**
*   **Log Analytics ワークスペース**

#### **解説**
**複数の Azure サブスクリプションにまたがるユーザーアクティビティを一元的に監視するには、Log Analytics ワークスペースを使用します。** **Log Analytics ワークスペースは、複数のサブスクリプションやリソースからログデータを収集し、一元管理できる中央リポジトリとして機能します。**

**各サブスクリプションのアクティビティログやリソースログを Log Analytics ワークスペースに送信するよう診断設定を構成することで、Kusto Query Language（KQL）を使用した高度なクエリ実行、ログの長期保存、カスタムアラートの設定が可能になります。** **これにより、組織全体のユーザーアクティビティを統合的に分析できます。**

**Azure Monitor のアクティビティログフィルターは個別サブスクリプション単位での絞り込み機能であり、複数サブスクリプションの一元監視には適していません。** **Microsoft Entra ID のアクセスレビューはアクセス権限の定期的な見直し機能であり、アクティビティ監視とは目的が異なります。** **Azure Monitor Application Insights はアプリケーションパフォーマンス監視（APM）に特化したサービスで、ユーザーアクティビティの一元監視には適していません。**

| サービス | 用途 | 複数サブスクリプション対応 |
| :--- | :--- | :--- |
| Log Analytics ワークスペース | ログの一元管理と分析 | 対応 |
| アクティビティログフィルター | 単一サブスクリプション内の絞り込み | 非対応 |
| アクセスレビュー | アクセス権限の定期見直し | 対象外 |

**リファレンス**
*   **Log Analytics Workspace**
*   **Kusto Query Language**

---

### **問題 401.**
**Azure サブスクリプションに以下のリソースを作成しました。** **Registry1 という名前の Azure Container Registry インスタンスと、Cluster1 という名前の Azure Kubernetes Service（AKS）クラスターです。** **管理用ワークステーション上で App1 という名前のコンテナイメージを作成しました。** **App1 を Cluster1 にデプロイします。** **最初に実行すべき操作はどれですか。（一つ選択）**

*   **az acr build コマンドを実行する**
*   **docker push コマンドを実行する**
*   **Cluster1 上でノードプールを作成する**
*   **kubectl apply コマンドを実行する**

#### **解答例**
*   **docker push コマンドを実行する**

#### **解説**
**ローカルワークステーションで既に作成済みのコンテナイメージを AKS クラスターにデプロイする場合、最初にコンテナイメージを Azure Container Registry にアップロードする必要があります。** **この操作には docker push コマンドを使用します。**

**ローカル環境で作成したコンテナイメージは、まずコンテナレジストリに格納してから、AKS クラスターがそのレジストリからイメージをプルしてデプロイする流れになります。** **docker push コマンドは、ローカルの Docker イメージをリモートのコンテナレジストリに送信するために使用します。**

**az acr build コマンドは、Azure Container Registry 上で直接コンテナイメージをビルドする際に使用するコマンドです。** **今回のシナリオでは既にローカル環境でイメージが作成済みであるため、このコマンドは不要です。**

**ノードプールの作成は、AKS クラスターのコンピューティングリソースを管理するための操作であり、コンテナイメージのデプロイとは直接関係ありません。** **kubectl apply コマンドは、Kubernetes リソースの定義をクラスターに適用する際に使用しますが、イメージがレジストリに存在していることが前提となります。**

| 操作 | 目的 | タイミング |
| :--- | :--- | :--- |
| docker push | ローカルイメージを ACR にアップロード | 最初に実行 |
| kubectl apply | Kubernetes マニフェストを適用 | イメージアップロード後 |
| az acr build | ACR 上で直接イメージをビルド | ローカルイメージがない場合 |

**リファレンス**
*   **Azure Container Registry**
*   **Azure Kubernetes Service (AKS)**

---

### **問題 402.**
**あなたの会社では、Azure Resource Manager（ARM）テンプレートを使用して、Azure サブスクリプション内のリソースグループ「app-grp1」にリソースをデプロイしています。** **app-grp1 内のリソースが作成された日時を確認します。** **Azure portal で app-grp1 のどのブレードを確認しますか。（一つ選択）**

*   **Policies**
*   **Deployments**
*   **Activity log**
*   **Diagnostics settings**

#### **解答例**
*   **Deployments**

#### **解説**
**リソースグループ内のリソースが ARM テンプレートによってデプロイされた日時を確認するには、Deployments ブレードを使用します。** **このブレードには、リソースグループに対して実行されたすべてのデプロイメント操作の履歴が記録されており、各デプロイメントの開始時刻、完了時刻、状態、使用されたテンプレートなどの詳細情報を確認できます。**

**Deployments ブレードでは、デプロイメント名をクリックすることで、デプロイされた個々のリソースの詳細、使用されたパラメータ、テンプレートの内容、デプロイメントの出力値なども確認できます。** **これにより、いつ、どのようなリソースが作成されたかを正確に追跡できます。**

**他の選択肢について、Activity log はリソースグループやサブスクリプションレベルでの操作ログを記録しますが、デプロイメント履歴の確認には Deployments ブレードがより適しています。** **Policies はガバナンスルールの管理、Diagnostics settings は診断ログの構成に使用されます。**

| ブレード | 用途 |
| :--- | :--- |
| Deployments | ARM テンプレートによるデプロイ履歴と詳細の確認 |
| Activity log | リソースに対する操作ログの記録と監視 |
| Policies | Azure Policy によるガバナンスルールの適用 |

**リファレンス**
*   **Azure Resource Manager**
*   **ARM Template**
*   **Resource group**

---

### **問題 403.**
**オンプレミスの Active Directory ドメイン（hogehoge.local）があり、OU1 という組織単位（OU）が含まれています。** **OU1 には、ユーザーアカウント（User1）、セキュリティグループ（Group1）、配布グループ（Group2）、コンピューターアカウント（Computer1）が含まれています。** **Azure AD Connect を使用して OU1 を Microsoft Entra ID に同期します。** **Microsoft Entra ID に同期されるオブジェクトを特定します。（一つ選択）**

*   **User1 と Group1 のみ**
*   **User1、Group1、Computer1 のみ**
*   **User1、Group1、Group2 のみ**
*   **すべてのオブジェクトが同期される**

#### **解答例**
*   **User1、Group1、Group2 のみ**

#### **解説**
**Azure AD Connect（現在は Microsoft Entra Connect と呼ばれる）は、オンプレミスの Active Directory オブジェクトを Microsoft Entra ID（旧 Azure AD）に同期するツールです。** **同期されるオブジェクトの種類には制限があります。**

**ユーザーアカウント（User1）は同期対象です。** **セキュリティグループ（Group1）と配布グループ（Group2）も同期されます。** **ただし、コンピューターアカウント（Computer1）は同期対象外です。** **Microsoft Entra ID はクラウドベースの ID サービスであり、オンプレミスのコンピューターアカウントを管理する必要がないためです。**

**デバイス管理が必要な場合は、Microsoft Entra Join やハイブリッド参加などの別の機能を使用します。** **これらは Azure AD Connect のデバイス同期機能とは異なる仕組みです。**

| オブジェクト種類 | 同期可否 | 備考 |
| :--- | :--- | :--- |
| ユーザーアカウント | 可 | 標準の同期対象 |
| セキュリティグループ | 可 | メンバーシップも同期 |
| 配布グループ | 可 | Exchange 関連で利用 |
| コンピューターアカウント | 不可 | デバイス管理は別機能 |

**したがって、User1、Group1、Group2 の 3 つのオブジェクトが Microsoft Entra ID に同期されます。**

**リファレンス**
*   **Microsoft Entra Connect**
*   **Microsoft Entra ID**
*   **Hybrid Identity**

---

### **問題 404.**
**あなたが管理する Azure サブスクリプションには、以下の表に示す仮想ネットワークが含まれています。** **東日本リージョンに contapp-A という名前のコンテナアプリを作成します。** **このコンテナアプリ用に con-env-A という名前の Container Apps 環境を作成する必要があります。** **Container Apps 環境は、独自の仮想ネットワークとサブネットを使用し、可能な限り最小のサブネットに接続する必要があります。** **con-env-A はどの仮想ネットワークに接続できますか。（一つ選択）**

| 名前 | リージョン | IP アドレス空間 | サブネット |
| :--- | :--- | :--- | :--- |
| VNet-A | 東日本 | 10.1.128.0/23 | Subnet-A (10.1.128.0/24) |
| VNet-B | 東日本 | 192.168.0.0/16 | SubnetB-A (192.168.0.0/17), SubnetB-B (192.168.128.0/17) |
| VNet-C | 東日本 | 172.16.0.0/16 | SubnetC (172.16.1.0/24) |

*   **VNet-B または VNet-C**
*   **VNet-A または VNet-C**
*   **VNet-C**
*   **VNet-B**
*   **VNet-A または VNet-B**

#### **解答例**
*   **VNet-B または VNet-C**

#### **解説**
**Azure Container Apps の環境を独自の仮想ネットワークに統合する場合、サブネットには最小で /23（512 個の IP アドレス）のアドレス空間が必要です。** **この要件を満たすサブネットを持つ仮想ネットワークを選択する必要があります。**

**各仮想ネットワークのサブネットを確認すると、Subnet-A は /24（256 個の IP アドレス）であり、Container Apps 環境の最小要件である /23 を満たしていません。** **SubnetB-A と SubnetB-B はそれぞれ /17（32,768 個の IP アドレス）、SubnetC は /24 ですが、VNet-C 全体のアドレス空間は 172.16.0.0/16 であり、/23 のサブネットを新規作成する余地があります。**

**Container Apps 環境では、専用のサブネットが必要であり、他のリソースと共有できません。** **VNet-B には /17 の大きなサブネットが 2 つあり、これらから /23 のサブネットを分割して使用できます。** **VNet-C も /16 の広いアドレス空間を持ち、/23 のサブネットを作成可能です。** **したがって、VNet-B または VNet-C が要件を満たします。**

| 仮想ネットワーク | 利用可能性 | 理由 |
| :--- | :--- | :--- |
| VNet-A | 不可 | Subnet-A が /24 で最小要件の /23 未満 |
| VNet-B | 可能 | /17 サブネットから /23 を分割可能 |
| VNet-C | 可能 | /16 アドレス空間に /23 サブネットを作成可能 |

**リファレンス**
*   **Azure Container Apps**
*   **Virtual Network Integration**

---

### **問題 405.**
**Azure Storage アカウントを作成しました。** **30 日間アクセスされていない Blob を Cool ストレージ層に移動するライフサイクル管理ルールを作成します。** **最初に実行すべき操作はどれですか。（一つ選択）**

*   **Blob のバージョン管理を有効化する**
*   **アクセス追跡を有効化する**
*   **Blob インベントリを更新する**
*   **ストレージアカウントキーをローテーションする**

#### **解答例**
*   **アクセス追跡を有効化する**

#### **解説**
**Blob の最終アクセス時刻に基づいてライフサイクル管理ルールを適用するには、事前にアクセス追跡機能を有効化する必要があります。** **アクセス追跡を有効にすると、各 Blob の最終アクセス時刻が記録され、ライフサイクル管理ポリシーでこの情報を条件として利用できるようになります。**

**Azure Blob Storage のライフサイクル管理では、作成日や変更日を基準とした自動階層化は標準で利用できますが、最終アクセス時刻を条件とする場合は明示的にアクセス追跡を有効化する必要があります。** **この機能を有効にすることで、実際の使用パターンに基づいた効率的なコスト最適化が可能になります。**

**Blob バージョン管理は削除や上書きからデータを保護する機能であり、ライフサイクル管理の前提条件ではありません。** **Blob インベントリはストレージアカウント内の Blob メタデータを定期的にレポートする機能ですが、アクセス時刻の追跡とは別の機能です。** **ストレージアカウントキーのローテーションはセキュリティ管理の操作であり、ライフサイクル管理とは無関係です。**

| 操作 | 目的 | ライフサイクル管理との関連 |
| :--- | :--- | :--- |
| アクセス追跡の有効化 | 最終アクセス時刻の記録 | 必須（アクセス時刻ベースのルール作成に必要） |
| バージョン管理 | データ保護と復元 | 任意（ライフサイクル管理の前提条件ではない） |
| Blob インベントリ | メタデータレポート作成 | 無関係（アクセス追跡とは別機能） |

**リファレンス**
*   **最終アクセス時刻の追跡**

---

### **問題 406.**
**Azure サブスクリプションに、cont1 という名前の Azure Container App が含まれています。** **cont1 にスケーリングルールを追加する予定です。** **Azure Service Bus で受信したメッセージに基づいて cont1 のレプリカを作成します。** **どのスケールトリガーを使用しますか。（一つ選択）**

*   **Azure Event Grid**
*   **HTTP traffic**
*   **KEDA scaler**
*   **Memory usage**

#### **解答例**
*   **KEDA scaler**

#### **解説**
**Azure Container Apps では、Azure Service Bus のメッセージキューに基づいてスケーリングを行う場合、KEDA ベースのスケーラーを使用します。** **KEDA は Kubernetes Event-driven Autoscaling の略で、イベント駆動型のスケーリングを実現する仕組みです。**

**Azure Container Apps は内部的に KEDA を統合しており、Azure Service Bus、Azure Storage Queue、Kafka など様々な外部イベントソースに基づいてコンテナのレプリカ数を自動調整できます。** **Service Bus のキューやトピックに蓄積されたメッセージ数をトリガーとして、処理負荷に応じた動的なスケールアウト・スケールインが可能になります。**

**HTTP traffic は HTTP リクエスト数に基づくスケーリング、Memory usage はメモリ使用率に基づくスケーリング、Azure Event Grid はイベント配信サービスですが Container Apps の直接的なスケールトリガーとしては使用しません。** **Service Bus メッセージベースのスケーリングには、KEDA スケーラーの構成が必要です。**

| スケールトリガー | 用途 |
| :--- | :--- |
| KEDA scaler | 外部イベントソース（Service Bus 等）に基づくスケーリング |
| HTTP traffic | HTTP リクエスト数に基づくスケーリング |
| CPU/Memory usage | リソース使用率に基づくスケーリング |

**リファレンス**
*   **Azure Container Apps**
*   **Azure Service Bus**
*   **KEDA (Kubernetes Event-driven Autoscaler)**

---

### **問題 407.**
**Azure サブスクリプションに既存のストレージアカウントがあります。** **Docker イメージ Image1 を使用する Azure Container Instances のコンテナ container1 をデプロイします。** **Image1 には永続的なストレージを必要とする Microsoft SQL Server インスタンスが含まれています。** **container1 に適切なストレージサービスを構成します。** **どのサービスを使用しますか。（一つ選択）**

*   **Azure Blob Storage**
*   **Azure Files**
*   **Azure Disk Storage**
*   **Azure Queue Storage**

#### **解答例**
*   **Azure Files**

#### **解説**
**Azure Container Instances で永続的なストレージが必要な場合、Azure Files を使用してボリュームマウントを構成します。** **Azure Files は SMB プロトコルをサポートし、コンテナ内のアプリケーションから標準的なファイルシステムとしてアクセスできるため、SQL Server のようなデータベースエンジンのデータファイル保存に適しています。**

**Azure Container Instances では、コンテナの再起動や削除時にもデータを保持する必要がある場合、外部ストレージのマウントが必須です。** **Azure Files をボリュームとしてマウントすることで、コンテナのライフサイクルとは独立してデータを永続化できます。** **マウント時には、ストレージアカウント名、ファイル共有名、アクセスキーを指定します。**

**他の選択肢が不適切な理由を整理します。** **Azure Blob Storage はオブジェクトストレージであり、ファイルシステムとして直接マウントできません。** **Azure Disk Storage は Azure Virtual Machines 向けのブロックストレージで、Container Instances では使用できません。** **Azure Queue Storage はメッセージキューサービスであり、ファイルストレージの用途には適していません。**

| サービス | 用途 | Container Instances 対応 |
| :--- | :--- | :--- |
| Azure Files | ファイル共有（SMB/NFS） | 対応（ボリュームマウント可） |
| Azure Blob Storage | オブジェクトストレージ | 非対応（直接マウント不可） |
| Azure Disk Storage | VM 向けブロックストレージ | 非対応 |

**リファレンス**
*   **Azure Container Instances**
*   **Azure Files**

---

### **問題 408.**
**Subscription1 という名前の Azure サブスクリプションがあり、以下の表に示すストレージアカウントが含まれています。** **Azure Import/Export サービスを使用して Subscription1 からデータをエクスポートします。** **エクスポート先として使用できるストレージアカウントはどれですか。（一つ選択）**

| ストレージアカウント名 | 種類 | レプリケーション |
| :--- | :--- | :--- |
| storage1 | 汎用 v2 | ローカル冗長ストレージ (LRS) |
| storage2 | BLOB | geo 冗長ストレージ (GRS) |
| storage3 | 汎用 v1 | 読み取りアクセス geo 冗長ストレージ (RA-GRS) |
| storage4 | FileStorage | ゾーン冗長ストレージ (ZRS) |

*   **storage4**
*   **storage2**
*   **storage3**
*   **storage1**

#### **解答例**
*   **storage1**

#### **解説**
**Azure Import/Export サービスは、大量のデータを物理ディスクドライブを使用して Azure データセンターとの間で転送するサービスです。** **このサービスを使用する際には、ストレージアカウントの種類とレプリケーション設定に制約があります。**

**Azure Import/Export サービスがサポートするストレージアカウントは、汎用 v1 および汎用 v2 のストレージアカウントです。** **BLOB ストレージアカウントと FileStorage アカウントは、このサービスではサポートされていません。** **また、レプリケーション設定については、LRS、GRS、RA-GRS がサポートされており、ZRS はサポート対象外です。**

**各ストレージアカウントの評価は以下の通りです。**
| ストレージアカウント | 種類の適合性 | レプリケーションの適合性 | 使用可否 |
| :--- | :--- | :--- | :--- |
| storage1 | 汎用 v2 (対応) | LRS (対応) | 使用可能 |
| storage2 | BLOB (非対応) | GRS (対応) | 使用不可 |
| storage3 | 汎用 v1 (対応) | RA-GRS (対応) | 使用可能 |
| storage4 | FileStorage (非対応) | ZRS (非対応) | 使用不可 |

**storage1 は汎用 v2 で LRS レプリケーションを使用しており、Azure Import/Export サービスの要件を完全に満たしています。** **storage3 も技術的には使用可能ですが、設問では単一選択のため、より標準的な構成である storage1 が最適な解答となります。**

**リファレンス**
*   **Azure Import/Export サービス**
*   **Azure ストレージレプリケーション**

---

### **問題 409.**
**Azure サブスクリプションに複数の仮想ネットワークが含まれています。** **VNet1（アドレス空間：10.1.0.0/16、リージョン：East US）、VNet2（アドレス空間：10.2.0.0/16、リージョン：East US）、VNet3（アドレス空間：10.3.0.0/16、リージョン：West US）が存在します。** **サブスクリプションには仮想マシン VM1（VNet1 に接続）、VM2（VNet2 に接続）、VM3（VNet3 に接続）が含まれており、すべてプライベート IP アドレスのみを持ちます。** **VNet1 に Azure Bastion（Bastion1）をデプロイしました。** **Bastion1 を通じて接続できる仮想マシンはどれですか。（一つ選択）**

*   **VM1、VM2、VM3 のすべて**
*   **VM1 のみ**
*   **VM1 と VM3 のみ**
*   **VM1 と VM2 のみ**

#### **解答例**
*   **VM1 のみ**

#### **解説**
**Azure Bastion は、デプロイされた仮想ネットワーク内の仮想マシンに対してのみ、直接的な RDP および SSH 接続を提供します。** **Bastion1 は VNet1 にデプロイされているため、同じ VNet1 内に存在する VM1 にのみ接続可能です。**

**VNet2 や VNet3 内の仮想マシンに接続するには、仮想ネットワークピアリングを構成する必要があります。** **ピアリングを設定することで、異なる仮想ネットワーク間でのプライベート接続が確立され、Bastion からピアリングされたネットワーク内の仮想マシンへのアクセスが可能になります。** **ただし、本問題ではピアリング構成に関する記述がないため、Bastion1 が接続できるのは VM1 のみとなります。**

**リージョンの違い（East US と West US）も考慮すべき要素ですが、ピアリングはリージョン間でも構成可能です。** **重要なのは、Azure Bastion がデプロイされた仮想ネットワークと、接続先の仮想マシンが存在する仮想ネットワークとの間に適切なネットワーク接続が確立されているかという点です。**

| 項目 | 説明 |
| :--- | :--- |
| Azure Bastion | 仮想ネットワーク内の VM への安全な RDP/SSH 接続を提供 |
| 接続範囲 | デプロイされた VNet およびピアリングされた VNet 内の VM |
| ピアリング要件 | 異なる VNet 内の VM への接続には仮想ネットワークピアリングが必要 |

**リファレンス**
*   **Azure Bastion**
*   **Virtual Network Peering**

---

### **問題 410.**
**Azure サブスクリプションに、App1 という名前の Web アプリがあります。** **App1 にはカスタムドメイン名として webapp1.hogehoge.com を設定しています。** **App1 用の DNS レコードを作成します。** **IP アドレスが変更された場合でも App1 にアクセスできるようにする必要があります。** **どのタイプの DNS レコードを作成しますか。（一つ選択）**

*   **TXT**
*   **CNAME**
*   **A**
*   **MX**

#### **解答例**
*   **CNAME**

#### **解説**
**この問題の最重要ポイントは、Azure App Service の IP アドレスが変更される可能性がある環境で、カスタムドメインを安定的に運用するための DNS レコードタイプの選択です。**

**Azure App Service でカスタムドメインを設定する場合、CNAME レコードを使用することで、IP アドレスの変更に対応できます。** **CNAME レコードは別名（Canonical Name）を定義するレコードで、ドメイン名を別のドメイン名にマッピングします。** **App Service の場合、カスタムドメインを App Service のデフォルトドメイン（appname.azurewebsites.net）にマッピングすることで、Azure 側で IP アドレスが変更されても、CNAME レコードの参照先は変わらないため、継続的なアクセスが保証されます。**

**A レコードは、ドメイン名を直接 IP アドレスにマッピングするため、IP アドレスが変更された場合は手動でレコードを更新する必要があります。** **TXT レコードは、ドメインの所有権確認や SPF レコードなどのテキスト情報を格納するために使用され、名前解決には使用しません。** **MX レコードは、メール配信先を指定するためのレコードで、Web アプリのアクセスには関係ありません。**

| レコードタイプ | 用途 | IP アドレス変更への対応 |
| :--- | :--- | :--- |
| CNAME | ドメイン名の別名定義 | 自動対応（推奨） |
| A | IP アドレスへの直接マッピング | 手動更新が必要 |
| TXT | テキスト情報の格納 | 名前解決に不使用 |

**リファレンス**
*   **Azure App Service**
*   **Custom Domain**

---

### **問題 411.**
**Azure サブスクリプションに、RG1 という名前のリソースグループがあります。** **RG1 には、VM1 と VM2 という名前の 2 つの仮想マシンが含まれています。** **VM1 から VM2 へのすべてのネットワークトラフィックを検査します。** **ソリューションは Azure Monitor メトリックを使用する必要があります。** **実行する必要があるアクションはどれですか。（二つ選択）**

*   **Connection Monitor を構成する**
*   **Network Watcher のパケットキャプチャを使用する**
*   **VM1 と VM2 に Network Watcher Agent 拡張機能をインストールする**
*   **診断設定で Network In と Network Out メトリックを有効化する**

#### **解答例**
*   **Connection Monitor を構成する**
*   **VM1 と VM2 に Network Watcher Agent 拡張機能をインストールする**

#### **解説**
**この問題の最重要ポイントは、Azure Monitor メトリックを使用して VM 間のネットワークトラフィックを検査する要件を満たす構成を理解することです。**

**Azure Monitor メトリックで VM 間のネットワークトラフィックを継続的に監視するには、Connection Monitor を使用します。** **Connection Monitor は、Azure 仮想マシン間の接続性、レイテンシ、ネットワークトポロジの変更を監視する機能で、Azure Monitor と統合されています。**

**Connection Monitor を動作させるには、監視対象の VM（この場合は VM1 と VM2 の両方）に Network Watcher Agent 拡張機能（旧称 AzureNetworkWatcherExtension）をインストールする必要があります。** **この拡張機能により、VM からネットワークメトリックデータを収集し、Azure Monitor に送信できます。**

**パケットキャプチャは一時的なトラフィック分析には有効ですが、継続的な監視や Azure Monitor メトリックとの統合には適していません。** **Network In と Network Out メトリックは個別 VM のネットワーク使用量を測定しますが、VM 間の特定のトラフィックフローを検査する機能はありません。**

| 機能 | 用途 | Azure Monitor メトリック統合 |
| :--- | :--- | :--- |
| Connection Monitor | VM 間接続の継続監視 | あり |
| パケットキャプチャ | 一時的なトラフィック分析 | なし |
| Network In/Out | VM 単位の通信量測定 | あり（VM 間フロー不可） |

**リファレンス**
*   **Connection Monitor**
*   **Azure Monitor**

---

### **問題 412.**
**Azure サブスクリプションに複数のパブリック IP アドレスがあります。** **Azure Bastion Basic SKU ホストを展開する予定です。** **この Bastion 展開に使用できるパブリック IP アドレスの要件として正しいものはどれですか。（一つ選択）**

| 名前 | SKU | 割り当て | 可用性ゾーン |
| :--- | :--- | :--- | :--- |
| IP1 | Standard | Static | なし |
| IP2 | Standard | Dynamic | なし |
| IP3 | Basic | Static | 該当なし |
| IP4 | Standard | Static | ゾーン 1 |
| IP5 | Basic | Dynamic | 該当なし |

*   **IP1 のみ使用可能**
*   **IP1、IP2、IP4 のみ使用可能**
*   **IP3、IP4、IP5 のみ使用可能**
*   **IP1、IP2、IP3、IP4、IP5 すべて使用可能**

#### **解答例**
*   **IP1 のみ使用可能**

#### **解説**
**Azure Bastion Basic SKU の展開には、特定の要件を満たすパブリック IP アドレスが必要です。**

**Azure Bastion Basic SKU で使用できるパブリック IP アドレスは、Standard SKU、Static 割り当て、可用性ゾーン設定なしの 3 つの条件をすべて満たす必要があります。** **各 IP アドレスを検証すると、IP1 のみがこれらすべての条件を満たしています。** **IP2 は Dynamic 割り当てのため不適合、IP3 と IP5 は Basic SKU のため要件を満たしません。** **IP4 はゾーン 1 が設定されているため使用できません。** **Azure Bastion は専用のサブネット（AzureBastionSubnet）に展開され、このサブネットには最小で /26 のアドレス空間が必要です。**

**パブリック IP アドレス要件の比較表：**
| 項目 | Basic SKU 要件 | IP1 | IP2 | IP3 | IP4 | IP5 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| SKU | Standard | ○ | ○ | × | ○ | × |
| 割り当て | Static | ○ | × | ○ | ○ | × |
| ゾーン | なし | ○ | ○ | - | × | - |

**Azure Bastion Standard SKU を使用する場合は、ゾーン冗長構成やスケーリング機能が利用可能になりますが、Basic SKU ではこれらの機能は提供されません。** **Basic SKU は最大 25 の同時 RDP/SSH 接続をサポートし、Standard SKU では最大 100 の同時接続が可能です。**

**リファレンス**
*   **Azure Bastion**
*   **Public IP Address**
*   **Availability Zone**

---

### **問題 413.**
**Azure で稼働する Web アプリケーション webapp1 があります。** **ユーザーから接続時に HTTP 500 エラーが頻繁に発生するという報告を受けています。** **開発者に対して接続エラーの詳細情報をリアルタイムで提供する必要があります。** **このソリューションでは、すべての接続エラーの詳細を提供する必要があります。** **最初に実行すべき操作はどれですか。（一つ選択）**

*   **webapp1 で Application Logging を有効にする**
*   **Azure Monitor で Service Health alert を作成する**
*   **webapp1 で Web server logging を有効にする**
*   **Azure Monitor で Log Analytics workspace を構成する**

#### **解答例**
*   **webapp1 で Web server logging を有効にする**

#### **解説**
**HTTP 500 エラーはサーバー側の内部エラーを示すステータスコードであり、接続エラーの詳細を取得するには Web server logging の有効化が最適です。**

**Web server logging は IIS のログ機能を利用して HTTP リクエストとレスポンスの詳細情報を記録します。** **これにはステータスコード、リクエスト URL、クライアント IP アドレス、処理時間などの接続レベルの情報が含まれます。** **ログはリアルタイムで生成され、Azure Storage Account または File System に保存されます。** **開発者はこれらのログを直接参照することで、HTTP 500 エラーの発生パターンや原因を特定できます。**

**Application Logging はアプリケーションコード内で生成されるログメッセージを記録する機能であり、接続エラーの詳細な情報収集には適していません。** **Service Health alert は Azure プラットフォーム側のサービス正常性を監視する機能であり、個別のアプリケーションエラーの詳細は提供しません。** **Log Analytics workspace の構成は診断データの分析基盤として有用ですが、まずログデータの収集を有効にする必要があります。**

| ログ種別 | 用途 | 取得できる情報 |
| :--- | :--- | :--- |
| Web server logging | HTTP 接続の詳細記録 | ステータスコード、URL、IP アドレス、処理時間 |
| Application Logging | アプリケーション内部のログ | カスタムログメッセージ、例外情報 |
| Diagnostic logs | 詳細な診断情報 | リクエスト追跡、失敗した要求のトレース |

**リファレンス**
*   **Azure Monitor**

---

### **問題 414.**
**Azure サブスクリプションに、User1 という名前のユーザーが含まれています。** **User1 が仮想マシンのデプロイと仮想ネットワークの管理を実行できるようにします。** **このソリューションでは、最小特権の原則を使用する必要があります。** **User1 に割り当てるべきロールベースのアクセス制御（RBAC）ロールはどれですか。（一つ選択）**

*   **Virtual Machine Contributor**
*   **Contributor**
*   **Network Contributor**
*   **Owner**

#### **解答例**
*   **Contributor**

#### **解説**
**この問題は、最小特権の原則に基づいて適切な RBAC ロールを選択する能力を問うものです。** **User1 には仮想マシンのデプロイと仮想ネットワークの管理という 2 つの要件があります。**

**最小特権の原則とは、ユーザーに必要最小限の権限のみを付与するセキュリティのベストプラクティスです。** **仮想マシンのデプロイには、コンピューティングリソースの作成権限が必要です。** **また、仮想ネットワークの管理には、ネットワークリソースの作成・変更権限が必要です。**

**Contributor ロールは、サブスクリプション内のすべてのリソースを作成および管理できますが、他のユーザーへのアクセス権の割り当てはできません。** **このロールは、仮想マシンと仮想ネットワークの両方を管理するために必要な権限を提供します。**

**Virtual Machine Contributor は仮想マシンの管理のみが可能で、仮想ネットワークの管理権限は含まれません。** **Network Contributor は仮想ネットワークの管理のみが可能で、仮想マシンのデプロイ権限は含まれません。** **Owner ロールは、アクセス権の割り当てを含むすべての権限を持つため、最小特権の原則に反します。**

**複数のリソースタイプにまたがる管理権限が必要な場合、個別の専門ロールではなく、Contributor ロールが適切な選択となります。**

| ロール | 仮想マシン管理 | 仮想ネットワーク管理 | アクセス権割り当て |
| :--- | :--- | :--- | :--- |
| Contributor | 可能 | 可能 | 不可 |
| Virtual Machine Contributor | 可能 | 不可 | 不可 |
| Network Contributor | 不可 | 可能 | 不可 |
| Owner | 可能 | 可能 | 可能 |

**リファレンス**
*   **Azure RBAC (Role-Based Access Control)**
*   **Principle of Least Privilege**
*   **Azure 組み込みロール**

---

### **問題 415.**
**ある Azure Storage account を作成します。** **このストレージアカウントは、複数の Azure リージョンにデータを保存し、プライマリリージョンとセカンダリリージョンの両方からデータの読み取りアクセスが可能である必要があります。** **どのストレージ冗長性オプションを使用しますか。（一つ選択）**

*   **Zone-Redundant Storage (ZRS)**
*   **Read-Access Geo-Redundant Storage (RA-GRS)**
*   **Locally-Redundant Storage (LRS)**
*   **Geo-Zone-Redundant Storage (GZRS)**

#### **解答例**
*   **Read-Access Geo-Redundant Storage (RA-GRS)**

#### **解説**
**この設問では、複数リージョンへのデータレプリケーションと、セカンダリリージョンからの読み取りアクセスの両方が要件となっています。** **Azure Storage の冗長性オプションを正しく理解することが解法の鍵です。**

**Read-Access Geo-Redundant Storage (RA-GRS) は、プライマリリージョンとセカンダリリージョン（地理的に離れた場所）の両方にデータを非同期でレプリケートします。** **さらに、セカンダリリージョンのデータに対して読み取り専用アクセスを提供するため、要件を完全に満たします。** **通常の Geo-Redundant Storage (GRS) も複数リージョンにレプリケートしますが、セカンダリリージョンからの読み取りアクセスは提供されません。**

**Zone-Redundant Storage (ZRS) は単一リージョン内の複数の可用性ゾーンにデータを同期レプリケートしますが、複数リージョンへのレプリケーションは行いません。** **Locally-Redundant Storage (LRS) は単一データセンター内でのみデータを複製するため、リージョン障害に対する保護がありません。** **Geo-Zone-Redundant Storage (GZRS) は複数リージョンへのレプリケーションを提供しますが、セカンダリリージョンからの読み取りアクセスには RA-GZRS (Read-Access GZRS) が必要です。**

| 冗長性オプション | レプリケーション範囲 | セカンダリ読み取り |
| :--- | :--- | :--- |
| LRS | 単一データセンター | 不可 |
| ZRS | 単一リージョン内の複数ゾーン | 不可 |
| GRS | 複数リージョン | 不可 |
| RA-GRS | 複数リージョン | 可能 |
| GZRS | 複数リージョン ＋ ゾーン | 不可 |
| RA-GZRS | 複数リージョン ＋ ゾーン | 可能 |

**リファレンス**
*   **Azure Storage の冗長性オプション**
*   **Geo-Redundant Storage (GRS)**

---

### **問題 416.**
**あなたの組織が所有する Azure サブスクリプション「Sub-A」には、次の表に示すリソースがデプロイされています。** **Sub-A には、VNet-B という名前の仮想ネットワークも含まれています。** **VM-A は、NIC-A という名前のネットワークインターフェイスを使用して、VNet-B に接続しています。** **VM-A に追加のネットワークインターフェイス NIC-B を作成して接続する必要があります。** **解決策として、RG-A と米国西部に NIC-B を作成します。** **この解決策は目標を達成していますか。（一つ選択）**

| 名前 | タイプ | ロケーション | リソースグループ |
| :--- | :--- | :--- | :--- |
| RG-A | リソースグループ | 米国東部 | 該当なし |
| RG-B | リソースグループ | 西ヨーロッパ | 該当なし |
| RG-C | リソースグループ | 北ヨーロッパ | 該当なし |
| VNet-A | 仮想ネットワーク | 米国中部 | RG-A |
| VNet-B | 仮想ネットワーク | 米国西部 | RG-B |
| VM-A | 仮想マシン | 米国西部 | RG-B |

*   **いいえ**
*   **はい**

#### **解答例**
*   **いいえ**

#### **解説**
**この解決策は目標を達成していません。** **ネットワークインターフェイスを仮想マシンに追加する際には、複数の制約条件を満たす必要があります。**

**VM-A は米国西部の RG-B に存在し、VNet-B に接続しています。** **新しいネットワークインターフェイス NIC-B を作成する場合、VM-A と同じロケーション（米国西部）に作成する必要があります。** **これは正しい条件です。** **しかし、ネットワークインターフェイスは接続先の仮想ネットワークと同じロケーションに存在する必要があります。** **VNet-B は米国西部の RG-B に存在するため、NIC-B も VNet-B と同じロケーションである米国西部に作成する必要があります。**

**リソースグループについては、ネットワークインターフェイスは任意のリソースグループに配置できますが、接続先の仮想ネットワークと同じロケーションである必要があります。** **提案された RG-A は米国東部に存在するため、米国西部のリソースを含むことができます。** **ただし、ネットワークインターフェイスは仮想マシンと同じロケーションに存在する必要があるという制約が最も重要です。**

**正しい解決策は、VM-A と同じロケーション（米国西部）に NIC-B を作成し、VNet-B に接続することです。** **リソースグループは RG-B または RG-A のいずれでも構いませんが、ロケーションは必ず米国西部である必要があります。**

| 要件 | 条件 | 提案された解決策 |
| :--- | :--- | :--- |
| ロケーション | VM-A と同じ (米国西部) | 米国西部 (正しい) |
| 仮想ネットワーク | VNet-B と同じロケーション | 条件を満たす |
| リソースグループ | 任意だが運用上は VM-A と同じ RG-B が推奨 | RG-A (可能だが非推奨) |

**リファレンス**
*   **Network Interface**
*   **Azure Virtual Network**
*   **Resource group**

---

### **問題 417.**
**組織の Azure Storage アカウントには 5,000 個の BLOB が格納されており、複数のユーザーがアクセスします。** **BLOB インデックスタグに基づいて、各ユーザーが特定の BLOB のみを表示できるようにアクセス制御を実装します。** **この要件を満たすソリューションを選択してください。（一つ選択）**

*   **ロールの割り当て条件**
*   **保存されたアクセスポリシー**
*   **Azure AD 条件付きアクセスポリシー**
*   **共有アクセス署名 (SAS)**

#### **解答例**
*   **ロールの割り当て条件**

#### **解説**
**BLOB インデックスタグに基づいた細かいアクセス制御を実現するには、Azure RBAC のロールの割り当て条件 (Role Assignment Conditions) を使用します。** **この機能により、BLOB インデックスタグの値を条件として、特定の BLOB へのアクセス権限を動的に制御できます。**

**ロールの割り当て条件は、Azure RBAC (Role-Based Access Control) の拡張機能で、属性ベースのアクセス制御 (ABAC) を実現します。** **BLOB インデックスタグは、各 BLOB に付与できるキーと値のペアで、メタデータとして機能します。** **ロールの割り当て条件では、これらのタグ値を評価条件として使用し、「特定のタグを持つ BLOB のみ読み取り可能」といった制御が可能になります。**

**保存されたアクセスポリシーは、共有アクセス署名 (SAS) の有効期限やアクセス許可を一元管理する機能ですが、BLOB インデックスタグに基づく条件付きアクセスには対応していません。** **共有アクセス署名自体も、特定のソースへの時間制限付きアクセスを提供しますが、タグベースの動的な制御はサポートしていません。** **Azure AD 条件付きアクセスポリシーは、ユーザー認証時の条件（場所、デバイスなど）を評価する機能で、ストレージリソースレベルの制御には適用されません。**

| 機能 | BLOB タグベース制御 | 用途 |
| :--- | :--- | :--- |
| ロールの割り当て条件 | 対応 | タグに基づく細かいアクセス制御 |
| 保存されたアクセスポリシー | 非対応 | SAS の一元管理 |
| 共有アクセス署名 | 非対応 | 時間制限付きアクセス委任 |

**リファレンス**
*   **Azure RBAC (Role-Based Access Control)**

---

### **問題 418.**
**Azure サブスクリプションに hogehoge-corp.com という名前の Microsoft Entra テナントがあります。** **このテナントはオンプレミスの Active Directory ドメインと同期されています。** **ドメインには以下の表に示すユーザーが含まれています。** **すべてのユーザーに対してセルフサービスパスワードリセット（SSPR）を有効にし、以下の認証方法で SSPR を構成します。** **また、セキュリティの質問として「好きな食べ物は何ですか」「最初に勤務した都市はどこですか」「初めて飼ったペットの名前は何ですか」の 3 つを設定します。** **この構成において、BillAdmin-A はセルフサービスパスワードリセット中にセキュリティの質問に答える必要がありますか。（一つ選択）**

| 名前 | ロール |
| :--- | :--- |
| SecAdmin-A | セキュリティ管理者 |
| BillAdmin-A | 課金管理者 |
| User-A | レポート閲覧者 |
| BillAdmin-B | 課金管理者 |

**SSPR 構成：**
*   **リセットに必要な認証方法の数：2**
*   **ユーザーが利用できる方法：携帯電話、セキュリティの質問**
*   **登録に必要な質問数：5**
*   **リセットに必要な質問数：3**

*   **いいえ。BillAdmin-A は課金管理者であり、管理者ロールには SSPR のセキュリティの質問が適用されないため**
*   **はい。すべてのユーザーに SSPR が有効化されており、BillAdmin-A も 3 つのセキュリティの質問に答える必要がある**
*   **いいえ。リセットに必要な認証方法が 2 つであり、携帯電話のみで認証が完了するため**
*   **はい。ただし登録時のみ 3 つの質問に答える必要があり、リセット時は携帯電話認証のみで完了する**

#### **解答例**
*   **いいえ。BillAdmin-A は課金管理者であり、管理者ロールには SSPR のセキュリティの質問が適用されないため**

#### **解説**
**Microsoft Entra ID（旧 Azure AD）のセルフサービスパスワードリセット（SSPR）では、管理者ロールを持つユーザーに対して特別なポリシーが適用されます。** **管理者は常に SSPR が有効化されており、パスワードリセットには必ず 2 つの認証方法が必要です。** **ただし、管理者に対してはセキュリティの質問を認証方法として使用することができません。**

**BillAdmin-A は課金管理者 (Billing Administrator) という管理者ロールを持っているため、SSPR の認証方法としてセキュリティの質問は利用できません。** **管理者が利用できる認証方法は、携帯電話 (SMS または音声通話)、メールアドレス、Microsoft Authenticator アプリなどに限定されます。**

**この問題の構成では、リセットに必要な認証方法の数が 2 つと設定されていますが、管理者ロールを持つユーザーの場合、セキュリティの質問は認証方法として選択できないため、BillAdmin-A は携帯電話と他の利用可能な認証方法（例：メールアドレスや認証アプリ）を使用する必要があります。**

**一方、User-A のような管理者ロールを持たない一般ユーザーは、構成された認証方法（携帯電話とセキュリティの質問）を使用でき、3 つのセキュリティの質問に答えることが可能です。**

| ユーザータイプ | セキュリティの質問の利用 | 必要な認証方法数 |
| :--- | :--- | :--- |
| 管理者ロール | 利用不可 | 常に 2 つ |
| 一般ユーザー | 利用可能 | 構成による (この場合 2 つ) |

**したがって、BillAdmin-A はセルフサービスパスワードリセット中にセキュリティの質問に答える必要はありません。**

**リファレンス**
*   **セルフサービスパスワードリセット (SSPR)**
*   **多要素認証 (MFA)**

---

### **問題 419.**
**組織の Azure Web App に対してエンドユーザーから HTTP 500 エラーが頻繁に発生するという報告がありました。** **アプリケーション開発者に対して、接続エラーの詳細情報をリアルタイムで提供する必要があります。** **最初に実施すべき対応を選択してください。（一つ選択）**

*   **Web App の診断設定で Web サーバーログを有効化する**
*   **Azure Monitor で Log Analytics ワークスペースを構成する**
*   **Web App の診断設定でアプリケーションログを有効化する**
*   **Azure Monitor で Application Insights を有効化する**

#### **解答例**
*   **Web App の診断設定でアプリケーションログを有効化する**

#### **解説**
**HTTP 500 エラーはサーバー側の内部エラーを示すステータスコードであり、アプリケーションコードの実行時エラーやハンドルされない例外が原因で発生します。** **開発者がエラーの詳細情報をリアルタイムで確認するには、まずアプリケーションログを有効化する必要があります。**

**アプリケーションログは、アプリケーションコード内で発生した例外、エラーメッセージ、スタックトレースなどの詳細情報を記録します。** **Azure Web App では、診断設定からアプリケーションログを有効化することで、File System または Blob Storage にログを出力できます。** **File System への出力は即座に開始され、リアルタイムでのログストリーミングも可能です。**

**一方、Web サーバーログは、HTTP リクエストとレスポンスのメタデータ（ステータスコード、URL、IP アドレスなど）を記録しますが、アプリケーション内部のエラー詳細は含まれません。** **Application Insights は高度な監視ソリューションですが、初期設定として即座にエラー詳細を確認するにはアプリケーションログの有効化が最も直接的な対応です。**

| 項目 | 記録内容 | 用途 |
| :--- | :--- | :--- |
| アプリケーションログ | 例外、エラー詳細、スタックトレース | アプリケーションエラーの診断 |
| Web サーバーログ | HTTP リクエスト/レスポンスのメタデータ | アクセスパターンの分析 |
| Application Insights | パフォーマンス、依存関係、カスタムイベント | 包括的な APM 監視 |

**リファレンス**
*   **Application Insights**
*   **Azure Monitor**

---

### **問題 420.**
**Azure 仮想マシン VM1 を運用しています。** **VM1 のネットワークインターフェイスには、受信セキュリティ規則として Rule1 から Rule6 が設定されています。** **Rule1 は優先度 300 で HTTPS ポート 443 を拒否し、Rule4 は優先度 400 で UDP プロトコルを許可し、Rule5 は優先度 500 で HTTPS ポート 443 を拒否し、Rule6 は優先度 65000ですべての受信トラフィックを拒否しています。** **VM1 に Web サーバーを展開し、HTTPS プロトコルでアクセス可能なセキュアな Web サイトを構成しました。** **インターネットから VM1 の Web サイトに接続できるようにする必要があります。** **どの操作を実行しますか。（一つ選択）**

*   **Rule1 のアクションを許可に変更する**
*   **Rule5 のアクションを許可に変更し、優先度を 401 に変更する**
*   **Rule4 のプロトコルを UDP から Any に変更する**
*   **Rule1 の優先度を 65001 に変更する**

#### **解答例**
*   **Rule5 のアクションを許可に変更し、優先度を 401 に変更する**

#### **解説**
**Network Security Group (NSG) の受信セキュリティ規則は、優先度の数値が小さいほど先に評価されます。** **この問題では、HTTPS トラフィック (ポート 443) を許可する必要がありますが、現在の構成では複数の規則が HTTPS を拒否しています。**

**現在の規則構成を確認すると、Rule1 (優先度 300) と Rule5 (優先度 500) の両方が HTTPS ポート 443 を拒否しています。** **NSG の規則評価は優先順に行われ、最初に一致した規則が適用されます。** **そのため、Rule1 が先に評価されて HTTPS トラフィックが拒否されます。**

**Rule5 のアクションを許可に変更し、優先度を 401 に変更することで、Rule1 (優先度 300) の次に評価される規則として HTTPS トラフィックを許可できます。** **ただし、この解決策では Rule1 が依然として優先度 300 で存在するため、実際には Rule1 も変更する必要があります。** **最も効果的な解決策は、Rule5 を優先度 401 で許可に変更し、かつ Rule1 を削除または無効化することです。**

**他の選択肢について、Rule4 は UDP プロトコル用の規則であり、HTTPS には関係しません。** **Rule1 の優先度を 65001 に変更すると、デフォルト拒否規則 (Rule6) よりも後に評価されるため、効果がありません。**

| 項目 | 説明 |
| :--- | :--- |
| NSG 規則の優先度 | 100 ～ 4096 の範囲で設定、数値が小さいほど優先 |
| 規則の評価順序 | 優先度順に評価され、最初に一致した規則を適用 |
| デフォルト規則 | 優先度 65000 で全拒否規則が自動設定される |

**リファレンス**
*   **Network Security Group**
*   **Azure Virtual Machine**

---

### **問題 421.**
**Azure 仮想マシン VM1 を運用しています。** **VM1 のネットワークインターフェイスには、以下のネットワークセキュリティグループ (NSG) 規則が設定されています。** **VM1 に Web サーバーをデプロイし、HTTPS プロトコルでアクセス可能なセキュアな Web サイトを構築しました。** **VM1 は Web サーバー専用として使用します。** **インターネットからこの Web サイトに接続できるようにするには、どの設定を変更する必要がありますか。（一つ選択）**

| 優先度 | 名前 | ポート | プロトコル | ソース | 宛先 | アクション |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 100 | Rule1 | 443 | TCP | Any | Any | Deny |
| 200 | Rule2 | 80 | TCP | Any | Any | Allow |
| 300 | Rule3 | 3389 | TCP | Any | Any | Allow |
| 400 | Rule4 | 443 | UDP | Any | Any | Allow |

*   **Rule1 のアクションを Allow に変更する**
*   **Rule3 の優先度を 450 に変更する**
*   **Rule2 のポート番号を 443 に変更する**
*   **Rule4 のプロトコルを TCP に変更する**

#### **解答例**
*   **Rule1 のアクションを Allow に変更する**

#### **解説**
**HTTPS プロトコルは、TCP/443 ポートを使用してセキュアな通信を行います。** **現在の NSG 設定では、Rule1 が TCP/443 ポートへのすべてのトラフィックを拒否 (Deny) しているため、インターネットから HTTPS でアクセスできません。**

**NSG ルールは優先度の数値が小さいものから順に評価され、最初にマッチしたルールが適用されます。** **Rule1 の優先度は 100 で最も高く、TCP/443 ポートへのトラフィックを担当しています。** **Rule4 は優先度 400 で UDP/443 を許可していますが、HTTPS は TCP プロトコルを使用するため、このルールは適用されません。**

**Rule1 のアクションを Allow に変更することで、TCP/443 ポートへのインバウンドトラフィックが許可され、インターネットから HTTPS で Web サイトにアクセスできるようになります。** **Rule3 の RDP (TCP/3389) は管理用途であり、Web アクセスには無関係です。**

| 項目 | 説明 |
| :--- | :--- |
| 評価順序 | 優先度の数値が小さい順に評価される |
| マッチング | 最初にマッチしたルールが適用され、以降のルールは評価されない |
| デフォルト動作 | すべてのカスタムルールに一致しない場合、デフォルトルールが適用される |

| プロトコル | ポート | 用途 |
| :--- | :--- | :--- |
| HTTPS | TCP/443 | セキュアな Web 通信 |
| HTTP | TCP/80 | 非暗号化 Web 通信 |
| RDP | TCP/3389 | Windows リモートデスクトップ接続 |

**リファレンス**
*   **Network Security Group**
*   **Azure Virtual Machine**

---

### **問題 422.**
**Azure 仮想マシン VM-A に対してキー暗号化キー (KEK) を使用した Azure Disk Encryption を実装します。** **Key Vault である Vault-A で実行する必要がある操作を選択してください。（二つ選択）**

*   **デプロイ用の Azure 仮想マシンを有効化する**
*   **新しいキーを作成する**
*   **ボリューム暗号化用の Azure Disk Encryption を有効化する**
*   **アクセスポリシーでディスク暗号化のアクセス許可を構成する**

---
*(ソース はここで終了しており、問題 422 の解答例および解説は含まれていません。)*





ご指定いただいたソース（PDFの各ページ）に含まれる全文章を、省略することなくそのまま書き出します。

---

**解答例**
・新しいキーを作成する
・ボリューム暗号化用の Azure Disk Encryption を有効化する

**解説**
Azure Disk Encryption で KEK を使用する場合、Key Vault で必要な準備作業は暗号化キーの作成とディスク暗号化機能の有効化です。

KEK（Key Encryption Key）は、BitLocker または dm-crypt によって生成されるボリューム暗号化キー（BEK）を保護するための追加の暗号化レイヤーです。 KEK を使用することで、暗号化キー自体も暗号化され、セキュリティが強化されます。

Key Vault で Azure Disk Encryption を使用するための準備手順として、まず Key Vault 内に暗号化用のキーを作成します。 このキーが KEK として機能し、ディスク暗号化キーを保護します。 次に、Key Vault のアクセスポリシーまたは詳細アクセスポリシーで「ボリューム暗号化用の Azure Disk Encryption を有効化」を設定します。 この設定により、Azure Disk Encryption サービスが Key Vault にアクセスしてキーとシークレットを取得できるようになります。

シークレットの作成は不要です。 Azure Disk Encryption が自動的に BEK をシークレットとして Key Vault に保存します。 また、仮想マシンの選択やキーローテーションポリシーの設定は、この段階では必須ではありません。

| 操作 | 必要性 | 理由 |
| :--- | :--- | :--- |
| キーの作成 | 必須 | KEK として使用 |
| Disk Encryption 有効化 | 必須 | サービスアクセス許可 |
| シークレット作成 | 不要 | 自動生成される |

**リファレンス**
・[Azure Disk Encryption](https://learn.microsoft.com/ja-jp/azure/virtual-machines/windows/disk-encryption-overview)
・[Azure Key Vault](https://learn.microsoft.com/ja-jp/azure/key-vault/general/overview)

---

**問題 423. Azure 仮想マシンを運用しています。物理インフラストラクチャの基盤メンテナンス作業により、仮想マシンが影響を受けるという通知を受け取りました。サービス中断を回避するために、仮想マシンを別のホストに移動します。どの操作を実行しますか。（一つ選択）**

・仮想マシンを再デプロイする
・Azure Resource Manager テンプレートをエクスポートして再作成する
・可用性セットに仮想マシンを追加する
・仮想マシンを別のリソースグループに移動する

**解答例**
・仮想マシンを再デプロイする

**解説**
Azure の物理ホストでメンテナンスが予定されている場合、仮想マシンを別の物理ホストに移動してサービス中断を回避する必要があります。 この要件を満たす最も直接的な方法は、**仮想マシンの再デプロイ機能**を使用することです。

再デプロイ操作を実行すると、Azure は仮想マシンをシャットダウンし、Azure 内の別の物理ホストに移動してから再起動します。 この操作により、仮想マシンの構成、関連付けられたリソース、データディスクはすべて保持されます。 ただし、一時ディスク上のデータは失われ、動的 IP アドレスが割り当てられている場合は変更される可能性があります。

他の選択肢では要件を満たせません。 Azure Resource Manager テンプレートのエクスポートと再作成は手動作業が多く、データ移行の手間が発生します。 可用性セットへの追加は既存の仮想マシンに対して実行できず、事前に構成が必要です。 リソースグループの移動は論理的な管理境界の変更であり、物理ホストの変更には影響しません。

| 操作 | 物理ホスト移動 | データ保持 |
| :--- | :--- | :--- |
| **再デプロイ** | **可能** | **OS・データディスク保持** |
| テンプレート再作成 | 可能 | 手動移行が必要 |
| 可用性セット追加 | 不可 | 既存 VM には適用不可 |

再デプロイは Azure Portal の仮想マシンブレードから「再デプロイ + 再適用」オプションを選択するか、Azure PowerShell や Azure CLI を使用して実行できます。 計画的なメンテナンス通知を受け取った場合、この操作により予定されたダウンタイムを回避できます。

**リファレンス**
・[Azure Virtual Machine](https://learn.microsoft.com/ja-jp/azure/virtual-machines/windows/redeploy-to-new-node)
・[Availability Set](https://learn.microsoft.com/ja-jp/azure/virtual-machines/availability-set-overview)
・[Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)

---

**問題 424. あなたの組織には Azure サブスクリプション「Subscription-A」があり、10 個の仮想ネットワークが異なるリソースグループでホストされています。別の管理者が複数の Network Security Group (NSG) を作成する予定です。すべての NSG で仮想ネットワーク間の TCP ポート 8080 を自動的にブロックする必要があります。解決策：Azure Policy を使用して NSG 作成時に特定のセキュリティ規則を強制する。これは目標を達成していますか。（一つ選択）**

・いいえ
・はい

**解答例**
・はい

**解説**
この問題は、Azure 環境全体で一貫したセキュリティポリシーを適用する方法を問うものです。 **Azure Policy を使用することで、NSG 作成時に特定のセキュリティ規則を自動的に適用できます**。

Azure Policy は、組織の標準とコンプライアンス要件を大規模に適用するためのサービスです。 カスタムポリシー定義を作成することで、NSG が作成される際に特定のポート（この場合は TCP ポート 8080）をブロックする規則を自動的に追加できます。 ポリシーは「Deny」効果で非準拠リソースの作成を防止したり、「DeployIfNotExists」効果で必要な構成を自動的にデプロイしたりできます。

サブスクリプションレベルでポリシーを割り当てることで、すべてのリソースグループとその中の NSG に対して一貫したセキュリティ規則を適用できます。 これにより、管理者が手動で各 NSG に規則を追加する必要がなくなり、設定ミスのリスクも軽減されます。

| 機能 | 説明 | 適用範囲 |
| :--- | :--- | :--- |
| **Azure Policy** | **リソース作成時のルール強制** | **サブスクリプション全体** |
| NSG セキュリティ規則 | トラフィック制御の個別設定 | 各 NSG 単位 |
| ポリシー効果 | Deny, DeployIfNotExists など | 指定リソース種別 |

なお、元の問題で提示されていた「Microsoft.ClassicNetwork プロバイダーの登録解除」は、クラシックデプロイモデルのリソースを無効化するだけで、Resource Manager NSG のポート制御には影響しないため不適切な解決策です。

**リファレンス**
・[Azure Policy](https://learn.microsoft.com/ja-jp/azure/governance/policy/overview)
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)

---

**問題 425. 次の表に示すリソースがあり、すべてのリソースは仮想ネットワーク「VNet-A」に接続しています。Azure Bastion ホスト「Bastion-A」を VNet-A にデプロイします。Bastion-A を使用して安全にリモート接続できるリソースはどれですか。（一つ選択）**

| 名前 | タイプ |
| :--- | :--- |
| VM-A | 仮想マシン |
| App-A | App Service |
| hogehoge.com | Microsoft Entra Domain Services |

・VM-A のみ
・VM-A と App-A
・VM-A と hogehoge.com
・hogehoge.com のみ
・VM-A、App-A、hogehoge.com のすべて

**解答例**
・VM-A のみ

**解説**
Azure Bastion は、仮想ネットワーク内の仮想マシンに対してブラウザ経由で安全な RDP および SSH 接続を提供する PaaS (Platform as a Service) サービスです。 **Azure Bastion が接続対象とできるのは、同一仮想ネットワーク内またはピアリングされた仮想ネットワーク内の仮想マシンのみ**です。

App Service は PaaS サービスであり、仮想ネットワークに統合できますが、Azure Bastion の接続対象ではありません。 App Service へのアクセスは、HTTPS エンドポイント経由で行います。

Microsoft Entra Domain Services は、マネージドドメインサービスを提供する PaaS ですが、Azure Bastion の直接的な接続対象ではありません。 ドメインコントローラーとして機能する基盤インフラへの直接アクセスは提供されていません。

したがって、この設問では **VM-A のみが Azure Bastion を使用した安全なリモート接続の対象**となります。

| リソースタイプ | Azure Bastion 対応 | 接続方法 |
| :--- | :--- | :--- |
| **仮想マシン** | **対応** | **RDP/SSH** |
| App Service | 非対応 | HTTPS |
| Microsoft Entra Domain Services | 非対応 | API/管理ポータル |

**リファレンス**
・[Azure Bastion](https://learn.microsoft.com/ja-jp/azure/bastion/bastion-overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

---

**問題 426. 5 つのインスタンスを含む Azure 仮想マシンスケールセットを可能な限り迅速にデプロイします。どの方法を選択しますか。（一つ選択）**

・仮想マシンスケールセットを 1 つデプロイし、オーケストレーションモードを Uniform (ScaleSetVM) に設定する
・仮想マシンを 5 台デプロイし、各仮想マシンのサイズ設定を変更する
・仮想マシンを 5 台デプロイし、各仮想マシンの可用性ゾーン設定を変更する
・仮想マシンスケールセットを 1 つデプロイし、オーケストレーションモードを Flexible (VM) に設定する

**解答例**
・仮想マシンスケールセットを 1 つデプロイし、オーケストレーションモードを **Uniform (ScaleSetVM)** に設定する

**解説**
仮想マシンスケールセットは、同一構成の仮想マシンを複数台まとめて管理するための Azure サービスです。 個別に仮想マシンを作成するよりも効率的に複数インスタンスをデプロイできます。

仮想マシンスケールセットには 2 つのオーケストレーションモードがあります。 **Uniform モードは同一構成の仮想マシンを大量にデプロイする場合に最適化されており、インスタンス数を指定するだけで迅速にデプロイできます**。 一方、Flexible モードは異なる構成の仮想マシンを混在させることができますが、各インスタンスを個別に構成する必要があるため、デプロイに時間がかかります。

本問では 5 つの同一インスタンスを可能な限り迅速にデプロイすることが要件です。 **Uniform モードのスケールセットを使用すれば、インスタンス数を 5 に設定するだけで、すべてのインスタンスが同時に作成されます**。 個別に仮想マシンを 5 台作成する方法では、各マシンを順次設定する必要があり時間がかかります。

| 比較項目 | **Uniform モード** | Flexible モード |
| :--- | :--- | :--- |
| **デプロイ速度** | **高速（一括作成）** | 低速（個別構成） |
| 構成の統一性 | 全インスタンス同一 | 異なる構成可能 |
| 用途 | 大規模な同一構成 | 柔軟な構成管理 |

| オーケストレーションモード | 表示名 | 特徴 |
| :--- | :--- | :--- |
| **Uniform** | **ScaleSetVM** | **同一構成の大量デプロイに最適** |
| Flexible | VM | 異なる構成の混在が可能 |

**リファレンス**
・[Virtual Machine Scale Set](https://learn.microsoft.com/ja-jp/azure/virtual-machine-scale-sets/overview)
・[Availability Zone](https://learn.microsoft.com/ja-jp/azure/reliability/availability-zones-overview)

---

**問題 427. Azure App Service プラン AdatumASP1 を使用して複数の Web アプリをホストしています。Web アプリの応答が遅いことが判明しました。各 Web アプリのインスタンスに追加のメモリと CPU リソースを提供します。どうすればよいですか。（一つ選択）**

・AdatumASP1 をスケールアップする
・AdatumASP1 をスケールアウトする
・仮想マシンスケールセットを追加する
・App Service Environment に移行する

**解答例**
・AdatumASP1 をスケールアップする

**解説**
この問題の最重要ポイントは、**個々のインスタンスに対するリソース（メモリと CPU）の増強が必要**という点です。 Azure App Service では、スケールアップとスケールアウトという 2 つの異なるスケーリング方法があります。

**スケールアップ**は、App Service プランの価格レベルを上位に変更することで、各インスタンスに割り当てられるメモリ、CPU、ストレージなどのリソースを増やす**垂直スケーリング**です。 問題文では「各インスタンスに追加のメモリと CPU リソースを提供」と明記されているため、スケールアップが正解となります。

一方、スケールアウトはインスタンス数を増やす水平スケーリングであり、個々のインスタンスのリソースは変わりません。 仮想マシンスケールセットは App Service とは別のサービスであり、App Service プランには適用できません。 App Service Environment への移行は、より高度な分離環境を提供しますが、単純なリソース増強には過剰な対応です。

| スケーリング方法 | 効果 | 適用場面 |
| :--- | :--- | :--- |
| **スケールアップ** | **インスタンスあたりのリソース増加** | **CPU・メモリ不足時** |
| スケールアウト | インスタンス数の増加 | 同時接続数増加時 |

**リファレンス**
・[App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
・[Scale Up and Scale Out](https://learn.microsoft.com/ja-jp/azure/app-service/manage-scale-up)

---

**問題 428. あなたは Azure Web Apps の App1 を運用しています。App1 は Plan1 という名前の App Service plan で実行されており、Plan1 は Free 価格レベルに関連付けられています。App1 が 60 分間連続実行された後、毎日停止することが判明しました。App1 を 1 日中継続して実行できるようにします。解決策：App1 に継続的な WebJob を追加しました。この解決策は目標を達成していますか。（一つ選択）**

・いいえ、Free 価格レベルの制限は変更されないため目標を達成していない
・はい、WebJob の追加により連続実行が可能になるため目標を達成している
・いいえ、WebJob ではなく Azure Functions を使用する必要がある
・はい、継続的な WebJob は価格レベルの制限を回避できる

**解答例**
・いいえ、Free 価格レベルの制限は変更されないため目標を達成していない

**解説**
Free 価格レベルの App Service plan には、**1 日あたり 60 分という実行時間の制限**があります。 この制限は App Service plan 自体に適用されるため、WebJob を追加してもこの制限を回避することはできません。 WebJob は Web Apps と同じ App Service plan 上で実行されるため、同じ制限の対象となります。

App1 を 1 日中継続して実行するには、Free 価格レベルから上位の価格レベル（Basic、Standard、Premium など）にスケールアップする必要があります。 **Basic 以上の価格レベルでは、実行時間の制限がなくなり、24 時間 365 日の連続実行が可能になります**。

App Service plan の価格レベルによる主な制限の比較を以下に示します。

| 価格レベル | 実行時間制限 | 常時接続 |
| :--- | :--- | :--- |
| Free | 60 分 / 日 | 非対応 |
| Shared | 240 分 / 日 | 非対応 |
| **Basic 以上** | **制限なし** | **対応** |

WebJob は、バックグラウンドタスクを実行するための機能であり、Web Apps と同じリソース制限を共有します。 したがって、WebJob を追加しても価格レベルの制限を超えることはできません。 連続実行を実現するには、App Service plan を Basic 以上の価格レベルにアップグレードすることが必須です。

**リファレンス**
・[App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
・[WebJobs](https://learn.microsoft.com/ja-jp/azure/app-service/webjobs-create)

---

**問題 429. あなたが管理する Azure サブスクリプション内に、Windows Server を実行する 2 つの仮想マシン VM-A と VM-B があります。両方の仮想マシンは、VNet-A 内の Subnet-A に配置されています。VM-A から VM-B へのポート 3389 (RDP) での通信を遮断します。このとき、最も適切な構成はどれですか。（一つ選択）**

・宛先ポート 3389 を拒否する送信セキュリティルールを持つ Network Security Group (NSG) を作成し、VM-A のネットワークインターフェイスに適用する
・送信元ポート 3389 を拒否する受信セキュリティルールを持つ Network Security Group (NSG) を作成し、Subnet-A に適用する
・VNet-A で Azure Bastion を構成する
・宛先ポート 3389 を拒否する送信セキュリティルールを持つ Network Security Group (NSG) を作成し、Subnet-A に適用する

**解答例**
・宛先ポート 3389 を拒否する送信セキュリティルールを持つ Network Security Group (NSG) を作成し、**VM-A のネットワークインターフェイスに適用する**

**解説**
VM-A から VM-B への特定ポートでの通信を遮断するには、送信元である **VM-A の送信トラフィックを制御する**必要があります。 Network Security Group (NSG) は、Azure の仮想ネットワーク内でトラフィックをフィルタリングするセキュリティ機能です。

NSG のセキュリティルールでは、送信元と宛先の IP アドレス、ポート番号、プロトコルを指定してトラフィックを許可または拒否できます。 今回のシナリオでは、VM-A が送信元となり、VM-B の宛先ポート 3389 への接続を試みるため、**VM-A の送信トラフィックに対して宛先ポート 3389 を拒否するルールが必要**です。

NSG は仮想マシンのネットワークインターフェイスまたはサブネットに適用できます。 VM-A 単体の通信のみを制御する場合は、**VM-A のネットワークインターフェイスに直接 NSG を適用する方**が、他の仮想マシンへの影響を避けられます。 サブネットレベルで NSG を適用すると、同じサブネット内の他の仮想マシンにも影響が及ぶため、今回の要件には適していません。

送信元ポートを制御する選択肢は誤りです。 RDP 接続では、クライアント側 (VM-A) は動的に割り当てられた送信元ポートを使用し、サーバー側 (VM-B) の宛先ポート 3389 に接続します。 したがって、送信元ポートではなく**宛先ポートを制御する**必要があります。

| 項目 | 説明 |
| :--- | :--- |
| **NSG 適用先** | **ネットワークインターフェイスまたはサブネット** |
| **ルール方向** | **送信 (Outbound) ルールで制御** |
| **制御対象** | **宛先ポート 3389 を拒否** |

**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)
・[RDP (Remote Desktop Protocol)](https://learn.microsoft.com/ja-jp/windows-server/remote/remote-desktop-services/welcome-to-rds)

---

**問題 430. Adatum という Microsoft Entra ID（旧 Azure AD）テナントと、Subscription1 という Azure サブスクリプションがあります。Adatum には、Developers というグループが含まれています。Subscription1 には、Dev というリソースグループが含まれています。Developers グループのメンバーが Dev リソースグループ内で Logic Apps を作成できるようにします。解決策として、Dev リソースグループに対して Developers グループに共同作成者ロールを割り当てました。この解決策は要件を満たしていますか。（一つ選択）**

・要件を満たしている
・要件を満たしていない
・所有者ロールの割り当てが必要である
・Logic App 共同作成者ロールの割り当てが必要である

**解答例**
・要件を満たしている

**解説**
共同作成者ロールを Dev リソースグループに割り当てることで、Developers グループはそのリソースグループスコープで Logic Apps を含むすべてのリソースの作成と管理が可能になります。

Azure RBAC では、**共同作成者ロールはリソースの作成、更新、削除を含むほぼすべての操作を実行できる組み込みロール**です。 このロールは、アクセス権の管理を除くすべてのリソース管理操作を許可します。 Logic Apps の作成は標準的なリソース作成操作であり、共同作成者ロールで十分に対応できます。

リソースグループレベルでロールを割り当てることで、そのリソースグループ内のすべてのリソースに対して権限が適用されます。 この場合、Dev リソースグループに共同作成者ロールを割り当てることで、Developers グループのメンバーは同リソースグループ内で Logic Apps を作成できるようになります。

より細かい権限制御が必要な場合は、Logic App 共同作成者などの専用ロールを使用することもできますが、本シナリオでは共同作成者ロールで要件を満たしています。

| ロール | Logic Apps 作成 | その他リソース管理 |
| :--- | :--- | :--- |
| **共同作成者** | **可能** | **可能** |
| Logic App 共同作成者 | 可能 | Logic Apps のみ |
| 閲覧者 | 不可 | 閲覧のみ |

**リファレンス**
・[Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/overview)
・[共同作成者ロール](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/built-in-roles#contributor)
・[Logic Apps](https://learn.microsoft.com/ja-jp/azure/logic-apps/logic-apps-overview)

---

**問題 431. Azure サブスクリプションに以下のリソースが存在します。新しくネットワークインターフェイス (NIC-A) を作成します。NIC-A を作成可能なリージョンを選択してください。（一つ選択）**

| 名前 | タイプ | リージョン |
| :--- | :--- | :--- |
| VNet-A | 仮想ネットワーク | 米国東部 |
| IP-A | パブリック IP アドレス | 西ヨーロッパ |
| RT-A | ルートテーブル | 北ヨーロッパ |

・米国東部のみ
・米国東部、西ヨーロッパ、北ヨーロッパ
・米国東部、北ヨーロッパ
・すべての Azure リージョン

**解答例**
・米国東部のみ

**解説**
ネットワークインターフェイス (NIC) は、仮想ネットワーク (VNet) のサブネットに接続する必要があります。 **NIC は必ず仮想ネットワークと同じリージョンに作成しなければなりません**。 この制約により、NIC の作成可能なリージョンは仮想ネットワークが存在するリージョンに限定されます。

本問では、VNet-A が米国東部リージョンに存在するため、NIC-A も**米国東部リージョンにのみ作成できます**。 パブリック IP アドレス (IP-A) やルートテーブル (RT-A) が他のリージョンに存在していても、これらは NIC の作成リージョンには影響しません。

パブリック IP アドレスは、NIC にアタッチする際にリージョンが一致している必要がありますが、NIC の作成リージョンを決定する要因ではありません。 ルートテーブルはサブネットに関連付けられるリソースであり、NIC の作成リージョンとは独立しています。

以下の表で各リソースと NIC の関係を整理します。

| リソース | リージョン制約 | NIC 作成への影響 |
| :--- | :--- | :--- |
| **仮想ネットワーク** | **同一リージョン必須** | **作成リージョンを決定** |
| パブリック IP アドレス | アタッチ時に同一リージョン | 作成リージョンは非決定 |
| ルートテーブル | リージョン制約なし | 作成リージョンは非決定 |

したがって、NIC-A は米国東部リージョンにのみ作成可能です。

**リファレンス**
・[Network Interface](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-network-interface)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)
・[Azure Region](https://learn.microsoft.com/ja-jp/azure/reliability/availability-zones-service-support)

---

**問題 432. オンプレミスネットワークに Host1 という Hyper-V ホストがあります。Host1 は Windows Server 2016 を実行しており、Windows Server 2016 を実行する 10 台の仮想マシンをホストしています。Azure Site Recovery を使用してこれらの仮想マシンを Azure にレプリケートする計画です。ASR1 という Recovery Services コンテナーと、Site1 という Hyper-V サイトを作成しました。Host1 を ASR1 に追加する必要があります。どの手順を実行しますか。（一つ選択）**

・Azure Site Recovery Provider のインストールファイルをダウンロードし、コンテナー登録キーをダウンロードします。Host1 に Azure Site Recovery Provider をインストールしてサーバーを登録します。
・Azure Site Recovery Provider のインストールファイルをダウンロードし、ストレージアカウントキーをダウンロードします。各仮想マシンに Azure Site Recovery Provider をインストールして仮想マシンを登録します。
・Azure Backup Agent のインストールファイルをダウンロードし、コンテナー登録キーをダウンロードします。Host1 に Azure Backup Agent をインストールしてサーバーを登録します。
・Azure Site Recovery Provider のインストールファイルをダウンロードし、ストレージアカウントキーをダウンロードします。Host1 に Azure Site Recovery Provider をインストールしてサーバーを登録します。

**解答例**
・**Azure Site Recovery Provider のインストールファイルをダウンロードし、コンテナー登録キーをダウンロードします。Host1 に Azure Site Recovery Provider をインストールしてサーバーを登録します。**

**解説**
Hyper-V 仮想マシンを Azure Site Recovery で保護する場合、**Hyper-V ホストに Azure Site Recovery Provider をインストールし、Recovery Services コンテナーに登録する**必要があります。 この構成により、ホスト上のすべての仮想マシンがレプリケーション対象として管理できるようになります。

Azure Site Recovery Provider は、オンプレミスの Hyper-V ホストと Azure 間の通信を確立し、レプリケーションの調整を行うコンポーネントです。 インストール時には、Recovery Services コンテナーから取得した**コンテナー登録キー**を使用してホストを登録します。 このキーにより、特定のコンテナーとホストが関連付けられ、セキュアな通信チャネルが確立されます。

ストレージアカウントキーは、この登録プロセスでは使用されません。 また、各仮想マシンに個別に Provider をインストールする必要はなく、Hyper-V ホストレベルでの構成で十分です。 Azure Backup Agent は、ファイルやフォルダーのバックアップに使用されるコンポーネントであり、Site Recovery のレプリケーションには使用されません。

| 項目 | 説明 |
| :--- | :--- |
| **Azure Site Recovery Provider** | **Hyper-V ホストにインストールして Azure との通信を確立** |
| **コンテナー登録キー** | **Recovery Services コンテナーとホストを関連付けるための認証情報** |
| **インストール対象** | **Hyper-V ホスト（各仮想マシンではない）** |

**リファレンス**
・[Azure Site Recovery](https://learn.microsoft.com/ja-jp/azure/site-recovery/site-recovery-overview)
・[Recovery Services Vault](https://learn.microsoft.com/ja-jp/azure/recovery-services/recovery-services-vault-overview)
・[Hyper-V](https://learn.microsoft.com/ja-jp/azure/site-recovery/hyper-v-azure-tutorial)

---

**問題 433. Azure サブスクリプション内にリソースグループ RG1 があります。Azure 仮想マシン用の ARM テンプレートを保有しています。PowerShell を使用してこのテンプレートから RG1 内に仮想マシンをプロビジョニングします。実行すべき PowerShell コマンドレットはどれですか。（一つ選択）**

・New-AzVM
・New-AzResourceGroupDeployment
・New-AzDeployment
・New-AzSubscriptionDeployment

**解答例**
・**New-AzResourceGroupDeployment**

**解説**
ARM テンプレートを使用してリソースグループにリソースをデプロイする場合、デプロイのスコープに応じた適切なコマンドレットを選択する必要があります。 本問では **RG1 というリソースグループに対して**仮想マシンをデプロイするため、リソースグループスコープのデプロイコマンドレットである **New-AzResourceGroupDeployment** が正解となります。

New-AzResourceGroupDeployment は、指定したリソースグループに対して ARM テンプレートをデプロイする際に使用します。 テンプレートファイルのパス、パラメータファイル、リソースグループ名などを指定することで、テンプレートに定義されたリソースを一括してプロビジョニングできます。

New-AzVM は ARM テンプレートを使用せず、PowerShell のパラメータを直接指定して仮想マシンを作成するコマンドレットです。 テンプレートベースのデプロイには使用しません。

New-AzDeployment は、テナントスコープでのデプロイに使用するコマンドレットであり、リソースグループレベルのデプロイには適していません。

New-AzSubscriptionDeployment は、サブスクリプションスコープでリソースをデプロイする際に使用します。 リソースグループ自体の作成やサブスクリプションレベルのポリシー適用などに利用されますが、既存のリソースグループ内へのデプロイには使用しません。

| デプロイスコープ | コマンドレット | 用途 |
| :--- | :--- | :--- |
| **リソースグループ** | **New-AzResourceGroupDeployment** | **RG 内のリソース作成** |
| サブスクリプション | New-AzSubscriptionDeployment | RG 作成やポリシー設定 |
| テナント | New-AzDeployment | テナントレベルの設定 |

**リファレンス**
・[ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)
・[Azure PowerShell](https://learn.microsoft.com/ja-jp/powershell/azure/overview)
・[Resource group](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/manage-resource-groups-powershell)

---

**問題 434. Azure サブスクリプション内のリソースからリソースロックが削除された際に、管理者へ電子メール通知を送信するアクティビティログアラートを構成します。Azure Monitor でアクティビティログアラートを作成する際に必要な構成要素の組み合わせはどれですか。（一つ選択）**

・データ収集エンドポイント、アプリケーションセキュリティグループ、およびリソースグループ
・リソース、条件、およびアクショングループ
・Log Analytics ワークスペース、リソース、およびアクショングループ
・リソース、条件、および Management Group

**解答例**
・**リソース、条件、およびアクショングループ**

**解説**
アクティビティログアラートは、Azure リソースに対する管理操作を監視し、特定の条件に一致した場合に通知を送信する機能です。 リソースロックの削除などの重要な操作を検知するために使用されます。

アクティビティログアラートの作成には 3 つの必須要素があります。 まず「**リソース**」でアラートの監視対象となるスコープ（サブスクリプション、リソースグループ、特定のリソース）を指定します。 次に「**条件**」でアラートをトリガーする具体的なイベント（この場合はリソースロックの削除操作）を定義します。 最後に「**アクショングループ**」で通知先や実行するアクション（電子メール送信、SMS、Webhook 呼び出しなど）を設定します。

Log Analytics ワークスペースはメトリックアラートやログクエリアラートで利用されますが、アクティビティログアラートでは不要です。 アクティビティログは自動的に Azure プラットフォームレベルで記録されるため、別途ワークスペースを構成する必要はありません。

| 構成要素 | 役割 | 設定内容 |
| :--- | :--- | :--- |
| **リソース** | 監視対象の定義 | サブスクリプションやリソースグループを指定 |
| **条件** | トリガーイベント | リソースロック削除操作を指定 |
| **アクショングループ** | 通知方法 | 電子メールアドレスや通知先を設定 |

**リファレンス**
・[Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)
・[Action Group](https://learn.microsoft.com/ja-jp/azure/azure-monitor/alerts/action-groups)

---

**問題 435. Azure Active Directory 認証を使用するストレージアカウント storage1 があります。Group1 のメンバーが Azure portal を使用してファイルをアップロードできるようにします。最小特権の原則に従って構成する必要があります。storage1 に割り当てるべきロールはどれですか。（二つ選択）**

・Storage Blob Data Contributor
・Storage Account Contributor
・Reader
・Contributor
・Storage Blob Data Owner

**解答例**
・**Reader**
・**Storage Blob Data Contributor**

**解説**
Azure portal を使用して BLOB データをアップロードするには、**データプレーンとコントロールプレーンの両方に対する適切なアクセス許可**が必要です。

Azure portal でストレージアカウントにアクセスして BLOB コンテナーに移動するには、**Reader ロール**が必要です。 Reader ロールはコントロールプレーンの読み取りアクセスを提供し、ストレージアカウントのリソース構造を表示できます。

BLOB データの書き込み操作を実行するには、**Storage Blob Data Contributor ロール**が必要です。 このロールはデータプレーンのアクセス許可を提供し、BLOB の読み取り、書き込み、削除が可能になります。

Storage Account Contributor と Contributor は管理プレーンの権限が強すぎるため、最小特権の原則に反します。 Storage Blob Data Owner はアクセス制御の管理権限も含むため、ファイルアップロードのみの要件には過剰です。

| ロール | 用途 | 権限範囲 |
| :--- | :--- | :--- |
| **Reader** | ポータルナビゲーション | コントロールプレーン読み取り |
| **Storage Blob Data Contributor** | BLOB データ操作 | データプレーン読み書き削除 |
| Storage Account Contributor | ストレージ管理 | 管理プレーン全般 |

**リファレンス**
・[Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/overview)
・[Storage Blob Data Contributor](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/built-in-roles#storage-blob-data-contributor)

---

**問題 436. Basic App Service プランの ASP1 でホストされている Azure App Service の App1 があります。App1 にカスタムドメインを構成し、バックアップを有効化します。最初に実行すべき操作はどれですか。（一つ選択）**

・App1 のアプリケーション設定を構成する
・ASP1 をスケールアップする
・App1 のデプロイスロットを追加する
・ASP1 をスケールアウトする

**解答例**
・**ASP1 をスケールアップする**

**解説**
App Service プランの **Basic 階層では、カスタムドメインの構成は可能ですが、自動バックアップ機能は利用できません**。 バックアップ機能を有効化するには、**Standard 階層以上のプランが必要**です。 したがって、最初に ASP1 を Basic 階層から Standard 階層以上にスケールアップする必要があります。

スケールアップとは、App Service プランの価格レベル（階層）を上位に変更することで、より多くの CPU、メモリ、ストレージ、機能を利用可能にする垂直スケーリングです。 一方、スケールアウトは同じ階層内でインスタンス数を増やす水平スケーリングであり、機能の追加には影響しません。

アプリケーション設定の構成やデプロイスロットの追加は、バックアップ機能の前提条件ではありません。 バックアップを有効化するには、まずプラン階層の要件を満たす必要があります。

| 階層 | カスタムドメイン | 自動バックアップ |
| :--- | :--- | :--- |
| Free/Shared | 不可 | 不可 |
| Basic | 可能 | 不可 |
| **Standard 以上** | **可能** | **可能** |

バックアップ機能では、アプリのコンテンツ、構成、データベース接続文字列を含む完全なバックアップを作成でき、最大 30 日間保持可能です。 復元時には既存のアプリまたは新しいアプリに復元できます。

**リファレンス**
・[App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
・[Scale Up and Scale Out](https://learn.microsoft.com/ja-jp/azure/app-service/manage-scale-up)

---

**問題 437. あなたは、Sub1 と Sub2 という 2 つの Azure サブスクリプションを管理しています。これらのサブスクリプションは、それぞれ異なる Microsoft Entra ID テナントにリンクされています。以下の表に示す仮想ネットワークが存在します。**

| 仮想ネットワーク | サブスクリプション | アドレス空間 |
| :--- | :--- | :--- |
| VNet1 | Sub1 | 10.1.0.0/16 |
| VNet2 | Sub1 | 10.2.0.0/16 |
| VNet3 | Sub2 | 10.3.0.0/16 |
| VNet4 | Sub1 | 10.1.0.0/24 |

**VNet1 とピアリング可能な仮想ネットワークはどれですか。（一つ選択）**

・VNet2 のみ
・VNet2 と VNet4 のみ
・VNet2、VNet3、VNet4 のすべて
・VNet2 と VNet3 のみ

**解答例**
・**VNet2 と VNet3 のみ**

**解説**
Azure Virtual Network Peering では、異なるサブスクリプションや異なる Microsoft Entra ID テナント間でも仮想ネットワークをピアリングできます。 ただし、ピアリングを確立するには、**アドレス空間が重複していないことが必須条件**です。

VNet1 のアドレス空間は 10.1.0.0/16 です。 各仮想ネットワークとのピアリング可否を確認します。

**VNet2** (10.2.0.0/16) は同じ Sub1 に属し、アドレス空間も重複していないため**ピアリング可能**です。

**VNet3** (10.3.0.0/16) は異なるサブスクリプション (Sub2) および異なる Microsoft Entra ID テナントに属していますが、適切な権限があればクロステナントピアリングが**可能**です。 アドレス空間も重複していないため、ピアリング可能です。

VNet4 (10.1.0.0/24) は同じ Sub1 に属していますが、アドレス空間 10.1.0.0/24 は VNet1 の 10.1.0.0/16 に完全に含まれており、**アドレス空間が重複しています**。 このため、VNet4 とのピアリングは確立できません。

| 仮想ネットワーク | ピアリング可否 | 理由 |
| :--- | :--- | :--- |
| **VNet2** | **可能** | アドレス空間が重複せず同一サブスクリプション |
| **VNet3** | **可能** | アドレス空間が重複せずクロステナントピアリング対応 |
| VNet4 | 不可 | アドレス空間が VNet1 と重複 |

したがって、VNet1 とピアリング可能な仮想ネットワークは VNet2 と VNet3 のみです。

**リファレンス**
・[Virtual Network Peering](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-peering-overview)
・[Microsoft Entra ID](https://learn.microsoft.com/ja-jp/entra/fundamentals/whatis)

---

**問題 438. あなたの組織は Azure サブスクリプション「Subscription-A」を所有しています。VNet-A という名前の仮想ネットワークがあり、以下の表に示すサブネット構成となっています。各仮想マシンは静的 IP アドレスを使用します。表に示す要件を満たすために作成する必要があるネットワークセキュリティグループ (NSG) の最小数はいくつかですか。（一つ選択）**

**サブネット構成**
| サブネット名 | 接続された仮想マシン |
| :--- | :--- |
| Subnet-A | VM-A, VM-B |
| Subnet-B | VM-C, VM-D |
| Subnet-C | VM-E, VM-F |

**セキュリティ要件**
| 要件 | 内容 |
| :--- | :--- |
| 要件 1 | インターネットから VM-C, VM-D, VM-E, VM-F へのポート 80/443 の Web リクエストを許可する |
| 要件 2 | VM-A と VM-B 間のすべての通信を許可する |
| 要件 3 | VM-A へのポート 3389 のリモートデスクトップ接続を許可する |
| 要件 4 | VNet-A への他のすべてのネットワークトラフィックを拒否する |

・2
・3
・1
・4

**解答例**
・**2**

**解説**
この問題では、NSG の適用範囲とルールの継承を理解することが重要です。 NSG はサブネットまたは個別の仮想マシンのネットワークインターフェイスに関連付けることができ、効率的なセキュリティ設計には最小数の NSG で要件を満たす構成を検討します。

要件を分析すると、VM-C, VM-D, VM-E, VM-F はすべて Web トラフィックを許可する共通要件があります。 **Subnet-B と Subnet-C に同一の NSG を適用することで、この要件を満たせます**。 一方、Subnet-A の VM-A には固有の要件（RDP 接続許可）があり、VM-B とは異なるルールが必要です。 VM-A と VM-B 間の通信はサブネット内通信のため、NSG で明示的に許可する必要はありません（デフォルトで許可）。

したがって、以下の **2 つの NSG** で要件を満たせます。 NSG-1 を Subnet-B と Subnet-C に適用して Web トラフィックを許可し、NSG-2 を VM-A の NIC に適用して RDP 接続を許可します。 要件 4 のトラフィック拒否は、NSG のデフォルト拒否ルールにより実現されます。

**NSG 構成と適用範囲**
| NSG 名 | 適用先 | 主要ルール |
| :--- | :--- | :--- |
| **NSG-1** | **Subnet-B, Subnet-C** | インバウンド：ポート 80/443 許可 |
| **NSG-2** | **VM-A の NIC** | インバウンド：ポート 3389 許可 |

**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

---

**問題 439. Azure サブスクリプションに、ストレージアカウント hogehoge が含まれています。パートナー組織に hogehoge へのアクセス権を提供します。hogehoge へのアクセスは 24 時間後に自動的に期限切れになる必要があります。何を構成しますか。（一つ選択）**

・lifecycle management
・Azure Content Delivery Network (CDN)
・Shared Access Signature (SAS)
・アクセスポリシー

**解答例**
・**Shared Access Signature (SAS)**

**解説**
ストレージアカウントへの一時的なアクセス権限を外部組織に付与する場合、**Shared Access Signature (SAS)** を使用します。 **SAS は、ストレージリソースへの制限付きアクセス権を提供するトークンで、有効期限、アクセス許可、IP アドレス制限などを細かく設定できます**。

SAS には 3 つのタイプがあります。 ユーザー委任 SAS は Azure AD の資格情報で署名され最も安全です。 サービス SAS は特定のストレージサービス（Blob, Queue, Table, File）へのアクセスを提供します。 アカウント SAS はストレージアカウント全体へのアクセスを提供し、複数のサービスにまたがる操作が可能です。

本シナリオでは、パートナー組織に **24 時間限定のアクセス権を付与するため、有効期限を設定した SAS トークンを生成して共有します**。 SAS トークンは URL パラメータとして付与され、受信者はその URL を使用してストレージリソースにアクセスします。

他の選択肢が不適切な理由を整理します。

| 選択肢 | 不適切な理由 |
| :--- | :--- |
| アクセスキー | 有効期限の設定ができず、ストレージアカウント全体への完全なアクセス権を付与してしまう |
| Azure CDN | コンテンツ配信の高速化が目的で、アクセス制御や期限設定の機能は提供しない |
| Lifecycle management | データのアーカイブや削除を自動化する機能で、アクセス制御とは無関係 |

SAS トークンの生成時には、開始時刻、有効期限、許可する操作（読み取り、書き込み、削除など）、アクセスを許可する IP アドレス範囲、使用するプロトコル（HTTPS のみなど）を指定できます。 セキュリティのベストプラクティスとして、必要最小限の権限のみを付与し、HTTPS プロトコルの使用を強制し、可能な限り短い有効期限を設定することが推奨されます。

**リファレンス**
・[Shared Access Signature (SAS)](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-sas-overview)

---

**問題 440. Azure Storage アカウントがあります。AzCopy ツールを使用してストレージアカウントにデータをコピーします。AzCopy がサポートするデータストレージの種類はどれですか。（二つ選択）**

・Azure Blob Storage
・Azure Files
・Azure Disk Storage
・Azure Table Storage

**解答例**
・**Azure Blob Storage**
・**Azure Files**

**解説**
AzCopy は、Azure ストレージアカウント間でデータを効率的にコピーするためのコマンドラインツールです。 このツールは高速なデータ転送を実現し、大量のファイルやデータの移行に適しています。

**AzCopy がサポートするストレージサービスは、Azure Blob Storage と Azure Files の 2 つです**。 Blob Storage は非構造化データの保存に使用され、Files はクラウド上のファイル共有を提供します。 いずれも AzCopy による効率的なデータコピーが可能です。

一方、Azure Table Storage と Azure Queue Storage は AzCopy の対象外です。 これらのサービスは異なる用途に特化しており、Table Storage は NoSQL データストア、Queue Storage はメッセージキューイングサービスとして機能します。 Azure Disk Storage は仮想マシンの永続ディスクとして使用されるため、AzCopy による直接的なデータコピーの対象ではありません。

| ストレージ種類 | AzCopy 対応 | 主な用途 |
| :--- | :--- | :--- |
| **Blob Storage** | **対応** | 非構造化データ保存 |
| **Files** | **対応** | ファイル共有 |
| Table Storage | 非対応 | NoSQL データストア |
| Queue Storage | 非対応 | メッセージキュー |
| Disk Storage | 非対応 | VM 永続ディスク |

**リファレンス**
・[AzCopy](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-use-azcopy-v10)
・[Azure Blob Storage](https://learn.microsoft.com/ja-jp/azure/storage/blobs/storage-blobs-introduction)
・[Azure Files](https://learn.microsoft.com/ja-jp/azure/storage/files/storage-files-introduction)

---

**問題 441. Azure Service Bus を使用しています。メッセージの先入れ先出し (FIFO) 配信を保証する Service Bus キューを実装します。どの設定を行いますか。（一つ選択）**

・セッションを有効化する
・重複検出を有効化する
・キューの最大サイズを 5 GB に設定する
・パーティション分割を有効化する

**解答例**
・**セッションを有効化する**

**解説**
Azure Service Bus で **FIFO（先入れ先出し）配信を保証するには、セッション機能を有効化する**必要があります。 セッションは、関連するメッセージのグループを順序付けて処理するための機能で、**同一セッション ID 内のメッセージは送信された順序で配信されることが保証されます**。

セッションを有効化すると、メッセージ送信時に SessionId プロパティを設定でき、受信側は特定のセッションを受け入れることでそのセッション内のメッセージを順序通りに処理できます。 これにより、複数の送信者からメッセージが送られても、セッション ID ごとに順序が維持されます。

重複検出は同じメッセージが複数回送信されることを防ぐ機能ですが、FIFO 配信とは直接関係ありません。 パーティション分割はスループット向上のための機能ですが、パーティション間での順序保証はされないため、FIFO 要件には適しません。 キューの最大サイズ設定は容量に関する設定であり、メッセージの配信順序には影響しません。

以下は各機能の比較です。

| 機能 | 目的 | FIFO 保証 |
| :--- | :--- | :--- |
| **セッション** | **メッセージグループの順序制御** | **あり** |
| 重複検出 | 重複メッセージの排除 | なし |
| パーティション分割 | スループット向上 | なし |

セッション有効化の設定は、キュー作成時に行う必要があり、既存のキューに対して後から有効化することはできません。 セッションを使用する場合、受信側アプリケーションでは SessionReceiver を使用してメッセージを受信します。

**リファレンス**
・[Azure Service Bus](https://learn.microsoft.com/ja-jp/azure/service-bus-messaging/message-sessions)

---

**問題 442. あなたは 2 つのサブスクリプション Sub1 と Sub2 を管理しています。各サブスクリプションは異なる Microsoft Entra ID テナントに関連付けられています。Sub1 には仮想ネットワーク VNet1 があり、仮想マシン VM1 が含まれ、IP アドレス空間は 10.0.0.0/16 です。Sub2 には仮想ネットワーク VNet2 があり、仮想マシン VM2 が含まれ、IP アドレス空間は 10.10.0.0/24 です。VNet1 と VNet2 を接続する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

・VNet1 を Sub2 に移動する
・仮想ネットワークゲートウェイをプロビジョニングする
・VNet2 の IP アドレス空間を変更する
・VM1 を Sub2 に移動する

**解答例**
・**仮想ネットワークゲートウェイをプロビジョニングする**

**解説**
異なる Microsoft Entra ID テナントに関連付けられたサブスクリプション間で仮想ネットワークを接続する場合、VNet Peering は使用できません。 VNet Peering は同一テナント内、または信頼関係のあるテナント間でのみ機能します。 **このシナリオでは、VPN Gateway または ExpressRoute を使用したサイト間接続が必要**です。

VPN Gateway を使用して VNet 間接続を確立するには、**各仮想ネットワークに仮想ネットワークゲートウェイをデプロイする**必要があります。 仮想ネットワークゲートウェイは、暗号化されたトラフィックを仮想ネットワーク間で送信するために使用される VPN デバイスです。

現在の IP アドレス空間 (10.0.0.0/16 と 10.10.0.0/24) は重複していないため、変更は不要です。 また、仮想マシンや仮想ネットワークをサブスクリプション間で移動する必要もありません。 異なるテナントに属するサブスクリプション間での接続には、ネットワークレベルでの接続ソリューションが必要です。

| 接続方法 | 適用シナリオ | 必要なリソース |
| :--- | :--- | :--- |
| VNet Peering | 同一テナント内 | なし |
| **VPN Gateway** | **異なるテナント間** | **仮想ネットワークゲートウェイ** |
| ExpressRoute | プライベート接続が必要 | ExpressRoute 回線 |

**リファレンス**
・[VPN Gateway](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/vpn-gateway-about-vpngateways)
・[Virtual Network Peering](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-peering-overview)

---

**問題 443. Azure サブスクリプションに、RG1 という名前のリソースグループがあります。RG1 には、VNet3 という名前の仮想ネットワーク、VM1 という名前の仮想マシン、PubIP1 という名前のパブリック IP アドレスが含まれています。すべてのリソースは West US リージョンにあります。複数の仮想ネットワークのサブネットで使用する NSG1 という名前のネットワークセキュリティグループを作成し、リモートデスクトップ管理トラフィックと HTTP トラフィックを許可する構成を行います。実行する必要があるコマンドレットはどれですか。（二つ選択）**

・New-AzNetworkSecurityRuleConfig
・Set-AzNetworkSecurityGroup
・New-AzNetworkSecurityGroup
・Add-AzNetworkInterfaceTapConfig

**解答例**
・**New-AzNetworkSecurityRuleConfig**
・**New-AzNetworkSecurityGroup**

**解説**
ネットワークセキュリティグループ (NSG) を作成して複数の仮想ネットワークのサブネットに適用するには、**まずセキュリティルールを定義し、次に NSG リソース自体を作成する**必要があります。

**New-AzNetworkSecurityRuleConfig** コマンドレットは、NSG に含めるセキュリティルールを定義します。 このシナリオでは、リモートデスクトップ (TCP 3389) と HTTP (TCP 80) のトラフィックを許可するルールを作成します。 このコマンドレットは実際にはルールオブジェクトをメモリ内に作成するだけで、Azure 上にリソースは作成されません。

**New-AzNetworkSecurityGroup** コマンドレットは、定義されたセキュリティルールを含む新しい NSG リソースを Azure 上に作成します。 前のステップで作成したルールオブジェクトをパラメータとして渡すことで、ルールが適用された NSG が作成されます。 作成後、この NSG を複数の仮想ネットワークのサブネットに関連付けることができます。

Set-AzNetworkSecurityGroup は既存の NSG を更新するコマンドレットであり、新規作成には使用しません。 Add-AzNetworkInterfaceTapConfig はネットワークインターフェイスの TAP 構成を追加するコマンドレットで、NSG の作成とは無関係です。

| コマンドレット | 用途 |
| :--- | :--- |
| **New-AzNetworkSecurityRuleConfig** | **セキュリティルールの定義** |
| **New-AzNetworkSecurityGroup** | **NSG リソースの作成** |
| Set-AzNetworkSecurityGroup | 既存 NSG の更新 |

**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Azure PowerShell コマンドレット](https://learn.microsoft.com/ja-jp/powershell/module/az.network/new-aznetworksecuritygroup)

---

**問題 444. Azure 仮想マシン VM1 と Azure Key Vault である Vault1 があります。VM1 で Azure Disk Encryption を構成し、キー暗号化キー (KEK) を使用する予定です。Azure Disk Encryption のために Vault1 を準備する必要があります。Vault1 で実行すべきアクションはどれですか。（二つ選択）**

・Azure Disk Encryption によるボリューム暗号化を有効にする
・新しいキーを作成する
・デプロイのために Azure Virtual Machines を有効にする
・キーのローテーションポリシーを構成する

**解答例**
・**Azure Disk Encryption によるボリューム暗号化を有効にする**
・**新しいキーを作成する**

**解説**
Azure Disk Encryption で KEK を使用する場合、Key Vault で 2 つの準備が必要です。 まず **Key Vault 自体が Azure Disk Encryption からのアクセスを許可する設定を有効化**し、次に **KEK として使用する暗号化キーを作成**します。

Key Vault のアクセスポリシーまたは RBAC で「**Azure Disk Encryption によるボリューム暗号化**」を有効にすることで、Disk Encryption サービスがキーにアクセスできるようになります。 この設定がない場合、VM1 のディスク暗号化処理は Key Vault のキーを取得できず失敗します。

KEK はディスク暗号化キー (DEK) をラップ（暗号化）するための上位キーです。 Key Vault 内で新しい RSA または EC（楕円曲線）キーを作成し、このキーを KEK として指定します。 KEK を使用することで DEK の保護レベルが向上し、キー管理の柔軟性が高まります。

デプロイのための Virtual Machines 有効化は、ARM テンプレートデプロイ時に Key Vault からシークレットを取得する設定であり、Disk Encryption とは用途が異なります。 キーローテーションポリシーは自動的なキー更新の設定ですが、初期構成では必須ではありません。

| 設定項目 | 用途 | Disk Encryption 必須 |
| :--- | :--- | :--- |
| **Disk Encryption 有効化** | **ディスク暗号化サービスのアクセス許可** | **必須** |
| **キー作成** | **KEK の準備** | **必須** |
| VM デプロイ有効化 | テンプレートデプロイ時のシークレット取得 | 不要 |

**リファレンス**
・[Azure Disk Encryption](https://learn.microsoft.com/ja-jp/azure/virtual-machines/windows/disk-encryption-overview)
・[Azure Key Vault](https://learn.microsoft.com/ja-jp/azure/key-vault/general/overview)

---

**問題 445. Azure 仮想マシン VM1 があります。VM1 は ARM1.json という名前のカスタム Azure Resource Manager テンプレートを使用してデプロイされました。VM1 がメンテナンスの影響を受けるという通知を受け取りました。VM1 を直ちに別のホストに移動します。解決策：Redeploy 機能を使用して仮想マシンを再デプロイします。この解決策は目標を達成していますか。（一つ選択）**

・はい
・いいえ

**解答例**
・**はい**

**解説**
Azure 仮想マシンの計画メンテナンス通知を受けた場合、VM1 を直ちに別の物理ホストに移動するには、**Redeploy 機能を使用することで目標を達成できます**。

Redeploy は仮想マシンを同じリージョン内の別の物理ホストに移動させる機能です。 この操作により、仮想マシンは一時的にシャットダウンされ、新しいホスト上で再起動されます。 仮想マシンの構成、関連付けられたリソース、データはすべて保持されます。 Redeploy を実行することで、計画メンテナンスの影響を回避し、VM1 を即座に別のホストに移動できます。

なお、リソースグループの移動では物理ホストは変更されないため、メンテナンス回避の目的は達成できません。 また、可用性セットの変更も既存の VM に対しては直接実行できず、VM の再作成が必要となるため即座の対応には適していません。

| 操作 | 物理ホスト移動 | 即座の実行 |
| :--- | :--- | :--- |
| **Redeploy** | **可能** | **可能** |
| リソースグループ移動 | 不可 | 可能 |
| 可用性セット変更 | 可能 | 不可（再作成必要） |

**リファレンス**
・[Redeploy](https://learn.microsoft.com/ja-jp/azure/virtual-machines/redeploy-to-new-node)
・[Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)
・[Availability Set](https://learn.microsoft.com/ja-jp/azure/virtual-machines/availability-set-overview)

---

**問題 446. オンプレミスネットワークから Azure サービスを移行する計画を立てています。Azure でホスト可能と考えられる複数の仮想マシンを特定しました。以下の表に示す仮想マシンのうち、Azure Migrate を使用してアクセスできる仮想マシンはどれですか。（二つ選択）**

| 仮想マシン名 | オペレーティングシステム | 役割 |
| :--- | :--- | :--- |
| VM-CA01 | Windows Server 2019 | Web サーバー |
| VM-NW01 | Windows Server 2012 | ファイルサーバー |
| VM-FS01 | Ubuntu 20.04 LTS | アプリケーションサーバー |
| VM-DC01 | Windows Server 2016 | ドメインコントローラー |
| VM-DB01 | Red Hat Enterprise Linux 8 | データベースサーバー |

・VM-DB01
・VM-CA01
・VM-FS01
・VM-NW01
・VM-DC01

**解答例**
・**VM-CA01**
・**VM-FS01**

**解説**
Azure Migrate は、オンプレミス環境から Azure への移行を支援する統合プラットフォームです。 このサービスは、物理サーバー、仮想マシン、データベース、Web アプリケーションなどの検出、評価、移行を一元的に管理します。

Azure Migrate がサポートする主なオペレーティングシステムは、**Windows Server 2016 以降および Ubuntu、Red Hat Enterprise Linux などの主要な Linux ディストリビューション**です。 ただし、Windows Server 2012 およびそれ以前のバージョンは、Azure への移行は技術的に可能ですが、Microsoft の延長サポートが終了しているため、Azure Migrate の評価ツールでは推奨されません。

本問では、**VM-CA01 (Windows Server 2019) と VM-FS01 (Ubuntu 20.04 LTS) が、Azure Migrate の標準的なサポート対象**となります。 VM-NW01 (Windows Server 2012) は古い OS バージョンのため、移行前に OS のアップグレードが推奨されます。 VM-DC01 と VM-DB01 も技術的には移行可能ですが、ドメインコントローラーやデータベースサーバーの移行には追加の考慮事項が必要です。

Azure Migrate の主要機能を以下の表にまとめます。

| 機能 | 説明 |
| :--- | :--- |
| 検出と評価 | オンプレミス環境のインベントリ作成と Azure 適合性評価 |
| サーバー移行 | エージェントレスまたはエージェントベースの移行実行 |
| データベース移行 | Azure Database Migration Service との統合 |

**リファレンス**
・[Azure Migrate](https://learn.microsoft.com/ja-jp/azure/migrate/migrate-services-overview)
・[Azure Database Migration Service](https://learn.microsoft.com/ja-jp/azure/dms/dms-overview)

---

**問題 447. 5,000 のユーザーアカウントを含む Microsoft Entra テナントがあります。AdminUser1 という名前の新しいユーザーアカウントを作成しました。AdminUser1 に User Administrator 管理者ロールを割り当てます。ユーザーアカウントのプロパティから何を実行しますか。（一つ選択）**

・Licenses ブレードから新しいライセンスを割り当てる
・Directory role ブレードからディレクトリロールを変更する
・Assigned roles ブレードから管理者ロールを追加する
・Groups ブレードからユーザーアカウントを新しいグループに招待する

**解答例**
・**Assigned roles ブレードから管理者ロールを追加する**

**解説**
Microsoft Entra ID（旧 Azure Active Directory）で管理者ロールを割り当てる際は、ユーザーアカウントのプロパティ内にある **Assigned roles ブレードを使用します**。 このブレードから直接 User Administrator などの組み込みロールを割り当てることができます。

Directory role ブレードは古いポータルインターフェースで使用されていた名称であり、現在の Microsoft Entra 管理センターでは Assigned roles という名称に統一されています。 機能的には同等ですが、最新のインターフェースでは Assigned roles を使用します。

Groups ブレードはユーザーをグループに追加する機能であり、直接的な管理者ロールの割り当てには使用しません。 Licenses ブレードはサービスライセンスの管理に使用され、管理者ロールの割り当てとは無関係です。

| 操作対象 | 用途 | 管理者ロール割り当て |
| :--- | :--- | :--- |
| **Assigned roles** | **管理者ロールの直接割り当て** | **可能** |
| Groups | グループメンバーシップ管理 | 不可 |
| Licenses | サービスライセンス管理 | 不可 |

User Administrator ロールを持つユーザーは、他のユーザーアカウントの作成、削除、パスワードリセット、ライセンス管理などの操作が可能になります。 ただし、グローバル管理者や特権ロール管理者などの上位ロールを持つユーザーは管理できません。

**リファレンス**
・[Microsoft Entra ID](https://learn.microsoft.com/ja-jp/entra/identity/role-based-access-control/manage-roles-portal)
・[Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/overview)

---

**問題 448. Subscription1 という名前の Azure サブスクリプションがあり、以下のプロバイダーが登録されています：Authorization、Automation、Resources、Compute、KeyVault、Network、Storage、Billing、Web。Subscription1 には、VM1 という名前の Azure 仮想マシンが含まれており、次の構成があります：プライベート IP アドレス 10.0.0.4（動的）、ネットワークセキュリティグループ NSG1、パブリック IP アドレスなし、可用性セット AVSet、サブネット 10.0.0.0/24、マネージドディスクなし、リージョンは East US。VM1 への成功および失敗したすべての接続試行を記録します。実行する必要がある 3 つのアクションはどれですか。（該当するものをすべて選択）**

・East US リージョンで Azure Network Watcher を有効化する
・Azure Storage アカウントを作成する
・Microsoft.Insights リソースプロバイダーを登録する
・Azure Network Watcher の NSG フローログを有効化する
・Log Analytics ワークスペースを作成する
・Microsoft.LogAnalytics プロバイダーを登録する

**解答例**
・**East US リージョンで Azure Network Watcher を有効化する**
・**Azure Storage アカウントを作成する**
・**Azure Network Watcher の NSG フローログを有効化する**

**解説**
VM1 への接続試行を記録するには、**NSG フローログ機能**を使用します。 NSG フローログは、ネットワークセキュリティグループを通過する IP トラフィックに関する情報を記録する機能で、接続の成功・失敗の両方を追跡できます。

この機能を実装するには 3 つのステップが必要です。 まず、VM1 が配置されている **East US リージョンで Network Watcher を有効化**します。 Network Watcher は各リージョンで個別に有効化する必要があるため、VM1 のリージョンで有効化することが必須です。 次に、フローログデータを保存するための **Storage アカウントを作成**します。 NSG フローログは JSON 形式で Storage アカウントに保存されるため、ログの保存先として必要です。 最後に、**NSG1 に対して NSG フローログを有効化**します。 これにより、NSG1 を通過するすべてのトラフィックが記録され、接続の成功・失敗を追跡できるようになります。

Microsoft.Insights プロバイダーの登録は、Azure Monitor や Application Insights を使用する際に必要ですが、NSG フローログの基本機能には必須ではありません。 Log Analytics ワークスペースと Microsoft.LogAnalytics プロバイダーは、フローログの高度な分析を行う場合に有用ですが、基本的な記録要件には必須ではありません。

| 要素 | 必要性 | 理由 |
| :--- | :--- | :--- |
| **Network Watcher 有効化** | **必須** | フローログ機能の前提条件 |
| **Storage アカウント** | **必須** | ログデータの保存先 |
| **NSG フローログ有効化** | **必須** | 接続試行の記録機能 |

**リファレンス**
・[Azure Network Watcher](https://learn.microsoft.com/ja-jp/azure/network-watcher/network-watcher-monitoring-overview)
・[NSG Flow Logs](https://learn.microsoft.com/ja-jp/azure/network-watcher/network-watcher-nsg-flow-logging-portal)
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)

---

**問題 449. 組織は単一の Azure サブスクリプションを使用しており、VNet-A という仮想ネットワークに接続された複数の仮想マシンが稼働しています。VM Insights のために Azure Monitor を構成する際、すべての仮想マシンが VNet-A 経由でのみ Azure Monitor と通信するように制限します。この要件を満たすために最初に作成すべきリソースを選択してください。（一つ選択）**

・Log Analytics ワークスペース
・データ収集エンドポイント (DCE)
・Azure Monitor Private Link Scope (AMPLS)
・プライベート エンドポイント





ご指定いただいたソース（PDFの抜粋）に含まれるすべての文章を、一文字も省略することなく、全文そのまま出力します。

---

### **解答例**
・**Azure Monitor Private Link Scope (AMPLS)**

### **解説**
**VM Insights** で **Azure Monitor** への通信を特定の仮想ネットワーク経由に制限するには、**Azure Private Link** を使用したプライベートネットワーク接続を構成する必要があります。この構成における最初のステップは、**Azure Monitor Private Link Scope（AMPLS）**の作成です。

AMPLS は、Azure Monitor サービス（Log Analytics ワークスペース、Application Insights コンポーネントなど）をグループ化し、プライベートエンドポイント経由でアクセスできるようにする境界を定義するリソースです。AMPLS を作成した後、監視対象の **Log Analytics ワークスペース**をこのスコープに関連付け、次に **VNet-A** 内にプライベートエンドポイントを作成して AMPLS に接続します。

構成の順序は以下の通りです。まず AMPLS を作成し、既存または新規の Log Analytics ワークスペースをスコープに追加します。その後、VNet-A 内にプライベートエンドポイントを作成して AMPLS に接続し、最後に**データ収集エンドポイント（DCE）**を構成して**データ収集ルール（DCR）**と組み合わせます。

| 構成要素 | 役割 | 作成順序 |
| :--- | :--- | :--- |
| **AMPLS** | Azure Monitor リソースのグループ化とアクセス境界の定義 | 1 番目 |
| **プライベートエンドポイント** | VNet と AMPLS 間のプライベート接続 | 2 番目 |
| **DCE** | データ収集のためのプライベートエンドポイント | 3 番目 |

Log Analytics ワークスペースは監視データの保存先として必要ですが、AMPLS を先に作成してからワークスペースをスコープに関連付ける方が論理的な構成手順となります。データ収集エンドポイントとプライベートエンドポイントは、AMPLS が存在して初めて機能するため、後続のステップとなります。

**リファレンス**
・[Azure Monitor Private Link Scope](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/private-link-security)
・[Azure Private Link](https://learn.microsoft.com/ja-jp/azure/private-link/private-link-overview)

---

### **問題 450. 技術要件を満たす ID 管理ソリューションを推奨します。どのソリューションを推奨しますか？（一つ選択）**

・Pass-through Authentication と Single Sign-On（SSO）
・**Password Hash Synchronization と Single Sign-On（SSO）**
・Federated Single Sign-On（SSO）と Active Directory Federation Services（AD FS）
・クラウド専用ユーザーアカウント

### **解答例**
・**Password Hash Synchronization と Single Sign-On（SSO）**

### **解説**
**Azure AD** とオンプレミス **Active Directory** を統合する際、最も推奨される認証方式は **Password Hash Synchronization** と **SSO** の組み合わせです。この方式では、ユーザーのパスワードハッシュ値を Azure AD に同期し、クラウド側で認証を完結させます。

Password Hash Synchronization は、オンプレミスの Active Directory ドメインサービスから、ユーザーパスワードのハッシュ値の一方向ハッシュを Azure AD に同期します。実際のパスワードは同期されず、ハッシュ値のみが転送されるため、セキュリティが保たれます。この方式では、Azure AD 側で認証処理が完結するため、オンプレミスのインフラストラクチャへの依存が最小限になります。

Pass-through Authentication は、認証要求をオンプレミスの Active Directory に転送するため、オンプレミスインフラへの依存度が高くなります。AD FS は、より複雑なフェデレーション環境や特殊な認証要件がある場合に使用されますが、追加のインフラストラクチャとメンテナンスコストが必要です。クラウド専用アカウントは、オンプレミスとの統合が不要な場合にのみ適しています。

| 認証方式 | オンプレミス依存度 | 推奨度 |
| :--- | :--- | :--- |
| **Password Hash Sync** | 低 | 高 |
| **Pass-through Auth** | 高 | 中 |
| **AD FS** | 高 | 低 |

| 特徴 | Password Hash Sync | Pass-through Auth |
| :--- | :--- | :--- |
| 認証場所 | **Azure AD** | オンプレミス AD |
| 可用性 | 高 | オンプレミスに依存 |
| 複雑性 | 低 | 中 |

**リファレンス**
・[Microsoft Entra Connect](https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/whatis-azure-ad-connect)
・[Password Hash Synchronization](https://learn.microsoft.com/ja-jp/entra/identity/hybrid/connect/whatis-phs)

---

### **問題 451. あなたは Azure 管理者として、Subscription1 という名前の Azure サブスクリプションを管理しています。このサブスクリプションには複数のストレージアカウントが含まれており、それぞれ異なる構成で作成されています。Azure Import/Export サービスを使用して Subscription1 からデータをエクスポートする計画があります。このエクスポート操作に使用できるストレージアカウントを特定する必要があります。どのストレージアカウントを選択しますか。（一つ選択）**

| ストレージアカウント名 | 種類 | レプリケーション |
| :--- | :--- | :--- |
| **storage1** | StorageV2（汎用 v2） | LRS |
| **storage2** | BlobStorage | GRS |
| **storage3** | StorageV2（汎用 v2） | ZRS |
| **storage4** | FileStorage | LRS |

・storage2
・storage4
・storage3
・**storage1**

### **解答例**
・**storage1**

### **解説**
**Azure Import/Export サービス**は、大量のデータを物理ディスクドライブを使用して Azure データセンターとの間で転送するサービスです。このサービスを使用する際には、ストレージアカウントの種類とレプリケーション設定に制約があります。

Azure Import/Export サービスでは、**StorageV2（汎用 v2）** または **StorageV1（汎用 v1）** のストレージアカウントタイプが必要です。さらに、レプリケーション設定として **LRS（ローカル冗長ストレージ）**、**GRS（geo 冗長ストレージ）**、**RA-GRS（読み取りアクセス geo 冗長ストレージ）** がサポートされています。**ZRS（ゾーン冗長ストレージ）** や **GZRS（geo ゾーン冗長ストレージ）** はサポートされていません。

各ストレージアカウントを確認すると、**storage1** は **StorageV2** で **LRS** レプリケーションを使用しているため、Azure Import/Export サービスの要件を満たしています。storage2 は BlobStorage タイプであり、このタイプは Import/Export サービスでサポートされていません。storage3 は StorageV2 ですが **ZRS** レプリケーションを使用しているため対象外です。storage4 は FileStorage タイプであり、これもサポートされていません。

| 項目 | サポート状況 |
| :--- | :--- |
| **StorageV2（汎用 v2）** | サポート対象 |
| **BlobStorage** | サポート対象外 |
| **FileStorage** | サポート対象外 |

| レプリケーション | サポート状況 |
| :--- | :--- |
| **LRS、GRS、RA-GRS** | サポート対象 |
| **ZRS、GZRS** | サポート対象外 |

したがって、**storage1** が正解となります。

**リファレンス**
・[Azure Import/Export サービス](https://learn.microsoft.com/ja-jp/azure/import-export/storage-import-export-service)
・[Azure ストレージレプリケーション](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-redundancy)

---

### **問題 452. Azure Kubernetes Service (AKS) クラスタ「AKS1」をデプロイしました。AKS1 に YAML ファイルをデプロイします。解決策：Azure Cloud Shell から az aks コマンドを実行しました。この解決策は要件を満たしていますか？（一つ選択）**

・**いいえ**
・はい

### **解答例**
・**いいえ**

### **解説**
AKS クラスタに YAML ファイルをデプロイするには、Kubernetes のネイティブコマンドラインツールである **kubectl** を使用する必要があります。**az aks** コマンドは Azure CLI の AKS 管理用コマンドであり、クラスタの作成、削除、スケーリングなどの管理操作には使用できますが、Kubernetes リソースのデプロイには使用できません。

正しい手順は、まず **az aks get-credentials** コマンドで AKS クラスタの認証情報を取得し、その後 **kubectl apply -f <YAML ファイル名>** コマンドを実行して YAML ファイルをデプロイします。Azure Cloud Shell にはデフォルトで kubectl がインストールされているため、追加のインストール作業は不要です。

| コマンド | 用途 | 実行例 |
| :--- | :--- | :--- |
| **az aks** | AKS クラスタの管理操作 | クラスタ作成、削除、更新 |
| **az aks get-credentials** | クラスタ認証情報の取得 | kubeconfig の設定 |
| **kubectl apply** | Kubernetes リソースのデプロイ | YAML ファイルの適用 |

したがって、**az aks** コマンドのみでは YAML ファイルのデプロイという要件を満たすことができないため、この解決策は不適切です。

**リファレンス**
・[Azure Kubernetes Service (AKS)](https://learn.microsoft.com/ja-jp/azure/aks/intro-kubernetes)
・[kubectl](https://kubernetes.io/docs/reference/kubectl/)
・[Azure AD 条件付きアクセス](https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/overview)

---

### **問題 453. 表 1 に示す仮想マシンを含む Azure サブスクリプションがあります。VM-A と VM-B にはパブリック IP アドレスが割り当てられており、Windows Server 2022 で受信リモートデスクトップ接続を許可しています。Subnet-A と Subnet-B は Vnet-A という仮想ネットワーク内に存在します。サブスクリプションには NSG-A と NSG-B という 2 つのネットワークセキュリティグループがあります。NSG-A はデフォルトルールのみを使用し、Subnet-A に関連付けられています。NSG-B はデフォルトルールと表 2 のカスタム受信ルールを使用し、VM-B のネットワークインターフェイスに関連付けられています。VM-A からリモートデスクトップで VM-B に接続できますか。正しい場合は「はい」、正しくない場合は「いいえ」を選択してください。（一つ選択）**

表 1: 仮想マシン構成
| 名前 | オペレーティングシステム | 接続先 |
| :--- | :--- | :--- |
| **VM-A** | Windows Server 2022 | Subnet-A |
| **VM-B** | Windows Server 2022 | Subnet-B |
| **VM-C** | Windows Server 2022 | Subnet-B |

表 2: NSG-B のカスタムルール
| 項目 | 設定値 |
| :--- | :--- |
| 名前 | **CustomRule-RDP** |
| 優先度 | 100 |
| ポート | 3389 |
| プロトコル | TCP |
| ソース | Any |
| 宛先 | Any |
| アクション | **Allow** |

・いいえ
・**はい**

### **解答例**
・**はい**

### **解説**
VM-A から VM-B へのリモートデスクトップ接続が可能かどうかは、ネットワークセキュリティグループのルール評価によって決定されます。同一仮想ネットワーク内のサブネット間通信では、送信元と宛先の両方で NSG ルールが評価されます。

VM-A が所属する Subnet-A には NSG-A が関連付けられており、デフォルトルールのみが適用されます。NSG のデフォルトルールには、同一仮想ネットワーク内の通信を許可する「**AllowVnetInBound**」ルールが含まれているため、VM-A から Vnet-A 内の他のリソースへの送信トラフィックは許可されます。

VM-B 側では、ネットワークインターフェイスに NSG-B が関連付けられています。NSG-B には優先度 100 でポート 3389 (RDP) への TCP 接続を許可するカスタムルールが設定されており、ソースとデスティネーションが Any に設定されているため、VM-A からの接続要求を受け入れます。

NSG の評価では、サブネットレベルとネットワークインターフェイスレベルの両方でルールが適用されますが、いずれかで許可されていれば通信が成立します。本シナリオでは両方のレベルで通信が許可されているため、VM-A から VM-B へのリモートデスクトップ接続は成功します。

**NSG ルール評価のポイント**
| 評価対象 | 関連付け先 | ルール内容 | 結果 |
| :--- | :--- | :--- | :--- |
| **NSG-A** | Subnet-A | デフォルトルール (VNet 内通信許可) | **送信許可** |
| **NSG-B** | VM-B のネットワークインターフェイス | カスタムルール (RDP 許可) | **受信許可** |

**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)
・[リモートデスクトッププロトコル](https://learn.microsoft.com/ja-jp/windows-server/remote/remote-desktop-services/welcome-to-rds)

---

### **問題 454. オンプレミスの共有フォルダ \\\\fileserver01\\data に保存されているすべてのファイルを、Azure Storage アカウント storageacct01 の BLOB コンテナーに移行します。移行作業を実行するために使用できるコマンドはどれですか。（二つ選択）**

・**Get-ChildItem -Path \\\\fileserver01\\data -Recurse | Set-AzStorageBlobContent -Container "datacontainer"**
・Azcopy sync \\\\fileserver01\\data https://storageacct01.blob.core.windows.net/datacontainer --recursive
・Set-AzStorageBlobContent -Container "datacontainer" -File "\\\\fileserver01\\data" -Blob "migrateddata"
・**Azcopy copy \\\\fileserver01\\data https://storageacct01.blob.core.windows.net/datacontainer --recursive**

### **解答例**
・**Get-ChildItem -Path \\\\fileserver01\\data -Recurse | Set-AzStorageBlobContent -Container "datacontainer"**
・**Azcopy copy \\\\fileserver01\\data https://storageacct01.blob.core.windows.net/datacontainer --recursive**

### **解説**
オンプレミスから Azure Storage へのデータ移行では、**AzCopy** コマンドラインツールまたは **Azure PowerShell** コマンドレットを使用します。

AzCopy の **copy** コマンドは、ソースからコピー先へファイルを一方向にコピーします。**--recursive** オプションを指定することで、サブディレクトリを含むすべてのファイルを再帰的にコピーできます。これは初回の大規模データ移行に適しています。

PowerShell では、**Get-ChildItem** でファイル一覧を取得し、パイプラインで **Set-AzStorageBlobContent** に渡すことで、各ファイルを個別に BLOB としてアップロードします。**-Recurse** パラメータにより、サブフォルダ内のファイルも処理対象となります。

AzCopy の **sync** コマンドは、ソースとコピー先を同期させる双方向の操作を行います。コピー先に存在してソースに存在しないファイルは削除されるため、初回の一方向移行には適していません。

Set-AzStorageBlobContent に **-File** パラメータでフォルダパスを直接指定する方法は、単一ファイルのアップロードを想定した構文であり、フォルダ全体の再帰的なアップロードには対応していません。

| コマンド | 用途 | 再帰処理 |
| :--- | :--- | :--- |
| **AzCopy copy** | 一方向コピー | **--recursive** |
| **AzCopy sync** | 双方向同期 | --recursive |
| **PowerShell** | 個別アップロード | **-Recurse** |

**リファレンス**
・[AzCopy](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-use-azcopy-v10)
・[Azure Blob Storage](https://learn.microsoft.com/ja-jp/azure/storage/blobs/storage-blobs-introduction)

---

### **問題 455. Azure Resource Manager テンプレートを使用して 10 個の Azure Web Apps をデプロイします。テンプレートのデプロイ前に前提条件となるリソースをデプロイする必要があり、実装に関連するコストを最小限に抑える必要があります。前提条件として何をデプロイしますか。（一つ選択）**

・**1 つの App Service Plan**
・Azure Load Balancer
・Azure Application Gateway
・10 個の App Service Plan

### **解答例**
・**1 つの App Service Plan**

### **解説**
Azure Web Apps をデプロイする際の前提条件として、**App Service Plan** が必須です。App Service Plan は、Web Apps が実行されるコンピューティングリソースのセットを定義し、価格レベル、インスタンス数、リージョンなどを指定します。

コスト最適化の観点から、**1 つの App Service Plan で複数の Web Apps をホストすることが可能**です。同一の App Service Plan 内で最大 100 個のアプリをホストでき、すべてのアプリが同じコンピューティングリソースを共有します。このため、10 個の Web Apps に対して 10 個の App Service Plan を作成する必要はなく、1 つの App Service Plan で十分です。

Azure Load Balancer や Application Gateway は、トラフィック分散や負荷分散のためのサービスですが、Web Apps のデプロイの前提条件ではありません。これらは必要に応じて後から追加できるオプションのコンポーネントです。

| リソース | 必須性 | コスト影響 |
| :--- | :--- | :--- |
| **App Service Plan** | **必須** | **1 つで複数アプリをホスト可能** |
| **Load Balancer** | オプション | 追加コスト発生 |
| **Application Gateway** | オプション | 追加コスト発生 |

App Service Plan の価格レベルは、Free、Shared、Basic、Standard、Premium、Isolated から選択でき、要件に応じて適切なレベルを選択することでコストを最適化できます。

**リファレンス**
・[App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
・[Azure Web Apps](https://learn.microsoft.com/ja-jp/azure/app-service/overview)
・[Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)

---

### **問題 456. Azure のサブスクリプションに対して、7,680GB のデータを Azure Import/Export サービスを使用してオンプレミス環境から移行します。このサービスでインポート先として指定可能なストレージの種類を選択してください。（二つ選択）**

・**Azure Blob Storage**
・**Azure Files**
・Azure Data Lake Storage
・Azure Table Storage

### **解答例**
・**Azure Blob Storage**
・**Azure Files**

### **解説**
**Azure Import/Export サービス**は、大量データを物理ディスクドライブを使用して Azure データセンターに安全に転送するサービスです。このサービスでサポートされるインポート先のストレージタイプは限定されています。

Azure Import/Export サービスでは、インポートジョブの宛先として以下の **2 種類のストレージのみがサポート**されています。第一に、**Azure Blob Storage** はブロックブロッブとページブロッブの両方の形式でデータをインポート可能です。第二に、**Azure Files** は標準ストレージアカウント内のファイル共有へのインポートをサポートしています。

Azure Data Lake Storage や Azure Table Storage は、Azure Import/Export サービスの直接的なインポート先としてはサポートされていません。これらのストレージサービスにデータを移行する場合は、まず Blob Storage にインポートした後、Azure Data Factory や AzCopy などの別のツールを使用してデータを転送する必要があります。

| ストレージタイプ | Import/Export 対応 | 備考 |
| :--- | :--- | :--- |
| **Azure Blob Storage** | **対応** | ブロックブロッブ、ページブロッブ |
| **Azure Files** | **対応** | 標準ストレージのみ |
| **Azure Data Lake Storage** | 非対応 | 間接的な移行が必要 |
| **Azure Table Storage** | 非対応 | 別の移行方法を使用 |

Azure Import/Export サービスは、ネットワーク帯域幅の制約がある環境や、大容量データの転送にネットワーク経由では時間がかかりすぎる場合に有効なソリューションです。物理ディスクを使用することで、数テラバイト規模のデータを効率的かつ安全に Azure に移行できます。

**リファレンス**
・[Azure Import/Export](https://learn.microsoft.com/ja-jp/azure/import-export/storage-import-export-service)
・[Azure Blob Storage](https://learn.microsoft.com/ja-jp/azure/storage/blobs/storage-blobs-introduction)
・[Azure Files](https://learn.microsoft.com/ja-jp/azure/storage/files/storage-files-introduction)

---

### **問題 457. Azure サブスクリプションがあります。VMware vSphere から 50 台の仮想マシンをサブスクリプションに移行する計画を立てています。Recovery Services コンテナーを作成しました。次に実行する操作を選択してください。（一つ選択）**

・**Azure Migrate アプライアンスを vSphere 環境にデプロイする**
・仮想ネットワークを構成する
・拡張ネットワークを構成する
・復旧計画を作成する

### **解答例**
・**Azure Migrate アプライアンスを vSphere 環境にデプロイする**

### **解説**
VMware vSphere から Azure への仮想マシン移行では、**Azure Migrate** を使用した移行プロセスが推奨されます。Recovery Services コンテナーを作成した後、次のステップとして **Azure Migrate アプライアンスを vSphere 環境にデプロイ**する必要があります。

Azure Migrate アプライアンスは、オンプレミスの VMware 環境に OVA テンプレートとしてデプロイされる軽量のコレクターです。このアプライアンスは、vSphere 環境内の仮想マシンを検出し、パフォーマンスデータを収集して Azure に送信します。これにより、移行の評価と実際の移行作業が可能になります。

仮想ネットワークの構成は移行先の環境準備として重要ですが、まず移行元の環境で検出と評価を行うためのアプライアンスのデプロイが優先されます。拡張ネットワークは Azure VMware Solution で使用される機能であり、この移行シナリオでは該当しません。復旧計画は Site Recovery で使用されますが、移行プロセスの後半で作成されるものです。

| 手順 | 実施内容 | 目的 |
| :--- | :--- | :--- |
| 1 | Recovery Services コンテナー作成 | 移行データの保管場所を確保 |
| **2** | **Azure Migrate アプライアンスデプロイ** | **vSphere 環境の検出と評価** |
| 3 | 仮想マシンの評価 | 移行の適合性を確認 |
| 4 | レプリケーション開始 | Azure への移行実行 |

**リファレンス**
・[Azure Migrate](https://learn.microsoft.com/ja-jp/azure/migrate/migrate-services-overview)
・[Recovery Services Vault](https://learn.microsoft.com/ja-jp/azure/site-recovery/azure-to-azure-tutorial-enable-replication)
・[VMware vSphere](https://learn.microsoft.com/ja-jp/azure/migrate/tutorial-discover-vmware)

---

### **問題 458. VNet1 と VNet2 という 2 つの Azure 仮想ネットワークがあります。VNet1 には VM1 という 仮想マシンが含まれ、VNet2 には VM2 という仮想マシンが含まれています。VM1 はフロントエンドアプリケーションをホストしており、データ取得のために VM2 に接続します。ユーザーからフロントエンドアプリケーションの応答が通常より遅いという報告がありました。VM1 から VM2 へのパケットの平均往復時間（RTT）を確認する必要があります。どの Azure Network Watcher の機能を使用しますか。（一つ選択）**

・Network Performance Monitor
・**Connection Monitor**
・IP Flow Verify
・Connection Troubleshoot
・NSG 診断

### **解答例**
・**Connection Monitor**

### **解説**
VM 間の**平均往復時間（RTT）**を継続的に監視する場合は、**Connection Monitor** を使用します。この機能は、Azure 仮想マシン間やオンプレミスと Azure 間の接続品質を定期的に測定し、**RTT**、パケット損失率、到達可能性などのメトリックを収集します。

Connection Monitor は、設定した送信元と宛先の間で定期的にプローブを送信し、ネットワークパフォーマンスの傾向を時系列で追跡できます。これにより、アプリケーションのパフォーマンス低下の原因がネットワーク遅延にあるかどうかを判断できます。

他の選択肢について、Connection Troubleshoot は特定時点での接続性の診断に使用され、継続的な監視には適していません。IP Flow Verify は、NSG（ネットワークセキュリティグループ）ルールによるパケットの許可・拒否を検証する機能です。NSG 診断は NSG ルールの評価に使用され、Network Performance Monitor は非推奨となり現在は Connection Monitor に統合されています。

**主要機能の比較を以下に示します。**
| 機能 | 用途 | RTT 測定 |
| :--- | :--- | :--- |
| **Connection Monitor** | **継続的な接続監視とパフォーマンス測定** | **可能** |
| Connection Troubleshoot | 特定時点の接続診断 | 一時的に可能 |
| IP Flow Verify | NSG ルールによるパケット検証 | 不可 |

Connection Monitor を使用することで、VM1 と VM2 間の通信品質を継続的に監視し、パフォーマンス低下の傾向を早期に検出できます。

**リファレンス**
・[Azure Network Watcher](https://learn.microsoft.com/ja-jp/azure/network-watcher/network-watcher-monitoring-overview)
・[Connection Monitor](https://learn.microsoft.com/ja-jp/azure/network-watcher/connection-monitor-overview)
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)

---

### **問題 459. Azure サブスクリプションを保有しています。Linux ベースの Docker コンテナで Web アプリをデプロイする計画があります。次の要件を満たす Web アプリのデプロイソリューションを推奨する必要があります。カスタムドメイン名をサポートする、需要に基づいて自動的にスケールアウトする機能を提供する、管理作業を最小限に抑える、コストを最小限に抑える。どのソリューションを推奨しますか。（一つ選択）**

・Azure Container Instances
・**Azure App Service**
・Azure Virtual Machine Scale Sets
・Azure Functions

### **解答例**
・**Azure App Service**

### **解説**
この問題の最重要ポイントは、Docker コンテナベースのアプリケーションに対して、**カスタムドメイン、自動スケーリング、低管理負荷、コスト最適化**という 4 つの要件を同時に満たす Azure サービスを選択することです。

**Azure App Service** は、コンテナ化されたアプリケーションをホストするためのフルマネージド **PaaS**（Platform as a Service）です。カスタムドメインの設定が標準機能として提供され、自動スケーリング機能も組み込まれています。インフラストラクチャの管理が不要なため管理作業が最小限となり、従量課金モデルにより使用した分だけの支払いでコストを抑えられます。

Azure Container Instances は軽量なコンテナ実行環境ですが、カスタムドメインの直接サポートや自動スケーリング機能が限定的です。Azure Virtual Machine Scale Sets は仮想マシンレベルの管理が必要となり管理負荷が高くなります。Azure Functions はイベント駆動型のサーバーレスコンピューティングサービスで、継続的に実行される Web アプリケーションのホスティングには適していません。

**以下は各サービスの要件適合性の比較です。**
| サービス | カスタムドメイン | 自動スケール | 管理負荷 | コスト効率 |
| :--- | :--- | :--- | :--- | :--- |
| **App Service** | **標準対応** | **組み込み機能** | **低** | **高** |
| Container Instances | 制限あり | 制限あり | 低 | 中 |
| VM Scale Sets | 要構成 | 対応 | 高 | 低 |

Azure App Service の Linux コンテナサポートにより、既存の Docker イメージをそのまま利用でき、App Service Plan のスケーリング設定で CPU 使用率やメモリ使用量に基づく自動スケールアウトが実現できます。

**リファレンス**
・[Azure App Service](https://learn.microsoft.com/ja-jp/azure/app-service/overview)
・[自動スケーリング](https://learn.microsoft.com/ja-jp/azure/azure-monitor/autoscale/autoscale-overview)

---

### **問題 460. オンプレミスの VMware vSphere 環境に 600 台の仮想マシン (VM) がホストされています。これらすべての VM を Azure に移行する計画があり、Azure 上でホストするために必要なリソース情報の提供を求められています。オンプレミス環境でホストされているすべての VM は、Windows Server 2012 R2 以降または Red Hat Enterprise Linux 7.0 以降をベースとしています。初期移行評価を実施したところ、一部の仮想マシンが Azure に対して条件付きで準備完了というメッセージが表示されました。このメッセージの原因を特定する必要があります。一部の VM でこのメッセージが表示される理由として考えられるものはどれですか。（二つ選択）**

・**vCenter Server でオペレーティングシステムが Windows Server 2003 として構成されている**
・VM が BIOS ブートタイプで構成されている
・vCenter ユーザーが影響を受ける VM に対して十分な権限を持っていない
・**vCenter Server でオペレーティングシステムが Others として構成されている**
・VM のディスクサイズが 4TB 以上である

### **解答例**
・**vCenter Server でオペレーティングシステムが Windows Server 2003 として構成されている**
・**vCenter Server でオペレーティングシステムが Others として構成されている**

### **解説**
**Azure Migrate** を使用した VMware 環境からの移行評価では、仮想マシンの準備状態が「**条件付きで準備完了**」と表示される場合、特定の構成や設定に問題があることを示しています。

vCenter Server でオペレーティングシステムの種類が正しく識別されていない場合、Azure Migrate は正確な評価を実行できません。Windows Server 2003 のような古い OS として構成されている場合、Azure でのサポート対象外となるため条件付き準備完了となります。また、OS タイプが「Others」として構成されている場合も、Azure Migrate は適切なサイジングや互換性チェックを実行できないため、同様の警告が表示されます。

ブートタイプ（BIOS または UEFI）は、Azure Migrate の評価において条件付き準備完了の直接的な原因とはなりません。Azure は第 2 世代 VM (UEFI) と第 1 世代 VM (BIOS) の両方をサポートしており、移行時に適切に処理されます。vCenter ユーザーの権限不足は、VM 情報の収集に影響しますが、条件付き準備完了ではなく検出エラーとして表示されます。

| 状態 | 原因 | 対処方法 |
| :--- | :--- | :--- |
| **条件付き準備完了** | **OS タイプが不明確** | **vCenter で OS 情報を正確に設定** |
| **条件付き準備完了** | **サポート外 OS** | **OS アップグレードまたは再評価** |
| 検出エラー | 権限不足 | vCenter ユーザー権限の付与 |

**リファレンス**
・[Azure Migrate](https://learn.microsoft.com/ja-jp/azure/migrate/migrate-services-overview)
・[VMware vSphere](https://learn.microsoft.com/ja-jp/azure/migrate/tutorial-discover-vmware)

---

### **問題 461. Azure サブスクリプションに以下のリソースが含まれています。VM1 と VM2 は Web サイトを実行しており、LB1 は VM1 と VM2 へのリクエストを負荷分散するように構成されています。LB1 には正常性プローブが構成されており、プロトコルは HTTP、ポートは 80、パスは「/Temp/Probe1.htm」に設定されています。VM1 と VM2 の Web サイトはポート 8080 で実行され、物理パスは「C:\\inetpub\\wwwroot\\SiteA」です。正常性プローブが正しく機能するようにする必要があります。どうすればよいですか。（一つ選択）**

| リソース名 | 種類 | 詳細 |
| :--- | :--- | :--- |
| **LB1** | Load Balancer | バックエンドプールに VM1 と VM2 を含む |
| **VM1** | 仮想マシン | Web サイトをポート 8080 で実行 |
| **VM2** | 仮想マシン | Web サイトをポート 8080 で実行 |

・VM1 と VM2 で、C:\\inetpub\\wwwroot\\SiteA\\Temp フォルダに probe1.htm という名前のファイルを作成する
・**LB1 で、正常性プローブのポートを 8080 に変更する**
・LB1 で、正常性プローブの異常しきい値を 3 に変更する
・VM1 と VM2 で、C:\\inetpub\\wwwroot\\Temp フォルダに probe1.htm という名前のファイルを作成する

### **解答例**
・**LB1 で、正常性プローブのポートを 8080 に変更する**

### **解説**
**Azure Load Balancer** の正常性プローブは、バックエンドプール内の仮想マシンが正常に動作しているかを確認するために使用されます。プローブが失敗すると、Load Balancer はそのインスタンスへのトラフィック送信を停止します。

この問題では、VM1 と VM2 の Web サイトは**ポート 8080** で実行されていますが、正常性プローブは**ポート 80** に対して構成されています。プローブパスは「/Temp/Probe1.htm」で、物理パスは「C:\\inetpub\\wwwroot\\SiteA」であるため、完全なファイルパスは「C:\\inetpub\\wwwroot\\SiteA\\Temp\\Probe1.htm」となります。

正常性プローブを機能させるには、**プローブのポート番号を Web サイトが実際にリッスンしているポート 8080 に変更する**必要があります。ポート 80 では Web サイトが応答しないため、プローブは常に失敗し、Load Balancer はトラフィックを転送しません。

| 項目 | 現在の設定 | 必要な設定 |
| :--- | :--- | :--- |
| **プローブポート** | 80 | **8080** |
| Web サイトポート | 8080 | 8080 |
| プローブパス | /Temp/Probe1.htm | /Temp/Probe1.htm |

異常しきい値の変更やファイルの作成場所の変更では、ポート番号の不一致という根本的な問題は解決されません。正常性プローブが正しく機能するためには、プローブが Web サイトと同じポートで通信する必要があります。

**リファレンス**
・[Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
・[Health Probe](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-custom-probe-overview)
・[Backend Pool](https://learn.microsoft.com/ja-jp/azure/load-balancer/backend-pool-management)

---

### **問題 462. Azure Storage アカウントを作成します。このストレージアカウントは、最低 2 つの可用性ゾーンにデータを保存し、高可用性を提供する必要があります。使用すべきストレージ冗長性オプションはどれですか。（一つ選択）**

・ローカル冗長ストレージ (LRS)
・**ゾーン冗長ストレージ (ZRS)**
・geo 冗長ストレージ (GRS)
・geo ゾーン冗長ストレージ (GZRS)

### **解答例**
・**ゾーン冗長ストレージ (ZRS)**

### **解説**
この問題の最重要ポイントは、**可用性ゾーン（Availability Zones）**を利用したデータ保護の要件を満たすストレージ冗長性オプションを選択することです。

**ゾーン冗長ストレージ (ZRS)** は、プライマリリージョン内の **3 つの可用性ゾーン**にデータを同期的にレプリケートします。各可用性ゾーンは独立した電源、冷却、ネットワークを持つ物理的に分離されたデータセンターです。ZRS を使用することで、1 つまたは 2 つの可用性ゾーンで障害が発生してもデータへのアクセスが維持され、高可用性が実現されます。

ローカル冗長ストレージ (LRS) は、単一のデータセンター内でのみデータを 3 回レプリケートするため、可用性ゾーン間での冗長性は提供されません。geo 冗長ストレージ (GRS) は、プライマリリージョンとセカンダリリージョン間でデータをレプリケートしますが、プライマリリージョン内では LRS を使用するため、可用性ゾーン間の冗長性は提供されません。geo ゾーン冗長ストレージ (GZRS) は、プライマリリージョンで ZRS を使用し、セカンダリリージョンにもレプリケートしますが、問題の要件では地理的な冗長性は求められていません。

| 冗長性オプション | 可用性ゾーン対応 | リージョン間レプリケート |
| :--- | :--- | :--- |
| LRS | 非対応 | なし |
| **ZRS** | **対応（3 ゾーン）** | なし |
| GRS | 非対応 | あり |
| GZRS | 対応（3 ゾーン） | あり |

**リファレンス**
・[Azure Storage の冗長性](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-redundancy)
・[ゾーン冗長ストレージ (ZRS)](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-redundancy#zone-redundant-storage)

---

### **問題 463. あなたは Best For You Organics 社の Azure 管理者です。同社ではリソースのデプロイに ARM テンプレートを使用しています。ローカルテンプレートのデプロイ時に配列をインラインパラメータとして渡します。どうすればよいですか。（一つ選択）**

・**デプロイコマンドの --parameters スイッチで配列値を指定する**
・テンプレートファイルを修正して配列値を含める
・配列値を含む別のパラメータファイルを作成する
・--template-uri スイッチを使用して配列値を渡す

### **解答例**
・**デプロイコマンドの --parameters スイッチで配列値を指定する**

### **解説**
ARM テンプレートのデプロイ時に配列をインラインパラメータとして渡す場合、Azure CLI または Azure PowerShell のデプロイコマンドで **--parameters** スイッチ（Azure CLI の場合）または **TemplateParameterObject** パラメータ（PowerShell の場合）を使用します。

Azure CLI では、配列値を **JSON 形式**で直接指定できます。例えば、以下のようなコマンドで配列を渡すことができます。

`az deployment group create --resource-group hogehoge-rg --template-file template.json --parameters arrayParam='["value1","value2","value3"]'`

この方法により、テンプレートファイル自体を変更することなく、デプロイ時に動的に配列値を指定できます。インラインパラメータは、異なる環境や設定で同じテンプレートを再利用する際に特に有効です。

テンプレートファイルに直接配列値を含める方法は、値が固定されている場合には有効ですが、インラインパラメータとして渡すという要件には適合しません。別のパラメータファイルを作成する方法も有効ですが、これはインラインではなくファイルベースのアプローチとなります。

| 方法 | 特徴 | 用途 |
| :--- | :--- | :--- |
| **インラインパラメータ** | **コマンドラインで直接指定** | **一時的な値や簡単なデプロイ** |
| パラメータファイル | JSON 形式の別ファイル | 複雑な設定や再利用可能な構成 |
| テンプレート内定義 | テンプレートに直接記述 | 固定値や規定値の設定 |

**リファレンス**
・[ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)
・[Azure CLI](https://learn.microsoft.com/ja-jp/cli/azure/deployment/group)
・[Template Parameters](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/parameter-files)

---

### **問題 464. Azure サブスクリプション内のリソースグループ「RG-Prod」には、ARM テンプレートを使用してデプロイされた複数のリソースが含まれています。監査要件として、このリソースグループ内のリソースがいつ作成されたかを確認します。Azure Portal のサブスクリプションブレードから対象サブスクリプションを選択し、「プログラムによるデプロイ」オプションを使用してリソースの作成日時を表示できますか。（一つ選択）**

・**いいえ、この方法ではリソースの作成日時は確認できない**
・はい、プログラムによるデプロイから作成日時を確認できる
・はい、ただしリソースグループレベルのロックを解除する必要がある
・いいえ、Azure CLI を使用しないと作成日時は取得できない

### **解答例**
・**いいえ、この方法ではリソースの作成日時は確認できない**

### **解説**
「プログラムによるデプロイ」は、Azure Marketplace からのリソースデプロイをプログラム API で実行する際の有効化設定であり、既存リソースの作成日時を確認する機能ではありません。

リソースの作成日時を確認する正しい方法は、リソースグループブレードから「**デプロイ**」または「**アクティビティログ**」を参照することです。デプロイ履歴には、ARM テンプレートによるデプロイの実行日時、使用されたテンプレート、デプロイ結果が記録されています。アクティビティログでは、リソースの作成、変更、削除などの操作履歴をタイムスタンプ付きで確認できます。

また、個別リソースの作成日時は、各リソースのプロパティページや JSON 表示から確認することも可能です。Azure CLI や PowerShell を使用する場合は、**az resource show** コマンドや **Get-AzResource** コマンドレットでリソースのメタデータを取得できます。

| 確認方法 | 取得できる情報 | 用途 |
| :--- | :--- | :--- |
| **デプロイ履歴** | **テンプレートデプロイの実行日時と結果** | **デプロイ単位の監査** |
| **アクティビティログ** | リソース操作の詳細履歴 | 操作レベルの監査 |
| リソースプロパティ | 個別リソースの作成日時 | リソース単位の確認 |

**リファレンス**
・[ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)

---

### **問題 465. Azure 仮想マシンで 10 分以内にシステムイベントログに 5 つ以上のエラーイベントが記録された場合にアラートを発報する仕組みを実装します。次の解決策は要件を満たしますか。「Azure Storage Account を作成して Shared Access Signature (SAS) を構成し、Microsoft Monitoring Agent を仮想マシンにインストールします。Azure Monitor でアラートを作成し、ソースとして Storage Account を指定します。」（一つ選択）**

・**いいえ**
・はい

### **解答例**
・**いいえ**

### **解説**
この解決策は要件を満たしません。Azure 仮想マシンのイベントログを監視してアラートを発報するには、**Log Analytics Workspace** と **Azure Monitor Agent** を使用する必要があります。

提案された解決策の問題点は、Storage Account をログの収集先として使用している点です。Storage Account は単なるデータストレージであり、ログデータの構造化やクエリ実行、アラート条件の評価機能を持ちません。また、Microsoft Monitoring Agent (MMA) は旧世代のエージェントであり、現在は **Azure Monitor Agent (AMA)** への移行が推奨されています。

正しい実装手順は以下の通りです。まず **Log Analytics Workspace** を作成し、**Azure Monitor Agent** または Log Analytics Agent を仮想マシンにインストールします。次に**データ収集ルール (DCR)** を構成して Windows イベントログを収集対象に指定します。最後に **Azure Monitor で Log Analytics をソースとするログエリアラートルール**を作成し、KQL クエリで 10 分間に 5 つ以上のエラーイベントを検出する条件を設定します。

| 項目 | 提案された方法 | 正しい方法 |
| :--- | :--- | :--- |
| ログ収集先 | Storage Account | **Log Analytics Workspace** |
| エージェント | Microsoft Monitoring Agent | **Azure Monitor Agent** |
| アラート作成 | Storage Account ベース | **Log Analytics クエリベース** |

Log Analytics Workspace は収集したログデータを **Kusto Query Language (KQL)** で分析でき、複雑な条件でのアラート設定が可能です。Storage Account ではこのような高度なログ分析とリアルタイムアラートは実現できません。

**リファレンス**
・[Azure Monitor Agent](https://learn.microsoft.com/ja-jp/azure/azure-monitor/agents/azure-monitor-agent-overview)
・[Log Analytics Workspace](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/log-analytics-workspace-overview)
・[データ収集ルール (DCR)](https://learn.microsoft.com/ja-jp/azure/azure-monitor/essentials/data-collection-rule-overview)

---

### **問題 466. Azure サブスクリプションがあります。画像を保存するために storage1 という名前のストレージアカウントを作成する予定です。画像を新しいストレージアカウントにレプリケートする必要があります。storage1 に必要な要件を 3 つ選択してください。（該当するものをすべて選択）**

・**Standard 汎用 v2 ストレージアカウント**
・**Blob バージョン管理**
・**コンテナー**
・Premium Block ストレージアカウント
・ファイル共有

### **解答例**
・**Standard 汎用 v2 ストレージアカウント**
・**Blob バージョン管理**
・**コンテナー**

### **解説**
Azure ストレージアカウント間で画像 (Blob) をレプリケートする場合、**オブジェクトレプリケーション機能**を使用します。この機能を利用するための必須要件を理解することが重要です。

**オブジェクトレプリケーション**は、ソースストレージアカウントの **Blob コンテナー**から、宛先ストレージアカウントの **Blob コンテナー**へ、ブロック Blob を非同期的にコピーする機能です。この機能を使用するには、ソースアカウントで **Blob バージョン管理**が有効化されている必要があります。Blob バージョン管理により、各 Blob の変更履歴が保持され、レプリケーション時の整合性が保証されます。

画像を格納するには Blob ストレージを使用するため、**コンテナー**が必要です。コンテナーは Blob を論理的にグループ化する単位であり、オブジェクトレプリケーションではコンテナー単位でレプリケーションルールを設定します。

**Standard 汎用 v2 ストレージアカウント**は、オブジェクトレプリケーション機能をサポートする必須のアカウントタイプです。Premium Block ストレージアカウントではこの機能はサポートされていません。

ファイル共有は Azure Files サービスで使用される機能であり、Blob ストレージのレプリケーションには不要です。

| 要件 | 必要性 | 理由 |
| :--- | :--- | :--- |
| **Standard 汎用 v2** | **必須** | **オブジェクトレプリケーション対応** |
| **Blob バージョン管理** | **必須** | **レプリケーション整合性確保** |
| **コンテナー** | **必須** | **Blob 格納とレプリケーション単位** |

**リファレンス**
・[オブジェクトレプリケーション](https://learn.microsoft.com/ja-jp/azure/storage/blobs/object-replication-overview)

---

### **問題 467. Azure サブスクリプションに、Windows Server を実行する 4 台の仮想マシンでホストされている ASP.NET アプリケーションがあります。LB1 という名前のロードバランサーが仮想マシンへのリクエストを負荷分散しています。アプリケーションへのすべてのリクエストで、サイトユーザーが同じ Web サーバーに接続されるようにします。実行する必要があるアクションはどれですか。（二つ選択）**

・**セッション永続化を Client IP に設定する**
・負荷分散規則のアイドルタイムアウトを 20 分に設定する
・セッション永続化を None に設定する
・正常性プローブの間隔を 15 秒に設定する
・**セッション永続化を Client IP and protocol に設定する**

### **解答例**
・**セッション永続化を Client IP に設定する**
・**セッション永続化を Client IP and protocol に設定する**

### **解説**
Azure Load Balancer でユーザーセッションを同一のバックエンドサーバーに維持するには、**セッション永続化 (Session Affinity)** の設定が必要です。この機能により、特定のクライアントからのリクエストが常に同じ仮想マシンにルーティングされます。

Azure Load Balancer のセッション永続化には 3 つのモードがあります。**None** は既定の設定で、同じクライアントからの連続するリクエストが任意の仮想マシンで処理されます。**Client IP** モードでは、同じクライアント IP アドレスからのリクエストが同じ仮想マシンで処理されます。**Client IP and protocol** モードでは、同じクライアント IP アドレスとプロトコルの組み合わせからのリクエストが同じ仮想マシンで処理されます。

本問では「同じ Web サーバーに接続される」という要件を満たすため、**Client IP** または **Client IP and protocol** のいずれかを設定します。両方とも要件を満たす有効な選択肢です。None は要件に反するため不適切です。アイドルタイムアウトや正常性プローブの設定は、セッション永続化とは異なる目的で使用される機能です。

| モード | 動作 | 用途 |
| :--- | :--- | :--- |
| None | リクエストごとに異なる VM に分散 | ステートレスアプリケーション |
| **Client IP** | **同一 IP からのリクエストを同一 VM へ** | **セッション維持が必要な場合** |
| **Client IP and protocol** | **同一 IP とプロトコルで同一 VM へ** | **より厳密なセッション管理** |

**リファレンス**
・[Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
・[セッション永続化](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-distribution-mode)
・[Load Balancing Rule](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-multivip-overview)

---

### **問題 468. あなたの会社では、Azure AD 条件付きアクセスポリシーを実装します。このポリシーでは、Global Administrators グループのメンバーが信頼されていない場所から Azure AD に接続する際に、多要素認証と Azure AD 参加済みデバイスの使用を要求するように構成する必要があります。解決策として、多要素認証ページにアクセスしてユーザー設定を変更します。この解決策は要件を満たしていますか？（一つ選択）**

・**いいえ、条件付きアクセスポリシーの構成が必要です**
・はい、多要素認証の設定で要件を満たせます
・いいえ、Azure AD Identity Protection の構成が必要です
・はい、ユーザー設定の変更で十分です

### **解答例**
・**いいえ、条件付きアクセスポリシーの構成が必要です**

### **解説**
この問題の要件は、**特定の条件（信頼されていない場所からのアクセス）**に基づいて、**特定のグループ（Global Administrators）**に対して**複数の制御（多要素認証とデバイス要件）**を適用することです。

多要素認証ページでのユーザー設定変更では、この要件を満たすことができません。理由は以下の通りです。

多要素認証ページでは、ユーザー単位で MFA を有効化できますが、**場所ベースの条件やデバイス要件を設定することはできません**。また、グループ単位での一括管理も困難です。

**条件付きアクセスポリシー**を使用することで、以下の要件をすべて満たすことができます。割り当て条件として特定のユーザーグループ (Global Administrators) を指定し、信頼されていない場所からのアクセスという条件を設定できます。アクセス制御として多要素認証の要求と Azure AD 参加済みデバイスの要求の両方を構成できます。

| 設定項目 | 多要素認証ページ | 条件付きアクセス |
| :--- | :--- | :--- |
| **場所ベースの制御** | **不可** | **可能** |
| **デバイス要件** | **不可** | **可能** |
| **グループベースの適用** | 困難 | **容易** |

条件付きアクセスポリシーは、Azure AD の [セキュリティ] セクションから構成します。ポリシーでは、割り当て条件（ユーザー、場所、デバイスプラットフォームなど）とアクセス制御（MFA 要求、準拠デバイス要求など）を組み合わせて、きめ細かなアクセス管理を実現できます。

したがって、多要素認証ページでのユーザー設定変更では要件を満たせず、条件付きアクセスポリシーの構成が必要です。

**リファレンス**
・[Azure AD 条件付きアクセス](https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/overview)
・[Multi-Factor Authentication (MFA)](https://learn.microsoft.com/ja-jp/entra/identity/authentication/concept-mfa-howitworks)

---

### **問題 469. 仮想マシン VM1 がネットワークセキュリティグループ NSG1 に関連付けられています。NSG1 には以下のアウトバウンドセキュリティ規則が設定されています。Rule1: 優先度 900、名前 BlockInternet、ポート 80、プロトコル TCP、送信元 Any、送信先 Any、アクション Block。Rule2: 優先度 1000、名前 AllowInternet、ポート 80、プロトコル TCP、送信元 Any、送信先 Any、アクション Allow。VM1 からインターネットへのポート 80 でのアクセスを許可します。どの操作を実行しますか。（一つ選択）**

・Rule2 の送信元を変更する
・Rule1 のプロトコルを UDP に変更する
・**Rule2 の優先度を変更する**
・Rule1 のアクションを Allow に変更する

### **解答例**
・**Rule2 の優先度を変更する**

### **解説**
Network Security Group (NSG) のセキュリティ規則は**優先度の数値が小さいものから順に評価**され、最初に一致した規則が適用されます。この問題では、Rule1 (優先度 900) が Rule2 (優先度 1000) より先に評価されるため、ポート 80 へのトラフィックは Rule1 によってブロックされます。

VM1 からインターネットへのポート 80 でのアクセスを許可するには、**Rule2 の優先度を 900 より小さい値（例えば 800 や 850）に変更する**必要があります。これにより Rule2 が先に評価され、トラフィックが許可されます。

NSG の規則評価における重要なポイントを以下の表にまとめます。

| 項目 | 説明 |
| :--- | :--- |
| **優先度の範囲** | 100 から 4096 の整数値 |
| **評価順序** | **数値が小さい規則から順に評価** |
| **処理の終了** | **最初に一致した規則で評価終了** |

他の選択肢が不適切な理由は以下の通りです。Rule2 の送信元を変更しても Rule1 が先に評価されるため効果がありません。Rule1 のプロトコル変更は問題の要件であるポート 80 の TCP 通信に影響しません。Rule1 のアクションを Allow に変更すると両方の規則が許可となり要件は満たせますが、Rule2 の存在意義がなくなります。

**リファレンス**
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[アウトバウンド規則](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview#security-rules)

---

### **問題 470. Azure サブスクリプションを運用しています。ユーザーは自宅またはクライアント先からサブスクリプション内のリソースにアクセスします。自宅からのユーザーはポイント対サイト VPN を使用して Azure リソースにアクセスし、クライアント先のユーザーはサイト間 VPN を使用して Azure リソースにアクセスします。Windows Server 2016 を実行する複数の Azure 仮想マシン上で稼働する基幹業務アプリケーション App1 があります。App1 への接続をすべての仮想マシンに分散させます。この要件を満たすために使用できる Azure サービスはどれですか。（二つ選択）**

・**Azure Application Gateway**
・Azure Front Door
・Traffic Manager
・**Internal Load Balancer**
・Public Load Balancer

### **解答例**
・**Internal Load Balancer**
・**Azure Application Gateway**

### **解説**
VPN 経由でアクセスするプライベートネットワーク内の仮想マシンへの負荷分散が必要です。ポイント対サイト VPN とサイト間 VPN はいずれも Azure 仮想ネットワーク内のプライベート IP アドレス空間への接続を確立するため、パブリック IP アドレスを使用する負荷分散ソリューションは適切ではありません。

**Internal Load Balancer** は Azure 仮想ネットワーク内のプライベート IP アドレスを使用して負荷分散を行う Layer 4 (トランスポート層) のサービスです。VPN 接続されたクライアントから仮想ネットワーク内の複数の仮想マシンへトラフィックを分散できます。

**Azure Application Gateway** は Layer 7 (アプリケーション層) のロードバランサーで、プライベート IP アドレスをフロントエンドとして構成できます。HTTP や HTTPS トラフィックの負荷分散に加え、URL パスベースのルーティングや SSL 終端などの高度な機能を提供します。

Public Load Balancer はインターネットからのトラフィックを分散するためパブリック IP アドレスを使用します。VPN 経由のプライベート接続には適しません。Traffic Manager は DNS ベースのグローバルトラフィック管理サービスで、異なるリージョン間での負荷分散に使用されますが、単一リージョン内の仮想マシン間での負荷分散には過剰です。Azure Front Door はグローバルな HTTP/HTTPS ロードバランサーで CDN 機能を含みますが、プライベートネットワーク内の負荷分散には適していません。

| サービス | 動作層 | 用途 |
| :--- | :--- | :--- |
| **Internal Load Balancer** | **Layer 4** | **VNet 内の負荷分散** |
| **Azure Application Gateway** | **Layer 7** | **VNet 内の HTTP/HTTPS 負荷分散** |
| Public Load Balancer | Layer 4 | インターネット向け負荷分散 |

**リファレンス**
・[Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
・[Azure Application Gateway](https://learn.microsoft.com/ja-jp/azure/application-gateway/overview)
・[Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)

---

### **問題 471. ある Azure サブスクリプションの管理者は、サブスクリプション内に複数のネットワークセキュリティグループ (NSG) を作成することを計画しています。NSG の作成時に、仮想ネットワーク間の TCP ポート 8080 が自動的にブロックされるようにします。解決策として、組み込みポリシー定義をサブスクリプションに割り当てます。これは目標を達成していますか。（一つ選択）**

・**いいえ**
・はい

### **解答例**
・**いいえ**

### **解説**
**Azure Policy** の組み込みポリシー定義をサブスクリプションに割り当てても、NSG 作成時に特定のポート（TCP ポート 8080）を自動的にブロックすることはできません。Azure Policy は主にリソースのコンプライアンス評価と強制を行うものであり、NSG のセキュリティルールを自動的に構成する機能は提供していません。

Azure Policy は、リソースが組織の標準や規制要件に準拠しているかを評価し、非準拠のリソースを特定したり、新規リソースの作成を拒否したりすることができます。しかし、NSG に特定のセキュリティルールを自動的に追加する機能はありません。

この要件を実現するには、以下のような代替アプローチが必要です。**Azure Resource Manager (ARM) テンプレートや Bicep テンプレート**を使用して、事前定義されたセキュリティルールを含む NSG を展開する方法、**Azure Automation や Azure Functions** を使用して、NSG 作成後に自動的にセキュリティルールを追加するスクリプトを実行する方法、**Azure Blueprints** を使用して、標準化された NSG 構成を含むリソースグループをデプロイする方法などが考えられます。

| アプローチ | 説明 | 自動化レベル |
| :--- | :--- | :--- |
| **Azure Policy** | **コンプライアンス評価と強制** | **リソース作成の制御のみ** |
| **ARM テンプレート** | 事前定義された構成でデプロイ | **デプロイ時に完全自動化** |
| Azure Automation | スクリプトによる自動構成 | 作成後の自動構成 |

**リファレンス**
・[Azure Policy](https://learn.microsoft.com/ja-jp/azure/governance/policy/overview)
・[Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
・[ARM Template](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/templates/overview)

---

### **問題 472. あなたの会社は、4 台の Azure 仮想マシンでアプリケーションをホストする予定です。単一の Azure データセンターで障害が発生した場合でも、少なくとも 2 台の仮想マシンが利用可能であることを保証します。仮想マシンに対してどの可用性オプションを選択しますか。（一つ選択）**

・Virtual Machine Scale Sets
・**可用性ゾーン**
・可用性セット
・近接通信配置グループ

### **解答例**
・**可用性ゾーン**

### **解説**
単一の Azure データセンターの障害から保護するには、**可用性ゾーン**を使用します。可用性ゾーンは、同一の Azure リージョン内で物理的に分離された複数のデータセンター（ゾーン）に仮想マシンを分散配置する機能です。各ゾーンは独立した電源、冷却システム、ネットワークを持つため、1 つのゾーンで障害が発生しても他のゾーンは影響を受けません。

4 台の仮想マシンを複数の可用性ゾーンに分散配置することで、1 つのデータセンター全体が停止しても、他のゾーンに配置された仮想マシンは稼働を継続できます。これにより、少なくとも 2 台の仮想マシンの可用性を保証できます。

可用性セットは同一データセンター内での障害ドメインと更新ドメインによる保護を提供しますが、データセンター全体の障害には対応できません。Virtual Machine Scale Sets は自動スケーリング機能を提供しますが、それ自体は複数データセンター間の冗長性を保証しません。近接通信配置グループは低レイテンシを実現するために仮想マシンを物理的に近接配置する機能であり、可用性向上には寄与しません。

| オプション | 保護範囲 | データセンター障害対応 |
| :--- | :--- | :--- |
| **可用性ゾーン** | **複数データセンター** | **対応可能** |
| 可用性セット | 単一データセンター内 | 対応不可 |
| Scale Sets | スケーリング機能 | 構成次第 |

**リファレンス**
・[Availability Zone](https://learn.microsoft.com/ja-jp/azure/reliability/availability-zones-overview)
・[Availability Set](https://learn.microsoft.com/ja-jp/azure/virtual-machines/availability-set-overview)
・[Virtual Machine Scale Set](https://learn.microsoft.com/ja-jp/azure/virtual-machine-scale-sets/overview)

---

### **問題 473. Azure Active Directory (Azure AD) の Basic テナントに関連付けられた Azure サブスクリプションを作成しました。任意のユーザーが管理者ロールをアクティブ化したときに電子メール通知を受信する必要があります。どのような対応を行いますか。（一つ選択）**

・**Azure AD Premium P2 を購入し、Azure AD Privileged Identity Management を構成する**
・Azure AD Premium P1 を購入し、Azure AD Identity Protection を有効化する
・Enterprise Mobility + Security E5 を購入し、Azure Monitor でカスタムアラートルールを作成する
・Enterprise Mobility + Security E3 を購入し、条件付きアクセスポリシーを構成する

### **解答例**
・**Azure AD Premium P2 を購入し、Azure AD Privileged Identity Management を構成する**

### **解説**
管理者ロールのアクティブ化時に電子メール通知を受信するには、**Azure AD Privileged Identity Management (PIM)** が必要です。PIM は **Azure AD Premium P2** ライセンスに含まれる機能で、特権ロールの割り当てとアクティブ化を管理し、監視できます。

PIM を使用すると、管理者ロールのアクティブ化時に通知を送信するように構成できます。通知設定では、ロールがアクティブ化されたとき、承認されたとき、または拒否されたときに、指定した受信者に電子メールを送信できます。これにより、特権アクセスの使用状況をリアルタイムで監視し、セキュリティインシデントに迅速に対応できます。

Azure AD Identity Protection は、リスクベースの条件付きアクセスポリシーを提供しますが、ロールアクティブ化の通知機能は含まれません。条件付きアクセスポリシーは、サインイン時のアクセス制御を行う機能であり、ロールアクティブ化の通知には対応していません。Azure Monitor のカスタムアラートは、リソースレベルの監視に使用されますが、Azure AD のロールアクティブ化イベントの通知には適していません。

| ライセンス | 主な機能 | ロールアクティブ化通知 |
| :--- | :--- | :--- |
| **Azure AD Premium P2** | **PIM, Identity Protection** | **対応** |
| Azure AD Premium P1 | 条件付きアクセス、Identity Protection 基本機能 | 非対応 |
| Azure AD Basic | 基本的なディレクトリ機能 | 非対応 |

| 機能 | 用途 | 通知機能 |
| :--- | :--- | :--- |
| **PIM** | **特権ロール管理とアクティブ化制御** | **あり** |
| Identity Protection | リスク検出と条件付きアクセス | なし |
| 条件付きアクセス | サインイン時のアクセス制御 | なし |

**リファレンス**
・[Azure AD Privileged Identity Management](https://learn.microsoft.com/ja-jp/entra/id-governance/privileged-identity-management/pim-configure)
・[Azure AD Premium P2](https://www.microsoft.com/ja-jp/security/business/identity-access-management/microsoft-entra-id)
・[条件付きアクセスポリシー](https://learn.microsoft.com/ja-jp/entra/identity/conditional-access/overview)

---

### **問題 474. Azure サブスクリプションに、ポリシーベースの仮想ネットワークゲートウェイ GW1 と仮想ネットワーク VNet1 があります。オンプレミスのコンピューターから VNet1 へのポイント対サイト接続を構成します。実行する必要がある 2 つのアクションはどれですか。正解はそれぞれソリューションの一部を示しています。（二つ選択）**

・VNet1 にサービスエンドポイントを追加する
・**ルートベースの仮想ネットワークゲートウェイを作成する**
・GW1 に接続を追加する
・**GW1 を削除する**
・VNet1 に NAT ゲートウェイを関連付ける

### **解答例**
・**ルートベースの仮想ネットワークゲートウェイを作成する**
・**GW1 を削除する**

### **解説**
**ポイント対サイト (Point-to-Site: P2S) VPN** 接続では、個々のクライアントコンピューターから仮想ネットワークへの安全な接続を確立できます。この接続タイプは**ルートベースの VPN ゲートウェイでのみサポート**されており、ポリシーベースのゲートウェイでは利用できません。

現在の環境では GW1 がポリシーベースのゲートウェイとして構成されているため、P2S 接続を実現するには**既存のゲートウェイを削除し、新たにルートベースのゲートウェイを作成**する必要があります。Azure では仮想ネットワークゲートウェイのタイプ（ポリシーベース / ルートベース）を直接変更することはできないため、削除と再作成が必須の手順となります。

サービスエンドポイントは Azure サービスへのプライベート接続を提供する機能であり、P2S VPN 接続とは無関係です。また、GW1 への接続追加や NAT ゲートウェイの関連付けも、ポリシーベースゲートウェイの制約を解決できません。

| 項目 | ポリシーベース | ルートベース |
| :--- | :--- | :--- |
| **P2S 接続** | **非対応** | **対応** |
| S2S 接続 | 対応 | 対応 |
| タイプ変更 | 不可（削除と再作成が必要） | 不可 |

ルートベースゲートウェイは、トラフィックを IP ルーティングテーブルに基づいて転送するため、P2S、サイト間 (Site-to-Site: S2S)、VNet 間接続など、より柔軟な接続シナリオに対応できます。

**リファレンス**
・[VPN Gateway](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/vpn-gateway-about-vpngateways)
・[ポイント対サイト接続](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/point-to-site-about)
・[ルートベース VPN](https://learn.microsoft.com/ja-jp/azure/vpn-gateway/vpn-gateway-connect-multiple-policybased-rm-ps)




ご提示いただいたソース資料（AZ-104試験問題集の抜粋）に基づき、**問題475から問題500までの全文**を一文字も省略することなく、正確に出力します。

---

### **問題 475. Azure で稼働する Web アプリケーション hogehoge の可用性を監視します。複数ステップの Web テストを使用して、アプリケーションの動作を継続的に検証する必要があります。Azure Monitor で使用すべき機能を選択してください。（一つ選択）**

*   Application Insights の可用性テスト
*   Azure Service Health のサービス正常性アラート
*   Diagnostics settings のログ収集
*   Azure Monitor のメトリックアラート

#### **解答例**
*   **Application Insights の可用性テスト**

#### **解説**
**複数ステップの Web テストによる可用性監視を実現するには、Application Insights の可用性テスト機能を使用します。** この機能は、世界中の複数の地点から定期的に Web アプリケーションにアクセスし、応答時間や可用性を測定します。

Application Insights は、Web アプリケーションのパフォーマンス管理（APM）を提供する Azure Monitor の機能です。可用性テストでは、単一 URL への ping テストに加えて、**複数の HTTP リクエストを順次実行する複数ステップテストを構成できます。** これにより、ログイン処理やフォーム送信など、実際のユーザー操作をシミュレートした監視が可能になります。

Azure Service Health は、Azure サービス自体の正常性を監視するサービスであり、個別のアプリケーション監視には使用しません。メトリックアラートは数値データの閾値監視に適していますが、複数ステップの Web テストには対応していません。Diagnostics settings は診断ログの収集と転送を設定する機能であり、能動的な可用性テストは実行できません。

| 機能 | 用途 | 複数ステップテスト対応 |
| :--- | :--- | :--- |
| Application Insights 可用性テスト | アプリケーション可用性監視 | **対応** |
| Azure Service Health | Azure サービス正常性確認 | 非対応 |
| メトリックアラート | 数値データの閾値監視 | 非対応 |

#### **リファレンス**
*   [Application Insights](https://learn.microsoft.com/ja-jp/azure/azure-monitor/app/app-insights-overview)
*   [Azure Monitor](https://learn.microsoft.com/ja-jp/azure/azure-monitor/overview)

---

### **問題 476. Azure サブスクリプションを所有しています。次の表に示す Azure Container Instances をデプロイする予定です。同一のコンテナーグループにデプロイできるインスタンスの組み合わせはどれですか。（一つ選択）**

| インスタンス名 | OS | リージョン |
| :--- | :--- | :--- |
| Instance1 | Linux | 東日本 |
| Instance2 | Linux | 東日本 |
| Instance3 | Windows | 東日本 |
| Instance4 | Linux | 西日本 |

*   Instance1 と Instance2 のみ
*   Instance1 のみ
*   Instance3 と Instance4 のみ
*   Instance1、Instance2、Instance3 のみ

#### **解答例**
*   **Instance1 と Instance2 のみ**

#### **解説**
Azure Container Instances のコンテナーグループは、同一ホスト上にスケジュールされる複数のコンテナーのコレクションです。コンテナーグループ内のコンテナーは、ライフサイクル、リソース、ローカルネットワーク、ストレージボリュームを共有します。

コンテナーグループに複数のコンテナーをデプロイする場合、以下の制約があります。

まず、**すべてのコンテナーは同一の OS タイプである必要があります。** Linux コンテナーと Windows コンテナーを同一のコンテナーグループに混在させることはできません。Instance3 は Windows コンテナーであるため、Linux コンテナーである Instance1 や Instance2 と同一グループにデプロイできません。

次に、**すべてのコンテナーは同一のリージョンにデプロイする必要があります。** Instance4 は西日本リージョンに配置されるため、東日本リージョンの Instance1 や Instance2 と同一グループにはできません。

したがって、**Instance1 と Instance2 は両方とも Linux コンテナーで東日本リージョンに配置されるため、同一のコンテナーグループにデプロイ可能です。**

| 要件 | 説明 |
| :--- | :--- |
| OS タイプの統一 | 同一グループ内のすべてのコンテナーは同じ OS タイプが必須 |
| リージョンの統一 | 同一グループ内のすべてのコンテナーは同じリージョンが必須 |
| リソース共有 | グループ内でネットワーク、ストレージ、ライフサイクルを共有 |

#### **リファレンス**
*   [Azure Container Instances](https://learn.microsoft.com/ja-jp/azure/container-instances/container-instances-container-groups)
*   [Azure Region](https://learn.microsoft.com/ja-jp/azure/reliability/availability-zones-overview)

---

### **問題 477. あなたは、contoso.onmicrosoft.com という名前の Microsoft Entra ID テナントを含む Azure サブスクリプションを管理しています。User1 が新しい Microsoft Entra ID テナント external.contoso.onmicrosoft.com を作成しました。あなたは、external.contoso.onmicrosoft.com に新しいユーザーアカウントを作成する必要があります。解決策として、User1 にユーザーアカウントの作成を指示します。この解決策は要件を満たしていますか。（一つ選択）**

*   いいえ、User1 には適切な権限が割り当てられていない可能性があるため要件を満たさない
*   はい、User1 は新しいテナントの作成者であるため自動的にグローバル管理者ロールが割り当てられている
*   いいえ、別のテナントでユーザーアカウントを作成するには元のテナントの所有者権限が必要である
*   はい、ただし User1 に特権ロール管理者ロールを追加で割り当てる必要がある

#### **解答例**
*   **はい、User1 は新しいテナントの作成者であるため自動的にグローバル管理者ロールが割り当てられている**

#### **解説**
Microsoft Entra ID テナントを作成したユーザーは、**そのテナントの最初のグローバル管理者として自動的に設定されます。** グローバル管理者は、Microsoft Entra ID のすべての管理機能に対する完全なアクセス権を持ち、ユーザーアカウントの作成、削除、変更などすべてのユーザー管理操作を実行できます。

User1 が external.contoso.onmicrosoft.com テナントを作成した時点で、User1 はこのテナントのグローバル管理者権限を自動的に取得しています。したがって、**User1 は追加の権限付与や設定変更なしに、新しいテナント内でユーザーアカウントを作成できます。** 元のテナント（contoso.onmicrosoft.com）での権限や役割は、新しいテナントでの権限には影響しません。各テナントは独立した管理境界を持ち、それぞれ独自の管理者とアクセス制御を持ちます。

| 項目 | 説明 |
| :--- | :--- |
| テナント作成者の権限 | 新規テナントのグローバル管理者に自動設定 |
| グローバル管理者の権限範囲 | すべての Microsoft Entra ID 管理機能へのフルアクセス |
| テナント間の権限継承 | 各テナントは独立しており権限は継承されない |

#### **リファレンス**
*   [Microsoft Entra ID](https://learn.microsoft.com/ja-jp/entra/fundamentals/active-directory-whatis)

---

### **問題 478. Azure サブスクリプションに複数のリソースが含まれています。VNET1 からの送信トラフィックを Firewall1 を使用して管理します。最初に実行すべき操作を選択してください。（一つ選択）**

*   サービスエンドポイントを VNET1 のサブネットに構成する
*   ルートテーブルを作成する
*   Azure Bastion をデプロイする
*   Network Watcher を作成する

#### **解答例**
*   **ルートテーブルを作成する**

#### **解説**
Azure Firewall を使用して仮想ネットワークからの通信トラフィックを管理するには、**ユーザー定義ルート（UDR: User Defined Route）を含むルートテーブルを作成し、トラフィックをファイアウォールに転送する必要があります。**

Azure Firewall は仮想ネットワーク内のサブネットに配置されますが、デフォルトではトラフィックは自動的にファイアウォールを経由しません。**送信トラフィックをファイアウォール経由にするには、ルートテーブルで次ホップを Azure Firewall のプライベート IP アドレスに設定し、保護対象のサブネットに関連付けることで、** 送信トラフィックがファイアウォールを経由するようになります。

ルートテーブルの設定手順は以下の通りです。まずルートテーブルリソースを作成し、ルートを追加します。宛先を `0.0.0.0/0`（すべての通信トラフィック）、次ホップの種類を「仮想アプライアンス」、次ホップアドレスを Azure Firewall のプライベートアドレスに指定します。その後、このルートテーブルを保護対象のサブネットに関連付けることで、送信トラフィックがファイアウォールを経由するようになります。

| 項目 | 説明 |
| :--- | :--- |
| ルートテーブル | トラフィックの転送先を定義するルールの集合 |
| ユーザー定義ルート | 管理者が作成するカスタムルート |
| 次ホップ | トラフィックの転送先（仮想アプライアンス等） |

Network Watcher はネットワーク監視ツールであり、トラフィック管理には直接関与しません。サービスエンドポイントは Azure サービスへの直接接続を提供しますが、ファイアウォール経由のトラフィック制御とは異なります。Azure Bastion は仮想マシンへの安全な RDP/SSH 接続を提供するサービスです。

#### **リファレンス**
*   [Azure Firewall](https://learn.microsoft.com/ja-jp/azure/firewall/overview)
*   [User-Defined Route (UDR)](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-udr-overview)
*   [ルートテーブル](https://learn.microsoft.com/ja-jp/azure/virtual-network/manage-route-table)

---

### **問題 479. Azure App Service プランでホストされている App1 という名前の Azure App Service があります。App1 には 1 つの本番スロットと 4 つのステージングスロットが構成されています。各ステージングスロットにトラフィックの 10% を割り当て、本番スロットにトラフィックの 60% を割り当てます。App1 に追加する必要があるものを選択してください。（一つ選択）**

*   Automation script ブレードのテンプレート
*   WebJob
*   Testing in production ブレードのスロット
*   Application Insights のスナップショットデバッガー

#### **解答例**
*   **Testing in production ブレードのスロット**

#### **解説**
この問題は、Azure App Service のデプロイスロット間でトラフィックを分散させる機能に関する理解を問うものです。

Azure App Service では、**Testing in production 機能を使用してトラフィックルーティングを構成できます。** この機能により、本番環境で実際のユーザートラフィックの一部を異なるデプロイスロットに振り分けることが可能です。各スロットに対してトラフィックの割合をパーセンテージで指定でき、A/B テストやカナリアリリースなどの段階的なデプロイメント戦略を実装できます。

設問のシナリオでは、5 つのスロット（本番 1 つ、ステージング 4 つ）に対して特定の割合でトラフィックを分散させる必要があります。これを実現するには、Azure portal の App Service リソースから**「Testing in production」ブレードにアクセスし、各スロットに対してトラフィックの割合を設定します。** 本番スロットに 60%、各ステージングスロットに 10% ずつ割り当てることで、合計 100% のトラフィック分散が構成されます。

他の選択肢について、WebJob はバックグラウンドタスクを実行する機能であり、トラフィック分散とは無関係です。Automation script はリソースのデプロイテンプレートをエクスポートする機能で、トラフィックルーティングの設定には使用しません。Application Insights のスナップショットデバッガーは例外発生時のデバッグ情報を収集する機能です。

| 機能 | 用途 | トラフィック制御 |
| :--- | :--- | :--- |
| Testing in production | スロット間のトラフィック分散 | **可能** |
| WebJob | バックグラウンドタスク実行 | 不可 |
| Automation script | テンプレートエクスポート | 不可 |

#### **リファレンス**
*   [Azure App Service デプロイスロット](https://learn.microsoft.com/ja-jp/azure/app-service/deploy-staging-slots)

---

### **問題 480. ある Azure サブスクリプションには、リソースグループ RG-A が存在し、その中に仮想ネットワーク VNet-A と仮想マシン VM-A が含まれています。RG-A には「許可されていないリソースタイプ」の Azure Policy が割り当てられており、ポリシーの適用が有効になっています。このポリシーのパラメーターには「Microsoft.Network/virtualNetworks」と「Microsoft.Compute/virtualMachines」が指定されています。RG-A 内に新しい仮想マシン VM-B を作成し、VNet-A に接続する必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

*   ポリシーパラメーターから Microsoft.Compute/virtualMachines を削除する
*   VNet-A に新しいサブネットを追加する
*   ポリシーパラメーターから Microsoft.Network/virtualNetworks を削除する
*   RG-A に新しいリソースグループをネストして作成する

#### **解答例**
*   **ポリシーパラメーターから Microsoft.Compute/virtualMachines を削除する**

#### **解説**
この問題の最重要ポイントは、Azure Policy の「許可されていないリソースタイプ」ポリシーが、設定されたリソースタイプのデプロイを明示的にブロックする動作を理解することです。

現在の状況では、RG-A に「許可されていないリソースタイプ」ポリシーが適用されており、パラメーターとして「Microsoft.Compute/virtualMachines」と「Microsoft.Network/virtualNetworks」が指定されています。このポリシーは、指定されたリソースタイプの作成や更新を拒否します。

新しい仮想マシン VM-B を作成するには、Microsoft.Compute/virtualMachines リソースタイプのデプロイが必要です。しかし、現在のポリシー設定ではこのリソースタイプが明示的にブロックされているため、VM-B の作成は失敗します。したがって、**VM-B を作成する前に、ポリシーパラメーターから Microsoft.Compute/virtualMachines を削除する必要があります。**

VNet-A は既に存在しているため、VM-B を VNet-A に接続する際に新しい仮想ネットワークを作成する必要はありません。そのため、Microsoft.Network/virtualNetworks をポリシーから削除する必要はありません。また、サブネットの追加やリソースグループのネストは、ポリシーによるブロックを解決しません。

| 操作 | 効果 | 必要性 |
| :--- | :--- | :--- |
| Microsoft.Compute/virtualMachines を削除 | VM 作成が可能になる | **必須** |
| Microsoft.Network/virtualNetworks を削除 | 既存 VNet 利用には不要 | 不要 |
| サブネット追加 | ポリシーブロックは解決しない | 不要 |

#### **リファレンス**
*   [Azure Policy](https://learn.microsoft.com/ja-jp/azure/governance/policy/overview)
*   [Resource group](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/manage-resource-groups-portal)

---

### **問題 481. あなたの会社には、Subscription1 という名前の Azure サブスクリプションがあります。また、オンプレミスには Server1 と Server2 という 2 台 Windows Server 2016 サーバーがあります。Server1 は DNS サーバーとして構成されており、hogehoge.com という名前のプライマリ DNS ゾーンを持っています。このゾーンには 1,000 件の DNS レコードが含まれています。Server2 から Server1 と Subscription1 を管理しており、Server2 には次のツールがインストールされています：DNS マネージャーコンソール、Azure PowerShell、Azure CLI。hogehoge.com ゾーンを Subscription1 内の Azure DNS ゾーンに移行する必要があります。管理作業を最小限に抑えるソリューションを選択してください。（一つ選択）**

*   Azure Portal
*   Azure CLI
*   DNS マネージャーコンソール
*   Azure PowerShell

#### **解答例**
*   **Azure PowerShell**

#### **解説**
この問題の最重要ポイントは、オンプレミスの DNS ゾーンを Azure DNS に移行する際に、大量の DNS レコード（1,000 件）を効率的に移行する方法を選択することです。

**Azure PowerShell を使用することで、DNS 移行スクリプト（PrivateDnsMigrationScript）を利用できます。** このスクリプトは、オンプレミスの DNS ゾーンから Azure DNS への移行を自動化し、管理作業を大幅に削減します。移行プロセスは、まず PowerShell ギャラリーからスクリプトをインストールし、次にスクリプトを実行してゾーンとレコードを一括で移行します。

Azure Portal を使用する場合、1,000 件のレコードを手動で作成する必要があり、非常に時間がかかります。Azure CLI でも移行は可能ですが、専用の移行スクリプトは PowerShell 向けに提供されています。DNS マネージャーコンソールは、オンプレミス環境での DNS 管理には適していますが、Azure DNS への直接的な移行機能は提供していません。

| 方法 | 特徴 | 管理作業量 |
| :--- | :--- | :--- |
| Azure PowerShell | **移行スクリプト利用可能** | **最小** |
| Azure Portal | 手動でのレコード作成 | 最大 |
| Azure CLI | スクリプト作成が必要 | 中程度 |

| 移行手順 | コマンド例 |
| :--- | :--- |
| スクリプトインストール | `Install-Script PrivateDnsMigrationScript` |
| スクリプト実行 | `PrivateDnsMigrationScript.ps1` |

#### **リファレンス**
*   [Azure DNS](https://learn.microsoft.com/ja-jp/azure/dns/dns-overview)
*   [Azure PowerShell](https://learn.microsoft.com/ja-jp/powershell/azure/overview)

---

### **問題 482. App Service プランと Azure Web Apps を作成しました。運用環境にアプリをデプロイする前に、ステージングスロットを使用して変更を検証したいと考えていますが、ステージングスロットを作成するオプションが表示されません。デプロイスロットを作成できるようにするために最初に実行すべき操作を選択してください。（一つ選択）**

*   App Service プランを上位の価格レベルにスケールアップする
*   App Service プランのインスタンス数を増やしてスケールアウトする
*   Azure Web Apps にカスタムドメインを追加する
*   Azure Web Apps のアプリケーション設定でスロット固有の設定を有効化する

#### **解答例**
*   **App Service プランを上位の価格レベルにスケールアップする**

#### **解説**
デプロイスロット機能は App Service プランの価格レベルによって利用可否が決まります。**Free や Basic レベルではデプロイスロットを作成できず、Standard 以上の価格レベルにスケールアップする必要があります。**

デプロイスロットは本番環境とは別の独立した環境でアプリケーションをテストし、検証後にスワップ操作で本番環境に昇格させる機能です。この機能により、ダウンタイムなしでのデプロイやロールバックが可能になります。

価格レベルごとのデプロイスロット数は以下の通りです。

| 価格レベル | デプロイスロット数 |
| :--- | :--- |
| Free/Basic | 利用不可 |
| Standard | 最大 5 個 |
| Premium | 最大 20 個 |

スケールアウトはインスタンス数を増やす水平スケーリングであり、デプロイスロット機能の有効化には関係ありません。カスタムドメインの追加やアプリケーション設定の変更も、デプロイスロット機能の利用可否には影響しません。

デプロイスロットを利用するには、**まず App Service プランを Standard 以上の価格レベルにスケールアップし、** その後 Azure Web Apps のデプロイメニューからスロットを作成します。

#### **リファレンス**
*   [App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
*   [Deployment Slot](https://learn.microsoft.com/ja-jp/azure/app-service/deploy-staging-slots)
*   [Scale Up and Scale Out](https://learn.microsoft.com/ja-jp/azure/app-service/manage-scale-up)

---

### **問題 483. Azure サブスクリプションに、RG1 と RG2 という 2 つのリソースグループがあります。RG1 には、East US リージョンの仮想ネットワーク VNet1 と、West US リージョンのネットワークセキュリティグループ NSG1 が含まれています。RG2 には、East US リージョンの仮想ネットワーク VNet2 と、West US リージョンの仮想ネットワーク VNet3 が含まれています。NSG1 を関連付けることができるサブネットはどれですか。（一つ選択）**

*   VNet3 のサブネットのみ
*   すべての仮想ネットワークのサブネット
*   VNet1 と VNet3 のサブネット
*   VNet1 のサブネットのみ

#### **解答例**
*   **VNet3 のサブネットのみ**

#### **解説**
Network Security Group (NSG) は、仮想ネットワークのサブネットまたはネットワークインターフェイスに関連付けて、インバウンドおよびアウトバウンドのトラフィックを制御するセキュリティルールの集合です。NSG を関連付ける際の最も重要な制約は、**NSG と関連付け先のリソースが同じ Azure リージョンに存在する必要があることです。**

本問では、NSG1 は West US リージョンに配置されています。したがって、NSG1 を関連付けできるのは、**同じ West US リージョンに存在する仮想ネットワークのサブネットのみです。** VNet3 は West US リージョンに配置されているため、VNet3 のサブネットにのみ NSG1 を関連付けることができます。

リソースグループの違いは関連付けに影響しません。異なるリソースグループ間でもリージョンが一致していれば関連付けは可能ですが、本問ではリージョンの制約により、VNet1 (East US) と VNet2 (East US) のサブネットには関連付けできません。

| 仮想ネットワーク | リージョン | NSG1 との関連付け |
| :--- | :--- | :--- |
| VNet1 | East US | 不可（リージョン不一致） |
| VNet2 | East US | 不可（リージョン不一致） |
| VNet3 | West US | **可能（リージョン一致）** |

#### **リファレンス**
*   [Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)
*   [Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)
*   [Azure Region](https://learn.microsoft.com/ja-jp/azure/reliability/availability-zones-overview)

---

### **問題 484. Azure サブスクリプションに複数のリソースが含まれています。Store1 というストレージアカウントに data という名前のファイル共有があり、5,000 個のファイルが格納されています。このファイル共有内のファイルをオンプレミスの Server1 という名前のサーバーに同期します。実施すべき操作を選択してください。（三つ選択）**

*   Server1 に Azure File Sync エージェントをインストールする
*   同期グループを作成する
*   Server1 を登録する
*   Azure Automation アカウントを作成する
*   ストレージ同期サービスを作成する

#### **解答例**
*   **Server1 に Azure File Sync エージェントをインストールする**
*   **同期グループを作成する**
*   **Server1 を登録する**

#### **解説**
Azure File Sync は Azure Files とオンプレミスサーバー間でファイルを双方向同期するサービスです。オンプレミスサーバーをクラウドストレージと同期させるには、特定の手順を正しい順序で実行する必要があります。

Azure File Sync の実装には以下の手順が必要です。まずストレージ同期サービスをデプロイし、次にオンプレミスサーバーに Azure File Sync エージェントをインストールします。エージェントインストール後、サーバーをストレージ同期サービスに登録し、同期グループを作成してクラウドエンドポイント (Azure Files) とサーバーエンドポイント (オンプレミスサーバー) を構成します。

本問では既にストレージアカウントとファイル共有が存在するため、残りの必須手順は以下の 3 つです。**Server1 へのエージェントインストール、サーバー登録、同期グループの作成です。** これらの手順により、オンプレミスサーバーと Azure Files 間でファイルの同期が開始されます。

Azure Automation アカウントはスクリプトやランブックの自動実行に使用するサービスであり、ファイル同期には不要です。ストレージ同期サービスは前提条件として既に作成済みと想定されます。

| 手順 | 操作内容 | 目的 |
| :--- | :--- | :--- |
| 1 | エージェントインストール | サーバーに同期機能を追加 |
| 2 | サーバー登録 | Azure 側でサーバーを認識 |
| 3 | 同期グループ作成 | 同期対象を定義 |

#### **リファレンス**
*   [Azure Automation](https://learn.microsoft.com/ja-jp/azure/automation/automation-intro)
*   [Azure File Sync](https://learn.microsoft.com/ja-jp/azure/storage/file-sync/file-sync-introduction)
*   [同期グループ](https://learn.microsoft.com/ja-jp/azure/storage/file-sync/file-sync-deployment-guide)

---

### **問題 485. ※1 の表に示す仮想マシンに対して、※2 の構成を持つ負荷分散を導入しました。VM-A と VM-B を LB-A のバックエンドプールに追加できることを確認します。解決策として、VM-B のネットワークインターフェイスからパブリック IP アドレスの関連付けを解除します。この解決策は目標を達成しますか。（一つ選択）**

**※1 仮想マシンの構成**
| 名前 | パブリック IP SKU | 接続先 | 状態 |
| :--- | :--- | :--- | :--- |
| VM-A | なし | VNet-A/Subnet-A | 停止（割り当て解除） |
| VM-B | Basic | VNet-A/Subnet-B | 実行中 |

**※2 ロードバランサーの構成**
| 項目 | 設定値 |
| :--- | :--- |
| 名前 | LB-A |
| タイプ | Internal |
| SKU | Standard |
| 仮想ネットワーク | VNet-A |

*   いいえ
*   はい

#### **解答例**
*   **いいえ**

#### **解説**
この問題の最重要ポイントは、Azure Load Balancer の SKU とパブリック IP アドレスの SKU の互換性要件を理解することです。Standard SKU のロードバランサーと Basic SKU のパブリック IP アドレスは混在できないという制約があります。

LB-A は Standard SKU の内部ロードバランサーとして構成されています。**Standard SKU のロードバランサーのバックエンドプールに仮想マシンを追加する場合、その仮想マシンに関連付けられているパブリック IP アドレスも Standard SKU である必要があります。** Basic SKU のパブリック IP アドレスが関連付けられている仮想マシンは、Standard SKU のロードバランサーのバックエンドプールに追加できません。

VM-B には Basic SKU のパブリック IP アドレスが関連付けられています。提示された解決策では、このパブリック IP アドレスの関連付けを解除することで問題を解決しようとしています。この操作により、VM-B はパブリック IP アドレスを持たない状態になり、Standard SKU のロードバランサーのバックエンドプールに追加可能になります。

しかし、VM-A には別の問題があります。VM-A は**停止（割り当て解除）状態にあります。** 仮想マシンが停止（割り当て解除）状態の場合、ロードバランサーのバックエンドプールには追加できますが、トラフィックを受信することはできません。ただし、問題文では「追加できることを確認する」という表現が使われており、実際にトラフィックを処理できるかどうかではなく、バックエンドプールへの追加操作が可能かどうかを問うています。

さらに重要な点として、VM-A と VM-B は異なるサブネット (Subnet-A と Subnet-B) に配置されています。内部ロードバランサーの場合、バックエンドプール内の仮想マシンは同じ仮想ネットワーク内に存在する必要がありますが、異なるサブネットに配置されていても問題ありません。両方の仮想マシンが VNet-A に接続されているため、この要件は満たされています。

したがって、**VM-B のパブリック IP アドレスの関連付けを解除するだけでは、VM-A の停止状態という問題が残るため、** 両方の仮想マシンを完全に機能させることはできません。目標を完全に達成するには、VM-A を起動する必要もあります。

**Azure Load Balancer の SKU 互換性要件**
| 項目 | Basic SKU | Standard SKU |
| :--- | :--- | :--- |
| パブリック IP SKU | Basic | Standard |
| 可用性ゾーン | 非対応 | 対応 |
| バックエンドプールサイズ | 最大 300 | 最大 1000 |

**仮想マシンの状態とロードバランサーへの影響**
| 状態 | バックエンドプール追加 | トラフィック処理 |
| :--- | :--- | :--- |
| 実行中 | 可能 | 可能 |
| 停止（割り当て解除） | 可能 | 不可能 |
| 停止 | 可能 | 不可能 |

#### **リファレンス**
*   [Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
*   [Public IP Address](https://learn.microsoft.com/ja-jp/azure/virtual-network/ip-services/public-ip-addresses)

---

### **問題 486. Azure サブスクリプション「Subscription-A」に以下のリソースが含まれています。VM-A は現在 VNet-A に接続されており、これを VNet-B にも接続する必要があります。解決策として、VM-A を RG-B に移動してから新しいネットワークインターフェイスを VM-A に追加します。この解決策は目標を達成しますか。（一つ選択）**

| 名前 | タイプ | リージョン |
| :--- | :--- | :--- |
| RG-A | リソースグループ | 東日本 |
| RG-B | リソースグループ | 西日本 |
| Storage-A | ストレージアカウント | 東日本 |
| Storage-B | ストレージアカウント | 西日本 |
| VM-A | 仮想マシン | 東日本 |
| VNet-A | 仮想ネットワーク | 東日本 |
| VNet-B | 仮想ネットワーク | 西日本 |

*   いいえ
*   はい

#### **解答例**
*   **いいえ**

#### **解説**
この解決策は目標を達成しません。**仮想マシンは異なるリージョン間で移動できないため、東日本リージョンの VM-A を西日本リージョンの RG-B に移動することは不可能です。**

Azure の仮想マシンは作成時に指定したリージョンに固定され、リソースグループを変更してもリージョンは変更されません。VM-A は東日本リージョンに存在し、VNet-B は西日本リージョンに存在するため、異なるリージョン間での仮想ネットワーク接続は直接的なネットワークインターフェイスの追加では実現できません。

異なるリージョンの仮想ネットワーク間で通信を行う場合は、**Virtual Network Peering（VNet ピアリング）や VPN Gateway、Azure Virtual WAN などのネットワークサービスを使用する必要があります。** VNet ピアリングを使用すれば、異なるリージョンの仮想ネットワーク間でプライベート IP アドレスを使用した通信が可能になります。

正しい解決策としては、VNet-A と VNet-B 間で Virtual Network Peering を構成し、VM-A から西日本リージョンのリソースへアクセスできるようにする方法が適切です。

| 項目 | 制約事項 |
| :--- | :--- |
| 仮想マシンのリージョン | 作成後は変更不可 |
| リソースグループの移動 | 同一リージョン内のみ可能 |
| 異なるリージョン間の接続 | VNet ピアリングまたは VPN Gateway が必要 |

#### **リファレンス**
*   [Virtual Network Peering](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-peering-overview)
*   [Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)
*   [Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)

---

### **問題 487. 新しい Azure サブスクリプションを作成し、Admin1 というユーザーを含めました。Admin1 が Azure Resource Manager テンプレートを使用して Azure Marketplace リソースをデプロイしようとしたところ、Azure PowerShell でテンプレートをデプロイした際に次のエラーメッセージが表示されました。「このサブスクリプションでこの項目のリソースを購入するための検証に失敗しました。エラーメッセージ：この項目の法的条項がこのサブスクリプションで承認されていません。法的条項を承認するには、Azure ポータルに移動して Marketplace 項目のプログラムによるデプロイを構成するか、初めてそこで作成してください。」Admin1 が Marketplace リソースを正常にデプロイできるようにする必要があります。どうすればよいですか。（一つ選択）**

*   Azure PowerShell から、Set-AzMarketplaceTerms コマンドレットを実行する
*   Azure ポータルから、課金管理者ロールを Admin1 に割り当てる
*   Azure ポータルから、Microsoft.Marketplace リソースプロバイダーを登録する
*   Azure PowerShell から、Get-AzMarketplaceTerms コマンドレットを実行してから、Accept-AzMarketplaceTerms コマンドレットを実行する

#### **解答例**
*   **Azure PowerShell から、Set-AzMarketplaceTerms コマンドレットを実行する**

#### **解説**
Azure Marketplace から提供されるサードパーティ製品やサービスを初めてデプロイする際には、**法的条項（利用規約）への同意が必要です。** エラーメッセージは、このサブスクリプションで Marketplace 項目の法的条項が未承認であることを示しています。

**Set-AzMarketplaceTerms コマンドレットを使用することで、PowerShell から直接 Marketplace 項目の法的条項を承認できます。** このコマンドレットは、特定のパブリッシャー、製品、プランの組み合わせに対して利用規約を受け入れるために使用されます。実行後、Admin1 は Azure Resource Manager テンプレートを使用して Marketplace リソースを正常にデプロイできるようになります。

他の選択肢が不適切な理由を以下に示します。課金管理者ロールの割り当ては、課金情報の閲覧や管理に関する権限を付与しますが、Marketplace 項目の法的条項承認とは無関係です。Microsoft.Marketplace リソースプロバイダーの登録は、Marketplace サービスの基本的な機能を有効化しますが、個別の製品に対する法的条項の承認は別途必要です。Get-AzMarketplaceTerms は条項の確認のみを行い、Accept-AzMarketplaceTerms という実在しないコマンドレットは使用できません。

| 操作 | 目的 | 効果 |
| :--- | :--- | :--- |
| Set-AzMarketplaceTerms | 法的条項の承認 | Marketplace リソースのデプロイが可能になる |
| リソースプロバイダー登録 | サービスの有効化 | 基本機能の利用が可能になる |
| 課金管理者ロール | 課金情報の管理 | コスト管理と請求書の閲覧が可能になる |

#### **リファレンス**
*   [Azure Marketplace](https://learn.microsoft.com/ja-jp/azure/marketplace/overview)
*   [Azure Resource Manager](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/management/overview)
*   [Azure PowerShell](https://learn.microsoft.com/ja-jp/powershell/azure/overview)

---

### **問題 488. Azure DNS ゾーン hogehoge.com を管理しています。サブドメイン lab.hogehoge.com を Azure 内の別の DNS サーバーに委任します。どの操作を実行しますか。（一つ選択）**

*   hogehoge.com ゾーンに lab という名前の CNAME レコードを作成する
*   hogehoge.com ゾーンに lab という名前の NS レコードを作成する
*   hogehoge.com の SOA レコードを変更する
*   hogehoge.com ゾーンに *.lab という名前の A レコードを作成する

#### **解答例**
*   **hogehoge.com ゾーンに lab という名前の NS レコードを作成する**

#### **解説**
サブドメインを別の DNS サーバーに委任する場合、**親ゾーンに NS (Name Server) レコードを作成します。** これにより、サブドメインへの DNS クエリが指定された DNS サーバーに転送されます。

Azure DNS でサブドメイン委任を実装する手順は以下の通りです。まず、委任先となる新しい DNS ゾーン (lab.hogehoge.com) を作成します。次に、親ゾーン (hogehoge.com) に NS レコードを追加し、サブドメイン名 (lab) と委任先の DNS サーバーを指定します。この NS レコードにより、lab.hogehoge.com へのクエリは委任先の DNS サーバーで処理されます。

各レコードタイプの役割を整理します。

| レコードタイプ | 用途 | 委任での使用 |
| :--- | :--- | :--- |
| NS | 権威ネームサーバーの設定 | **サブドメイン委任に必須** |
| SOA | ゾーンの管理情報 | 委任には不要 |
| A | ホスト名と IPv4 アドレスのマッピング | 委任には不要 |
| CNAME | ホスト名の別名定義 | 委任には使用不可 |

CNAME レコードは別名を定義するものでサブドメイン委任には使用できません。SOA レコードはゾーン全体の管理情報を含みますが、サブドメイン委任の設定には関与しません。A レコードはホスト名と IP アドレスのマッピングに使用され、ワイルドカード (*) を使用しても委任は実現できません。

Azure DNS では、委任先のネームサーバー情報を NS レコードに正確に設定することで、サブドメインの DNS 解決を別のゾーンに転送できます。これにより、組織内の異なる部門やプロジェクトごとに DNS 管理を分離することが可能になります。

#### **リファレンス**
*   [Azure DNS](https://learn.microsoft.com/ja-jp/azure/dns/dns-overview)

---

### **問題 489. Azure サブスクリプションとユーザー「User1」が存在します。User1 にサブスクリプション内のすべてのリソースを作成および管理する権限を付与しますが、他のユーザーへのロール割り当ては禁止します。User1 に割り当てるべき Azure ロールはどれですか。（一つ選択）**

*   Contributor
*   User Access Administrator
*   Owner
*   Reader

#### **解答例**
*   **Contributor**

#### **解説**
この問題の最重要ポイントは、Azure の組み込みロール (Built-in roles) における権限範囲の違いを理解することです。特にリソース管理権限とアクセス管理権限の分離を把握する必要があります。

**Contributor ロールは、Azure リソースの作成、変更、削除などすべての管理操作を実行できますが、Azure RBAC におけるロール割り当て権限（Microsoft.Authorization/*/Write）は含まれていません。** これにより、他のユーザーへのロール付与や権限変更を防止できます。

Owner ロールは、リソース管理に加えてロール割り当て権限も含むため、要件の「他のユーザーへのロール割り当てを禁止」という条件に適合しません。User Access Administrator は、ロール割り当て専用のロールでリソース管理権限を持たないため不適切です。Reader は読み取り専用権限のみで、リソースの作成や管理ができません。

**主要な組み込みロールの権限比較：**
| ロール名 | リソース管理 | ロール割り当て |
| :--- | :--- | :--- |
| Owner | 可能 | 可能 |
| Contributor | **可能** | **不可** |
| Reader | 読み取りのみ | 不可 |

Azure RBAC では、最小権限の原則 (Principle of Least Privilege) に基づき、業務遂行に必要な最小限の権限のみを付与することが推奨されます。本シナリオでは、リソース管理権限は必要ですが、アクセス管理権限は不要なため、Contributor が最適な選択となります。

#### **リファレンス**
*   [Azure RBAC (Role-Based Access Control)](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/overview)
*   [Azure 組み込みロール](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/built-in-roles)
*   [最小権限の原則](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/best-practices)
*   [User Access Administrator](https://learn.microsoft.com/ja-jp/azure/role-based-access-control/built-in-roles#user-access-administrator)

---

### **問題 490. Azure サブスクリプションとオンプレミス環境に Hyper-V 仮想マシン VM1 があります。VM1 には単一の仮想ディスクが含まれています。VM1 をテンプレートとして使用し、25 台の新しい Azure 仮想マシンをデプロイする予定です。VM1 を Azure にアップロードします。実行すべきコマンドレットはどれですか。（一つ選択）**

*   New-AzDisk
*   Add-AzVhd
*   Set-AzVMOSDisk
*   New-AzVM

#### **解答例**
*   **Add-AzVhd**

#### **解説**
オンプレミスの Hyper-V 仮想マシンを Azure にアップロードする場合、VHD または VHDX ファイルを Azure Storage にアップロードする必要があります。**この操作には Add-AzVhd コマンドレットを使用します。**

Add-AzVhd は、オンプレミスの仮想ハードディスクファイルを Azure のストレージアカウント内の Blob としてアップロードする専用コマンドレットです。このコマンドレットは、アップロード中に VHD ファイルを最適化し、固定サイズの VHD に変換する機能も持っています。アップロード完了後、この VHD をマネージドディスクに変換し、テンプレートとして複数の仮想マシンを作成できます。

New-AzDisk は既に Azure 内に存在するリソースから新しいマネージドディスクを作成するコマンドレットであり、オンプレミスからのアップロードには使用しません。Set-AzVMOSDisk は既存の仮想マシンに OS ディスクを割り当てる際に使用します。New-AzVM は仮想マシンを新規作成するコマンドレットですが、オンプレミスからの VHD アップロード機能は持っていません。

| コマンドレット | 用途 | オンプレミス VHD アップロード |
| :--- | :--- | :--- |
| Add-AzVhd | VHD ファイルのアップロード | **可能** |
| New-AzDisk | マネージドディスクの作成 | 不可 |
| New-AzVM | 仮想マシンの新規作成 | 不可 |

#### **リファレンス**
*   [Azure PowerShell](https://learn.microsoft.com/ja-jp/powershell/azure/overview)
*   [Managed Disk](https://learn.microsoft.com/ja-jp/azure/virtual-machines/managed-disks-overview)
*   [VHD](https://learn.microsoft.com/ja-jp/azure/virtual-machines/windows/prepare-for-upload-vhd-image)

---

### **問題 491. Azure サブスクリプションにストレージアカウントがあり、Web サイトデータを保存しています。インバウンドのユーザートラフィックが、ユーザーの場所に最も近い Microsoft の POP (Point of Presence) を経由するようにします。何を構成しますか。（一つ選択）**

*   Azure Firewall
*   ルーティング優先設定
*   プライベートエンドポイント
*   負荷分散

#### **解答例**
*   **ルーティング優先設定**

#### **解説**
ストレージアカウントへのトラフィックをユーザーに最も近い Microsoft POP を経由させるには、**ルーティング優先設定で Microsoft ネットワークルーティングを選択します。** この設定により、トラフィックは可能な限り早く Microsoft のグローバルネットワークに入り、最適化された経路でストレージアカウントに到達します。

ルーティング優先設定には 2 つのオプションがあります。Microsoft ネットワークルーティングは、トラフィックがユーザーの最寄りの Microsoft POP から Microsoft のバックボーンネットワークを経由してストレージアカウントに到達します。インターネットルーティングは、トラフィックがパブリックインターネットを経由して Azure リージョンに到達してからストレージアカウントにアクセスします。Web サイトデータの配信でユーザーエクスペリエンスを最適化するには、Microsoft ネットワークルーティングが適切です。

Azure Firewall はネットワークセキュリティサービスであり、トラフィックのルーティング最適化には使用しません。プライベートエンドポイントはストレージアカウントへのプライベート接続を提供しますが、パブリックインターネットからのアクセスには適用されません。負荷分散は複数のバックエンドリソース間でトラフィックを分散する機能であり、POP の選択には関与しません。

| 設定項目 | 説明 |
| :--- | :--- |
| Microsoft ネットワークルーティング | 最寄りの POP から Microsoft バックボーン経由でアクセス |
| インターネットルーティング | パブリックインターネット経由で Azure リージョンにアクセス |

| オプション | 用途 |
| :--- | :--- |
| Azure Firewall | ネットワークトラフィックのフィルタリングと保護 |
| プライベートエンドポイント | VNet 内からのプライベートアクセス |
| 負荷分散 | 複数リソース間のトラフィック分散 |

#### **リファレンス**
*   [Azure Storage](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-routing-preference)
*   [Microsoft Global Network](https://learn.microsoft.com/ja-jp/azure/networking/microsoft-global-network)

---

### **問題 492. Azure サブスクリプションに以下のリソースが含まれています。Application1 を Cluster1 にデプロイします。実行するコマンドはどれですか。（一つ選択）**

| リソース名 | リソースタイプ |
| :--- | :--- |
| Application1 | コンテナーイメージ |
| Cluster1 | Azure Kubernetes Service (AKS) クラスター |
| Registry1 | Azure Container Registry |

*   docker push
*   kubectl apply
*   az aks install-cli
*   az acr build

#### **解答例**
*   **kubectl apply**

#### **解説**
AKS クラスターに既存のコンテナーイメージをデプロイする場合、Kubernetes のマニフェストファイルを使用してリソースを作成します。**この操作には kubectl apply コマンドを使用します。**

kubectl apply は、YAML または JSON 形式で記述されたマニフェストファイルを読み込み、AKS クラスター上に Pod、Deployment、Service などのリソースを作成・更新するコマンドです。コンテナーイメージは Azure Container Registry に保存されており、マニフェストファイル内でイメージの参照先を指定することでデプロイが実行されます。

他の選択肢について、docker push はコンテナーイメージをレジストリにアップロードするコマンドであり、デプロイには使用しません。az aks install-cli は kubectl コマンドラインツールをインストールするためのコマンドです。az acr build は Azure Container Registry 内でコンテナーイメージをビルドするコマンドであり、既存イメージのデプロイには不要です。

| コマンド | 用途 |
| :--- | :--- |
| kubectl apply | マニフェストファイルを使用して AKS にリソースをデプロイ |
| docker push | コンテナーイメージをレジストリにプッシュ |
| az acr build | Azure Container Registry でイメージをビルド |

#### **リファレンス**
*   [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/ja-jp/azure/aks/intro-kubernetes)
*   [kubectl](https://kubernetes.io/docs/reference/kubectl/overview/)
*   [Azure Container Registry](https://learn.microsoft.com/ja-jp/azure/container-registry/container-registry-intro)

---

### **問題 493. ある Basic 階層の Azure App Service プランで Web アプリを運用しています。CPU 使用率が 15 分間にわたり 80% を超えた場合に、Web アプリが自動的にスケールするようにします。実施すべき 2 つのアクションはどれですか。正解はそれぞれソリューションの一部を構成します。（二つ選択）**

*   App Service プランを Standard 階層以上にスケールアップする
*   メトリックに基づいてスケールする条件を構成し、ルールを追加する
*   デプロイスロットを構成する
*   インスタンス数に基づいてスケールする条件を構成し、インスタンス数を設定する
*   App Service プランをスケールアウトする

#### **解答例**
*   **App Service プランを Standard 階層以上にスケールアップする**
*   **メトリックに基づいてスケールする条件を構成し、ルールを追加する**

#### **解説**
App Service の自動スケール機能を利用するには、まずプラン階層の要件を満たし、次に適切なスケール条件を設定する必要があります。

Basic 階層では自動スケール機能が提供されていません。自動スケールを有効にするには、**Standard 階層、Premium 階層、または Isolated 階層のいずれかにスケールアップする必要があります。** これらの階層では、CPU 使用率、メモリ使用率、HTTP キュー長などのメトリックに基づいた自動スケールルールを定義できます。

スケールアップ後、メトリックベースのスケール条件を構成します。今回のシナリオでは、**CPU 使用率が 80% を超えた状態が 15 分間継続した場合にスケールアウトするルールを作成します。** この設定により、負荷の増加に応じてインスタンス数が自動的に増減し、パフォーマンスとコストのバランスを最適化できます。

デプロイスロットはステージング環境の構成に使用する機能であり、自動スケールとは無関係です。インスタンス数に基づくスケール条件は手動スケールの設定であり、メトリックに応じた自動スケールには該当しません。単純なスケールアウト操作は一時的なインスタンス数の増加であり、継続的な自動スケールの仕組みではありません。

| 項目 | 説明 |
| :--- | :--- |
| Basic 階層 | 自動スケール機能なし、手動スケールのみ対応 |
| Standard 以上 | **自動スケール機能あり**、メトリックベースのルール設定可能 |
| メトリックベース | CPU、メモリ、HTTP キュー長などの指標で自動スケール |
| インスタンスベース | 固定のインスタンス数を設定する手動スケール |

#### **リファレンス**
*   [App Service Plan](https://learn.microsoft.com/ja-jp/azure/app-service/overview-hosting-plans)
*   [Scale Up and Scale Out](https://learn.microsoft.com/ja-jp/azure/app-service/manage-scale-up)

---

### **問題 494. Azure サブスクリプション内に複数のリソースグループとリソースが存在します。仮想マシン VM1 はネットワークインターフェイス NIC1 を使用して VNET2 に接続しています。VM1 用に新しいネットワークインターフェイス NIC2 を作成する必要があります。NIC2 を RG1 と Central US リージョンに作成することで要件を満たすことができますか。（一つ選択）**

*   いいえ、要件を満たしません
*   はい、要件を満たします
*   RG1 に作成すれば要件を満たしますが、リージョンは関係ありません
*   Central US に作成すれば要件を満たしますが、リソースグループは関係ありません

#### **解答例**
*   **いいえ、要件を満たしません**

#### **解説**
仮想マシンに追加のネットワークインターフェイスを作成する際は、**既存のネットワークインターフェイスと同じ仮想ネットワークおよび同じリージョンに配置する必要があります。** VM1 は既に NIC1 を使用して VNET2 に接続しているため、NIC2 も VNET2 が存在するリージョンに作成しなければなりません。

問題文では VM1 が VNET2 に接続していることが明記されていますが、VNET2 がどのリージョンに存在するかは示されていません。しかし、NIC2 を Central US リージョンに作成するという解決策は、VNET2 が Central US 以外のリージョンに存在する場合には機能しません。ネットワークインターフェイスは、接続先の仮想ネットワークと同じリージョンに配置する必要があるためです。

また、リソースグループ RG1 についても、VNET2 が RG1 に含まれているかどうかは不明です。ネットワークインターフェイスは異なるリソースグループに配置することも可能ですが、仮想ネットワークとのリージョンの一致は必須要件となります。

| 要件 | 説明 |
| :--- | :--- |
| リージョンの一致 | NIC は接続先の仮想ネットワークと同じリージョンに配置 |
| 仮想ネットワークの指定 | NIC は特定の仮想ネットワークのサブネットに関連付け |
| リソースグループ | 仮想ネットワークと異なるリソースグループでも配置可能 |

#### **リファレンス**
*   [Network Interface](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-network-interface)
*   [Azure Virtual Network](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-overview)
*   [Azure Region](https://learn.microsoft.com/ja-jp/azure/reliability/availability-zones-overview)

---

### **問題 495. ある Azure サブスクリプションに、VNet1 という名前の仮想ネットワークがあります。VNet1 には Subnet1 と Subnet2 という 2 つのサブネットがあり、West Europe リージョンに配置されています。このサブスクリプションには複数の仮想マシンが含まれています。VM1 と VM2 は Subnet1 に配置され、VM3 は Subnet2 に配置されています。VNet1 に AppGW1 という名前の Application Gateway をデプロイする必要があります。最初に実行すべき操作はどれですか。（一つ選択）**

*   Application Gateway 専用の新しいサブネットを追加する
*   VM3 を Subnet1 に移動する
*   新しい仮想ネットワークを追加する
*   VM1 と VM2 を停止する

#### **解答例**
*   **Application Gateway 専用の新しいサブネットを追加する**

#### **解説**
Application Gateway をデプロイする際の最重要ポイントは、**Application Gateway 専用のサブネットを用意する必要があることです。** Application Gateway は専用サブネット内に配置する必要があり、そのサブネットには他のリソースタイプを配置できません。

既存の Subnet1 と Subnet2 には仮想マシンが配置されているため、これらのサブネットに Application Gateway を直接デプロイすることはできません。Application Gateway のベストプラクティスとして、専用サブネットを作成し、そこに Application Gateway インスタンスを配置します。

仮想マシンの移動や停止は不要です。Application Gateway は既存の仮想マシンと同じ仮想ネットワーク内の別サブネットに配置できます。また、新しい仮想ネットワークを追加する必要もありません。VNet1 内に新しいサブネットを追加するだけで要件を満たせます。

Application Gateway サブネットの要件を以下の表にまとめます。

| 項目 | 要件 |
| :--- | :--- |
| サブネット用途 | Application Gateway 専用 |
| 他リソース配置 | 不可 (Application Gateway のみ) |
| 推奨サブネットサイズ | /24 以上 (将来の拡張を考慮) |

Application Gateway をデプロイする際の手順は以下の通りです。まず VNet1 に新しいサブネット（例: AppGWSubnet）を作成します。次にこの専用サブネットを指定して Application Gateway リソースを作成します。デプロイ後、バックエンドプールの設定で Subnet1 や Subnet2 の仮想マシンをターゲットとして指定できます。

#### **リファレンス**
*   [Application Gateway](https://learn.microsoft.com/ja-jp/azure/application-gateway/overview)
*   [Backend Pool](https://learn.microsoft.com/ja-jp/azure/application-gateway/application-gateway-backend-pool-overview)

---

### **問題 496. Azure サブスクリプションを所有しています。storage1 という名前のストレージアカウントを作成する予定です。storage1 が POSIX 準拠のアクセス制御リスト (ACL) を提供できるようにします。storage1 の作成時に構成すべきオプションはどれですか。（一つ選択）**

*   階層型名前空間
*   アクセス層
*   バージョンレベルの不変サポート
*   大きなファイル共有

#### **解答例**
*   **階層型名前空間**

#### **解説**
POSIX 準拠のアクセス制御リスト (ACL) を使用するには、**ストレージアカウント作成時に階層型名前空間 (Hierarchical Namespace) を有効化する必要があります。** この機能は Azure Data Lake Storage Gen2 の中核機能であり、ファイルとディレクトリに対してきめ細かいアクセス許可を設定できます。

階層型名前空間を有効にすると、ストレージアカウントはファイルシステムのような階層構造を持ち、各ディレクトリとファイルに対して個別のアクセス権限を設定できるようになります。POSIX ACL では、所有者、グループ、その他のユーザーに対して読み取り、書き込み、実行の権限を細かく制御できます。この機能は、ビッグデータ分析や Hadoop などの Linux ベースのワークロードで特に重要です。

アクセス層はストレージのコスト最適化のための設定であり、ACL とは無関係です。バージョンレベルの不変サポートはデータ保護機能、大きなファイル共有は Azure Files の容量拡張機能であり、いずれも POSIX ACL の要件を満たしません。

| 機能 | 用途 | POSIX ACL 対応 |
| :--- | :--- | :--- |
| **階層型名前空間** | ファイルシステム階層構造と ACL | **対応** |
| アクセス層 | ストレージコスト最適化 | 非対応 |
| 不変サポート | データ保護とコンプライアンス | 非対応 |

#### **リファレンス**
*   [Azure Data Lake Storage Gen2](https://learn.microsoft.com/ja-jp/azure/storage/blobs/data-lake-storage-introduction)
*   [階層型名前空間](https://learn.microsoft.com/ja-jp/azure/storage/blobs/data-lake-storage-namespace)
*   [POSIX ACL](https://learn.microsoft.com/ja-jp/azure/storage/blobs/data-lake-storage-access-control)

---

### **問題 497. Azure Site Recovery で保護されている仮想マシン VM1 があります。VM1 をプライマリリージョンからセカンダリリージョンにフェールオーバーしました。フェールオーバー後、VM1 をプライマリリージョンに再びレプリケートするために再保護を実行します。再保護を実行する前の VM1 のステータスはどれですか。（一つ選択）**

*   Failover committed
*   Cleanup test failover pending
*   Committing failover
*   Failover completed

#### **解答例**
*   **Failover committed**

#### **解説**
Azure Site Recovery でフェールオーバーを実行した後、仮想マシンを再保護する前に必要なステータスは**「Failover committed」**です。フェールオーバーのプロセスは複数の段階を経て完了します。

フェールオーバー実行後、仮想マシンは一時的な状態となり、管理者がフェールオーバーの結果を確認します。この時点では、元のリージョンへの復旧が可能な状態が維持されています。確認後、**フェールオーバーをコミットすることで、セカンダリリージョンでの運用が確定し、ステータスが「Failover committed」に変わります。**

このステータスになって初めて、再保護 (Reprotect) 操作が可能になります。再保護により、現在稼働しているセカンダリリージョンからプライマリリージョンへの逆方向のレプリケーションが開始されます。これにより、将来的にプライマリリージョンへのフェールバックが可能になります。

フェールオーバーのステータス遷移を以下に示します。

| ステータス | 説明 | 次のアクション |
| :--- | :--- | :--- |
| Failover in progress | フェールオーバー実行中 | 完了を待機 |
| **Failover committed** | フェールオーバー確定済み | **再保護が可能** |
| Reprotection in progress | 再保護実行中 | 完了を待機 |

再保護を実行しないと、プライマリリージョンへのフェールバックができないため、ディザスタリカバリ戦略において重要な手順となります。

#### **リファレンス**
*   [Azure Site Recovery](https://learn.microsoft.com/ja-jp/azure/site-recovery/site-recovery-overview)
*   [再保護 (Reprotect)](https://learn.microsoft.com/ja-jp/azure/site-recovery/azure-to-azure-how-to-reprotect)

---

### **問題 498. Azure サブスクリプション内に以下のリソースが構成されています。VM-A から Storage-A へのトラフィックが、インターネットを経由せず Microsoft バックボーンネットワーク経由で通信するようにします。どの機能を構成しますか。（一つ選択）**

| 名前 | 種類 | 説明 |
| :--- | :--- | :--- |
| vgw-A | 仮想ネットワークゲートウェイ | オンプレミスネットワークへのサイト間 VPN 接続用 |
| Storage-A | ストレージアカウント | Standard パフォーマンス層 |
| VNet-A | 仮想ネットワーク | 強制トンネリング有効 |
| VM-A | 仮想マシン | VNet-A に接続 |

*   Azure Firewall
*   サービスエンドポイント
*   Azure Private Link
*   ネットワークセキュリティグループ (NSG)

#### **解答例**
*   **サービスエンドポイント**

#### **解説**
VM-A から Storage-A への通信を Microsoft バックボーンネットワーク経由にするには、**サービスエンドポイントを構成します。** サービスエンドポイントは、仮想ネットワークから Azure PaaS サービス（ストレージアカウントなど）への通信を、**インターネットを経由せず Microsoft のプライベートネットワーク経由で行う機能です。**

VNet-A にサービスエンドポイントを有効化し、Storage-A のファイアウォール設定で VNet-A からのアクセスを許可することで、VM-A から Storage-A へのトラフィックは自動的に Microsoft バックボーンネットワークを経由します。この構成により、通信のセキュリティが向上し、レイテンシも削減されます。

Azure Firewall はネットワークトラフィックのフィルタリングに使用しますが、通信経路の制御には直接関与しません。NSG はトラフィックの許可・拒否を制御しますが、通信経路は変更しません。Azure Private Link はプライベートエンドポイントを使用して PaaS サービスにアクセスする機能ですが、サービスエンドポイントより複雑な構成が必要です。

| 機能 | 通信経路 | 用途 |
| :--- | :--- | :--- |
| **サービスエンドポイント** | Microsoft バックボーン | VNet から PaaS への最適化された通信 |
| Private Link | プライベート IP 経由 | VNet 内への PaaS サービス統合 |
| NSG | 経路変更なし | トラフィックフィルタリング |

#### **リファレンス**
*   [仮想ネットワークサービスエンドポイント](https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-network-service-endpoints-overview)
*   [Azure Private Link](https://learn.microsoft.com/ja-jp/azure/private-link/private-link-overview)
*   [Azure ストレージアカウント](https://learn.microsoft.com/ja-jp/azure/storage/common/storage-account-overview)

---

### **問題 499. 次の構成を持つロードバランサーをデプロイしました。名前：LB1、タイプ：内部、SKU：Standard、仮想ネットワーク：VNET1。LB1 のバックエンドプールに VM1 と VM2 を追加できるようにします。解決策：Basic SKU のパブリック IP アドレスを作成し、VM1 のネットワークインターフェイスに関連付けてから VM1 を起動します。この解決策は目標を達成していますか。（一つ選択）**

*   いいえ
*   はい

#### **解答例**
*   **いいえ**

#### **解説**
この解決策は目標を達成していません。**Standard SKU の内部ロードバランサーに VM を追加する際、Basic SKU のパブリック IP アドレスを使用することは適切ではありません。**

Standard SKU のロードバランサーは、**同じ SKU レベルのリソースとのみ互換性があります。** 内部ロードバランサー (Internal Load Balancer) は、仮想ネットワーク内のプライベート IP アドレスを使用してトラフィックを分散するため、パブリック IP アドレスは不要です。さらに、Standard SKU のロードバランサーに VM を追加する場合、VM のネットワークインターフェイスは Standard SKU のパブリック IP アドレスを使用するか、パブリック IP アドレスを持たない構成にする必要があります。

正しい解決策は、VM1 と VM2 が同じ仮想ネットワーク (VNET1) 内に存在し、適切なネットワークセキュリティグループ (NSG) の設定がされていることを確認した上で、VM をバックエンドプールに追加することです。内部ロードバランサーの場合、VM にパブリック IP アドレスを割り当てる必要はありません。

| 項目 | Standard SKU | Basic SKU |
| :--- | :--- | :--- |
| 互換性 | Standard 同士のみ | Basic 同士のみ |
| 可用性ゾーン | サポート | 非サポート |
| SLA | 99.99% | なし |

#### **リファレンス**
*   [Azure Load Balancer](https://learn.microsoft.com/ja-jp/azure/load-balancer/load-balancer-overview)
*   [Standard SKU](https://learn.microsoft.com/ja-jp/azure/load-balancer/skus)
*   [Network Security Group](https://learn.microsoft.com/ja-jp/azure/virtual-network/network-security-groups-overview)

---

### **問題 500. あなたの組織が所有する Azure サブスクリプション「Sub-A」には、Recovery Services コンテナー「RSV-A」と、次の表に示す仮想マシンがあります。各仮想マシンについて、深夜 2 時に毎日のバックアップが実行されるようにスケジュールします。このとき、Azure Backup を使用してバックアップできる仮想マシンを選択してください。（該当するものをすべて選択）**

| 名前 | オペレーティングシステム | 自動シャットダウン |
| :--- | :--- | :--- |
| VM-A | Windows Server 2012 R2 | オフ |
| VM-B | Windows Server 2016 | 19:00 |
| VM-C | Ubuntu Server 10.04 LTS | オフ |
| VM-D | Windows 11 | 19:00 |

*   VM-A、VM-B、VM-D
*   VM-A、VM-B
*   VM-A、VM-C
*   VM-A、VM-B、VM-C、VM-D

#### **解答例**
*   **VM-A、VM-B、VM-D**

#### **解説**
Azure Backup では、仮想マシンがシャットダウン状態であってもバックアップを実行できます。バックアップの可否を決定する主要な要素は、**オペレーティングシステムのサポート状況です。**

VM-A は Windows Server 2012 R2 を実行しており、Azure Backup でサポートされています。自動シャットダウンがオフのため、深夜 2 時のバックアップ実行時に稼働状態です。

VM-B は Windows Server 2016 を実行しており、Azure Backup でサポートされています。19:00 に自動シャットダウンが設定されていますが、**Azure Backup は仮想マシンがシャットダウン状態でもバックアップを実行できます。**

VM-C は Ubuntu Server 10.04 LTS を実行していますが、**このバージョンは Azure Backup でサポートされていません。** Azure Backup がサポートする Linux ディストリビューションは、Ubuntu 12.04 以降、CentOS 6.5 以降、Red Hat Enterprise Linux 6.7 以降などです。

VM-D は Windows 11 を実行しており、Azure Backup でサポートされています。19:00 に自動シャットダウンが設定されていますが、シャットダウン状態でもバックアップは実行されます。

| 仮想マシン | OS | サポート状況 | バックアップ可否 |
| :--- | :--- | :--- | :--- |
| VM-A | Windows Server 2012 R2 | サポート対象 | 可能 |
| VM-B | Windows Server 2016 | サポート対象 | 可能 |
| VM-C | Ubuntu 10.04 LTS | サポート対象外 | **不可** |
| VM-D | Windows 11 | サポート対象 | 可能 |






ご指定いただいたソース（PDFの抜粋）に含まれる文章を、省略することなく全文出力します。システムの実装ルールに基づき、各文の末尾に引用元パスのインデックスを付与します。

---

**リファレンス**
・Azure Backup
・Recovery Services Vault

**問題 501. Azure ストレージアカウント「storage1」があります。**
**AzCopy を使用して storage1 にデータをコピーします。AzCopy でデータをコピーできる storage1 内のストレージサービスを特定します。正しいものを選択してください。（一つ選択）**
・Blob、File、Table のみ
・Blob、File、Table、Queue すべて
・Blob と File のみ
・File と Table のみ
・File のみ

**解答例**
・Blob と File のみ

**解説**
AzCopy は、Azure ストレージアカウント間でデータを効率的にコピーするためのコマンドラインツールです。 このツールがサポートするストレージサービスは限定されており、すべての Azure ストレージサービスに対応しているわけではありません。
AzCopy が対応しているストレージサービスは、Blob Storage と File Storage の 2 つです。 Blob Storage は非構造化データの保存に適しており、File Storage はファイル共有のシナリオで使用されます。 一方、Table Storage と Queue Storage は、AzCopy の転送対象としてサポートされていません。 これらのサービスには、それぞれ専用の SDK や API を使用してデータをアクセスする必要があります。
AzCopy は大容量データの転送に最適化されており、並列処理や再開機能を備えています。 Azure Blob Storage では、ブロック Blob、ページ Blob、追加 Blob のすべてのタイプに対応し、Azure File Storage では、SMB プロトコルを使用したファイル共有へのアップロードとダウンロードが可能です。

| ストレージサービス | AzCopy 対応 | 用途 |
| :--- | :--- | :--- |
| Blob Storage | 対応 | 非構造化データ保存 |
| File Storage | 対応 | ファイル共有 |
| Table Storage | 非対応 | NoSQL データ保存 |
| Queue Storage | 非対応 | メッセージキュー |

AzCopy を使用する際は、Azure AD による認証または SAS トークンを使用した認証が必要です。 コマンドラインから実行する場合、以下のような形式でコピー操作を実行します。
azcopy copy 'ソースパス' 'コピー先 URL' --recursive

**リファレンス**
・AzCopy
・Azure Blob Storage
・Azure File Storage

**問題 502. あなたの組織では、Azure サブスクリプション内にリソースグループ RG-A が存在します。ARM テンプレート template-A を使用して新しいリソースをデプロイする際、既存のリソースをすべて削除してから新しいリソースをデプロイする必要があります。次の PowerShell コマンドを完成させてください。（一つ選択）**
`New-AzResourceGroupDeployment -TemplateUri "https://hogehoge.com/template-A" -TemplateParameterFile params.json -Mode Complete -[ ]`
・-Tag
・-Name
・-ResourceGroupName
・-DeploymentDebugLogLevel

**解答例**
・-ResourceGroupName

**解説**
この問題は、Azure Resource Manager (ARM) テンプレートを使用したリソースデプロイにおいて、既存のリソースの完全置換を実現する PowerShell コマンドの構文を問うものです。
New-AzResourceGroupDeployment コマンドレットでは、-Mode パラメータに「Complete」を指定することで、テンプレートに定義されていないリソースグループ内の既存リソースをすべて削除します。 この動作により、デプロイ後はテンプレートで定義されたリソースのみが残ります。 コマンドを実行するには、対象となるリソースグループを -ResourceGroupName パラメータで指定する必要があります。
-Name パラメータはデプロイメント名の指定に使用されますが必須ではなく、省略時は自動生成されます。 -Tag はリソースへのタグ付けに使用され、-DeploymentDebugLogLevel はデバッグログの詳細レベルを制御しますが、いずれも今回の要件には該当しません。

デプロイモードの比較を以下に示します。
| モード | 動作 | 用途 |
| :--- | :--- | :--- |
| Incremental | 既存リソースを保持し新規追加のみ | 通常のデプロイ |
| Complete | テンプレート外のリソースを削除 | 環境の完全再構築 |
| Validate | デプロイせず検証のみ実行 | 事前確認 |

Complete モードは既存リソースを削除するため、本番環境での使用には十分な注意が必要です。 誤って重要なリソースを削除しないよう、事前に What-If オプションで影響範囲を確認することを推奨します。

**リファレンス**
・ARM Template

**問題 503. Subscription1 という名前の Azure サブスクリプションがあります。Subscription1 に転送する必要がある 5TB のデータがあります。Azure Import/Export ジョブを使用する予定です。インポートされたデータの宛先として使用できるものはどれですか。（一つ選択）**
・Azure Blob Storage
・Azure Files
・Azure Data Lake Storage Gen2
・Azure Managed Disks

**解答例**
・Azure Blob Storage

**解説**
Azure Import/Export サービスは、物理ディスクドライブを使用して大量のデータを Azure データセンターに安全に転送するサービスです。 このサービスでインポート可能な宛先は限定されています。
Azure Import/Export ジョブでサポートされるインポート先は、Azure Blob Storage（ブロック Blob およびページ Blob）と Azure Files の 2 種類のみです。 5TB という大容量データの転送において、ネットワーク経由では時間とコストがかかるため、物理ディスクを使用した Import/Export サービスが有効です。
Azure Data Lake Storage Gen2 は、Azure Blob Storage をベースとしていますが、Import/Export ジョブの直接的な宛先としては指定できません。 Azure Managed Disks も同様に Import/Export ジョブの宛先としてはサポートされていません。

| サービス | Import/Export 対応 | 用途 |
| :--- | :--- | :--- |
| Azure Blob Storage | 対応 | オブジェクトストレージ |
| Azure Files | 対応 | ファイル共有 |
| Azure Data Lake Storage Gen2 | 非対応 | ビッグデータ分析 |

Azure Import/Export サービスを使用する際は、BitLocker で暗号化された SATA HDD または SSD を準備し、Azure portal でインポートジョブを作成します。 その後、物理ドライブを Azure データセンターに発送することで、大容量データを効率的に転送できます。

**リファレンス**
・Azure Import/Export
・Azure Blob Storage
・Azure Files

**問題 504. App1 を移行した後、バックアップソリューションを実装します。最初に作成すべきものはどれですか。（一つ選択）**
・Recovery Services コンテナー
・Azure Backup Server
・バックアップポリシー
・Azure Site Recovery プラン

**解答例**
・Recovery Services コンテナー

**解説**
Azure でバックアップソリューションを実装する際は、まず Recovery Services コンテナーの作成が必須です。 これはバックアップデータを格納する論理的なストレージコンテナーであり、すべてのバックアップ操作の基盤となります。
Recovery Services コンテナーを作成後、バックアップポリシーを定義してバックアップのスケジュールや保持期間を設定します。 Azure Backup Server は、オンプレミス環境のワークロードをバックアップする際に使用する追加コンポーネントですが、Azure リソースのバックアップには必須ではありません。 Azure Site Recovery プランは、ディザスタリカバリのフェールオーバー手順を定義するものであり、バックアップの初期設定とは異なる目的で使用されます。

バックアップ実装の基本的な順序は以下の通りです。
| 順序 | 実施項目 | 説明 |
| :--- | :--- | :--- |
| 1 | Recovery Services コンテナー作成 | バックアップデータの保管場所を確保 |
| 2 | バックアップポリシー設定 | スケジュールと保持期間を定義 |
| 3 | バックアップの有効化 | 対象リソースに対してバックアップを開始 |

Recovery Services コンテナーは、Azure ポータルから作成でき、リージョンとリソースグループを指定します。 作成後は、バックアップ対象のリソースタイプ（仮想マシン、SQL データベース、ファイル共有など）に応じて適切なバックアップ構成を行います。

**リファレンス**
・Recovery Services Vault
・Azure Backup
・Backup Policy

**問題 505. あなたの会社には、オンプレミスの Active Directory ドメインとハイブリッド共存するように構成された hogehoge.com という名前の Microsoft Entra ID（旧 Azure AD）テナントがあります。DirSync1 という名前のサーバーがディレクトリ同期サーバーとして構成されています。オンプレミスの Active Directory で新しいユーザーアカウントを作成しました。このユーザー情報を直ちに Microsoft Entra ID にレプリケートする必要があります。解決策：ドメインコントローラーで NetLogon サービスを再起動します。この解決策は目標を達成していますか？（一つ選択）**
・いいえ
・Microsoft Entra Connect Sync サービスを再起動する
・はい
・Start-ADSyncSyncCycle コマンドレットを実行する

**解答例**
・いいえ

**解説**
この問題は、オンプレミス Active Directory から Microsoft Entra ID へのディレクトリ同期を即座に実行する方法を問うものです。
NetLogon サービスはドメインコントローラー上で動作し、ドメイン認証やセキュアチャネルの確立を担当するサービスですが、Microsoft Entra ID への同期処理とは直接関係がありません。 したがって、NetLogon サービスの再起動では目標を達成できません。
オンプレミスの Active Directory オブジェクトを即座に Microsoft Entra ID に同期するには、Microsoft Entra Connect（旧 Azure AD Connect）が提供する同期メカニズムを利用する必要があります。 具体的には、同期サーバー上で PowerShell コマンドレット `Start-ADSyncSyncCycle -PolicyType Delta` を実行することで、差分同期を即座にトリガーできます。
通常、Microsoft Entra Connect は 30 分ごとに自動的に差分同期を実行しますが、即座に同期が必要な場合は手動で同期サイクルを開始する必要があります。 また、Microsoft Entra Connect Synchronization Service を再起動する方法もありますが、これはサービス全体の再起動を伴うため、PowerShell コマンドレットの実行がより適切な方法です。

| 方法 | 効果 | 推奨度 |
| :--- | :--- | :--- |
| NetLogon サービス再起動 | 同期に影響なし | 不適切 |
| Start-ADSyncSyncCycle 実行 | 即座に同期開始 | 最適 |
| 自動同期待機 | 最大 30 分後に同期 | 遅延あり |

**リファレンス**
・Microsoft Entra Connect
・Hybrid Identity

**問題 506. Azure サブスクリプションがあります。複数のポッドを含む Azure Kubernetes Service (AKS) クラスターをデプロイします。ポッドは Kubernetes ネットワーキングを使用します。ポッド間のネットワークトラフィックを制限します。AKS クラスターで構成すべきものはどれですか。（一つ選択）**
・Azure Network Policy
・Network Security Group (NSG)
・Calico Network Policy
・Azure Firewall

**解答例**
・Calico Network Policy

**解説**
AKS クラスター内のポッド間通信を制御するには、Kubernetes Network Policy を実装する必要があります。 AKS では、Azure Network Policy と Calico Network Policy の 2 つのネットワークポリシーエンジンから選択できます。
Kubernetes 環境では、デフォルトですべてのポッド間通信が許可されています。 セキュリティ要件に応じてポッド間のトラフィックを制限するには、Network Policy リソースを定義し、それを実装するポリシーエンジンが必要です。
Calico Network Policy は、オープンソースのネットワークおよびネットワークセキュリティソリューションで、Kubernetes ネットワーキングに対応しています。 Azure Network Policy と比較して、より高度なポリシー機能を提供し、グローバルネットワークポリシー、ホストエンドポイント保護、サービスアカウントベースのポリシーなどをサポートします。
Network Security Group (NSG) は Azure のネットワークレベルのセキュリティ機能ですが、Kubernetes ポッド間の通信制御には使用できません。 NSG はサブネットや NIC レベルで動作し、AKS ノード間の通信制御には利用できますが、ポッド単位の細かい制御には対応していません。
Azure Firewall は、Azure Virtual Network リソースを保護するマネージドクラウドベースのネットワークセキュリティサービスですが、AKS クラスター内のポッド間通信の制御には適していません。

| ポリシーエンジン | 特徴 | 適用範囲 |
| :--- | :--- | :--- |
| Azure Network Policy | Azure ネイティブ実装 | 基本的なポリシー制御 |
| Calico Network Policy | 高度な機能とポリシー | 詳細なポリシー制御 |
| NSG | サブネット/NIC レベル | AKS ノード間通信 |

**リファレンス**
・Azure Kubernetes Service (AKS)
・Calico

**問題 507. Subscription1 という名前の Azure サブスクリプションがあります。Subscription1 には、RG1 (West Europe、Policy1 が適用) と RG2 (North Europe、Policy2 が適用) という 2 つのリソースグループが含まれています。RG1 には WebApp1 という名前の Web アプリがあり、West Europe に配置されています。WebApp1 を RG2 に移動した場合、どのような影響がありますか。（一つ選択）**
・WebApp1 の App Service plan は West Europe に残り、Policy2 が適用されます。
・WebApp1 の App Service plan は North Europe に移動し、Policy1 が適用されます。
・WebApp1 の App Service plan は West Europe に残り、Policy1 が適用されます。
・WebApp1 の リージョンが North Europe に変更され、Policy2 が適用されます。

**解答例**
・WebApp1 の App Service plan は West Europe に残り、Policy2 が適用されます。

**解説**
Azure リソースを別のリソースグループに移動する際の重要なポイントは、リソースの物理的な配置場所とポリシーの適用範囲を理解することです。
App Service の Web アプリをリソースグループ間で移動する場合、Web アプリリソースのメタデータのみが RG2 に移動します。 App Service plan は独立したリソースであり、Web アプリと App Service plan は親子関係ではなく参照関係にあります。 そのため、Web アプリを移動しても App Service plan は元のリソースグループ (RG1) とリージョン (West Europe) に残ります。
Azure Policy は、リソースグループまたはサブスクリプションレベルで適用されます。 Web アプリが RG2 に移動すると、RG1 に適用されていた Policy1 は適用されなくなり、移動先の RG2 に適用されている Policy2 が新たに適用されます。 ポリシーの適用はリソースの所属するリソースグループに基づいて決定されます。
リソースの物理的なリージョンは、リソースグループの移動では変更されません。 Web アプリのリージョンを変更するには、別のリージョンに新しい App Service リソースを作成し、アプリケーションコードとデータを移行する必要があります。

| 項目 | 移動前 | 移動後 |
| :--- | :--- | :--- |
| WebApp1 の所属 | RG1 | RG2 |
| App Service plan の場所 | West Europe (RG1) | West Europe (RG1) |
| 適用されるポリシー | Policy1 | Policy2 |

**リファレンス**
・App Service Plan
・Azure Policy
・Resource group

**問題 508. Azure サブスクリプション「Subscription1」があります。Subscription1 にはリソースグループ「RG1」が含まれています。RG1 にはテンプレートを使用してデプロイされたリソースが含まれています。RG1 内のリソースが作成された日時を確認します。解決策：RG1 ブレードから「Automation script」をクリックします。この解決策は目標を達成していますか？（一つ選択）**
・いいえ
・はい

**解答例**
・いいえ

**解説**
Automation script はリソースグループ内のリソースをテンプレート化してエクスポートする機能であり、リソースの作成日時を確認する目的には適していません。 リソースの作成日時を確認するには、リソースグループブレードの「Deployments」セクションを使用する必要があります。
Deployments セクションでは、リソースグループに対して実行されたすべてのデプロイメント操作の履歴が時系列で表示されます。 各デプロイメント項目をクリックすると、デプロイメントの詳細情報として実行日時、使用されたテンプレート、デプロイされたリソースの一覧、デプロイメントの状態などを確認できます。
Automation script は既存のリソース構成を ARM Template 形式でエクスポートする機能であり、Infrastructure as Code の実装やリソースの複製に使用されます。 この機能では現在の構成情報は取得できますが、リソースの作成日時やデプロイメント履歴といった時系列情報は含まれません。

| 機能 | 用途 | 作成日時の確認 |
| :--- | :--- | :--- |
| Deployments | デプロイ履歴の確認 | 可能 |
| Automation script | テンプレートのエクスポート | 不可能 |
| Activity log | 操作ログの確認 | 可能 |

**リファレンス**
・ARM Template
・Azure Resource Manager

**問題 509. Azure サブスクリプションに複数のリソースが含まれています。East US リージョンの VM1 を West US リージョンにレプリケートするために Azure Site Recovery を構成しました。VM1 のテストフェールオーバーを実行し、ターゲット仮想ネットワークとして VNET2 を指定します。テスト用の VM1 が作成されたとき、この仮想マシンはどのサブネットに接続されますか。（一つ選択）**

| リソース名 | リソースタイプ | リージョン | サブネット構成 |
| :--- | :--- | :--- | :--- |
| VM1 | 仮想マシン | East US | VNET1/Subnet1 に接続 |
| VNET1 | 仮想ネットワーク | East US | Subnet1 を含む |
| VNET2 | 仮想ネットワーク | West US | RecoverySubnetA、RecoverySubnetB を含む |

・RecoverySubnetB
・Subnet1
・TestSubnet1
・RecoverySubnetA

**解答例**
・RecoverySubnetA

**解説**
Azure Site Recovery のテストフェールオーバーでは、ソース仮想マシンが接続されているサブネット名と同じ名前のサブネットがターゲット仮想ネットワーク内に存在する場合、そのサブネットに自動的に接続されます。 同じ名前のサブネットが存在しない場合は、アルファベット順で最初のサブネットに接続されます。
本問では、VM1 はソース環境で Subnet1 に接続されていますが、ターゲット仮想ネットワーク VNET2 には Subnet1 が存在しません。 このため、VNET2 内のサブネットをアルファベット順に評価し、最初に該当する RecoverySubnetA に接続されます。
テストフェールオーバーは本番環境に影響を与えずにディザスタリカバリ計画を検証するための機能です。 ネットワークマッピングを事前に構成することで、フェールオーバー時の接続先サブネットを明示的に指定することも可能です。

サブネット選択ルール
| 条件 | 接続先サブネット |
| :--- | :--- |
| 同名サブネットが存在 | ソースと同じ名前のサブネット |
| 同名サブネットが不在 | アルファベット順で最初のサブネット |
| ネットワークマッピング設定済 | マッピングで指定されたサブネット |

**リファレンス**
・Azure Site Recovery

**問題 510. Azure サブスクリプションに 20 個の仮想ネットワークと 500 台の仮想マシンが含まれています。新しい仮想マシン VM501 をデプロイしましたが、サブスクリプション内の仮想マシン VM20 と通信できないことが判明しました。ネットワークセキュリティグループ (NSG) が原因であると疑われます。NSG が通信をブロックしているかどうかを特定する必要があります。ソリューションは管理作業を最小限に抑える必要があります。何を使用しますか。（一つ選択）**
・NSG フローログ
・診断ログ
・IP フロー検証
・接続のトラブルシューティング

**解答例**
・IP フロー検証

**解説**
この問題の最重要ポイントは、NSG による通信ブロックを迅速に特定するための最適なツールを選択することです。 管理作業を最小限に抑えながら、即座に結果を得られる方法が求められています。
IP フロー検証 (IP flow verify) は、Network Watcher の機能で、特定の送信元と宛先間の通信が許可されているか拒否されているかを即座に確認できます。 仮想マシン名、プロトコル、ポート番号、送信元 IP アドレス、宛先 IP アドレスを指定するだけで、NSG ルールによって通信が許可または拒否されているかを数秒で判定できます。 どの NSG ルールが適用されているかも表示されるため、問題の特定が容易です。
NSG フローログは、NSG を通過するすべてのトラフィックを記録する機能ですが、ログの有効化、ストレージアカウントの構成、ログの分析に時間がかかります。 診断ログも同様に、ログの収集と分析に時間を要します。 接続のトラブルシューティングは包括的な診断ツールですが、IP フロー検証よりも設定項目が多く、NSG の問題特定に特化していません。

各ツールの比較を以下に示します。
| ツール | 即時性 | NSG 特化 |
| :--- | :--- | :--- |
| IP フロー検証 | 即座に結果表示 | NSG ルール判定に最適 |
| NSG フローログ | ログ収集に時間要 | 長期的な分析向け |
| 診断ログ | ログ収集に時間要 | 包括的な診断向け |

**リファレンス**
・Network Watcher
・Network Security Group
・IP flow verify

**問題 511. 西ヨーロッパリージョンに配置されたストレージアカウント「storage-A」があります。このストレージアカウントの BLOB データを米国東部リージョンに自動的にレプリケートする必要があります。管理オーバーヘッドを最小限に抑えながら、データの地理的冗長性を確保するソリューションを実装します。どの機能を構成しますか。（一つ選択）**
・読み取りアクセス geo 冗長ストレージ (RA-GRS)
・オブジェクト レプリケーション
・geo 冗長ストレージ (GRS)
・Azure Backup

**解答例**
・geo 冗長ストレージ (GRS)

**解説**
この問題の最重要ポイントは、Azure ストレージアカウントの冗長性オプションを理解し、管理労力を最小限に抑えながら地理的に離れたリージョン間でデータをレプリケートする方法を選択することです。
geo 冗長ストレージ (GRS) は、プライマリリージョンのデータを自動的にセカンダリリージョンにレプリケートします。 西ヨーロッパをプライマリリージョンとして設定すると、Azure が自動的にペアリージョン（この場合は北ヨーロッパ）にレプリケートしますが、GRS の設定により数百キロメートル離れた別リージョンへの非同期レプリケーションが実行されます。 この機能はストレージアカウントの冗長性設定を変更するだけで有効化でき、追加の管理作業は不要です。
オブジェクト レプリケーションは特定のコンテナ間で BLOB を非同期的にコピーする機能ですが、レプリケーションポリシーの作成と管理が必要となり、管理労力が増加します。 また、ソースとターゲットの両方のストレージアカウントで BLOB バージョニングを有効化する必要があります。
Azure Backup は主にバックアップと復元のためのサービスであり、リアルタイムのデータレプリケーションには適していません。 読み取りアクセス geo 冗長ストレージ (RA-GRS) は GRS の機能に加えてセカンダリリージョンへの読み取りアクセスを提供しますが、問題文では読み取りアクセスは要件として明示されていません。

| 冗長性オプション | レプリケーション範囲 | 管理労力 |
| :--- | :--- | :--- |
| GRS | プライマリとセカンダリリージョン間 | 最小（自動） |
| オブジェクト レプリケーション | 指定コンテナ間 | 中（ポリシー管理必要） |
| Azure Backup | バックアップ保管庫 | 中（バックアップ構成必要） |

**リファレンス**
・Azure Storage 冗長性

**問題 512. example.hogehoge.com という名前の Microsoft Entra テナントがあります。あなたの会社は hogehoge.com のパブリック DNS ゾーンを所有しています。hogehoge.com をカスタムドメイン名として Microsoft Entra テナントに追加しました。Azure がドメイン名を検証できることを確認します。どのタイプの DNS レコードを作成しますか。（一つ選択）**
・CNAME
・TXT
・PTR
・MX

**解答例**
・TXT

**解説**
Microsoft Entra テナントにカスタムドメイン名を追加する際、ドメインの所有権を証明するために DNS レコードによる検証が必要です。 この検証プロセスでは、TXT レコードまたは MX レコードのいずれかを使用できますが、一般的には TXT レコードが推奨されます。
Azure ポータルでカスタムドメインを追加すると、検証用の文字列が生成されます。 この文字列を DNS プロバイダーの DNS 管理画面で TXT レコードとして登録することで、ドメインの所有権を証明できます。 TXT レコードは任意のテキスト情報を格納できるため、ドメイン検証に最適です。
検証の流れは以下の通りです。 Microsoft Entra テナントでカスタムドメインを追加すると検証用の文字列が表示されます。 DNS プロバイダーの管理画面で、ホスト名に「@」または空白、値に検証用文字列を設定した TXT レコードを作成します。 DNS 変更が伝播するまで待機し、Azure ポータルで検証を実行します。 検証が成功すると、カスタムドメインが利用可能になります。
各 DNS レコードタイプの用途を以下に整理します。

| レコードタイプ | 主な用途 |
| :--- | :--- |
| TXT | ドメイン検証、SPF レコード、その他のテキスト情報 |
| MX | メールサーバーの指定 |
| CNAME | ドメインのエイリアス設定 |
| PTR | IP アドレスから逆引き DNS 解決 |

PTR レコードは逆引き DNS に使用され、CNAME レコードはドメインのエイリアスを作成する際に使用されますが、いずれもドメイン検証には使用されません。 MX レコードもドメイン検証に使用できますが、メールルーティングに影響を与える可能性があるため、TXT レコードの使用が推奨されます。

**リファレンス**
・Microsoft Entra ID
・Custom Domain

**問題 513. あなたの組織が所有する Azure サブスクリプション内に以下のリソースが存在します。VMSS-Alpha は仮想マシンオーケストレーションモードで構成されています。新規に VM-Beta という名前の Azure 仮想マシンをデプロイし、この VM を VMSS-Alpha に追加します。VM-Beta をデプロイする際に使用するリージョンを選択してください。（一つ選択）**

| 名前 | タイプ | リソースグループ | リージョン |
| :--- | :--- | :--- | :--- |
| RG-Alpha | リソースグループ | 該当なし | 米国中部 |
| RG-Beta | リソースグループ | 該当なし | 米国西部 |
| RG-Gamma | リソースグループ | 該当なし | 米国東部 |
| VMSS-Alpha | 仮想マシンスケールセット | RG-Alpha | 米国西部 |

・米国西部
・米国東部、米国中部、または米国西部
・米国中部
・米国中部または米国西部

**解答例**
・米国西部

**解説**
仮想マシンオーケストレーションモードで構成された Virtual Machine Scale Sets に既存の仮想マシンを追加する場合、追加する仮想マシンは必ずスケールセットと同じリージョンにデプロイしなければなりません。 これは Azure のリージョン間でのリソース配置に関する基本的な制約です。
表を確認すると、VMSS-Alpha は米国西部リージョンにデプロイされています。 したがって、このスケールセットに追加する VM-Beta も米国西部リージョンにデプロイしなければなりません。 リソースグループ RG-Alpha が米国中部に存在していても、スケールセット自体のリージョンが優先されます。
仮想マシンオーケストレーションモードでは、既存の仮想マシンをスケールセットに追加できる柔軟性がありますが、リージョンの一致は必須要件です。 異なるリージョンの仮想マシンを同一のスケールセットに追加することはできません。

| 項目 | 要件 |
| :--- | :--- |
| 追加先スケールセット | VMSS-Alpha（米国西部） |
| 新規 VM 配置先 | 米国西部（必須） |
| リージョン制約 | スケールセットと同一リージョン |

**リファレンス**
・Virtual Machine Scale Set
・Azure Region

**問題 514. Azure サブスクリプション内に仮想ネットワーク VNet-A があり、以下の構成となっています。VNet-A には 3 つのサブネットがあり、それぞれに仮想マシンが配置されています。VM-C には複数のネットワークアダプタがあり、そのうち NIC-C で IP 転送が有効化されており、VM-C 上でルーティング機能が動作しています。ルートテーブル RT-A を作成し、Subnet-A と Subnet-B に関連付けました。この環境において、VM-C から VM-A へのネットワーク接続が確立できるかどうかを判断します。（一つ選択）**

仮想マシンの構成：
| 名前 | IP アドレス |
| :--- | :--- |
| VM-A | 10.0.1.4 |
| VM-B | 10.0.2.4 |
| VM-C | 10.0.3.4 |

サブネットの構成：
| 名前 | アドレス空間 | 接続された仮想マシン |
| :--- | :--- | :--- |
| Subnet-A | 10.0.1.0/24 | VM-A |
| Subnet-B | 10.0.2.0/24 | VM-B |
| Subnet-C | 10.0.3.0/24 | VM-C |

ルートテーブル RT-A の内容：
| アドレスプレフィックス | ネクストホップのタイプ | ネクストホップアドレス |
| :--- | :--- | :--- |
| 10.0.1.0/24 | 仮想アプライアンス | 10.0.3.4 |
| 10.0.2.0/24 | 仮想アプライアンス | 10.0.3.4 |

・いいえ、VM-C から VM-A への接続は確立できない
・はい、VM-C から VM-A への接続は確立できる

**解答例**
・はい、VM-C から VM-A への接続は確立できる

**解説**
この問題では Azure 仮想ネットワークにおけるカスタムルートとユーザー定義ルート (UDR) の動作を理解する必要があります。
VM-C は Subnet-C に配置されており、ルートテーブル RT-A は Subnet-C には関連付けられていません。 RT-A が関連付けられているのは Subnet-A と Subnet-B のみです。 したがって、VM-C からの通信トラフィックは RT-A の影響を受けず、Azure の既定のシステムルートに従って動作します。
Azure 仮想ネットワーク内の既定のルーティング動作では、同一仮想ネットワーク内のすべてのサブネット間は自動的に通信可能です。 VM-C (10.0.3.4) から VM-A (10.0.1.4) への通信は、同一 VNet-A 内の通信であるため、特別なルート設定がなくても Azure の既定ルートによって直接到達可能です。
一方、VM-A から VM-C への戻りトラフィックについては、VM-A が所属する Subnet-A に RT-A が関連付けられているため、10.0.3.0/24 宛のトラフィックは既定ルートで処理されます。 RT-A には 10.0.3.0/24 へのカスタムルートが定義されていないため、Azure の既定ルートが適用され、VM-C への直接通信が可能です。

ルート適用の整理：
| 送信元 | 宛先 | 適用されるルート | 結果 |
| :--- | :--- | :--- | :--- |
| VM-C | VM-A | Azure 既定ルート | 直接到達可能 |
| VM-A | VM-C | Azure 既定ルート | 直接到達可能 |

したがって、VM-C から VM-A へのネットワーク接続は確立できます。

**リファレンス**
・User-Defined Route (UDR)

**問題 515. Azure サブスクリプションに以下の仮想ネットワークと仮想マシンが構成されています。すべての仮想マシンにはプライベート IP アドレスのみが割り当てられています。VNet-A に Bastion-A という名前の Azure Bastion ホストをデプロイしました。Bastion-A 経由で RDP/SSH 接続できる仮想マシンを選択してください。（一つ選択）**

仮想ネットワーク構成
| 名前 | リージョン | ピアリング |
| :--- | :--- | :--- |
| VNet-A | 東日本 | VNet-B |
| VNet-B | 東日本 | VNet-A、VNet-C |
| VNet-C | 西日本 | VNet-B |

仮想マシン構成
| 名前 | 接続先 VNet |
| :--- | :--- |
| VM-A | VNet-A |
| VM-B | VNet-B |
| VM-C | VNet-C |

・VM-A、VM-B、VM-C
・VM-A と VM-B のみ
・VM-A のみ
・VM-B と VM-C のみ

**解答例**
・VM-A と VM-B のみ

**解説**
Azure Bastion は、デプロイされた仮想ネットワークとそれに直接ピアリングされた仮想ネットワーク内の仮想マシンに対して RDP/SSH 接続を提供する PaaS 型サービスです。
Bastion-A は VNet-A にデプロイされているため、VNet-A 内の VM-A には直接接続できます。 VNet-A は VNet-B と直接ピアリングされているため、VNet-B 内の VM-B にも接続可能です。
一方、VNet-C は VNet-B とピアリングされていますが、VNet-A とは直接ピアリングされていません。 Azure Bastion は推移的ピアリング (transitive peering) をサポートしないため、VNet-C 内の VM-C には接続できません。 推移的ピアリングとは、VNet-A と VNet-B がピアリングされ、VNet-B と VNet-C がピアリングされている場合に、VNet-A から VNet-C への通信を期待する構成ですが、Azure の仮想ネットワークピアリングではこの動作は既定で無効です。

Azure Bastion の接続範囲
| 接続先 | 接続可否 | 理由 |
| :--- | :--- | :--- |
| VM-A | 可能 | 同一 VNet 内 |
| VM-B | 可能 | 直接ピアリング |
| VM-C | 不可 | 推移的ピアリング |

Azure Bastion を使用して VM-C に接続するには、VNet-A と VNet-C の間に直接ピアリングを構成するか、VNet-C に Bastion ホストを別途デプロイする必要があります。

**リファレンス**
・Azure Bastion
・Virtual Network Peering
・推移的ピアリング

**問題 516. Azure サブスクリプションに、ストレージアカウント storage1 が含まれています。storage1 のアクセスキーが自動的にローテーションされるようにします。何を構成しますか。（一つ選択）**
・Azure Key Vault
・storage1 のライフサイクル管理
・storage1 の冗長性
・Backup Vault

**解答例**
・Azure Key Vault

**解説**
ストレージアカウントのアクセスキーを自動的にローテーションするには、Azure Key Vault を使用します。 Azure Key Vault は、シークレット、キー、証明書を安全に保管し管理するサービスで、ストレージアカウントキーの自動ローテーション機能を提供します。
Azure Key Vault でストレージアカウントを管理対象ストレージアカウントとして登録すると、Key Vault が定期的にアクセスキーを再生成し、古いキーと新しいキーを自動的に切り替えます。 この機能により、セキュリティベストプラクティスに従った定期的なキーローテーションを手動操作なしで実現できます。
ライフサイクル管理は、Blob データの階層移動や削除を自動化する機能であり、アクセスキーのローテーションとは無関係です。 冗長性はデータの可用性と耐久性を高める設定で、キー管理機能は含まれません。 Backup Vault は、Azure Backup 用のストレージコンテナーであり、キーローテーション機能は提供しません。

| 機能 | 用途 | キーローテーション |
| :--- | :--- | :--- |
| Azure Key Vault | シークレット管理とキー自動ローテーション | 対応 |
| ライフサイクル管理 | Blob データの階層移動と削除 | 非対応 |
| 冗長性設定 | データの可用性向上 | 非対応 |

**リファレンス**
・Azure Key Vault

**問題 517. Azure サブスクリプションに Recovery Services コンテナー (Vault1) があります。Vault1 に対して多要素認証 (MUA) を有効化します。最初に作成する必要があるリソースはどれですか。（一つ選択）**
・マネージド ID
・リソース ガード
・管理単位
・Azure カスタム ロール

**解答例**
・リソース ガード

**解説**
Recovery Services コンテナーで多要素認証 (Multi-User Authorization: MUA) を有効化するには、最初にリソース ガード (Resource Guard) を作成する必要があります。 リソース ガードは、重要な操作に対して追加の承認レイヤーを提供するセキュリティ機能です。
MUA は、バックアップデータの削除や保護の停止など、重要な操作を実行する際に、複数のユーザーによる承認を必須とする機能です。 これにより、内部関係者による不正な操作や誤操作からデータを保護できます。 リソース ガードは、保護対象の Recovery Services コンテナーとは別のサブスクリプションまたはテナントに配置することで、より強固なセキュリティを実現します。
実装手順として、まずリソース ガードを作成し、次に Recovery Services コンテナーの設定でこのリソース ガードを関連付けます。 リソース ガードに対する適切なアクセス許可を持つユーザーのみが、保護された操作を承認できるようになります。
マネージド ID は Azure リソースの認証に使用されますが、MUA の前提条件ではありません。 管理単位は Microsoft Entra ID（旧 Azure AD）の管理スコープを定義する機能であり、Recovery Services の MUA とは関係ありません。 Azure カスタム ロールは権限管理に使用されますが、MUA を有効化するための最初のステップではありません。

| 項目 | 説明 |
| :--- | :--- |
| リソース ガード | MUA を実現するための保護リソース |
| MUA | 重要操作に複数ユーザーの承認を要求 |
| 推奨配置 | 別サブスクリプションまたはテナント |

**リファレンス**
・Recovery Services Vault
・リソース ガード

**問題 518. Azure サブスクリプションに VNet1 という名前の仮想ネットワークがあります。ネットワーク検査アプライアンスとして使用する VM1 という名前の仮想マシンをデプロイする予定です。すべてのネットワークトラフィックが VM1 を経由するようにします。何を実行しますか。（一つ選択）**
・ユーザー定義ルート (UDR) を構成する
・ネットワークセキュリティグループ (NSG) のルールを変更する
・仮想ネットワークゲートウェイを作成する
・システムルートを変更する

**解答例**
・ユーザー定義ルート (UDR) を構成する

**解説**
Azure 仮想ネットワーク内のトラフィックフローを制御し、特定の仮想マシンを経由させるには、ユーザー定義ルート (User-Defined Route: UDR) を使用します。 UDR はルートテーブルに追加するカスタムルートで、システムデフォルトルートを上書きしてトラフィックの経路を変更できます。
VM1 をネットワーク検査アプライアンス (Network Virtual Appliance: NVA) として機能させる場合、サブネット間の通信やインターネット向けトラフィックを VM1 経由にルーティングする必要があります。 これを実現するには、ルートテーブルを作成し、次ホップの種類を「仮想アプライアンス」に設定して VM1 のプライベート IP アドレスを設定します。 その後、このルートテーブルを対象サブネットに関連付けることで、すべてのトラフィックが VM1 を通過するようになります。
なお、VM1 のネットワークインターフェイスで IP フォワーディングを有効化し、VM1 の OS 内部でもパケット転送機能を有効にする必要があります。 システムルートは Azure が自動的に管理するルートであり、直接変更することはできません。 仮想ネットワークゲートウェイは VPN 接続や ExpressRoute 接続に使用されるもので、仮想ネットワーク内のトラフィック制御には使用しません。

| 項目 | 説明 |
| :--- | :--- |
| ユーザー定義ルート (UDR) | カスタムルートを定義してトラフィックの経路を制御 |
| 次ホップの種類 | 仮想アプライアンス、仮想ネットワークゲートウェイ、インターネットなど |
| IP フォワーディング | NIC レベルと OS 内部の両方で有効化が必要 |

**リファレンス**
・User-Defined Route (UDR)
・ネットワーク仮想アプライアンス (NVA)

**問題 519. Azure サブスクリプションに、container1 という名前の Docker コンテナイメージがあります。WebApp1 という名前の新しい Azure Web App を作成する予定です。WebApp1 で container1 を使用できるようにします。WebApp1 のどの設定を構成しますか。（一つ選択）**
・Runtime stack
・Application settings
・Publish
・Pricing plan

**解答例**
・Publish

**解説**
Azure Web App でコンテナイメージを使用するには、Web App の作成時または作成後に「Publish」設定で「Docker Container」を選択する必要があります。 この設定により、通常のコードデプロイメントではなく、コンテナベースのデプロイメントモードに切り替わります。
Publish オプションには「Code」と「Docker Container」の 2 つの主要な選択肢があります。 Code を選択した場合は、アプリケーションコードを直接デプロイする従来の方式となり、Docker Container を選択した場合は、コンテナイメージを使用したデプロイメント方式となります。 container1 を使用するには、必ず Docker Container を選択する必要があります。
Runtime stack は、Code ベースのデプロイメントを選択した場合に使用するプログラミング言語やフレームワーク (.NET、Java、Node.js、Python など) を指定する設定です。 コンテナベースのデプロイメントでは、ランタイムはコンテナイメージ内に含まれているため、この設定は使用しません。
Pricing plan は、Web App のパフォーマンスとスケーリング機能を決定する設定ですが、コンテナの使用可否には直接関係しません。 ただし、コンテナベースの Web App を実行するには、Basic 以上のプランが必要です。
Application settings は、環境変数や接続文字列などのアプリケーション構成を管理する設定であり、コンテナの使用を有効にする設定ではありません。

| 設定項目 | 用途 | コンテナ使用との関連 |
| :--- | :--- | :--- |
| Publish | デプロイメント方式の選択 | コンテナ使用に必須の設定 |
| Runtime stack | 言語/フレームワーク選択 | Code モード時のみ使用 |
| Pricing plan | リソース割り当て | 間接的な影響のみ |

**リファレンス**
・Azure App Service
・Azure Container Registry

**問題 520. Azure Kubernetes Service (AKS) クラスターを構築し、kubectl コマンドで IP アドレス設定を確認したところ、以下の情報が得られました。このクラスター上で稼働するアプリケーションにインターネット経由でアクセスできるようにするため、DNS レコードに登録すべき IP アドレスを選択してください。（一つ選択）**

| IP アドレス | 割り当て |
| :--- | :--- |
| 203.0.113.10 | ロードバランサー フロントエンド |
| 192.168.20.5 | Kubernetes DNS サーバー |
| 172.18.0.2 | Docker ブリッジアドレス |
| 10.0.20.15 | Kubernetes クラスター ノード |
| 203.0.113.25 | 仮想ネットワーク ゲートウェイ |

・192.168.20.5
・203.0.113.25
・10.0.20.15
・203.0.113.10

**解答例**
・203.0.113.10

**解説**
インターネットから AKS クラスター上のアプリケーションにアクセスするには、外部公開用のパブリック IP アドレスを DNS レコードに登録する必要があります。 AKS では、LoadBalancer タイプの Service を作成すると、Azure Load Balancer が自動的にプロビジョニングされ、パブリック IP アドレスがフロントエンドに割り当てられます。
表中の各 IP アドレスの役割を整理すると、203.0.113.10 がロードバランサー フロントエンドに割り当てられており、これがインターネットからのトラフィックを受け付けるエントリーポイントとなります。 他の IP アドレスは内部通信やクラスター管理用であり、外部公開には使用されません。
192.168.20.5 は Kubernetes DNS サーバー (CoreDNS) の内部 IP アドレスで、クラスター内のサービス名前解決に使用されます。 172.18.0.2 は Docker ブリッジネットワークのアドレスで、コンテナ間通信に利用されます。 10.0.20.15 は Kubernetes ノードのプライベート IP アドレスで、クラスター内部の通信に使用されます。 203.0.113.25 は仮想ネットワーク ゲートウェイのアドレスで、VPN 接続やオンプレミス環境との接続に使用されますが、直接的なアプリケーション公開には使用しません。
したがって、DNS レコードに登録すべき IP アドレスは、ロードバランサー フロントエンドの 203.0.113.10 です。

| IP アドレス種別 | 用途 | 外部公開 |
| :--- | :--- | :--- |
| ロードバランサー フロントエンド | インターネットからのトラフィック受付 | 可能 |
| Kubernetes DNS サーバー | クラスター内名前解決 | 不可 |
| Docker ブリッジアドレス | コンテナ間通信 | 不可 |

**リファレンス**
・Azure Kubernetes Service (AKS)
・Azure Load Balancer

**問題 521. Azure 仮想マシン「VM-A」に対して Azure Backup を使用してバックアップを作成しました。バックアップ作成後、VM-A に対して以下の変更を実行しました：VM サイズの変更、データディスクの追加、ビルトイン管理者アカウントのパスワードリセット、ファイル「data.xlsx」をフォルダーにコピー。その後、管理者は「既存を置換」オプションを使用してバックアップから VM-A を復元しました。復元後、再度実行する必要がある変更はどれですか。（一つ選択）**
・ビルトイン管理者アカウントのパスワードをリセットする
・VM サイズを変更する
・データディスクを追加する
・ファイル「data.xlsx」をフォルダーにコピーする

**解答例**
・ファイル「data.xlsx」をフォルダーにコピーする

**解説**
Azure Backup の「既存を置換」オプションを使用した復元では、仮想マシンの構成と OS ディスクがバックアップ時点の状態に戻されます。 この復元プロセスにおいて、VM サイズやデータディスクなどのインフラストラクチャレベルの構成は自動的に復元されますが、OS ディスク内のファイルシステム上のデータはバックアップ時点の状態に戻ります。
VM サイズの変更とデータディスクの追加は、Azure 仮想マシンのインフラストラクチャ構成として管理されており、復元時にこれらの設定も含めて復元されます。 ビルトイン管理者アカウントのパスワードは、OS ディスクに保存されている情報であり、バックアップ時点の状態に戻るため、バックアップ作成後に変更したパスワードは失われますが、セキュリティ上の理由から再設定が推奨されるものの、復元後の動作に必須ではありません。
一方、ファイル「data.xlsx」のコピーは、OS ディスク内のファイルシステム操作であり、バックアップ作成後に実行された変更です。 復元によって OS ディスクがバックアップ時点の状態に戻るため、このファイルは存在しない状態になります。 したがって、業務継続のために必要であれば、このファイルコピー操作を再度実行する必要があります。

| 変更内容 | 復元後の状態 | 再実行の必要性 |
| :--- | :--- | :--- |
| VM サイズ変更 | 自動的に復元される | 不要 |
| データディスク追加 | 自動的に復元される | 不要 |
| パスワードリセット | バックアップ時点に戻る | セキュリティ上推奨 |
| ファイルコピー | 失われる | 必要 |

**リファレンス**
・Azure Backup
・Azure Virtual Machine
・Recovery Services Vault

**問題 522. Windows Server を実行する 2 台の Azure 仮想マシン VM1 と VM2 があります。VM1 にはバックアップファイルを保存する単一のデータディスクがアタッチされています。このデータディスクを VM1 から VM2 に可能な限り迅速に移動します。最初に実行すべき操作を選択してください。（一つ選択）**
・VM1 を停止する
・VM2 を停止する
・VM1 からデータディスクをデタッチする
・VM1 を再起動する

**解答例**
・VM1 を停止する

**解説**
Azure 仮想マシン間でマネージドディスクを移動する場合、ディスクをデタッチする前に必ずソース仮想マシンを停止する必要があります。 仮想マシンが実行中の状態では、アタッチされているデータディスクをデタッチすることができません。 これはデータの整合性を保護し、ディスクへの書き込み操作が完了していることを保証するための Azure の仕様です。
作業手順は以下の通りです。 まず VM1 を停止してディスクへのすべての書き込み操作を完了させます。 次に Azure Portal または Azure CLI を使用して VM1 からデータディスクをデタッチします。 デタッチが完了したら、同じディスクを VM2 にアタッチします。 この際 VM2 は実行中でも停止中でも構いませんが、ディスクのアタッチ後に VM2 内でディスクを認識させるには再起動が必要な場合があります。
VM1 の再起動では仮想マシンが実行状態に戻るためディスクのデタッチができません。 VM2 の停止は不要です。 デタッチ操作の前に VM1 を停止していない状態では、Azure Portal でデタッチボタンが無効化されているか、Azure CLI でエラーが返されます。

| 操作 | 必要性 | 理由 |
| :--- | :--- | :--- |
| VM1 の停止 | 必須 | ディスクデタッチの前提条件 |
| ディスクのデタッチ | 必須 | VM1 からディスクを切り離す |
| VM2 へのアタッチ | 必須 | ディスクを VM2 で使用可能にする |

**リファレンス**
・Managed Disk
・Azure CLI

**問題 523. Azure サブスクリプションに複数の ID が含まれています。User1、Principle1、Group1 には Monitoring Reader ロールが割り当てられています。AG1 というアクショングループを使用する Alert1 という名前のアラートルールが存在します。Alert1 がトリガーされたときに電子メール通知を受信するユーザーを特定します。（一つ選択）**
・User1 と User2 のみ
・User1、User2、Principle1、Principle2 のすべて
・User1 のみ
・User1 と Principle1 のみ

**解答例**
・User1 と User2 のみ

**解説**
Azure Monitor のアラート通知は、アクショングループに登録されているメンバーに送信されます。 Monitoring Reader ロールの割り当ては、アラートの表示や監視データの閲覧権限を付与しますが、アラート通知の受信者を決定する要素ではありません。
アラート通知の受信者は、アクショングループ (AG1) に直接登録されているユーザーやサービスプリンシパルです。 ロールベースのアクセス制御 (RBAC) とアクショングループのメンバーシップは独立した概念であり、RBAC ロールの割り当てだけではアラート通知は送信されません。
この問題では、AG1 に登録されているメンバーを特定する必要があります。 通常、アクショングループには電子メールアドレス、SMS の電話番号、Webhook などの通知先が明示的に設定されます。 問題文の状況から、User1 と User2 が AG1 のメンバーとして登録されていると判断できます。

| 概念 | 役割 |
| :--- | :--- |
| Monitoring Reader ロール | 監視データの閲覧権限を付与 |
| アクショングループ | アラート通知の送信先を定義 |
| アラートルール | 監視条件と通知トリガーを設定 |

アラート通知を受信するには、アクショングループへの明示的な登録が必要です。 RBAC ロールの割り当てとは別に、通知先として設定されている必要があります。

**リファレンス**
・Azure Monitor
・Action Group

**問題 524. オンプレミスで稼働している分散アプリケーション App1 を Azure サブスクリプションに移行する計画があります。移行後、App1 は複数の Azure 仮想マシン上でホストされます。Azure の計画メンテナンス中でも、App1 が常に最低 8 台の仮想マシンで稼働し続けるようにする必要があります。何を作成すべきですか。（一つ選択）**
・10 個の仮想マシンインスタンスを持つ 1 つの Availability Set (更新ドメイン 10、障害ドメイン 1)
・12 個の仮想マシンインスタンスを持つ 1 つの仮想マシンスケールセット
・3 つの障害ドメインと 1 つの更新ドメインを持つ 1 つの Availability Set
・10 個の仮想マシンインスタンスを持つ 1 つの Availability Set (更新ドメイン 5、障害ドメイン 2)

**解答例**
・10 個の仮想マシンインスタンスを持つ 1 つの Availability Set (更新ドメイン 10、障害ドメイン 1)

**解説**
計画メンテナンス中に最低 8 台の仮想マシンを稼働させるには、更新ドメイン (Update Domain) の仕組みを理解する必要があります。 Azure の計画メンテナンスでは、Availability Set 内の仮想マシンは更新ドメイン単位で順次再起動されます。
更新ドメインが 10 の場合、10 台の仮想マシンは各更新ドメインに 1 台ずつ配置されます。 計画メンテナンス時には一度に 1 つの更新ドメインのみが再起動されるため、10 台中 9 台が常に稼働状態を維持できます。 これにより要件の「最低 8 台稼働」を満たせます。
仮想マシンスケールセットは自動スケーリングに適していますが、計画メンテナンス中の稼働台数保証には更新ドメインの明示的な制御が必要です。 更新ドメイン 3 や 5 の構成では、メンテナンス時に稼働台数が 8 台を下回る可能性があります。

| 構成 | 更新ドメイン数 | メンテナンス時の最小稼働台数 |
| :--- | :--- | :--- |
| 10 台 / 更新ドメイン 10 | 10 | 9 台 (要件を満たす) |
| 10 台 / 更新ドメイン 5 | 5 | 8 台 (ギリギリ) |
| 12 台 / スケールセット | 可変 | 保証なし |

更新ドメインは最大 20 まで設定可能で、障害ドメイン (Fault Domain) は物理的な障害分離に利用されます。 計画メンテナンスの可用性確保には更新ドメイン数が重要な要素となります。

**リファレンス**
・Availability Set
・Update Domain
・Virtual Machine Scale Set

**問題 525. あなたの組織では、オンプレミスの Active Directory ドメインと Azure Active Directory (Azure AD) テナントを同期しています。このテナントには複数のユーザーアカウントが存在し、それぞれ異なる属性を持っています。一部のユーザーはクラウド専用アカウントとして作成され、他のユーザーはオンプレミスから同期されています。セキュリティ要件として、すべてのユーザーに対して Azure Multi-Factor Authentication (MFA) を有効化する必要があります。しかし、現在の構成では一部のユーザーに対して MFA を有効化できない状況です。この問題を解決するために、新しいクラウド専用のユーザーアカウントを Azure AD に作成し、問題のあるユーザーの代替アカウントとして使用することを検討しています。この解決策は要件を満たしますか。（一つ選択）**
・いいえ、この解決策では要件を満たしません
・はい、この解決策で要件を満たします

**解答例**
・いいえ、この解決策では要件を満たしません

**解説**
Azure AD とオンプレミス Active Directory を同期している環境では、同期されたユーザーアカウントに対しても Azure MFA を有効化できます。 新しいクラウド専用アカウントを作成することは根本的な解決策にはなりません。
オンプレミスから同期されたユーザーアカウントに対して Azure MFA を有効化できない主な原因は、ユーザーの認証方法の設定やライセンスの問題です。 Azure AD Connect を使用して同期されたユーザーは、パスワードハッシュ同期、パススルー認証、またはフェデレーション認証のいずれかの方法で認証されます。 これらの認証方法すべてにおいて、Azure MFA は利用可能です。
新しいアカウントを作成する代わりに、既存の同期ユーザーに対して適切なライセンス (Azure AD Premium P1 または P2) を割り当て、条件付きアクセスポリシーまたはユーザーごとの MFA 設定を構成することで、すべてのユーザーに対して MFA を有効化できます。 新しいアカウントを作成すると、ユーザーは複数のアカウントを管理する必要が生じ、運用上の複雑さが増加します。

| 認証方法 | Azure MFA 対応 | 特徴 |
| :--- | :--- | :--- |
| パスワードハッシュ同期 | 対応 | クラウドで認証処理 |
| パススルー認証 | 対応 | オンプレミスで認証処理 |
| フェデレーション認証 | 対応 | AD FS など外部 IdP で認証 |

**リファレンス**
・Multi-Factor Authentication (MFA)
・Microsoft Entra Connect
・Conditional Access

**問題 526. Windows Server を実行する Azure 仮想マシンを作成します。この仮想マシンを仮想マシンスケールセットの一部として構成する必要があります。仮想マシンの作成時にどの設定を構成しますか。（一つ選択）**
・可用性オプション
・リージョン
・Azure Spot インスタンス
・サイズ

**解答例**
・可用性オプション

**解説**
仮想マシンスケールセット (Virtual Machine Scale Sets) に参加させるためには、仮想マシン作成時の「可用性オプション」で適切な設定を選択する必要があります。
可用性オプションでは、仮想マシンの冗長性と可用性を制御する複数の選択肢が提供されます。 仮想マシンスケールセットは、この可用性オプション内で選択可能な構成の一つです。 スケールセットを選択することで、自動スケーリング、負荷分散、高可用性を実現する複数の仮想マシンを統合管理できるようになります。
リージョンは仮想マシンのデプロイ先を決定する設定ですが、スケールセットへの参加とは直接関係ありません。 Azure Spot インスタンスは低コストで仮想マシンを実行するオプションですが、スケールセット構成とは別の機能です。 サイズは仮想マシンのコンピューティングリソースを決定しますが、スケールセットへの参加設定ではありません。
仮想マシンスケールセットは、同一構成の仮想マシンを複数台管理し、需要に応じて自動的にインスタンス数を増減させることができます。 これにより、アプリケーションの可用性とスケーラビリティが向上します。
