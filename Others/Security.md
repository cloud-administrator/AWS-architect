

# Source: 10_13_モバイル_脅威インテリジェンス_完全解説.md


# 情報処理安全確保支援士（セキスペ）試験対策：モバイルセキュリティ & 脅威インテリジェンス 完全解説

> [!NOTE]
> **本資料の目的**
> この資料は、技術的な背景を持たない方でも「情報処理安全確保支援士」試験に合格できるレベルの知識を身につけることを目的としています。
> 専門用語には必ず「日常の例え」を添え、試験で狙われやすい「ひっかけポイント」を重点的に解説します。

---

## 第1章 はじめに：なぜこの分野が重要なのか？

スマートフォンの普及により、私たちの業務は劇的に変化しました。カフェでメールを返信し、移動中にクラウド上の資料を確認する。これは便利ですが、セキュリティの観点からは**「守るべき場所が社内だけでなく、社員のポケットの中にまで広がった」**ことを意味します。

また、サイバー攻撃は高度化し、もはや「攻撃されていることに気づかない」ケースも増えています。そこで重要になるのが、敵の手口を知る**「脅威インテリジェンス」**です。

試験では、この「守る範囲の広がり（モバイル）」と「敵を知る力（インテリジェンス）」が頻出分野となっています。

---

## 第2章 モバイルセキュリティ

モバイルセキュリティとは、スマートフォンやタブレット（スマートデバイス）を、紛失・盗難・ウイルス感染などの脅威から守るための仕組みです。

### 1. MDM (Mobile Device Management：モバイルデバイス管理)

**【ひとことで言うと】**
> **「会社支給スマホを一括管理する『司令塔』システム」**

会社が社員にスマホを配る際、一番怖いのは何でしょうか？
「電車に置き忘れた」「勝手に変なアプリを入れてウイルスにかかった」「カメラで機密書類を撮影して持ち出した」……心配は尽きません。
これらを**遠隔（リモート）で制御**するのが **MDM** です。

#### ① MDMの仕組みと主な機能

MDMは、管理者が使う「管理サーバー」と、社員のスマホに入れる「エージェントアプリ」で構成されます。管理者が「カメラ禁止！」と指令を出すと、全社員のスマホでカメラが起動しなくなります。

| 機能名 | 内容 | 日常の例え |
| :--- | :--- | :--- |
| **リモートロック** | 遠隔でスマホ画面をロックし、操作不能にする。 | 落とした財布に遠隔で鍵をかけるイメージ。拾われても中身を見られない。 |
| **リモートワイプ** | 遠隔でスマホ内のデータを消去（初期化）する。 | 落とした手帳の文字が、遠隔操作で魔法のように白紙になるイメージ。 |
| **デバイス機能制限** | カメラ、SDカード、Wi-Fi、Bluetoothなどの利用を禁止する。 | 子供にゲーム機を渡すとき「ネット接続は禁止」と設定するペアレンタルコントロールの強力版。 |
| **ポリシー適用** | パスワードの最低文字数や複雑さを強制する。 | 「鍵は必ず二重ロックにしてください」というルールを強制的に守らせる。 |
| **ジェイルブレイク/root化検知** | OSの改造を検知し、利用を遮断する。 | 改造車が敷地内に入ってきたら、警報を鳴らして追い出す。 |

> [!IMPORTANT]
> **【試験のツボ】リモートロックとリモートワイプの使い分け**
> - **リモートロック**: まず最初にやること。発見できた場合にデータを消さずに済むため、被害を最小限に抑えつつ利便性も残す。
> - **リモートワイプ**: 「最後の手段」。スマホが確実に戻ってこないと判断した場合や、絶対に漏れてはいけない機密情報が入っている場合に実行する。一度消すと元に戻せない（バックアップがない場合）。

#### ② 試験で頻出！MDMの「限界」と「ひっかけ」

ここが試験で最も狙われるポイントです。MDMは万能ではありません。

> [!WARNING]
> **ひっかけ問題注意報**
>
> **Q. MDMを導入していれば、モバイル端末のウイルス対策は不要である。**
> **A. ×（間違い！）**
>
> **【解説】**
> MDMはあくまで「設定や資産を管理するツール」です。「鍵をかける（設定）」ことはできますが、「泥棒（ウイルス）を見つけて捕まえる」機能は基本的についていません。
> ですから、**MDMとは別に、アンチウイルスソフト（モバイルセキュリティアプリ）の導入が必要**です。
> （※最近はアンチウイルス機能付きの統合製品（EMM/UEM）もありますが、試験の定義として「MDM＝管理ツール」と覚えておくのが安全です。）

#### ③ 紛失・盗難時の対応フロー（試験記述対策）

午後試験（現・論述式試験）では、紛失時の対応手順を書かせる問題が出ることがあります。

1. **本人からの連絡**: 「スマホをなくしました！」
2. **管理者によるリモートロック**: まずは情報流出を止める。
3. **位置情報の確認**: MDMの機能でGPS位置情報を確認する。
4. **捜索**: 本人が探しに行く。
5. **発見できない場合**: **リモートワイプ**を実行してデータを消去する。
6. **事後対応**: 回線停止手続きなど。

---

### 2. BYOD (Bring Your Own Device：私的端末の業務利用)

**【ひとことで言うと】**
> **「社員の私物スマホを、仕事道具として持ち込ませること」**

BYODは、会社が端末を買わなくて良いのでコスト削減になりますし、社員も使い慣れたスマホで仕事ができます。しかし、セキュリティ担当者にとっては悪夢になりかねません。

**日常の例え：**
> 工事現場（会社）に、大工さん（社員）が**自分のハンマー（私物スマホ）**を持ってきて作業するようなもの。
> 使いやすいですが、そのハンマーが壊れたり、現場の資材（機密情報）を勝手に持ち帰ったりするリスクがあります。

#### ① BYODの最大のリスク：公私混同

私物スマホには、仕事のメールと、プライベートなLINEや写真が同居します。
もしスマホを紛失して、MDMで「リモートワイプ（全消去）」したらどうなるでしょうか？
**「会社のデータと一緒に、社員の家族写真まで消してしまった！」**というトラブルになります。これはプライバシー侵害として訴訟リスクすらあります。

#### ② 対策：MAM と MCM

そこで登場するのが、端末全体ではなく「特定の領域」だけを管理する技術です。

| 用語 | フルネーム | 内容 | 例え |
| :--- | :--- | :--- | :--- |
| **MAM** | Mobile Application Management | **アプリ単位**で管理する。業務アプリだけを制御し、私的アプリには触れない。 | 会社の道具箱（業務アプリ）だけを管理し、ポケットの中身（私的アプリ）は見ない。 |
| **MCM** | Mobile Content Management | **データ（コンテンツ）単位**で管理する。業務ファイルだけを暗号化・閲覧制限する。 | 仕事の書類（データ）だけ特殊なケースに入れて渡す。 |
| **コンテナ化** | Containerization | スマホの中に**「業務専用の隔離領域（コンテナ）」**を作り、その中だけを管理する。 | スマホの中に「仮想的な会社用の部屋」を作るイメージ。退職時はその部屋だけ消す。 |

> [!IMPORTANT]
> **【試験のツボ】BYOD導入時のガイドライン策定**
> 技術的な対策だけでなく、**「運用ルール（ガイドライン）」**を決めることが重要です。
> - 紛失時の届出義務
> - リモートワイプの同意（「消去しても文句言いません」という誓約書）
> - 費用負担（通信費はどっち持ち？）

---

### 3. モバイルアプリのセキュリティ & OSの仕組み

スマホのOS（iOS/Android）は、パソコン（Windows/Mac）よりもセキュリティが強固に設計されています。その中心概念が「サンドボックス」です。

#### ① サンドボックス (Sandbox)

**【ひとことで言うと】**
> **「アプリを隔離された空間で遊ばせる仕組み」**

**日常の例え：**
> **「公園の砂場（サンドボックス）」**です。
> 子供（アプリ）が砂場でどんなに激しく遊んでも、砂場の外（他のアプリやOSの核心部）には影響が出ません。お城を作っても壊しても、砂場の中だけの出来事です。
> これにより、もし悪意あるアプリを入れてしまっても、連鎖的に他のアプリの情報を盗んだり壊したりできません。

#### ② パーミッション（権限）管理

アプリがカメラや連絡帳を使いたいときは、OS（親）に「許可（パーミッション）」を求めます。
「このアプリが連絡先へのアクセスを求めています。許可しますか？」というポップアップがそれです。

> [!WARNING]
> **Androidでの権限確認**
> Androidアプリは、インストール時や実行時に必要な権限を一覧表示します。
> **「懐中電灯アプリなのに『連絡帳』と『位置情報』の権限を求めてくる」**……これは怪しい動き（情報抜き取り）の兆候です。試験でもこの「過剰な権限要求」を見抜く視点が問われます。

#### ③ OSの魔改造：ジェイルブレイク / root化

ユーザーがOSの制限（サンドボックス保護など）を意図的に解除する行為です。
- **ジェイルブレイク (Jailbreak)**: 主にiOS（iPhone）での呼び名。「脱獄」。
- **root化 (Rooting)**: 主にAndroidでの呼び名。管理者権限（root権限）を取得すること。

これをやると、好きなカスタマイズができる反面、**「サンドボックスの壁が壊れる」**ため、一つのアプリが感染するとスマホ全体が乗っ取られるリスクが生じます。企業利用では**厳禁**です。

#### ④ サイドローディング (Side-loading)

公式ストア（App Store, Google Play）を通さずに、アプリを直接インストールすることです。これを許可すると、「野良アプリ」と呼ばれる審査を経ていない危険なアプリが入る隙間ができます。
Androidでは「提供元不明のアプリのインストール」設定で許可/拒否を制御できます。

---

## 第3章 脅威インテリジェンス (Threat Intelligence)

脅威インテリジェンスとは、**「敵の手口、動機、能力などの情報を収集・分析し、防御に役立つ知識に変えたもの」**です。
単なる「生データ（ログ）」ではなく、分析によって「意味のある情報（インテリジェンス）」に昇華されている点が重要です。

### 1. なぜ今、脅威インテリジェンスが必要なのか？

かつてのセキュリティは「ファイアウォールで城壁を築き、内側を守る」だけで十分でした。しかし、現在は以下のような状況です。

1.  **境界防御の崩壊**: クラウドやテレワークで「守るべき境界」が曖昧になった。
2.  **攻撃の高度化**: APT攻撃（持続的標的型攻撃）のように、数ヶ月かけて潜伏・偵察を行う攻撃が増えた。

これに対抗するには、攻撃が来るのを待つのではなく、**「攻撃者が次に何をしてくるか」「世の中でどんな攻撃が流行っているか」**を積極的に知り、先回りして対策を打つ（プロアクティブな防御）必要があります。

---

### 2. インテリジェンスの3つのレベル

脅威インテリジェンスは、それを利用する人や目的によって3つの階層に分類されます。試験ではこの**「誰が、何のために使うか」**の組み合わせがよく問われます。

| レベル | 英語名 | 対象読者 | 内容の例 | 目的 |
| :--- | :--- | :--- | :--- | :--- |
| **戦略的** | Strategic | **経営層 (CISO, CEO)** | 攻撃グループの動機、業界の脅威トレンド、ビジネスへの金銭的影響 | 予算策定、セキュリティ投資の判断、リスク管理方針の決定 |
| **戦術的** | Tactical | **セキュリティ管理者 (SOC/CSIRT)** | **TTPs**（敵の戦術・技術・手順）、攻撃のパターン | 防御戦略の立案、ハンティング（潜伏脅威の探索）の手法検討 |
| **運用/技術的** | Operational / Technical | **現場担当者・セキュリティ機器** | **IoC**（IPアドレス、ハッシュ値、ドメイン）、C2サーバー情報 | ファイアウォールでのブロック、SIEMでの検知ルール作成、即時遮断 |

> [!NOTE]
> **日常の例え：天気予報**
> - **戦略的**: 「今年は冷夏になりそうなので、農作物の輸入量を増やそう」（経営判断）
> - **戦術的**: 「明日は台風が来るから、電車の計画運休を検討しよう」（対応策の準備）
> - **運用・技術的**: 「今、雨雲レーダーでここに雨が降っているから、傘をさそう」（即時のアクション）

---

### 3. インテリジェンス・サイクル (The Intelligence Cycle)

情報はただ集めるだけでは役に立ちません。以下のプロセス（サイクル）を回すことで、初めて価値あるインテリジェンスになります。

1.  **計画と指示 (Planning & Direction/Requirements)**
    *   「何を知りたいか？」を決めるフェーズ。
    *   例：「自社業界（金融）を狙う攻撃グループの最新手口を知りたい」
2.  **収集 (Collection)**
    *   生のデータを集めるフェーズ。
    *   情報源：OSINT（公開情報）、ハニーポット（囮サーバー）、セキュリティベンダーのレポート、ダークウェブ。
3.  **処理 (Processing)**
    *   集めたデータを分析可能な形式に変換する。
    *   例：外国語の翻訳、ログの正規化（フォーマット統一）、ノイズ除去。
4.  **分析 (Analysis)**
    *   **ここが最重要**。情報を解釈し、意味を見出す。
    *   例：「このIPアドレスからのアクセスは、攻撃グループXの偵察活動である可能性が高い」と結論付ける。
5.  **配布・共有 (Dissemination)**
    *   適切な相手（経営層やSOC）に適切な形式で届ける。
    *   **STIX/TAXII** などの標準規格を用いてシステム間で自動共有することもある。
6.  **フィードバック (Feedback)**
    *   「その情報は役に立ったか？」を評価し、次の計画（Step 1）に活かす。

> [!IMPORTANT]
> **【試験のツボ】STIX と TAXII**
> 脅威情報の共有を自動化するための技術標準です。セットで覚えましょう。
> - **STIX (Structured Threat Information eXpression)**: 脅威情報を**記述**するためのフォーマット（XML/JSON）。「手紙の書き方」。
> - **TAXII (Trusted Automated eXchange of Indicator Information)**: 脅威情報を**交換**するための通信手順（プロトコル）。「郵便の運び方」。

---

### 4. IoC と TTPs：敵の「痕跡」と「手口」

#### ① IoC (Indicator of Compromise：侵害指標)

**【ひとことで言うと】**
> **「システムが攻撃されたことを示す『証拠』や『痕跡』」**

**日常の例え：**
> 犯行現場に残された**「指紋」「足跡」「DNA」「凶器」**です。
> これらがデータベース（ブラックリスト）にあれば、「この指紋（ファイルハッシュ）は指名手配犯のものだ！」とすぐに検知できます。

**主なIoCの例:**
*   マルウェアのファイルハッシュ値（MD5, SHA-256）
*   C2サーバー（指令サーバー）のIPアドレスやドメイン
*   不正なURL
*   特徴的なレジストリキーの変更

#### ② TTPs (Tactics, Techniques, and Procedures：戦術・技術・手順)

**【ひとことで言うと】**
> **「攻撃者の『行動パターン』や『クセ』」**

IoCが「モノ（指紋）」なら、TTPsは**「コト（手口）」**です。
*   **Tactics (戦術)**: 「何がしたいか（目的）」 例：初期侵入、権限昇格。
*   **Techniques (技術)**: 「どうやってやるか」 例：標的型メールを送る、PowerShellを悪用する。
*   **Procedures (手順)**: 「具体的な実行フロー」

#### ③ Pyramid of Pain (痛みのピラミッド)

攻撃者が攻撃インフラを変更する際の「痛み（コスト・手間の大きさ）」を階層化した図です。
防御側にとっては、**「ピラミッドの上位を攻略するほど、攻撃者に大打撃を与えられる」**ことを意味します。

| 階層（下から上へ） | 攻撃者の痛み | 解説 |
| :--- | :--- | :--- |
| **Hash Values** (ハッシュ値) | **Trivial (無痛・簡単)** | マルウェアを1ビット変えるだけでハッシュは変わる。防御効果は一瞬。 |
| **IP Addresses** | **Easy (容易)** | プロキシやボットネットを使えばIPはすぐに変えられる。 |
| **Domain Names** | **Simple (単純)** | ドメインの再取得も比較的容易。 |
| **Network/Host Artifacts** | **Annoying (厄介)** | 通信の特徴（User-Agent文字列など）や作成ファイル名。変えるにはツールの設定変更が必要。 |
| **Tools** | **Challenging (困難)** | 攻撃ツール自体（PowerShell Empire, Cobalt Strikeなど）の使用を封じられると、攻撃者は新しいツールを開発・習得しなければならない。 |
| **TTPs** | **Tough (過酷)** | 攻撃者の「お家芸（手口）」を見抜いて対策すること。例：「彼らは必ずメールの添付ファイルを使う」と見抜き、そこを封じると、攻撃者は**ビジネスモデルそのもの（教育・訓練・組織）から作り直す必要**がある。 |

> [!IMPORTANT]
> **試験対策：**
> 「IoC（IPやハッシュ）によるブロックは、一時的な効果しかない（いたちごっこになる）」という点を理解してください。
> 本質的な防御には、**上位のTTPsを分析して対策する**ことが重要です。

---

### 5. OSINT (Open Source Intelligence：オシント)

**【ひとことで言うと】**
> **「一般公開情報を分析して、隠れた真実をあぶり出す手法」**

スパイ映画のように機密文書を盗むのではなく、**「誰でも見られる情報」**を組み合わせてインテリジェンスを作ります。
攻撃者もこの手法を使って、ターゲット企業（あなた）を偵察しています。

**情報源の例:**
*   **SNS**: Twitter, Facebook, LinkedIn（社員の所属、技術スタック、人間関係、休暇予定）。
*   **技術情報**: Whois（ドメイン所有者）、DNSレコード、GitHub（誤って公開されたコード）、Shodan（ネット接続機器の検索エンジン）。
*   **ダークウェブ**: 漏洩したID/パスワードの売買リスト。

> [!WARNING]
> **Shodan (ショーダン) とは？**
> 「インターネットに接続されたデバイス（Webカメラ、ルーター、IoT機器など）」を検索できる検索エンジンです。
> 脆弱性のある古いバージョンのサーバーや、パスワードのかかっていないWebカメラなどが簡単に見つかってしまいます。
> セキュリティ担当者は自社資産がShodanに晒されていないかチェックするために使いますが、攻撃者は標的を探すために使います（諸刃の剣）。

---

## 第4章 まとめ & 学習ロードマップ

### この資料のポイント振り返り

1.  **モバイルセキュリティ**:
    *   **MDM**は「管理ツール」であり、「ウイルス対策」ではない。
    *   **BYOD**は「公私混同」のリスクが高い。**MAM/MCM**や**ガイドライン**で対策する。
    *   **サンドボックス**は「公園の砂場」。アプリを隔離してOSを守る。

2.  **脅威インテリジェンス**:
    *   敵を知り、先回りして防御する（プロアクティブ）。
    *   **戦略・戦術・運用**の3レベルがあり、それぞれ利用者が違う。
    *   **IoC**（指紋）だけでなく、**TTPs**（手口）を理解することが、攻撃者に「痛み」を与える（Pyramid of Pain）。

### 次のステップ
実際の試験では、これらの知識をもとに「長文のシナリオ」を読み解く力が問われます。
過去問を解く際は、**「この事例では、どのレベルのインテリジェンスが必要だったか？」「もしMDMの設定がこうだったら防げたか？」**と、本書の知識を当てはめながら考えてみてください。

---




# Source: 4_暗号技術_完全解説.md


# 情報処理安全確保支援士「暗号技術」完全解説

> [!IMPORTANT]
> **本資料の目的**
> 情報処理安全確保支援士試験（セキスペ）の「暗号技術」分野において、基礎から応用、そして試験で頻出の「引っかけポイント」までを網羅的に解説します。
> 初心者の方でも理解できるよう図解的な説明を心がけ、試験直前の見直しにも使えるよう重要なポイントを強調しています。

---

## 1. はじめに：暗号技術の全体像

情報セキュリティの根幹を支えるのが「暗号技術」です。試験では、単に用語を覚えるだけでなく、「なぜその技術が必要なのか」「何を守るために使うのか」という目的意識が問われます。

### 1.1 情報セキュリティの3要素（CIA）と暗号
情報セキュリティには**CIA**と呼ばれる3つの主要な要素があります。暗号技術はこれらをどのように守るのでしょうか。

| 要素 | 英語 (意味) | 暗号技術の役割 | 関連技術 |
| :--- | :--- | :--- | :--- |
| **機密性** | **C**onfidentiality (秘密を守る) | 第三者に内容を読まれないようにする。 | 共通鍵暗号、公開鍵暗号 |
| **完全性** | **I**ntegrity (改ざんされていない) | データが途中で書き換えられていないことを証明する。 | ハッシュ関数、メッセージ認証コード (MAC) |
| **可用性** | **A**vailability (いつでも使える) | (直接的には関与しないが、DoS攻撃対策などで関連) | - |

> [!NOTE]
> **試験のポイント：** 「暗号化」＝「機密性」の確保ですが、「完全性」の確保には「ハッシュ関数」や「デジタル署名」が使われます。「認証」や「否認防止」というキーワードも後ほど登場します。どの技術がどのセキュリティ要件を満たすのかを常に意識してください。

---

## 2. 共通鍵暗号方式 (Common Key Cryptography)

暗号化と復号に**「同じ鍵」**（共通鍵）を使う方式です。古くからある基本的な方式ですが、現在のインターネット通信（SSL/TLSなど）でも、データ本体の暗号化にはこの方式が使われています。

### 2.1 仕組みと特徴
*   **仕組み**: 送信者と受信者が事前に「共通の鍵」を持ち合います。送信者は鍵で鍵をかけ（暗号化）、受信者は同じ鍵で鍵を開けます（復号）。
*   **メリット**: 処理速度が**非常に高速**です。
*   **デメリット**: 鍵を安全に相手に渡す必要があります（**鍵配送問題**）。また、通信相手ごとに異なる鍵が必要になるため、相手が増えると管理する鍵の数が膨大になります。

> [!WARNING]
> **引っかけポイント：鍵の管理数**
> $n$ 人が相互に通信する場合、必要な鍵の数は **$n(n-1)/2$** 個になります。
> 一方、公開鍵暗号方式では $2n$ 個（各自が公開鍵と秘密鍵を持つだけ）で済みます。この計算式は午前の問題でよく出ます。

### 2.2 主要なアルゴリズム

試験で名前が出るアルゴリズムは以下の通りです。特に**AES**が最重要です。

1.  **AES (Advanced Encryption Standard)**
    *   現在の世界標準。米国政府標準暗号。
    *   **鍵長**: 128bit, 192bit, 256bit から選択可能。
    *   無線LANの暗号化（WPA2/WPA3）など、あらゆる場面で使われています。
2.  **DES (Data Encryption Standard) / 3DES**
    *   かつての標準ですが、現在は計算機能力の向上により、短時間で解読可能となっており、**「危殆化（きたいか）」**しています。
    *   3DESはDESを3回繰り返すことで強度を高めたものですが、現在はAESへの移行が推奨されています。
3.  **Camellia (カメリア)**
    *   NTTと三菱電機が開発した日本発の暗号。AESと同等の強度を持ち、電子政府推奨暗号リスト（CRYPTREC）にも掲載されています。
4.  **KASUMI**
    *   第3世代携帯電話などで使われているストリーム暗号の基礎となったもの。

### 2.3 【最重要】ブロック暗号の利用モード

共通鍵暗号の多くは、データを一定の長さ（ブロック）ごとに区切って暗号化する「ブロック暗号」です。長いデータをどう処理するか、その手順を定めたのが**「モード」**です。
試験では、各モードの特徴（特にメリット・デメリット）が詳細に問われます。

#### (1) ECBモード (Electronic CodeBook)
*   **仕組み**: 各ブロックを独立して単純に暗号化します。
*   **弱点**: **同じ平文ブロックは、常に同じ暗号文ブロックになります。**
    *   例えば、画像の平文をECBで暗号化しても、色のパターンなどでなんとなく元の画像が見えてしまうことがあります（「ペンギンの画像」の例が有名）。
*   **試験対策**: 「パターンが解析されやすいため、**通常は使用すべきではない**」と覚えてください。

#### (2) CBCモード (Cipher Block Chaining)
*   **仕組み**: 前のブロックの暗号文と、現在の平文ブロックのXOR（排他的論理和）をとってから暗号化します。最初のブロックには**初期化ベクトル (IV)** を使います。
*   **特徴**: 同じ平文でも、前のブロックやIVが異なれば暗号文が変わるため、ECBのようなパターンは出ません。
*   **欠点**: 暗号化は前の結果を待つ必要があるため、**並列処理ができません**（復号は並列可能）。また、1ビットのエラーがそのブロック以降の復号に影響を与えます。

#### (3) OFBモード (Output FeedBack) / CFBモード (Cipher FeedBack)
*   **仕組み**: ブロック暗号を使いながら、実質的に「ストリーム暗号」（ビット単位やバイト単位で処理するように見せる）として動作させるモードです。
*   **特徴**: エラーの波及範囲などが異なりますが、近年は次のCTRモードの方が主流です。

#### (4) CTRモード (CounTeR)
*   **仕組み**: 「カウンタ」と呼ばれる値を暗号化し、それと平文をXORして暗号文を作ります。
*   **メリット**:
    *   各ブロックの処理が独立しているため、**暗号化も復号も完全に並列処理が可能**です。これにより非常に高速です。
    *   パディング（最後のブロックの埋め合わせ）が不要です。
*   **試験対策**: **TLS 1.3**や**WPA2/3 (CCMP/GCMP)** で採用されている現代の主流モードです。「並列処理」「高速」というキーワードが出たらCTRモードを疑ってください。

#### (5) GCMモード (Galois/Counter Mode)
*   **仕組み**: CTRモードに、**認証（メッセージ認証コード）**の機能を組み込んだものです。
*   **特徴**: **「認証付き暗号 (AEAD)」** の代表格です。暗号化（機密性）と同時に、改ざん検知（完全性）も行います。
*   **試験対策**: 処理速度が速く、安全性も高いため、現在のTLS通信で最も推奨されるモードの一つです（例: AES-GCM）。

> [!TIP]
> **用語整理：ストリーム暗号とブロック暗号**
> *   **ブロック暗号**: データをまとめて（例: 128bit）暗号化。AESなど。
> *   **ストリーム暗号**: データをビット/バイト単位で逐次暗号化。RC4（古・脆弱）、ChaCha20など。
> CTRモードなどは、ブロック暗号のアルゴリズムを使ってストリーム暗号のような振る舞いを実現しています。

### 2.4 パディング（Padding）
ブロック暗号では、データの長さがブロック長の倍数にならない場合、最後のブロックに足りない分を埋めるデータ（パディング）を追加します。
*   **パディングオラクル攻撃**: 復号時のパディングの扱いに関するエラー応答の違いを利用して、暗号文の内容を推測する攻撃。CBCモードなどで発生しやすい脆弱性です。

---

## 3. 公開鍵暗号方式 (Public Key Cryptography)

「共通鍵」の課題（鍵配送問題）を解決するために生まれた、画期的な方式です。

### 3.1 仕組み：2つの鍵（「公開鍵」と「秘密鍵」）
公開鍵暗号では、ペアとなる2つの鍵を作ります。
1.  **公開鍵 (Public Key)**: 世の中に広く公開する鍵。「誰でも手に入れられる」。
2.  **秘密鍵 (Private Key)**: 自分だけが持ち、**絶対に他人に見せてはいけない**鍵。

> [!IMPORTANT]
> **鉄則：暗号化するときのルール**
> *   **「暗号化」は、「受信者の公開鍵」で行う。**
> *   **「復号」は、「受信者の秘密鍵」で行う。**
>
> **覚え方**: 「Aさん宛ての秘密の手紙」を送りたいなら、「Aさんが配っている南京錠（Aさんの公開鍵）」で箱に鍵をかけます。その箱を開けられるのは、「その鍵の鍵穴（Aさんの秘密鍵）」を持っているAさんだけです。

### 3.2 メリットとデメリット
*   **メリット**:
    *   **鍵配送問題の解決**: 公開鍵は誰に見られても良いため、メール等で堂々と送れます。
    *   **鍵の管理数**: $2n$ 個（各人がペアを1組持つだけ）で済みます。共通鍵暗号の $n(n-1)/2$ に比べて大幅に楽です。
*   **デメリット**:
    *   **処理が遅い**: 複雑な数学計算を行うため、共通鍵暗号に比べて数百倍〜数千倍遅いです。そのため、大容量データの暗号化には向きません。

### 3.3 主要なアルゴリズム

試験で問われるのは以下の3つです。数学的根拠の違いを抑えてください。

1.  **RSA**
    *   **数学的根拠**:「巨大な整数の**素因数分解**」が困難であることを利用（$n=p \times q$）。
    *   最も歴史があり、広く普及している方式。
2.  **楕円曲線暗号 (ECC: Elliptic Curve Cryptography)**
    *   **数学的根拠**:「楕円曲線上の**離散対数問題**」が困難であることを利用。
    *   **特徴**: RSAに比べて、**「短い鍵長」で同等の安全性**を確保できます。
        *   例: RSA 2048bit と ECC 224bit が同等の強度。
    *   **用途**: 計算能力やメモリの少ないIoT機器、ICカード、スマートフォンなどで重宝されます。
3.  **ElGamal暗号**
    *   離散対数問題を利用した方式。GnuPGなどで使われます。

### 3.4 ハイブリッド暗号方式
「共通鍵の速さ」と「公開鍵の便利さ」をいいとこ取りした方式です。SSL/TLSやS/MIMEなどは、実際にはこの方式です。「公開鍵暗号で通信している」と言っても、中身はハイブリッドです。

**【通信の流れ】**
1.  送信者は、その通信のためだけの**共通鍵（セッション鍵）**をランダムに作ります。
2.  その「共通鍵」を使って、送りたい**データ本体**を高速に暗号化します（共通鍵暗号）。
3.  使った「共通鍵」自体を、**受信者の公開鍵**で暗号化します（公開鍵暗号）。
4.  「暗号化されたデータ」と「暗号化された共通鍵」を相手に送ります。
5.  受信者は、自分の**秘密鍵**で「共通鍵」を復号して取り出し、その共通鍵で「データ」を復号します。

> [!WARNING]
> **引っかけポイント：鍵の言葉の使い分け**
> 「共通鍵暗号方式の鍵」のことを「秘密鍵」と呼んでしまうと、公開鍵暗号の「秘密鍵」と混同します。
> *   公開鍵暗号のPrivate Key = **秘密鍵**
> *   共通鍵暗号のCommon/Symmetric Key = **共通鍵**
> と明確に呼び分けましょう。

### 3.5 Man-in-the-Middle攻撃 (MITM：中間者攻撃)
公開鍵暗号の弱点として、「その公開鍵が本当に本人のものか？」という問題があります。
攻撃者が「私はAです」と嘘をついて、攻撃者の公開鍵を配る可能性があります。これを防ぐための仕組みが、後述する**PKI（公開鍵基盤）**と**電子証明書**です。

---

## 4. ハッシュ関数 (Hash Functions)

任意の長さのデータから、固定長の不規則な値（**ハッシュ値**、またはメッセージダイジェスト）を計算する関数です。「データの指紋」とも呼ばれます。

### 4.1 ハッシュ関数の3つの性質（重要）
試験では、この定義がよく問われます。
1.  **一方向性 (One-way)**: ハッシュ値から、元のデータを復元することはできない（不可逆）。「暗号化」とはここが違います。
2.  **衝突発見困難性 (Collision Resistance)**: 同じハッシュ値になる異なる2つのデータを見つけるのが非常に難しいこと。
3.  **雪崩効果**: 元データが1ビットでも変わると、ハッシュ値はまったく異なる値になること。

### 4.2 主要なアルゴリズム
1.  **SHA-256 (SHA-2ファミリー)**
    *   現在の主流。256ビットのハッシュ値を出力。
2.  **SHA-3**
    *   SHA-2とは異なる構造（Keccakなど）を持つ、次世代の標準。
3.  **MD5, SHA-1**
    *   **危殆化**しており、使用は推奨されません（衝突攻撃が可能になっているため）。

### 4.3 HMAC (Hash-based Message Authentication Code)
ハッシュ関数と「共通鍵」を組み合わせて、**「完全性」**だけでなく**「送信者の認証」**も行う技術です。
*   単なるハッシュ値だけでは、攻撃者が「データ」と「ハッシュ値」の両方を置き換えると改ざんがバレません。
*   HMACでは、秘密の鍵を持っている人しか正しいハッシュ値（MAC値）を作れないため、改ざんとなりすましを検知できます。

---

## 5. デジタル署名 (Digital Signatures)

「ハンコ」や「サイン」のデジタル版です。**公開鍵暗号の応用技術**です。

### 5.1 目的（何ができるか）
1.  **完全性**: 改ざんされていないことの証明。
2.  **認証**: 確かにその人が作ったことの証明。
3.  **否認防止 (Non-repudiation)**: 後になって「私は送っていない」と言い逃れさせないこと。
    *   **注意**: デジタル署名自体には、データを隠す（機密性）機能はありません。

### 5.2 仕組み（暗号化との逆転）
これが最大の試験ポイントです。「暗号化」と「署名」では、**使う鍵が逆**になります。

*   **署名作成**: 送信者の **「秘密鍵」** で行います。（自分しか押せないハンコ）
*   **署名検証**: 送信者の **「公開鍵」** で行います。（誰でもその人のハンコだと確認できる）

**【署名の流れ】**
1.  送信者は、メッセージの**ハッシュ値**を計算します。
    *   （メッセージ全体を暗号化すると遅いため、ハッシュ値だけを暗号化します）
2.  そのハッシュ値を、送信者の**秘密鍵**で暗号化します。これが**「署名」**です。
3.  メッセージ本文と署名をセットで送ります。
4.  受信者は、受け取ったメッセージから自分で**ハッシュ値A**を計算します。
5.  また、受け取った署名を送信者の**公開鍵**で復号し、**ハッシュ値B**を取り出します。
6.  AとBが一致すれば、「改ざんされていない」かつ「本人の署名である」と証明されます。

> [!WARNING]
> **引っかけポイントまとめ**
> *   **暗号化通信**: 「受信者の公開鍵」で暗号化 → 「受信者の秘密鍵」で復号
> *   **デジタル署名**: 「送信者の秘密鍵」で署名 → 「送信者の公開鍵」で検証
>
> 誰の、どの鍵を使うのかを常に図描いてイメージしましょう。

---

## 6. PKI (Public Key Infrastructure: 公開鍵基盤)

公開鍵暗号の「その公開鍵、本当にあの人のもの？」という問題を解決するための**社会的な基盤（インフラ）**です。
信頼できる第三者機関（CA）が、「この公開鍵は間違いなくAさんのものです」と証明書を発行する仕組み全体を指します。

### 6.1 PKIの構成要素
1.  **CA (Certification Authority: 認証局)**
    *   **役割**: 電子証明書を発行する機関。
    *   **ルートCA**: 最上位の認証局。自分自身で証明書に署名します（自己署名証明書）。
    *   **中間CA**: ルートCA（または他の中間CA）から署名をもらっている認証局。
2.  **RA (Registration Authority: 登録局)**
    *   **役割**: 本人確認の審査を行う機関。（パスポート申請の窓口のようなもの）
    *   CAの中に機能が含まれることも多いです。
3.  **リポジトリ (Repository)**
    *   **役割**: 発行された証明書や、有効期限切れ前の失効リスト (CRL) を公開・保管する場所。LDAPサーバーなどが使われます。

---

## 7. 電子証明書 (Digital Certificate)

PKIによって発行される、「デジタルの身分証明書」です。
**X.509** という規格でフォーマットが決まっています。

### 7.1 証明書に書かれていること
試験で問われる主な項目は以下の通りです。
1.  **所有者の情報**: ディスティングイッシュネーム (DN) など。
2.  **【最重要】所有者の公開鍵**: 「誰」の「公開鍵」なのかを結びつけています。
3.  **有効期限**: 免許証と同じで期限があります。
4.  **発行者 (CA) のデジタル署名**: CAが信憑性を保証するために付けた署名です。

### 7.2 証明書の検証プロセス
ブラウザがWebサイトにアクセスした際、サーバーから送られてきた証明書をどう検証するか、試験でよく出ます。

1.  **有効期限の確認**: 期限切れでないか。
2.  **正当性の確認**: 「CAの署名」を、「CAの公開鍵」を使って検証します。（デジタル署名の検証）
    *   **信頼の連鎖 (Chain of Trust)**: ルートCAに辿り着くまで、上位のCAの証明書を順に辿って検証します。ルートCAの証明書は、最初からブラウザやOSに「信頼済み」として組み込まれています。
3.  **失効確認**: 有効期限内でも、秘密鍵の流出などで無効化（失効）されていないか確認します。
    *   **CRL (Certificate Revocation List)**: 失効した証明書のリスト（ブラックリスト）をダウンロードして確認する方法。
    *   **OCSP (Online Certificate Status Protocol)**: サーバーにオンラインで問い合わせて、「この証明書は有効ですか？」と聞く方法。

> [!WARNING]
> **引っかけポイント：証明書の役割**
> 「電子証明書には、所有者の**秘密鍵**が含まれている」→ **× 間違いです！**
> 証明書は一般に公開・配布するものです。秘密鍵が含まれていたら大変なことになります。含まれているのは「公開鍵」です。

---

## 8. SSL/TLS (Secure Sockets Layer / Transport Layer Security)

Webブラウザとサーバー間の通信を暗号化する、最も身近なプロトコルです。
現在は SSL は脆弱性があるため使われず、**TLS** が使われていますが、慣習的に「SSL/TLS」と呼ばれます。

### 8.1 TLSのバージョン
試験で出るのは **TLS 1.2** と **TLS 1.3** の違いです。
*   **TLS 1.2**: 長らく使われてきた標準。
*   **TLS 1.3**: 最新版。
    *   **特徴1（高速化）**: ハンドシェイク（接続開始の手続き）が簡素化され、通信開始までの往復回数（RTT）が減りました。
    *   **特徴2（安全性向上）**: 過去の脆弱な暗号方式（RSA鍵交換など）を廃止し、**PFS (Perfect Forward Secrecy: 前方秘匿性)** を持つ方式のみに限定しました。

### 8.2 通信の流れ（ハイブリッド暗号の実践）
1.  **ハンドシェイク**:
    *   お互いに対応している暗号方式を確認（ネゴシエーション）。
    *   サーバー証明書を検証。
    *   **セッション鍵（共通鍵）**を安全に共有。
2.  **レコードプロトコル**:
    *   共有した「セッション鍵」を使って、実際のHTTP通信などを暗号化してやり取り。

### 8.3 クライアント認証
通常は「サーバーが本物か」をクライアントが確認しますが、逆に「クライアントが許可された正規の利用者か」をサーバーが確認する仕組みです。
*   ID/パスワードの代わりに、クライアント側にインストールされた**クライアント証明書**を使います。

---

## 9. その他の暗号プロトコル

### 9.1 S/MIME (Secure/MIME)
*   **用途**: **電子メール**の暗号化とデジタル署名。
*   **仕組み**: 公開鍵暗号方式を利用します。送信者と受信者の双方が**電子証明書**を持つ必要があります。
*   **対抗馬**: PGP (Web of Trustという信頼モデルを使うが、試験ではS/MIMEがPKI関連でよく出ます)。

### 9.2 IPsec (Security Architecture for Internet Protocol)
*   **用途**: **VPN**（拠点間接続やリモートアクセス）の構築。
*   **階層**: **ネットワーク層 (IP層)** で暗号化します。（SSL/TLSはトランスポート層〜アプリケーション層）。ですので、アプリケーションを選ばず全ての通信を暗号化できます。
*   **モード**: トンネルモード（全体をカプセル化）とトランスポートモード（データ部のみ）。

---

## 10. 暗号への攻撃手法と対策

### 10.1 代表的な攻撃
1.  **中間者攻撃 (Man-in-the-Middle Attack)**: 通信経路に割り込み、盗聴や改ざんを行う。対策はPKI（証明書）。
2.  **リプレイ攻撃 (再送攻撃)**: 過去の正当な暗号文を盗み、そのまま再送して認証を突破しようとする。
    *   **対策**: タイムスタンプや**ノンス (Nonce: 使い捨てのランダムな値)** を含めて暗号化し、「今の通信」であることを証明する。
3.  **サイドチャネル攻撃**: 暗号処理中の「消費電力」や「処理時間」「電磁波」を測定して、鍵を推測する物理的な攻撃。
4.  **POODLE / BEAST**: 古いSSL/TLSの脆弱性を突く攻撃。対策はプロトコルのバージョンアップ。

### 10.2 危殆化 (Compromise) 対策
暗号技術は計算機の進化とともに解読されやすくなります。
*   **CRYPTREC**: 日本の電子政府推奨暗号リスト。これを見て、安全な暗号（AES, SHA-256など）を選び、危険な暗号（DES, MD5など）を使わないようにします。

---

**解説は以上です。**
この資料の内容を理解すれば、午前試験の知識問題はもちろん、午後試験の記述問題でも「なぜその暗号方式を使うのか」「鍵はどう管理すべきか」といった問いに的確に答えられるはずです。



# Source: 5_認証技術_完全解説.md


# 情報処理安全確保支援士【認証技術】完全解説
～初心者でも試験の「引っ掛け」を見抜ける！徹底ガイド～

このドキュメントは、技術的な背景を持たない方でも情報処理安全確保支援士（セキスペ）試験の**「認証技術」**分野を完全に理解し、得点源にできるように構成されています。
専門用語を日常の言葉に置き換えながら、試験で問われるポイントを網羅的に解説します。

---

## 目次

1. [認証とは何か？ ～セキュリティの玄関～](#chapter1)
2. [パスワード認証 ～基本にして最大の弱点～](#chapter2)
3. [認証を強固にする技術 ～多要素認証・生体・OTP～](#chapter3)
4. [社内ネットワークを守る認証インフラ ～RADIUS・LDAP・Kerberos～](#chapter4)
5. [ウェブとクラウドの認証・連携 ～SSO・SAML・OAuth・OIDC～](#chapter5)
6. [試験直前チェックリスト＆用語集](#chapter6)

---

<a id="chapter1"></a>
## 第1章：認証とは何か？ ～セキュリティの玄関～

### 1-1. その「鍵」は本物ですか？
セキュリティの世界では、システムを使おうとしている人が「本当にその人本人なのか？」を確認することが全ての始まりです。これを**「認証 (Authentication)」**と呼びます。

試験では、よく似た言葉である**「認可 (Authorization)」**との違いが問われます。

> [!IMPORTANT]
> **【試験に出る！超重要ポイント】**
> - **認証 (Authentication)**: 「あなたは誰？」を確認すること。（例：パスポートを見せる、社員証をタッチする）
> - **認可 (Authorization)**: 「あなたは何をしていい？」と権限を与えること。（例：立ち入り禁止エリアに入る許可、ファイルの編集権限）
>
> **覚え方**: 「認証」は身元確認、「認可」は権限付与です。「AuthN（認証）」と「AuthZ（認可）」と略されることもあります。

### 1-2. 本人確認の「3つの要素」
システムが「あなただ」と認めるためには、以下の3つの要素のいずれか（または組み合わせ）を使います。

| 要素 | 説明 | 具体例 | メリット | デメリット |
| :--- | :--- | :--- | :--- | :--- |
| **知識情報**<br>(Knowledge) | **「知っていること」**<br>本人だけが記憶している情報 | パスワード、PINコード、秘密の質問 | 低コストで手軽 | 忘れる、推測される、盗み見されるリスク |
| **所持情報**<br>(Possession) | **「持っているもの」**<br>本人だけが持っている物理的なモノ | ICカード、スマホ、ハードウェアトークン、鍵 | 盗まれない限り安全 | 紛失する、忘れると使えない、物理的コスト |
| **生体情報**<br>(Inherence) | **「その人そのもの」**<br>本人の身体的特徴 | 指紋、顔、虹彩、静脈、声紋 | 忘れない、紛失しない | 変更できない（一度漏れると危険）、怪我で使えない |

> [!WARNING]
> **【ここが引っ掛け！】**
> 「パスワード」と「秘密の質問（母親の旧姓は？）」を組み合わせても、強度は上がりません。
> なぜなら、どちらも**「知識情報」**だからです。
> セキュリティを高めるには、**異なる要素**（例：知識＋所持）を組み合わせる必要があります。これを「多要素認証」と言います（後述）。

---

<a id="chapter2"></a>
## 第2章：パスワード認証 ～基本にして最大の弱点～

最も身近な認証ですが、最も攻撃されやすい部分でもあります。

### 2-1. パスワードはどうやって保存されている？
あなたがパスワードを入力して登録するとき、システムはパスワードをそのまま保存（平文保存）してはいけません。管理者が覗き見たり、漏洩したときに悪用されるからです。

#### ① ハッシュ化 (Hashing)
パスワードを「ハッシュ関数」という魔法の計算機に入れて、**元の文字が分からない別の文字列（ハッシュ値）**に変換して保存します。
- `password123` → `5e884898da280471...`
- 入力時のパスワードを同じ計算機に入れて、保存されたハッシュ値と一致すればOKと判断します。
- **特徴**: 元に戻せない（不可逆性）。

#### ② ソルト (Salt)
「ハッシュ化」だけでは不十分です。同じパスワードを使っている人は、同じハッシュ値になってしまうからです。
そこで、パスワードに**ランダムな文字列（塩：ソルト）**を混ぜてからハッシュ化します。
- ユーザーA: `password123` + `randomX` → `hashA`
- ユーザーB: `password123` + `randomY` → `hashB`
- これにより、レインボーテーブル攻撃（後述）を防げます。

#### ③ ストレッチング (Stretching)
ハッシュ化の計算を数千回～数万回繰り返すこと。
攻撃者がパスワードを解読しようとして計算する時間を稼ぐための技術です。

### 2-2. パスワードに対する攻撃手法（試験の頻出エリア）

攻撃者はあの手この手でパスワードを破ろうとします。

| 攻撃名 | どんな攻撃？ | 対策 |
| :--- | :--- | :--- |
| **辞書攻撃**<br>(Dictionary Attack) | 辞書にある単語（apple, admin, passwordなど）を片っ端から試す。 | 意味のない文字列にする。<br>辞書に載っていないパスワードを使う。 |
| **ブルートフォース攻撃**<br>(Brute Force Attack) | 「総当たり攻撃」。a, b, c... aa, ab... と全ての組み合わせを試す。時間がかかるが確実。 | パスワードを長くする。<br>アカウントロック機能を導入する（数回ミスで停止）。 |
| **リバースブルートフォース** | **【重要】** パスワードを固定（例："123456"）して、ユーザーIDの方を次々と入れ替えて試す攻撃。「逆」総当たり。 | 予測しにくいユーザーIDにする。<br>基本的なパスワードの使用を禁止する。 |
| **パスワードリスト攻撃** | 他のサイトから漏洩した「IDとパスワードのリスト」を使って、別のサイトへのログインを試みる。 | **パスワードの使い回しをしない**。<br>多要素認証を導入する。 |
| **レインボーテーブル攻撃** | あらかじめ「よくあるパスワード」と「ハッシュ値」の対応表（テーブル）を作っておき、盗んだハッシュ値から元のパスワードを検索する。 | **ソルト (Salt)** を付与する。<br>（ソルトがあるとテーブルが役に立たない） |

> [!TIP]
> **【最新トレンドと試験対策】**
> 昔は「パスワードは定期的に変更しましょう」と言われていましたが、現在は**「定期変更は推奨しない」**（NIST SP800-63Bなど）が定説です。
> **理由**: 頻繁に変更させると、ユーザーは `Password01` → `Password02` のような推測しやすいパターンにするため、かえって危険になるからです。
> 試験でも「定期変更を強制することは、セキュリティ対策として必ずしも有効ではない」という主旨の選択肢が正解になるケースが増えています。ただし、「漏洩の疑いがある場合」は即座に変更が必要です。

---

<a id="chapter3"></a>
## 第3章：認証を強固にする技術 ～多要素認証・生体・OTP～

パスワードだけでは守れない時代になり、様々な強化技術が登場しました。

### 3-1. 多要素認証 (MFA: Multi-Factor Authentication)
前述の「知識」「所持」「生体」のうち、**2つ以上の異なる要素**を組み合わせて認証することです。
- **〇 良い例**: パスワード（知識） ＋ スマホアプリのコード（所持）
- **× 悪い例**: パスワード（知識） ＋ 秘密の質問（知識） → これは「二段階認証」かもしれませんが、「多要素認証」ではありません。

> [!NOTE]
> 「多要素認証 (MFA)」と「二段階認証 (2SV)」は違います。
> - **MFA**: **要素の種類**が複数であること。
> - **2SV**: **手順**が2回あること。（例：パスワード入力後に秘密の質問に答えるのは、手順は2回だが要素は「知識」のみなのでMFAではない）
> ※試験では「MFA」の定義（2つ以上の**異なる要素**）が重要視されます。

### 3-2. 生体認証 (Biometrics)
身体の特徴を使って認証します。

#### エラーの種類（ここが試験の山場！）
生体認証は完全ではありません。「本人なのに拒否される」「他人なのに許可される」というミスが起こります。

| 用語 | 略称 | 説明 | どういう状態？ |
| :--- | :--- | :--- | :--- |
| **本人拒否率** | **FRR**<br>(False Rejection Rate) | 本人なのに「違います」と弾かれる確率。 | 利便性が悪い（イライラする）。 |
| **他入受入率** | **FAR**<br>(False Acceptance Rate) | 他人なのに「どうぞ」と入れてしまう確率。 | **セキュリティ的に危険**。 |

> [!IMPORTANT]
> **【トレードオフの関係】**
> - 「厳しく」判定すると：他人は防げるが、本人も弾かれやすくなる（FAR↓ FRR↑）。
> - 「緩く」判定すると：本人は入りやすいが、他人も入りやすくなる（FAR↑ FRR↓）。
>
> この2つのエラー率が交わる点を**「クロスオーバーエラーレート (CER)」**と呼びます。**CERが低いほど優秀な装置**と判断されます。

### 3-3. ワンタイムパスワード (OTP)
1分間だけ、あるいは1回だけ有効な「使い捨てパスワード」のことです。主に「所持情報」として扱われます。

- **時刻同期方式 (TOTP)**: スマホとサーバーの「時計」が合っていることを利用して、現在の時刻からパスワードを生成します。（Google Authenticatorなど）
- **カウンタ同期方式 (HOTP)**: ボタンを押した回数などで生成します。
- **S/KEY (ワンタイムパッド)**: サーバーから送られた「種」にパスワードを混ぜてハッシュ化し、それを何度もハッシュ化して送る特殊な方式（最近はあまり出ませんが、基礎として知っておくと良いです）。

---

<a id="chapter4"></a>
## 第4章：社内ネットワークを守る認証インフラ ～RADIUS・LDAP・Kerberos～

社内でWi-Fiにつないだり、PCにログインしたりするとき、裏側では専用のサーバーが動いています。

### 4-1. AAAモデル
ネットワーク管理の基本概念です。
1.  **Authentication (認証)**: あなたは誰？
2.  **Authorization (認可)**: 何をしていい？
3.  **Accounting (課金/監査)**: 何をした？（ログを残す）

これを実現するためのプロトコルとして、以下のRADIUSが有名です。

### 4-2. RADIUS (Remote Authentication Dial In User Service)
**「ネットワークの門番」**です。
- **使われる場所**: Wi-Fiの認証、VPNの認証など。
- **仕組み**:
    1. ユーザーがWi-Fiアクセスポイント（NASと呼びます）に接続要求。
    2. アクセスポイントは、ID/パスワードを**RADIUSサーバー**に転送する。
    3. RADIUSサーバーがDBを確認し、OK/NGを返す。
- **特徴**: UDPを使う。パスワードだけ暗号化して送る（従来のRADIUS）。IPアドレスの割り当てなども管理できる。

### 4-3. LDAP (Lightweight Directory Access Protocol)
**「ユーザー情報の電話帳」**です。
- **役割**: ユーザー名、パスワード、メールアドレス、所属部署などの情報を一元管理するデータベース（ディレクトリサービス）にアクセスするための手順（プロトコル）。
- **構造**: ツリー状（階層構造）になっています。`c=jp` (国), `o=company` (組織), `ou=sales` (部署), `cn=taro` (名前) のように住所を指定します。（これをDN: Distinguished Nameと言います）
- **RADIUSとの関係**: RADIUSサーバーがユーザー確認をする際、実際の台帳としてLDAPサーバーを参照することが多いです。

### 4-4. Kerberos (ケルベロス) 認証
**「社内ネットワーク最強の認証」**です。WindowsのActive Directoryなどで標準的に使われています。
ギリシャ神話の地獄の番犬が名前の由来です。

#### 仕組み（重要！）
「チケット」を使って、パスワードをネットワークに流さずに認証します。

1.  **認証サーバー (AS)** でID/パスワードを確認してもらい、**TGT (Ticket Granting Ticket: チケットを貰うためのチケット)** を受け取る。
2.  ファイルサーバーなどを使いたい時、**TGS (Ticket Granting Server)** にTGTを見せ、**「サービス利用チケット」**を貰う。
3.  そのチケットをサーバーに見せて利用開始。

> [!CAUTION]
> **【Kerberosの最大の弱点（試験ポイント）】**
> Kerberosはチケットに**「時刻」**が含まれており、防犯のために有効期限が厳しく設定されています。
> そのため、**サーバーとクライアントの時計がズレていると認証に失敗します**。
> （NTPという時刻同期プロトコルが必須になります）

---

<a id="chapter5"></a>
## 第5章：ウェブとクラウドの認証・連携 ～SSO・SAML・OAuth・OIDC～

今の時代の試験では最もよく出る、Webサービス同士をつなぐ技術です。

### 5-1. シングルサインオン (SSO)
1回のログインで複数のサービスを使えるようにする仕組みです。

| 方式 | 仕組み | メリット/デメリット |
| :--- | :--- | :--- |
| **リバースプロキシ方式** | Webサーバーの手前にプロキシ（中継サーバ）を置き、そこで認証する。 | 全アクセスがプロキシを通るため**ボトルネック**になりやすい。<br>既存アプリの改修が少なくて済む。 |
| **エージェント方式** | 各Webサーバーに小さなソフト（エージェント）を入れ、認証サーバーに確認しに行く。 | サーバーごとにエージェント導入が必要で、対応OSなどに制限がある。 |
| **フェデレーション方式** | 今の主流。Googleでログイン、Facebookでログインなど。 | 異なる組織（ドメイン）間でもSSOが可能。**クラウド時代はこれ一択**。 |

### 5-2. ID連携 (Federation)
「A社（Googleなど）」のIDを使って、「B社（ショッピングサイトなど）」を利用することです。
- **IdP (Identity Provider)**: IDを持っている側（認証する側）。例：Google, Microsoft Entra ID
- **SP (Service Provider)** / **RP (Relying Party)**: サービスを提供する側（利用される側）。

### 5-3. SAML (Security Assertion Markup Language)
**企業向けSSOの事実上の標準**です。
- **形式**: **XML**（タグがいっぱいのデータ形式）を使います。
- **特徴**: ユーザーの「属性情報（部署や役職）」も一緒に送れるため、権限設定がしやすい。
- **流れ**: ユーザー → SP「ログインしたい」 → IdPにリダイレクト「証明書持ってきて」 → IdPでログイン → **「アサーション（認証状）」**発行 → ユーザー経由でSPに提出。

### 5-4. OAuth 2.0 (Open Authorization)
これは**「認証（AuthN）」ではなく「認可（AuthZ）」**のプロトコルです。
- **例え話**: 「ホテルの駐車係（バレーパーキング）」に車のキーを渡すとき、家や金庫の鍵がついた束ごと渡しませんよね？「エンジンをかける・ドアを開ける」ことだけができる**「バレーキー（合鍵・限定鍵）」**を渡します。
- これがOAuthです。「私のGoogleカレンダーの予定を**見る権限**」をスケジュール調整アプリに渡す、といった時に使います。
- キーのことを**「アクセストークン」**と呼びます。

> [!WARNING]
> **【よくある間違い】**
> 「OAuthを使ってログイン機能を実装した」は、厳密には間違いです（セキュリティホールになります）。
> OAuthはあくまで「鍵（権限）」を渡すだけで、「本人確認」の手順が厳格には決まっていないからです。
> そこで登場したのが、次のOIDCです。

### 5-5. OpenID Connect (OIDC)
**「OAuth 2.0 ＋ 本人確認（認証）」**です。
- OAuthの仕組みに乗っかって、「この人は誰ですよ」という情報（**IDトークン**）を一緒に渡します。
- **形式**: **JWT (JSON Web Token)** という軽量なデータ形式を使います。
- **特徴**: スマホアプリやSPA（モダンWebアプリ）と相性が良い。

---

<a id="chapter6"></a>
## 第6章：試験直前チェックリスト＆用語集

最後に、試験直前にこれだけは見直しておきたい重要ポイントをまとめました。

 ### 6-1. どっちがどっち？セットで覚える用語
| 用語A | 用語B | 違いのポイント |
| :--- | :--- | :--- |
| **辞書攻撃** | **ブルートフォース** | 辞書は「単語のみ」、ブルートフォースは「全組み合わせ」。 |
| **SAML** | **OIDC** | SAMLは「XML・企業向け・重厚」、OIDCは「JSON・Web向け・軽量」。 |
| **OAuth** | **OIDC** | OAuthは「**認可**（合鍵）」、OIDCは「**認証**（身分証）」。 |
| **FRR (本人拒否)** | **FAR (他入受入)** | FRRは「使いにくい」、FARは「**危険**」。CERが低いほど優秀。 |
| **RADIUS** | **LDAP** | RADIUSは「門番（プロトコル）」、LDAPは「電話帳（へのアクセス手順）」。 |

### 6-2. 試験に出る「略語」フルネーム
略語の意味を知っているだけで解ける問題もあります。

- **MFA**: Multi-Factor Authentication（多要素認証）
- **SSO**: Single Sign-On（シングルサインオン）
- **OTP**: One-Time Password（ワンタイムパスワード）
- **TOTP**: Time-based OTP（時刻同期式）
- **KDC**: Key Distribution Center（Kerberosの鍵配布センター）
- **TGT**: Ticket Granting Ticket（Kerberosのチケット）
- **IdP**: Identity Provider（ID提供者）
- **JWT**: JSON Web Token（ジョット。OIDCで使うトークン形式）
- **FIDO**: Fast Identity Online（生体認証などでパスワードレスを実現する規格）

### 6-3. 最後に ～合格へのアドバイス～
認証技術は、単暗記ではなく**「誰が、誰に、何を渡して、どう確認しているか？」**というフロー（図）を頭に描くことが大切です。
特にSAMLやKerberosは、登場人物（クライアント、サーバー、認証局など）の関係性を整理しておきましょう。
また、**「セキュリティと利便性のトレードオフ」**（例：パスワードを長くすれば安全だが覚えられない）の視点を持つと、記述式問題で良い回答が書けるようになります。

Good Luck!



# Source: 6_Webアプリケーションセキュリティ_完全解説.md


# 情報処理安全確保支援士：Webアプリケーションセキュリティ 完全解説

## はじめに：本試験におけるWebセキュリティの重要性

情報処理安全確保支援士（セキスペ）試験において、**Webアプリケーションセキュリティ**は、午後試験（記述式）で最も頻出かつ高得点が狙える重要分野の一つです。
攻撃手法の仕組み、具体的な被害、そして**根本的な対策と緩和策の違い**を正確に理解しているかが問われます。

本資料では、初心者が躓きやすいポイントを丁寧に紐解きながら、試験で「そのまま書ける」レベルの知識を網羅的に解説します。

---

## 1. SQLインジェクション (SQL Injection)

### 概要とイメージ
**SQLインジェクション**は、Webアプリケーションがデータベース（DB）へ問い合わせる命令文（SQL）を構築する際に、悪意のある入力データが混入することで、意図しないSQL文が実行されてしまう脆弱性です。

> [!TIP]
> **イメージ**:
> レストランで「オムライスをください」と注文票に書くはずが、「オムライスをください、**あとレジの金を全部よこせ**」と書いて渡すようなものです。店員（DB）がそれをそのまま命令として受け取ってしまうと、強盗（データ漏洩）が成立してしまいます。

### 仕組み（メカニズム）
Webアプリは通常、ユーザーからの入力を受け取り、それをSQL文の一部として結合します。
例えば、書籍検索システムで以下のようなSQLを組み立てているとします。

```sql
SELECT * FROM books WHERE title = '$UserInput';
```

ここで、ユーザーが `$UserInput` に以下の文字列を入力したとします。

```text
' OR '1'='1
```

すると、完成するSQL文は以下のようになります。

```sql
SELECT * FROM books WHERE title = '' OR '1'='1';
```

この条件式 `WHERE title = '' OR '1'='1'` は、「タイトルが空、**または 1=1（真）である**」という意味になります。`1=1` は常に真（True）であるため、**全てのデータが合致**してしまい、本来見えてはいけない全書籍データが表示されてしまいます。

### 攻撃による影響
*   **情報漏洩**: 会員情報、クレカ情報などの全件抜き出し。
*   **データ改ざん・消去**: `DELETE` や `UPDATE` 文を注入されることによる破壊。
*   **認証回避**: ログイン画面でパスワードを入力をせずに `OR '1'='1'` でログイン成功してしまう。
*   **OSコマンド実行**: DBの設定によっては、DB経由でOSのコマンドを実行される恐れもあります。

### 【試験対策】ここが狙われる！「対策」の正解
セキスペ試験では、「SQLインジェクションの根本的対策は何か？」という問いが非常に多く出ます。
以下の優先順位を必ず覚えてください。

#### 1. 根本的対策（ベストプラクティス）
**「プレースホルダ（BIND機構）を利用して、SQL文の組み立てを静的に行う」**

これが試験での**唯一かつ最強の正解**です。
「静的プレースホルダ」とも呼ばれます。

*   **仕組み**: SQLのひな形（テンプレート）あらかじめDBに送り、ユーザー入力は「値」として後から割り当てます。
    *   `SELECT * FROM books WHERE title = ?`
    *   ユーザー入力が `' OR '1'='1` であっても、DBはこれを「`' OR '1'='1` というタイトルの本」として処理します（文字として扱う）。命令文としては解釈されません。

#### 2. 根本的対策（次善の策）
**「エスケープ処理を行う」**
*   SQLで特別な意味を持つ文字（`'` シングルクォートなど）を、無害な文字に置換します。
*   ※ただし、実装漏れの可能性があるため、プレースホルダが使えない場合の代替案です。

#### 3. 緩和策（保険的対策）
**「WAF (Web Application Firewall) の導入」**
*   WAFで攻撃パターン（シグネチャ）を検知して遮断します。
*   **重要**: WAFはあくまで「緩和策」です。脆弱性そのものを消すわけではありません。「根本対策がすぐにできない場合の緊急措置」として記述するのが正解です。

> [!WARNING]
> **よくある間違い（ひっかけ）**
> × 「入力文字数を制限する」 → 対策になりません。短い攻撃コードも存在します。
> × 「エラーメッセージを非表示にする」 → 攻撃の手がかりを隠すだけで、脆弱性は残ります。
> × 「ストアドプロシージャを使う」 → 内部で動的SQL結合をしていれば脆弱になります。

---
## 2. クロスサイトスクリプティング (XSS)

### 概要とイメージ
**XSS**は、攻撃者が作成した「悪意のあるスクリプト（主にJavaScript）」を、被害者のブラウザ上で実行させる脆弱性です。
Webページにスクリプトが“注入”されてしまうため、ユーザーからは「正規のサイト上で動いているプログラム」に見えてしまい、ブラウザもそれを信頼して実行してしまいます。

> [!TIP]
> **イメージ**:
> 掲示板に「こんにちは」と書き込む代わりに、「読んだ人の財布から僕に送金しろ」という命令書を貼り付けるようなものです。
> 他の人がその掲示板（Webサイト）を見ると、自動的にその命令（スクリプト）が実行されてしまいます。

### 3つの分類
試験では、以下の3つのタイプの違いが出ることがあります。

1.  **反射型XSS (Reflected XSS)**
    *   攻撃者が用意した「罠リンク」をユーザーがクリックすることで発動します。
    *   スクリプトはサーバーに保存されず、検索結果画面などに一時的に表示（反射）されます。
    *   例：「ここをクリック！」→ 偽の検索結果ページへ → スクリプト実行。
2.  **蓄積型XSS (Stored XSS)**
    *   攻撃者が掲示板やSNSなどにスクリプトを書き込み、DBに**保存**されます。
    *   そのページを閲覧した**全てのユーザー**でスクリプトが実行されるため、被害が拡大しやすいです。
3.  **DOM Based XSS**
    *   サーバーとの通信を待たずに、ブラウザ上のJavaScript（DOM操作）だけで完結して発生するXSSです。
    *   URLの `#` 以降（フラグメント）などをJSで読み取って画面に表示する処理などで発生します。

### 攻撃による影響
*   **セッションハイジャック**: クッキー（Cookie）に含まれるセッションIDを盗み出し、本人になりすます。
*   **フィッシング**: 偽のログインフォームを画面上に表示させ、パスワードを盗む。
*   **Webサイトの改ざん**: 画面の見た目を勝手に書き換える。

### 【試験対策】XSSの「対策」
#### 1. 根本的対策
**「出力時にエスケープ処理（サニタイズ）を行う」**
*   HTMLとして特別な意味を持つ文字（`<`, `>`, `&`, `"`, `'` など）を、実体参照（`&lt;`, `&gt;` など）に変換します。
*   `<script>` は `&lt;script&gt;` と変換され、ただの文字として表示されるようになります。

#### 2. 緩和策（保険）
**「WAFの導入」**
**「入力値検証（バリデーション）」**
*   あくまで補助的な対策です。

**「Cookieに `HttpOnly` 属性を付与する」**
*   **超重要**: JavaScriptからCookieへのアクセス（`document.cookie`）を禁止します。
*   これにより、たとえXSSが発生しても、セッションID（Cookie）だけは盗まれないように防御できます。

---

## 3. クロスサイトリクエストフォージェリ (CSRF)

### 概要とイメージ
**CSRF**（シーサーフ）は、ユーザーがWebサービスにログイン中であることを悪用し、**ユーザーの意図しない操作（リクエスト）を勝手に送信させる**攻撃です。

> [!TIP]
> **イメージ**:
> あなたが銀行の窓口で本人確認を済ませて手続き中だとします。
> その隙に、後ろから泥棒が「A口座に100万円振込！」と書いた紙を、あなたの手を通して窓口に出させるような攻撃です。
> 銀行側は「あなたの手から出された（認証済みセッションからの）」お願いいなので、正しい手続きとして受理してしまいます。

### 仕組み
1.  被害者が、攻撃対象サイト（例：SNS）にログインしている。
2.  攻撃者が用意した「罠サイト」を被害者が閲覧する。
3.  罠サイトには、「SNSに対して退会リクエストを送る」ような見えないリクエスト（`form`送信や画像読み込みタグ）が仕込まれている。
4.  被害者のブラウザは、SNSへの認証情報（Cookie）を自動的に付けてリクエストを送ってしまう。
5.  SNS側は、正規のユーザーからのリクエストと誤認して処理を実行（退会完了）してしまう。

### 攻撃による影響
*   意図しない商品購入、退会処理、投稿、パスワード変更など。
*   ※XSSと違い、情報の**閲覧（盗み見）**はできません（レスポンスは攻撃者には見えないため）。あくまで「処理の強要」です。

### 【試験対策】CSRFの「対策」
#### 1. 根本的対策
**「予測不可能な『トークン（ワンタイムトークン）』埋め込み」**
*   重要な処理（決済、変更など）のフォーム送信時に、サーバー側で発行した乱数（CSRFトークン）を含めます。
*   セッションIDとは別のものです。
*   攻撃者はこのトークンを知ることができないため、罠サイトからのリクエストには正しいトークンが含まれず、サーバーで拒否できます。

**「重要な処理の実行前にパスワード再入力を求める」**
*   これも有効です。

#### 2. その他の対策
**「SameSite属性の設定」**
*   Cookieに `SameSite=Strict` や `Lax` を設定することで、他サイト（クロスサイト）からのリクエスト時にCookieを送信しないように制御できます。

> [!WARNING]
> **XSSとCSRFの違い**
> *   **XSS**: ユーザーのブラウザ上で**スクリプトが動く**。情報漏洩のリスク大。
> *   **CSRF**: ユーザーの権限で勝手に**リクエスト（処理）が飛ぶ**。情報の盗み見はできない。
> 混同しないように注意しましょう。

---
## 4. ディレクトリトラバーサル (Directory Traversal)

### 概要とイメージ
**ディレクトリトラバーサル**（パストラバーサル）は、ファイル名を指定して読み込む機能などにおいて、攻撃者が想定外のパスを指定することで、本来アクセス権のないサーバー内のファイル（設定ファイルやパスワードファイルなど）を盗み見る攻撃です。
「トラバーサル」は「横断する」という意味です。

> [!TIP]
> **イメージ**:
> 図書館のカウンターで「本を持ってきます」と言われたときに、「地下の金庫にある重要書類を取ってきて」と依頼するようなものです。
> 司書（サーバー）が何も疑わずに指定された場所へ行って持ってきてしまうと成立します。

### 仕組み
通常、`http://example.com/view?file=report.txt` のようにファイル名を指定する場合、サーバーは `/var/www/html/docs/` などの公開ディレクトリからファイルを探します。

しかし、攻撃者が `file=../../../../etc/passwd` のように入力したとします。
`..` は「一つ上の階層（親ディレクトリ）」を意味します。これを繰り返すことで、公開ディレクトリを遡り、システムのルートディレクトリまで到達し、重要ファイル（Linuxの `passwd` ファイルなど）を指定できてしまいます。

### 攻撃による影響
*   サーバー内の重要ファイル（設定ファイル、ソースコード、パスワードファイル）の漏洩。
*   場合によってはファイルの改ざんや削除。

### 【試験対策】ディレクトリトラバーサルの「対策」
#### 1. 根本的対策
**「ファイル名を直接指定させない（外部からパスを指定させない）」**
*   ユーザー入力値をそのままファイルパスとして使わないのが鉄則です。
*   例えば、`file=1` のようにIDのみを渡し、内部ロジックで `1` に対応するファイル名（`report.txt`）を決定する方式にします（間接参照）。

#### 2. どうしてもファイル名指定が必要な場合の対策
**「ファイル名として許可する文字を制限する」**
*   英数字のみを許可し、パス区切り文字（`/` や `\`）やドット（`.`）の使用を禁止します。

**「`basename()` 関数などでディレクトリ部分を除去する」**
*   入力値からファイル名の部分だけを取り出す関数を通すことで、`../../` などのパス操作部分を無効化します。

---

## 5. OSコマンドインジェクション

### 概要とイメージ
**OSコマンドインジェクション**は、ユーザーからの入力をきっかけにサーバー内部でOSのコマンド（シェルコマンド）を実行している処理において、攻撃者が別のコマンドを紛れ込ませることで、サーバー上で任意のコマンドを不正実行させる脆弱性です。
Webセキュリティの中で**最も危険度が高い**脆弱性の一つです。

> [!TIP]
> **イメージ**:
> 「翻訳して」と頼まれて辞書を引くアシスタントに対し、「翻訳して。**あと、このビルの電源を落として**」というメモを渡すようなものです。
> アシスタント（サーバー）が律儀に後半の命令まで実行してしまうと、システム全体が破壊されます。

### 仕組み
Webアプリが、ユーザーの入力（メールアドレスなど）を使って、裏側でメール送信コマンドなどを呼び出しているとします。
```bash
mail $UserInput
```
ここで、ユーザーが `$UserInput` に以下のように入力します。
```text
info@example.com ; cat /etc/passwd
```
すると、実行されるコマンドは以下のようになります（`;` はコマンドの区切り文字）。
```bash
mail info@example.com ; cat /etc/passwd
```
「メールを送る」という本来の処理の後に、「パスワードファイルを表示しろ」という命令が実行されてしまいます。

### 攻撃による影響
*   **サーバーの乗っ取り**: バックドアの設置、管理者権限の奪取。
*   情報の漏洩、改ざん、システムの破壊（`rm -rf /` など）。
*   他のサーバーへの攻撃の踏み台にされる。

### 【試験対策】OSコマンドインジェクションの「対策」
#### 1. 根本的対策
**「シェル（OSコマンド）を起動できる言語機能を使わない」**
*   Perlの `open()`、PHPの `system()` や `exec()` などの関数使用を避けます。
*   メール送信なら、コマンド呼び出しではなく、言語標準のメール送信ライブラリを使用します。

#### 2. どうしてもOSコマンド呼び出しが必要な場合の対策
**「引数を安全な形にエスケープする」**
*   シェルにとって特別な意味を持つ文字（`;`, `|`, `&`, `>` など）をエスケープ処理します。
*   各言語に用意された安全なエスケープ関数を使用します。

> [!WARNING]
> **よくあるひっかけ**
> 「WAFを入れる」や「権限を最小化する」は、被害を軽減するための緩和策であり、根本対策ではありません。
> 最も推奨されるのは「そもそもOSコマンド呼び出しを行わない実装にする」ことです。

---
## 6. セッション管理の不備

Webアプリケーションにおいて「ログイン状態」を維持するために使われるのが「セッション」です。ここにも多くの脆弱性が潜んでいます。

### セッションハイジャック (Session Hijacking)
*   **概要**: 何らかの手段（XSSによるCookie盗難や、通信の盗聴など）で正規ユーザーのセッションIDを盗み出し、そのユーザーになりすます攻撃です。
*   **対策**:
    *   **通信の暗号化 (HTTPS化)**: 経路での盗聴を防ぎます。
    *   **Secure属性の付与**: Cookieに `Secure` 属性を付け、HTTPS通信時のみ送信されるようにします。
    *   **HttpOnly属性の付与**: XSSによる盗難を防ぎます。

### セッション固定攻撃 (Session Fixation)
*   **概要**: 攻撃者が**あらかじめ取得した有効なセッションID**を被害者に送り付け（強制し）、被害者がそのIDを使ってログインすることで、攻撃者がそのアカウントの操作権限を得る攻撃です。
*   **イメージ**: 攻撃者が発行した「整理券」を被害者に渡し、被害者がその整理券で受付を済ませると、攻撃者も同じ整理券を持っているので、被害者として振る舞えてしまう。
*   **【超頻出】対策**:
    *   **「ログイン成功後に新しいセッションIDを発行し直す」**: これが鉄則です。
    *   ログイン前のID（攻撃者が知っているID）を破棄し、新しいID（攻撃者が知らないID）に切り替えることで、攻撃者を締め出します。

### セキュアなCookie属性まとめ
試験ではCookieの属性設定が問われることが多いので、表で整理しましょう。

| 多重属性名 | 役割 | 対策できる攻撃 |
| :--- | :--- | :--- |
| **Secure** | HTTPS通信時のみCookieを送信する | 盗聴、中間者攻撃 |
| **HttpOnly** | JavaScriptからのアクセスを禁止する | XSSによるセッションハイジャック |
| **SameSite** | クロスサイトのリクエストでの送信を制限 | CSRF |
| **Domain** | 送信先のドメイン範囲を指定 | (広すぎるとセキュリティホールになるため注意) |

---

## 7. WAF (Web Application Firewall)

### 概要
**WAF**は、Webアプリケーションへの通信内容（HTTP/HTTPSリクエスト）を検査し、SQLインジェクションやXSSなどの攻撃パターン（シグネチャ）が含まれていないかチェックする「アプリケーション層のファイアウォール」です。

### FW、IPSとの違い
試験では、既存のネットワークセキュリティ機器との違いが問われます。

1.  **ファイアウォール (FW)**
    *   **レイヤー**: L3/L4 (IPアドレス、ポート番号)
    *   **役割**: 「許可されたポート（80/443など）以外の通信を遮断する」。
    *   **限界**: 80番ポートを通る**中身（攻撃コード）**まではチェックしません。Web攻撃はスルーしてしまいます。

2.  **IPS (Intrusion Prevention System)**
    *   **レイヤー**: L3～L7
    *   **役割**: OSやミドルウェアの既知の脆弱性攻撃を防ぐのが得意。
    *   **限界**: Webアプリ特有の複雑なロジックに対する攻撃（SQLiなどの亜種）の検知精度はWAFに劣ります。

3.  **WAF**
    *   **レイヤー**: L7 (Webアプリケーション層)
    *   **役割**: HTTPリクエストの**中身（パラメータやCookie）**を詳細に解析できる。
    *   **得意**: SQLインジェクション、XSS、ディレクトリトラバーサルなど。

### WAFの限界
*   **あくまで「緩和策」**: アプリケーションのバグ自体を直すわけではないので、WAFをすり抜ける攻撃手法（難読化など）には無力になる可能性があります。
*   **誤検知 (False Positive)**: 正常な通信を攻撃とみなして遮断してしまう可能性があります。
*   **暗号化通信**: WAF自身がSSL/TLS復号機能を持たない場合（または秘密鍵を設定していない場合）、HTTPS通信の中身は見えないため防御できません。

---
## 8. 同一オリジンポリシー (Same-Origin Policy / SOP)

### 概要
Webブラウザのセキュリティの根幹をなすルールです。「あるWebサイト（オリジン）から読み込まれたJavaScriptなどは、異なるオリジンのリソース（データ）にはアクセスできない」という制限のことです。
これがなければ、例えば悪意のあるサイトを開いただけで、裏で勝手にGmailを開いてメールの中身を読み取られる、といったことが起きてしまいます。

### 「オリジン (Origin)」とは何か？
以下の3つの要素がすべて一致する場合、**同一オリジン**とみなされます。
1.  **プロトコル** (http, https)
2.  **ホスト** (example.com)
3.  **ポート番号** (80, 443 など)

| URL A | URL B | 同一オリジン？ | 理由 |
| :--- | :--- | :--- | :--- |
| `http://a.com/` | `http://a.com/login` | ○ | パスが違ってもオリジンは同じ |
| `http://a.com/` | `https://a.com/` | × | プロトコルが違う |
| `http://a.com/` | `http://b.com/` | × | ホストが違う |
| `http://a.com:80/` | `http://a.com:8080/` | × | ポートが違う |

### SOPの制限範囲
*   **できること**: 他オリジンの画像 (`img`) やスクリプト (`script src`) を**埋め込んで表示・実行すること**は可能です。
*   **できないこと**: 他オリジンのページの中身を、JavaScript (`XMLHttpRequest` や `fetch`) で**読み取ること**はできません。

---

## 9. CORS (Cross-Origin Resource Sharing)

### 概要
SOPは重要ですが、最近のWebアプリでは「APIサーバーとフロントエンドサーバーが別ドメイン」という構成も一般的です。この場合、SOPの制限によりデータを取得できなくなって困ります。
そこで、**サーバー側が明示的に許可を出した場合に限り、SOPの制限を緩和して他オリジンからのアクセスを許可する仕組み**が **CORS** です。

### 仕組み
ブラウザとサーバーの間で、HTTPヘッダーを使ってやり取りを行います。

1.  **リクエスト (ブラウザ)**: 「Origin: `http://my-app.com` からアクセスしたいです」とヘッダーを付けて送ります。
2.  **レスポンス (サーバー)**: 許可する場合、「Access-Control-Allow-Origin: `http://my-app.com`」というヘッダーを返します。
3.  **判定 (ブラウザ)**: レスポンスヘッダーを見て、許可されている場合のみ、JavaScriptに結果を渡します。

### プリフライトリクエスト (Preflight Request)
単純なGETリクエスト以外（JSONを送るPOSTや、認証情報を含む場合など）では、本当のリクエストを送る前に、**OPTIONSメソッド**で「送ってもいいですか？」と事前の問い合わせを行います。これを**プリフライトリクエスト**と呼びます。

### セキュリティ上の注意点
*   **`Access-Control-Allow-Origin: *` の乱用**:
    *   開発が面倒だからといって `*`（全許可）に設定すると、悪意のあるサイトからもデータを読み取れるようになってしまいます。
    *   特に認証情報（Cookie）を伴う通信では、 `*` は指定できない仕様になっていますが、もし特定のオリジンを動的に反射して返してしまえば脆弱性になります。

---
## 10. セキュアコーディング (Secure Coding)

### 原則
脆弱なコードを書かないための基本原則です。

1.  **入力値検証 (Validation)**:
    *   外部からのデータはすべて「悪意があるかもしれない」と疑う。
    *   期待する形式（数字のみ、郵便番号形式など）かどうかをチェックし、合致しない場合は処理を中断する。
2.  **出力時エスケープ (Encoding)**:
    *   データを画面に表示する直前に、HTML特殊文字などを無害化する。
3.  **最小権限の原則**:
    *   Webアプリが使うDBユーザーやOSユーザーには、必要最小限の権限だけを与える。（root権限で動かさない）
4.  **フェイルセーフ (Fail Safe)**:
    *   エラーが発生した際、システムを安全な状態（停止や拒否）にする。
    *   詳細なエラーログ（スタックトレースやSQLエラー）を画面に表示しない。

---

## 【最終まとめ】試験直前チェックリスト

試験で問われる「攻撃」と「根本的対策」の組み合わせを丸暗記リストにしました。
**ここだけは絶対に間違えないようにしましょう。**

| 攻撃手法 | 根本的対策 (Best Practice) | 緩和策 (Defense in Depth) |
| :--- | :--- | :--- |
| **SQLインジェクション** | **プレースホルダ** (静的プレースホルダ) の利用 | WAF、エスケープ |
| **XSS (クロスサイトスクリプティング)** | **HTMLエスケープ** (サニタイズ) | WAF、HttpOnly属性 |
| **CSRF (クロスサイトリクエストフォージェリ)** | **トークン** (ワンタイムトークン) の埋め込み | SameSite属性、パスワード再入力 |
| **ディレクトリトラバーサル** | **外部からのパス指定を避ける** (間接参照)<br>`basename()`の使用 | 入力文字制限 |
| **OSコマンドインジェクション** | **シェル呼び出し関数を使わない** | 引数のエスケープ |
| **セッションハイジャック** | **HTTPS化**、**Secure属性** | HttpOnly属性 |
| **セッション固定** | **ログイン成功時のセッションID再発行** | - |

---

## おわりに

Webアプリケーションセキュリティは、攻撃の手口が具体的でイメージしやすいため、仕組みさえ理解すれば得点源になります。
「なんとなく危ない」ではなく、「**具体的にどの文字がどう解釈されるから危ないのか**」を説明できるようになれば、セキスペ合格は目前です。

学習頑張ってください！




# Source: 7_攻撃手法_完全解説.md


# 情報処理安全確保支援士「7. 攻撃手法」完全解説

> [!IMPORTANT]
> **この資料の使い方**
> - **初心者向け**: 技術用語はできるだけ噛み砕いています。
> - **試験対策**: ⚠️ アイコンは「試験によく出る」「ひっかけ」ポイントです。
> - **網羅性**: 支援士試験で問われる攻撃手法を網羅しています。

---

## 1. はじめに：なぜ「攻撃手法」を知る必要があるのか？

情報処理安全確保支援士（セキスペ）の試験では、攻撃者が「**どのような手口で**」システムを攻撃してくるかを知らなければ、適切な「**対策（防御）**」答えられません。
敵の手口を知ることが、防御の第一歩です。

この章では、試験に頻出する代表的な攻撃手法を、**仕組み**と**対策**セットで解説します。

---

## 2. マルウェア (Malware) の脅威

**マルウェア (Malware)** とは、「**Mal**icious (悪意のある)」と「Soft**ware** (ソフトウェア)」を組み合わせた造語です。
コンピュータウイルスやワームなど、害を与えるプログラムの総称です。

試験では、**ウイルス、ワーム、トロイの木馬** の3つの分類と違いがよく問われます。

### 2.1. 3大マルウェアの違い

| 分類 | 特徴 (ここが出ます！) | 単独動作 | 自己増殖 |
| :--- | :--- | :---: | :---: |
| **ウイルス** (Virus) | 他のプログラムに**寄生**して広がる。<br>宿主（ファイル）が必要。 | ❌ | ⭕ |
| **ワーム** (Worm) | **単独**で存在し、ネットワーク経由で**勝手に**感染を広げる。<br>宿主は不要。最も感染力が高い。 | ⭕ | ⭕ |
| **トロイの木馬** (Trojan Horse) | **有用なソフトに偽装**して侵入する。<br>増殖はしないが、裏口（バックドア）を作るなどの悪さをする。 | ⭕ | ❌ |

> [!WARNING]
> **⚠️ 試験のひっかけポイント**
> - 「トロイの木馬は自己増殖する」➡ **誤り (×)**。トロイの木馬は自分では増えません。ユーザーが騙されてダウンロードすることで侵入します。
> - 「ワームはファイルに感染（寄生）する」➡ **誤り (×)**。ワームはファイルに寄生せず、独立したプログラムとしてメモリ上やネットワーク上で活動します。

### 2.2. 代表的なマルウェアの機能

#### ボット (Bot) とボットネット
- **ボット**: マルウェアの一種で、攻撃者（C&Cサーバー）からの**遠隔指令**を受けてロボットのように動くプログラム。
- **C&Cサーバー (Command and Control Server)**: ボットに命令を送る指令塔のサーバー。
- **ボットネット**: 多数のボットに感染したPC（ゾンビPC）で構成されたネットワーク。DDoS攻撃の一斉攻撃元として悪用されます。

> [!TIP]
> **試験での問われ方**
> 「多数のPCを感染させ、外部からの指令によって一斉に攻撃を行わせる攻撃手法に関与するマルウェアはどれか？」
> ➡ 答え：**ボット**

## 3. 身代金を要求する恐怖：ランサムウェア (Ransomware)

**ランサムウェア**は、「Ransom (身代金)」と「Software」の造語です。
PC内のファイルを勝手に**暗号化**して読めなくし、「元に戻したければ金を払え」と脅迫するマルウェアです。

### 3.1. 攻撃の手口と進化

昔は「ばら撒き型」が多かったですが、現在は「特定の企業」を狙い撃ちにする手口が増えています。

#### ⚠️ 重要：二重脅迫 (Double Extortion)
最近のトレンドは、単に暗号化するだけではありません。
1.  **暗号化**: 業務データを暗号化してシステムを止める。
2.  **情報漏えい**: 「金を払わなければ、盗んだ機密情報を公開するぞ」と脅す。

これを「**二重脅迫**」と呼びます。バックアップから復旧できても、「情報の公開」を人質に取られるため、非常に厄介です。

### 3.2. 対策のポイント

*   **オフラインバックアップ**: ネットワークにつながっていない外付けHDDなどにバックアップを取る。（つながっていると、バックアップごと暗号化されるため！）
*   **不審なメールを開かない**: 侵入経路の多くはメールの添付ファイルやURLです。

---

## 4. 執拗に狙う：標的型攻撃 (APT)

**標的型攻撃**、または **APT (Advanced Persistent Threat)** は、特定の組織や個人をターゲットにして、長期間潜伏し、執拗に攻撃を繰り返す手法です。

### 4.1. APTの3つの特徴
1.  **Advanced (高度)**: ゼロデイ攻撃（未知の脆弱性）など、高度な技術を使う。
2.  **Persistent (執拗・持続的)**: 一度失敗しても諦めず、長期間（数ヶ月〜数年）潜伏してチャンスを伺う。
3.  **Threat (脅威)**: 国家レベルの組織や産業スパイが関与していることが多い。

### 4.2. 攻撃のプロセス（サイバーキルチェーン）

試験では、攻撃の流れ（順序）が問われることがあります。

1.  **偵察 (Reconnaissance)**: SNSや公式サイトから、社員のメルアドや取引先などを調べる。
2.  **武器化 (Weaponization)**: ターゲットに合わせたウイルスファイル（PDFなど）を作る。
3.  **配送 (Delivery)**: **標的型メール**（業務連絡を装ったメール）で送りつける。
4.  **エクスプロイト (Exploit)**: ファイルを開封させ、脆弱性を突く。
5.  **インストール (Installation)**: マルウェア（バックドア）を仕込む。
6.  **遠隔操作 (C2)**: C&Cサーバーと通信し、指示を待つ。
7.  **目的の実行 (Actions on Objectives)**: 内部ネットワークを探索し、機密データを盗み出す。

> [!CAUTION]
> **やり取り型攻撃に注意**
> 最初はウイルスを送らず、何度か「業務の相談なんですが…」と普通のメールやり取りをして**信用させた後**、最後にウイルスファイルを送る手口です。「知ってる人からのメールだ」と油断させるため、人間心理を突いた高度な手法です。

### 4.3. 内部横断的移動 (ラテラルムーブメント)
侵入した後、最初のPCだけでは価値ある情報は少ないです。
そこで、攻撃者はネットワーク内で**管理者権限**などを奪取しながら、サーバーやAD（Active Directory）など、より重要なシステムへ移動していきます。これを**ラテラルムーブメント**と呼びます。

---

## 5. サービスを停止させる：DDoS攻撃 (Distributed Denial of Service attack)

サーバーに大量のアクセス集中させ、パンクさせてサービスダウン（停止）させる攻撃です。

### 5.1. DoSとDDoSの違い
*   **DoS攻撃**: **1対1**。1台のPCから攻撃する。
*   **DDoS攻撃 (Distributed - 分散型)**: **多対1**。世界中のボットネット（乗っ取られたPC）から一斉に攻撃する。防御が難しい。

### 5.2. 代表的な攻撃手法

#### ① SYNフラッド攻撃 (SYN Flood)
TCPの接続開始手順（3ウェイハンドシェイク）を悪用します。
「接続したいです（SYN）」だけ大量に送り、サーバーからの「いいよ（SYN/ACK）」に対して**無視（ACKを返さない）**します。
サーバーは「返事待ち」の状態（ハーフオープン）でメモリを食いつぶされ、ダウンします。

#### ② UDPフラッド・リフレクション攻撃 (DNS amp / NTP amp)
**ここが試験に出ます！**
攻撃者は、自分の**送信元IPアドレスを「ターゲットのIP」に偽装**し、DNSサーバーなどに「問い合わせ」を送ります。
すると、問い合わせを受けたDNSサーバーは、偽装された（＝ターゲットの）IPアドレスに、「**大量の応答パケット**」を送りつけます。
少ない労力（問い合わせ）で、大きなダメージ（大量の応答）を与えられるため、「増幅（Amplification）攻撃」とも呼ばれます。

> [!NOTE]
> **対策**
> - FW（ファイアウォール）で不要なパケットを遮断する。
> - ISP（プロバイダ）側でDDoS対策サービスを利用する。
> - SYN Cookiesなどの技術で、無駄なリソース消費を防ぐ。

---

## 6. 通信を盗み見る・改ざんする：中間者攻撃 (MITM)

**中間者攻撃 (Man-In-The-Middle attack)** は、利用者とサーバーの間に**割り込み**、通信を盗聴・改ざんする攻撃です。

### 6.1. 代表例：ARPスプーフィング (ARP Spoofing)
LAN内（Wifi内など）で行われる攻撃です。
攻撃者が「私がルーターです！」という**嘘のARPパケット**（IPアドレスとMACアドレスの対応情報）をPCに送ります。
騙されたPCは、ルーターではなく攻撃者にデータを送ってしまい、通信内容が筒抜けになります。

> [!TIP]
> **公衆無線LAN（フリーWifi）の危険性**
> カフェなどの暗号化されていないWifiでは、MITM攻撃が容易に行えます。
> 重要な情報を入力するときは、必ず**TLS (https)** で暗号化されているか確認し、**VPN** を使うと安全です。

### 6.2. 対策
*   **HTTPS (TLS) 通信の利用**: 通信経路が暗号化されていれば、盗聴されても内容は分かりません。
*   **VPNの利用**: 仮想的な専用線でトンネリングして身を守る。

---

## 7. 人を騙す手口：フィッシング & ソーシャルエンジニアリング

技術的な脆弱性ではなく、人間の「心理的な隙」や「行動のミス」を突く攻撃です。

### 7.1. フィッシング (Phishing)
正規の企業（銀行やAmazonなど）を装ったメールを送り、偽サイト（フィッシングサイト）に誘導して、ID・パスワードやクレカ情報を盗み出す詐欺です。

| 手法 | 特徴 |
| :--- | :--- |
| **フィッシング** | 不特定多数にばら撒く。 |
| **スピアフィッシング** | **特定の組織・個人**を狙い撃ちにする。<br>件名や本文が具体的で騙されやすい。 |
| **スミッシング (Smishing)** | **SMS** (ショートメッセージ) を使ったフィッシング。 |
| **ビッシング (Vishing)** | **電話** (Voice) を使ったフィッシング。 |

### 7.2. ソーシャルエンジニアリング (Social Engineering)
IT技術を使わず、アナログな手段で情報を盗むことの総称です。

*   **ショルダーハッキング**: 後ろからパスワード入力やスマホ画面を盗み見る。
*   **トラッシング (スキャベンジング)**: ゴミ箱を漁り、廃棄された書類や記憶媒体から情報を盗む。
*   **なりすまし電話**: 社内の管理者などを装って電話し、パスワードを聞き出す。

> [!WARNING]
> **対策の基本**
> - 離席時の画面ロック（クリアスクリーンポリシー）。
> - 重要書類のシュレッダー廃棄（クリアデスクポリシー）。
> - 不審なメールやURLは開かない訓練の実施。

---

## 8. 未知の脆弱性を突く：ゼロデイ攻撃 (Zero-Day Attack)

ソフトウェアの脆弱性が発見されてから、修正パッチ（修正プログラム）が提供されるまでの「空白の期間（0日）」を狙う攻撃です。

### 8.1. なぜ怖いのか？
パッチが存在しないため、**従来の「アップデートする」という対策が通用しません**。

### 8.2. 対策
*   **WAF (Web Application Firewall)**: 攻撃パターン（シグネチャ）だけでなく、異常な振る舞いを検知して防ぐ。
*   **ネットワーク分離**: 最悪侵入されても被害が広がらないように、重要ネットワークを切り離す。
*   **サンドボックス**: 不審なファイルを隔離された仮想環境で実行させて様子を見る。

---

## 9. 待ち伏せする罠：水飲み場攻撃 (Watering Hole Attack)

ターゲットとなる組織のユーザーが**「よく見るWebサイト」を改ざん**し、閲覧しただけでマルウェアに感染させる手法です。
野生動物が来る水飲み場に毒を盛る様子から名付けられました。

*   **ドライブバイダウンロード (Drive-by Download)**: サイトを見ただけで、勝手にマルウェアがダウンロード・実行される攻撃手法。これを水飲み場攻撃で使います。

---

## 10. 案内人を騙す：DNSキャッシュポイズニング

DNSサーバー（インターネットの電話帳）の**キャッシュ（一時保存データ）に嘘の情報**を書き込み、ユーザーを偽サイトへ誘導する攻撃です。

### 10.1. 攻撃の仕組み
本来のDNSサーバー（権威DNS）からの回答より早く、攻撃者が「嘘の回答」を送りつけます。
キャッシュサーバーは「早い者勝ち」で回答を受け入れるため、嘘のIPアドレスを記憶（ポイズニング）してしまいます。

### 10.2. カミンスキー攻撃
従来のDNSキャッシュポイズニングの手法を進化させ、効率的に成功させる手法です。

### 10.3. 対策
*   **DNSSEC (DNS Security Extensions) の導入**: **最重要対策！** デジタル署名を使って、「正しいDNSからの回答か」を検証する仕組み。
*   **ソースポートランダム化**: 攻撃者が回答を偽装するのを難しくする。

---

## 11. なりすましの常套手段：セッションハイジャック

Webサイトにログインしている状態（セッション）を管理する「セッションID（Cookieなど）」を盗み出し、**正規のユーザーになりすます**攻撃です。

### 11.1. よくある手口
*   **セッションIDの固定化 (Session Fixation)**:
    攻撃者が用意したセッションIDで、ユーザーにログインさせる手法。「このURLからログインして！」と誘い、ログインさせると、そのIDは攻撃者も知っているため、乗っ取れる。
*   **XSS (クロスサイトスクリプティング)**:
    Webページの脆弱性を突き、JavaScriptを実行させてCookieを盗む。

### 11.2. 対策
*   **ログイン後のセッションID再発行**: ログインが成功したタイミングで、新しいIDに作り変える（Regenerate）。
*   **Secure属性**: CookieにSecure属性をつけ、HTTPS通信でのみ送信させる（盗聴防止）。
*   **HttpOnly属性**: JavaScriptからCookieを読めないようにして、XSSでの盗難を防ぐ。

---

## 12. メモリの隙間を突く：バッファオーバーフロー (Buffer Overflow)

プログラムが確保したメモリ領域（バッファ）を超えて（オーバーフロー）、データを書き込む攻撃です。
溢れたデータで、**プログラムの実行を制御する重要なデータ（リターンアドレスなど）を上書き**し、攻撃者の用意したプログラムを実行させます。

### 12.1. 攻撃の仕組み（スタックオーバーフロー）
関数が呼び出されると、「処理が終わったらどこに戻るか（リターンアドレス）」がメモリ（スタック領域）に保存されます。
攻撃者は、入力データに悪意のあるコードを混ぜ、わざと長いデータを送ってリターンアドレスを書き換えます。
すると、プログラムは本来の場所に戻れず、攻撃者のコードを実行してしまいます。

### 12.2. 対策
*   **境界値チェック（バウンズチェック）**: データを書き込む前に、「バッファの大きさを超えていないか」を確認する。
*   **安全な関数の利用**: C言語の `strcpy`（チェックなし）ではなく、`strncpy`（サイズ指定あり）を使う。
*   **ASLR (アドレス空間配置のランダム化)**: メモリ上の配置場所を毎回ランダムに変え、攻撃者が場所を特定できないようにする。

---

## 13. まとめ & 試験直前チェックリスト

最後に、試験で間違えやすいポイントを復習しましょう。

| 用語 | ポイント |
| :--- | :--- |
| **トロイの木馬** | 自己増殖**しない**。ユーザーに実行させる。 |
| **リフレクション攻撃** | 送信元IPを**偽装**して、DNS等に問い合わせる。 |
| **DNSSEC** | DNS応答に**デジタル署名**を付与して検証する。 |
| **ドライブバイダウンロード** | サイトを**見ただけ**で感染する。 |
| **二重脅迫** | ランサムウェアの新しい手口（暗号化＋暴露）。 |

### 学習のアドバイス
攻撃手法は、単に名前を覚えるだけでなく、「**どの脆弱性を**」「**どういう仕組みで突いて**」「**どう守るか**」をセットで覚えるのが合格への近道です。
特に**対策（WAF, FW, 暗号化, 教育）**は、午後試験（記述式）で書かせる問題として頻出です。

頑張ってください！




# Source: 8_脆弱性管理_完全解説.md


# 8. 脆弱性管理完全解説

> [!NOTE] 
> この資料は、情報処理安全確保支援士（セキスペ）試験における「脆弱性管理」の分野を徹底的に解説するものです。試験で問われるポイントや、実務で重要となる概念を網羅しています。

## 目次
1. 脆弱性管理の概要
2. 脆弱性診断（Vulnerability Assessment）
3. ペネトレーションテスト（Penetration Test）
4. 脆弱性情報の識別と分類（CVE、CWE）
5. CVSS (共通脆弱性評価システム)
6. 脆弱性情報の収集・管理
7. セキュリティパッチ適用

---

## 1. 脆弱性管理の概要

### 1.1 脆弱性（Vulnerability）とは
情報セキュリティにおける「脆弱性」とは、ソフトウェアやハードウェア、システム設定などに存在する**セキュリティ上の欠陥（バグや設定ミス）**のことです。
「セキュリティホール」とも呼ばれます。

攻撃者は、この脆弱性を悪用して、システムの乗っ取り、情報の窃取、サービスの停止（DoS攻撃）などを行います。

> [!IMPORTANT]
> **試験のPOINT**
> 脆弱性は「なくす」ことが理想ですが、現代の複雑なシステムにおいては「完全にゼロにする」ことは極めて困難です。
> したがって、**「脆弱性は存在するもの」という前提の特、リスクを許容範囲内に抑えるための継続的な「管理」**が重要になります。

### 1.2 脆弱性管理が必要な理由
- **システム構成の変化**: 日々のアップデートや設定変更により、新たな脆弱性が生まれる可能性があります。
- **新たな脅威の発見**: 開発時点では知られていなかった脆弱性が、後に発見される（ゼロデイ脆弱性など）ことが頻繁にあります。
- **コンプライアンス**: ガイドラインや法令により、適切な管理が求められます。

### 1.3 脆弱性管理サイクル
脆弱性管理は一過性のイベントではなく、以下のサイクルを回し続けるプロセスです。

1. **情報収集**: 自社の資産に関する脆弱性情報を収集する。
2. **特定・評価**: どのシステムに影響があるか特定し、リスクの大きさを評価する（CVSSなどを活用）。
3. **対策実施**: パッチ適用、回避策の実施、設定変更などを行う。
4. **検証**: 対策が正しく機能しているか確認する。

---

## 2. 脆弱性診断（Vulnerability Assessment）

### 2.1 概要
**脆弱性診断**とは、システムやネットワーク、アプリケーションにおける既知のセキュリティホールを網羅的に検出するための検査です。
主に、ツールを使用して自動的にスキャンする場合と、専門家が手動で診断する場合があります。

### 2.2 診断の種類

| 種類 | 対象 | 特徴 |
| :--- | :--- | :--- |
| **プラットフォーム診断** | OS、ミドルウェア、ネットワーク機器 | ポートスキャン、不要なサービスの稼働確認、古いバージョンのOS/MWの使用有無などを検査。 |
| **Webアプリケーション診断** | Webサイト、Webアプリ | SQLインジェクション、XSS、認可不備など、Webアプリ特有の脆弱性を検査。 |

### 2.3 診断手法

#### ツール診断（自動診断）
- **メリット**: 短時間で広範囲を網羅できる。コストが比較的安い。定期的・高頻度に実施しやすい。
- **デメリット**: 誤検知（False Positive）や過小評価が含まれる可能性がある。複雑なビジネスロジックの診断は苦手。

#### 手動診断
- **メリット**: セキュリティエンジニアが実際に操作して診断するため、精度の高い診断が可能。ツールの届かないビジネスロジックの不備なども発見できる。
- **デメリット**: 時間とコストがかかる。担当者のスキルに依存する。

> [!TIP]
> **試験対策**：
> 「ツール診断は網羅性に優れるが、誤検知がある」「手動診断は深掘りができるが高コスト」という特徴をセットで覚えておきましょう。
> 実務では、**ツールによる定期診断**と、**メジャーリリース時の手動詳細診断**を組み合わせるのが一般的です。

---

## 3. ペネトレーションテスト（Penetration Test）

### 3.1 概要
**ペネトレーションテスト（侵入テスト）**とは、攻撃者の視点に立ち、**実際にシステムへ侵入を試みるテスト**です。
脆弱性診断が「脆弱性の有無」を網羅的に調べる「健康診断」だとすれば、ペネトレーションテストは「実際に攻撃に耐えられるか」を試す「避難訓練」や「実戦演習」に近いイメージです。

### 3.2 脆弱性診断との違い【超重要】

この違いは試験で**非常によく問われます**。以下の表の内容を確実に理解してください。

| 項目 | 脆弱性診断 (Vulnerability Assessment) | ペネトレーションテスト (Penetration Test) |
| :--- | :--- | :--- |
| **目的** | 脆弱性を**網羅的に**洗い出すこと。 | 特定の目的（例：機密情報の窃取、管理者権限の奪取）が**達成可能か実証する**こと。 |
| **網羅性** | 高い（システム全体を広く浅く見る）。 | 低い（侵入ルートの一例を示すため、網羅性は重視しない）。 |
| **手法** | ツールによるスキャンが主体。 | 攻撃者と同様の手法（ソーシャルエンジニアリング含む場合も）を駆使し、発見した脆弱性を連鎖的に悪用する。 |
| **成果物** | 発見された脆弱性のリストと評価。 | 侵入の可否、侵入成功までのシナリオ、具体的な被害の影響。 |

> [!WARNING]
> **ここが引っ掛けポイント！**
> 試験問題で「**システム全体の脆弱性を網羅的に検出するために実施した**」という記述があれば、それは「**脆弱性診断**」です。
> 一方で、「**攻撃が成功するかどうか、侵入して情報の持ち出しが可能かを確認した**」という記述があれば、それは「**ペネトレーションテスト**」です。
> この「**網羅性**」と「**実証性**」のキーワードで区別しましょう。

### 3.3 実施フェーズの例
1. **情報収集（Reconnaissance）**: 公開情報の調査、ポートスキャンなど。
2. **脅威モデリング**: 攻撃シナリオの作成。
3. **脆弱性分析**: 攻撃可能な脆弱性の特定。
4. **攻撃実行（Exploitation）**: 実際に脆弱性を突いて侵入を試みる。
5. **後処理（Post-Exploitation）**: 侵入後の活動（横展開、権限昇格、痕跡の消去など）の検証。
6. **報告**: テスト結果と対策の提言。

---

## 4. 脆弱性情報の識別と分類（CVE、CWE）

脆弱性情報を世界共通で扱うための規格（識別子）があります。これらを知らないと、セキュリティ情報を正しく読み解くことができません。

### 4.1 CVE (Common Vulnerabilities and Exposures)
**「共通脆弱性識別子」**と呼ばれます。
個別の製品（ソフトウェアやハードウェア）に見つかった、具体的な脆弱性に割り当てられる**ユニークなID**です。

- **管理者**: MITRE社（米国）
- **IDの形式**: `CVE-西暦-連番` (例: `CVE-2017-0144` ※WannaCryで悪用された脆弱性)
- **役割**: 同じ脆弱性に対して、ベンダーA社、B社、セキュリティ機関Cなどが別々の名前で呼んでいると混乱します。すべての脆弱性に「CVE ID」という背番号をつけることで、**「どの脆弱性の話をしているか」を一意に特定**できるようにしています。

> [!NOTE]
> CVEはあくまで「辞書」のようなもので、IDと簡単な概要のみが登録されています。詳細な技術情報やスコアなどは、後述のNVDなどのデータベースで確認します。

### 4.2 CWE (Common Weakness Enumeration)
**「共通脆弱性タイプ一覧」**と呼ばれます。
個別のバグ（CVE）ではなく、**脆弱性の「種類（タイプ）」を分類・体系化**したものです。

- **管理者**: MITRE社（米国）
- **IDの形式**: `CWE-番号` (例: `CWE-79` はクロスサイトスクリプティング)
- **階層構造**: 抽象度の高い分類から、具体的な実装レベルの分類まで、階層構造（木構造）になっています。ビュー（View）と呼ばれる切り口によって分類体系が異なります。
- **主な用途**:
    - 開発者が「どのような種類のバグを作り込まないようにすべきか」を学ぶためのガイドライン。
    - 脆弱性診断ツールが「どのタイプの脆弱性を検出したか」を報告するため。

#### 【試験に出る！】CWE Top 25
MITRE社は定期的に「**CWE Top 25**」という、**最も危険で頻繁に悪用される脆弱性タイプのランキング**を発表しています。
上位には「クロスサイトスクリプティング (XSS)」「SQLインジェクション」「境界外書き込み (Buffer Overflow)」などが常連です。
「CWE Top 25を参照して、優先的に対策すべき脆弱性の種類を把握する」といった文脈で出題されます。

---

## 5. CVSS (Common Vulnerability Scoring System)

**CVSS (共通脆弱性評価システム)** は、脆弱性の深刻度を同一の基準で定量的に評価するための仕組みです。
（管理者はこれを見て、「今すぐ深夜対応すべきか、来週の定期メンテで良いか」を判断します。）

試験では、**3つの評価基準**の違いと、それぞれのパラメータの意味が詳細に問われます。

### 5.1 3つの評価基準

| 基準名 | 英語名 | 概要・特徴 | 誰が決める？ | 変動する？ |
| :--- | :--- | :--- | :--- | :--- |
| **基本評価基準** | **Base Metrics** | 脆弱性そのものの特性を評価。どこにあっても変わらない普遍的な値。 | ベンダーや評価機関 | **変動しない** |
| **現状評価基準** | **Temporal Metrics** | 時間の経過とともに変化する状況（攻撃コードの出現、パッチの有無など）を評価。 | ベンダーや評価機関 | **変動する** |
| **環境評価基準** | **Environmental Metrics** | ユーザーの利用環境における重要度や被害影響を評価。 | **ユーザー組織** | **組織ごとに異なる** |

> [!IMPORTANT]
> **試験のPOINT**
> - 「ベンダーが提供するのは**基本評価基準**と**現状評価基準**」
> - 「ユーザー組織自身が算出・調整する必要があるのは**環境評価基準**」
> という役割分担がよく問われます。
> また、CVSSスコアは、基本 < 現状 < 環境 の順で計算されます（基本スコアをもとに現状スコアを計算し、さらに環境スコアを計算する）。

### 5.2 基本評価基準（Base Metrics）の構成要素
基本評価基準は、**「攻撃のしやすさ（Exploitability）」**と**「影響の大きさ（Impact）」**の2軸で構成されます。

#### 攻撃のしやすさ (Exploitability Metrics)
1. **攻撃元区分 (Attack Vector)**: どこから攻撃可能か？（ネットワーク > 隣接 > ローカル > 物理）※ネットワーク経由が最もスコアが高い。
2. **攻撃条件の複雑さ (Attack Complexity)**: 攻撃成立に特殊な条件が必要か？（低 > 高）
3. **必要な特権レベル (Privileges Required)**: 攻撃に管理者権限などが必要か？（なし > 低 > 高）
4. **ユーザ関与レベル (User Interaction)**: ユーザーがクリックするなど、何らかの操作が必要か？（なし > 必要）

#### 影響の大きさ (Impact Metrics)
いわゆる「CIA」への影響を評価します。
1. **機密性への影響 (Confidentiality Impact)**
2. **完全性への影響 (Integrity Impact)**
3. **可用性への影響 (Availability Impact)**
※それぞれ「なし (None)」「低 (Low)」「高 (High)」で評価されます。

### 5.3 スコアと深刻度
CVSS v3.0では、0.0〜10.0のスコアで評価され、以下の深刻度に分類されます。

- **9.0 - 10.0**: **緊急 (Critical)** ※直ちに対応が必要
- **7.0 - 8.9**: **重要 (High)**
- **4.0 - 6.9**: **警告 (Medium)**
- **0.1 - 3.9**: **注意 (Low)**
- **0.0**: なし (None)

---

## 6. 脆弱性情報の収集・管理

脆弱性対策の第一歩は、タイムリーな情報のキャッチアップです。
主要な情報源（データベース）の名称と特徴を覚えましょう。

1. **JVN (Japan Vulnerability Notes)**
    - **運営**: JPCERT/CC と IPA
    - **特徴**: 日本国内で使用されているソフトウェアの脆弱性情報や対策情報を日本語で提供。

2. **JVN iPedia** (脆弱性対策情報データベース)
    - **運営**: IPA
    - **特徴**: JVNの情報を蓄積・検索できるようにしたデータベース。国内だけでなく、国外のNVDなどの情報も取り込んでいる。

3. **NVD (National Vulnerability Database)**
    - **運営**: NIST（米国国立標準技術研究所）
    - **特徴**: 米国政府が管理する世界最大級の脆弱性データベース。CVE IDに関連する詳細情報（CVSSスコアなど）が網羅されている。

> [!TIP]
> **実務での活用**:
> すべての脆弱性情報を人手で監視するのは不可能です。
> ツールを使って、自社の資産情報（OSバージョン、ライブラリなど）とJVN/NVDのデータベースを自動照合し、「自社に関係ある重要な脆弱性」だけを通知させる仕組み作り（Vulnerability Management）が求められます。

---

## 7. セキュリティパッチ適用

脆弱性が発見された場合、最も根本的な対策はベンダーが提供する修正プログラム（パッチ）を適用することです。

### 7.1 パッチ適用のプロセスと注意点

1. **情報の入手**: ベンダーからの通知やJVNなどでパッチ公開を知る。
2. **影響調査**: パッチ適用によって、自社のシステムが動かなくなる（デグレ）リスクがないか調査する。
3. **検証（テスト）**:
    - **重要ポイント**: いきなり本番環境に適用しない！
    - 必ずテスト環境（ステージング環境）で適用し、業務アプリが正常に動作することを確認する。
4. **バックアップ**: 作業前に必ずシステムのバックアップを取る（不具合時に切り戻せるようにするため）。
5. **本番適用**: メンテナンス時間を設けて適用する。

### 7.2 パッチが適用できない場合の対応
「業務アプリが古すぎて最新パッチに対応していない」「24時間365日稼働で再起動できない」などの理由で、すぐにパッチを当てられないことがあります。
その場合は、**「緩和策（Workaround）」**を実施します。

- **WAF (Web Application Firewall)** で攻撃パターンを遮断する。
- 脆弱性のある機能や該当するポートを一時的に無効化する。
- ネットワークを隔離して、信頼できる端末からしかアクセスできないようにする。

これを**「仮想パッチ」**と呼ぶこともあります（実際に修正するわけではないが、外側で守ることでパッチを当てたのと同等の効果を得るため）。

---

## 8. まとめ・試験対策チェックリスト

最後に、本ドキュメントの重要ポイントを振り返ります。

- [ ] **脆弱性診断 vs ペネトレーションテスト**: 「網羅性」なら診断、「目的達成の実証」ならペネトレーションテスト。
- [ ] **CVE vs CWE**: 「個別の脆弱性ID」ならCVE、「脆弱性のタイプ分類」ならCWE。
- [ ] **CVSSの3基準**:
    - **基本**: どこでも不変。ベンダーが決める。
    - **現状**: 時間で変わる。ベンダーが決める。
    - **環境**: 組織で変わる。**ユーザー（自組織）が決める**。
- [ ] **CVSS基本評価の要素**: 攻撃元区分（Attack Vector）は、ネットワーク経由が最もスコアが高い。
- [ ] **パッチ適用**: 3万文字のテスト環境での検証とバックアップが必須。できない場合はWAFなどの緩和策を検討する。

---
> **Good Luck!**
> 脆弱性管理は、セキュリティエンジニアにとって最も基礎的かつ日常的な業務です。これらの用語とプロセスをマスターすることは、試験合格だけでなく、実務でも強力な武器になります。




# Source: 9_クラウドセキュリティ_完全解説.md


# 情報処理安全確保支援士（セキスペ）試験対策：クラウドセキュリティ完全解説

> [!NOTE]
> **はじめに**
> 本資料は、情報処理安全確保支援士試験における「クラウドセキュリティ」分野を、初心者の方にも分かりやすく、かつ試験に出題されるポイントを網羅的に解説したものです。これ1本で合格レベルの知識が身につくよう構成されています。

## 目次（本資料の構成）
1. [はじめに：クラウドセキュリティの重要性](#1-はじめにクラウドセキュリティの重要性)
2. [第1章：クラウドサービスの基本モデル (IaaS/PaaS/SaaS)](#2-第1章クラウドサービスの基本モデル-iaaspaassaas)
3. [第2章：責任共有モデル (Shared Responsibility Model)](#3-第2章責任共有モデル-shared-responsibility-model)
4. 第3章：クラウド特有のセキュリティ対策技術（後続）
5. 第4章：クラウドセキュリティポスチャ管理と設定ミス対策（後続）
6. 第5章：コンテナセキュリティ（後続）
7. 第6章：試験対策・重要ポイントまとめ（後続）

---

## 1. はじめに：クラウドセキュリティの重要性

近年、企業のシステム構築は「クラウドファースト（まずはクラウド利用を検討する）」が当たり前となりました。それに伴い、情報処理安全確保支援士試験でも**クラウドセキュリティに関する出題が急増**しています。

従来（オンプレミス）は「自社のデータセンターを守る＝境界防御」が基本でしたが、クラウドでは**「データはインターネットの向こう側にある」**ため、考え方を根本から変える必要があります。

### 試験で求められる視点
*   **技術的な視点**: クラウド特有の技術（コンテナ、API、IAMなど）の理解
*   **管理的な視点**: クラウド事業者（CSP）と利用者（ユーザー）の責任分界点の理解

---

## 2. 第1章：クラウドサービスの基本モデル (IaaS/PaaS/SaaS)

クラウドを理解する上で避けて通れないのが、「**NIST（米国国立標準技術研究所）によるクラウドの定義**」です。試験では、以下の3つのサービスモデルの違いを明確に理解しているかが問われます。

### 2-1. 3つのサービスモデル（スパイシーに解説）

イメージしやすいように、「カレー作り」で例えられることがありますが、ここでは**「誰がどこまで面倒を見てくれるか」**という視点で整理します。

#### ① SaaS (Software as a Service) サース/サーズ
**「完成した料理を提供してくれるレストラン」**

*   **概要**: 利用者は、インターネット経由でソフトウェア（アプリケーション）の機能だけを利用します。
*   **利用者の管理範囲**: 基本的に**「設定」と「データ」と「ID（アカウント）」のみ**。サーバーやOSの管理は一切不要。
*   **代表例**: Gmail, Microsoft 365, Slack, Salesforce, Zoom
*   **セキュリティのポイント**:
    *   OSのパッチ当ては事業者がやってくれるので楽。
    *   **アクセス権限の設定や、誰にIDを発行するかは利用者の責任**。（ここが狙われます！）

#### ② PaaS (Platform as a Service) パース
**「調理場と道具を提供してくれるレンタルキッチン」**

*   **概要**: アプリケーションを動かすための「土台（プラットフォーム）」を提供します。OSやミドルウェア（データベースやWebサーバーソフト）まで用意されています。
*   **利用者の管理範囲**: **「開発したアプリケーション」と「データ」**。
*   **代表例**: AWS Elastic Beanstalk, Google App Engine, Microsoft Azure App Service, Heroku
*   **セキュリティのポイント**:
    *   OSの管理は不要だが、**自分が作ったプログラムの脆弱性（バグ）は自分の責任**。

#### ③ IaaS (Infrastructure as a Service) イアース/アイアース
**「食材とガス・水道だけ提供されるキャンプ場」**

*   **概要**: 仮想サーバー、ネットワーク、ストレージなどの「インフラ」機能だけを提供します。OSのインストールから自分で行うイメージです（実際はOSイメージを選択して起動しますが、管理責任は利用者）。
*   **利用者の管理範囲**: **OSより上のレイヤー全て**（OS、ミドルウェア、アプリ、データ）。
*   **代表例**: Amazon EC2, Azure Virtual Machines, Google Compute Engine (GCE)
*   **セキュリティのポイント**:
    *   自由度は高いが、**OSのセキュリティパッチ適用やウイルス対策もすべて利用者の責任**。
    *   オンプレミスに最も近い感覚。

### 2-2. 比較まとめ表

試験によく出る比較表です。**「誰が管理するのか？」**を常に意識してください。

| 階層 | SaaS (ソフト) | PaaS (プラットフォーム) | IaaS (インフラ) | オンプレミス |
| :--- | :---: | :---: | :---: | :---: |
| **データ** | **利用者** | **利用者** | **利用者** | **利用者** |
| **アプリ** | 事業者 | **利用者** | **利用者** | **利用者** |
| **ミドルウェア** | 事業者 | 事業者 | **利用者** | **利用者** |
| **OS** | 事業者 | 事業者 | **利用者** | **利用者** |
| **仮想化/HW** | 事業者 | 事業者 | 事業者 | **利用者** |
| **物理設備** | 事業者 | 事業者 | 事業者 | **利用者** |

> [!IMPORTANT]
> **試験対策の合言葉**
> *   **SaaS**: 「使うだけ」。設定とID管理に注意。
> *   **PaaS**: 「作る場所」。アプリのバグに注意。
> *   **IaaS**: 「箱だけ」。OS管理・パッチ当てが必要。

---

## 3. 第2章：責任共有モデル (Shared Responsibility Model)

これがクラウドセキュリティで**最も重要**な概念です。
「クラウドを使っているからセキュリティは全部お任せで安心」という**勘違い**が、大規模な情報漏洩事故の最大の原因です。

### 3-1. 責任共有モデルとは？
クラウド事業者（CSP: Cloud Service Provider）と利用者（ユーザー）が、セキュリティの責任を**分担する**という考え方です。

*   **事業者の責任**: **Security "OF" the Cloud**（クラウド**自体の**セキュリティ）
    *   データセンターの物理的な警備、ハードウェアの故障対応、クラウド基盤のネットワーク保護など。
*   **利用者の責任**: **Security "IN" the Cloud**（クラウド**利用における**セキュリティ）
    *   クラウドの中に保存するデータ、OSの設定、アカウント管理、ファイアウォールの設定など。

### 3-2. どこで線引きされるか？（重要）

第1章のモデルごとに責任境界線（責任分界点）が変わります。

#### 間違いやすい「引っ掛け」ポイント徹底解説

> [!WARNING]
> **【超重要】ここが試験に出る！勘違いポイント**
>
> **1. 「SaaSなら何も責任がない」は間違い！**
> *   SaaSであっても、**「誰にアクセス権を与えるか（ID管理）」**と**「データの分類・管理」**は、100%利用者の責任です。
> *   例：従業員が簡単なパスワードを設定していて乗っ取られた場合、それはクラウド事業者のせいではなく、利用者の責任です。
>
> **2. 「IaaSでOSのパッチを当て忘れた」**
> *   これは100%利用者の責任です。AmazonやGoogleが勝手にあなたの仮想サーバーに入ってアップデートしてくれることはありません。
>
> **3. 「可用性（止まらないこと）」の責任**
> *   IaaSの場合、事業者は「インフラが稼働していること」には責任を持ちますが、「あなたのサーバーが落ちないような冗長構成（HA構成）」を設計するのは、利用者の責任である場合が多いです。

### 3-3. 責任共有モデルの図解イメージ

```mermaid
graph TD
    subgraph User["利用者の責任 (Security IN the Cloud)"]
        Data[顧客データ・コンテンツ]
        IAM[ID・アクセス権限管理]
        Config[暗号化設定・FW設定]
        OS_User[OS・ミドルウェア (IaaSのみ)]
    end

    subgraph Boundary["責任分界点"]
        Line[----------------------------------------]
    end

    subgraph CSP["事業者の責任 (Security OF the Cloud)"]
        Hypervisor[仮想化基盤]
        Hardware[物理サーバー・ストレージ]
        Network[物理ネットワーク]
        Facility[データセンター施設]
    end

    User --> Boundary
    Boundary --> CSP

    style User fill:#ffe6e6,stroke:#ff0000,stroke-width:2px
    style CSP fill:#e6f3ff,stroke:#0000ff,stroke-width:2px
```

### 3-4. 試験で問われるシナリオ例

**Q. A社は自社のWebサーバーをオンプレミスからIaaSに移行した。移行後に行うべきセキュリティ対策として、適切なものはどれか。**

1. データセンターの入退室管理ログを取得する。
2. 物理サーバーのハードディスク故障に備えてRAID構成を組む。
3. ゲストOSの脆弱性修正プログラム（パッチ）を定期的に適用する。
4. 仮想化ソフトウェアのバージョンアップ計画を立てる。

**【解説】**
*   正解は **3** です。
*   1, 2, 4はすべて「クラウド事業者（CSP）」の責任範囲（Security OF the Cloud）です。
*   IaaSでは、ゲストOSの管理は利用者の責任（Security IN the Cloud）です。これを怠ると攻撃を受けます。

---

## 4. 第3章：クラウド特有のセキュリティ対策技術

オンプレミスでは「ファイアウォール（境界防御）」が主役でしたが、クラウドでは**「ID管理」**と**「データの暗号化」**、そして**「CASB」**が主役になります。

### 4-1. ID管理とアクセス制御 (IAM)

クラウドセキュリティにおいて、**「IDこそが新たな境界線 (Identity is the new Perimeter)」** と呼ばれます。

*   **IAM (Identity and Access Management)**:
    *   ユーザー認証（誰か？）とアクセス認可（何をしてよいか？）を一元管理する仕組みです。
*   **多要素認証 (MFA) の必須化**:
    *   ID/パスワードだけでは漏洩リスクが高いため、SMSやアプリによる二段階認証を必ず設定します。
    *   **試験ポイント**: 管理者権限（ルートアカウント）には**必ず**MFAを設定すること。これが出題されたら即答レベルです。
*   **最小権限の原則 (Least Privilege)**:
    *   業務に必要な「最低限の権限」だけを与えます。「とりあえず管理者権限」はNGです。

### 4-2. CASB (Cloud Access Security Broker) キャスビー

従業員が勝手にクラウドサービスを使ってしまう「シャドーIT」対策として登場しました。企業とクラウドサービスの間に立つ「関所」のような存在です。

#### CASBの4つの機能（ガートナー提唱）

1.  **可視化 (Visibility)**:
    *   社内で「誰が」「どのクラウドサービスを」使っているかを検出する（シャドーITの発見）。
2.  **データ保護 (Data Security)**:
    *   機密情報（マイナンバーなど）がアップロードされるのを防ぐ (DLP連携)。
3.  **脅威防御 (Threat Protection)**:
    *   アカウントの乗っ取りやマルウェアの混入を検知する。
4.  **コンプライアンス (Compliance)**:
    *   クラウドの利用が社内規定や法令に違反していないかチェックする。

> [!TIP]
> **API型 vs プロキシ型**
> *   **API型**: クラウドサービスのAPIを使ってスキャンする。導入が容易で既存構成を変えない。
> *   **プロキシ型**: 通信経路に配置する。リアルタイム制御が得意だが導入負荷が高い。
> *   最近はAPI型が主流です。

### 4-3. 暗号化と鍵管理 (KMS)

データをクラウドに預ける際の最後の砦です。

*   **保存データの暗号化 (Encryption at Rest)**: データベースやストレージに保存される瞬間に暗号化します。
*   **通信の暗号化 (Encryption in Transit)**: HTTPS(TLS)などで通信経路を暗号化します。
*   **鍵管理 (Key Management)**:
    *   **BYOK (Bring Your Own Key)**: 暗号化の「鍵」をクラウド事業者任せにせず、**利用者自身が作成・管理する鍵**を持ち込む方式。事業者が勝手にデータを見られないようにするために有効です。

---

## 5. 第4章：クラウドセキュリティポスチャ管理と設定ミス対策

ここ数年、情報漏洩の原因トップは**「クラウドの設定ミス」**です。「S3バケット公開設定ミス」などのニュースをよく聞くはずです。これを防ぐための自動化ツール群をアルファベット4文字で整理しましょう。

### 5-1. CSPM (Cloud Security Posture Management)
**「IaaS/PaaSの家の鍵が開いていないかチェックする警備員」**

*   **対象**: IaaS, PaaS (AWS, Azure, GCPなど)
*   **機能**: クラウドの設定（コンフィグ）を継続的にチェックし、危険な設定（公開状態のストレージ、MFA未設定の管理者IDなど）があれば警告・自動修復します。
*   **キーワード**: 設定ミス防止、ポスチャ（姿勢・状態）管理。

### 5-2. SSPM (SaaS Security Posture Management)
**「SaaSの共有設定をチェックする監査役」**

*   **対象**: SaaS (Microsoft 365, Slack, Salesforceなど)
*   **機能**: CSPMのSaaS版です。「外部ユーザーとファイル共有しすぎていないか」「退職者のIDが残っていないか」などをチェックします。

### 5-3. CWPP (Cloud Workload Protection Platform)
**「サーバーの中で悪さをしている犯人を捕まえる警察官」**

*   **対象**: 仮想マシン(VM)、コンテナ、サーバーレス機能（ワークロード）
*   **機能**: 従来のウイルス対策ソフトの進化版。OS内部やコンテナ内部の脆弱性スキャン、不正なプロセスの検知、変更監視を行います。
*   **CSPMとの違い**:
    *   **CSPM**: 「**設定**」を見る（鍵は閉まってる？）→ 静的・外側
    *   **CWPP**: 「**中身**」を見る（ウイルスはいない？）→ 動的・内側

### 5-4. CNAPP (Cloud Native Application Protection Platform)
**「全部入りパック」**

*   CSPM + CWPP + その他（CI/CDセキュリティなど）を統合したプラットフォームのこと。最近のトレンド用語です。

> [!IMPORTANT]
> **試験での使い分け**
> *   「設定不備」「公開状態」「コンプライアンス」という言葉が出たら **CSPM**。
> *   「ワークロード」「OSの保護」「マルウェア対策」という言葉が出たら **CWPP**。
> *   「シャドーIT」「利用状況の可視化」という言葉が出たら **CASB**。

---

## 6. 第5章：コンテナセキュリティ

近年の開発現場では「Docker」や「Kubernetes（クーベネティス）」を使ったコンテナ技術が標準になりつつあります。試験でも頻出エリアです。

### 6-1. コンテナとは何か？
*   **仮想マシン (VM) との違い**:
    *   **VM**: ハードウェアごと仮想化し、ゲストOSをまるごと動かす。重い。独立性が高い。
    *   **コンテナ**: ホストOSのカーネルを共有し、プロセスとして動かす。軽い・起動が速い。
*   **リスクの違い**:
    *   コンテナは**カーネルを共有している**ため、もしコンテナから脱出されると（**コンテナブレイクアウト**）、ホストOS全体、ひいては他のコンテナまで乗っ取られる危険性があります。

### 6-2. コンテナイメージのセキュリティ (Supply Chain)
コンテナは「イメージ」という設計図から作られます。
*   **リスク**: 公開されているイメージ（Docker Hubなど）に最初からマルウェアや脆弱性が含まれている可能性があります。
*   **対策**:
    *   **イメージスキャン (Trivy, Clairなど)**: イメージの中に既知の脆弱性（CVE）が含まれていないか、デプロイ前にチェックします。
    *   **Distroless（ディストロレス）イメージの利用**: シェルやパッケージマネージャを含まない、必要最小限のイメージを使うことで、攻撃者の足場を奪います。

### 6-3. コンテナランタイムとKubernetes
*   **ランタイム防御**: 動いているコンテナの異常な挙動（身に覚えのない通信、ファイル書き込みなど）を検知します。
*   **Kubernetes (K8s) のセキュリティ**:
    *   **RBAC (Role-Based Access Control)**: 「誰が」「どのPodを」操作できるかを厳密に制限します。
    *   **Network Policy**: コンテナ同士の通信（East-West通信）を制限します。デフォルトでは全許可になっていることが多いので注意です。

---

## 7. 第6章：試験対策・重要ポイントまとめ

最後に、試験直前に見直すべきポイントをまとめます。

### 7-1. 必修略語リスト (フルネームと意味)

| 略語 | フルネーム | 意味・役割 |
| :--- | :--- | :--- |
| **CSP** | Cloud Service Provider | クラウド事業者 (AWS, Azure, Google等) |
| **IAM** | Identity and Access Management | IDとアクセス権限の管理。クラウドの守りの要。 |
| **CASB** | Cloud Access Security Broker | クラウド利用の可視化・制御を行う仲介者。 |
| **CSPM** | Cloud Security Posture Management | IaaS/PaaSの設定ミスを検知・修正するツール。 |
| **CWPP** | Cloud Workload Protection Platform | VMやコンテナ内部を保護するツール。 |
| **SSPM** | SaaS Security Posture Management | SaaSの設定ミスを検知するツール。 |
| **IdP** | Identity Provider | ID情報の提供者（Azure AD / Entra IDなど）。 |
| **MFA** | Multi-Factor Authentication | 多要素認証。「知識」「所有」「生体」の2つ以上。 |

### 7-2. 試験に出る「最後の確認」

1.  **責任分界点を常に意識せよ**: 「誰の責任か？」という視点で問題を解くこと。
    *   OSパッチ → IaaSなら**自分**、PaaS/SaaSなら**事業者**。
    *   データ管理 → どのモデルでも**自分**。
    *   ID管理 → どのモデルでも**自分**。
2.  **可用性対策**:
    *   「クラウドだから落ちない」は間違い。アベイラビリティゾーン (AZ) をまたいだ冗長構成（マルチAZ）は利用者が設計する必要がある。
3.  **インシデント対応**:
    *   クラウド事業者のログ（CloudTrailなど）を取得・分析するのは利用者の役目。

---

> [!NOTE]
> **おわりに**
> クラウドセキュリティは技術の進化が早い分野ですが、**「責任共有モデル」**という原則さえ押さえておけば、どんな問題も解く糸口が見つかります。
> 皆様の試験合格を心より応援しています！

（解説資料 完）



# Source: RISS_Network_Security_Guide.md


# 情報処理安全確保支援士（ネットワーク分野）徹底解説ガイド

> [!NOTE]
> 本資料は、情報処理安全確保支援士（RISS）試験の「セキュリティ技術（ネットワーク）」分野に特化した、初心者向けの網羅的な学習ガイドです。
> 専門用語をなるべく噛み砕き、試験で頻出の「引っかけ問題」や「勘違いしやすいポイント」を重点的に解説しています。

---

## 1. はじめに：ネットワークセキュリティの全体像

### ネットワークセキュリティとは？
ネットワークセキュリティとは、インターネットなどの通信網を通じて、外部から侵入されたり、大切なデータが盗まれたりするのを防ぐための「関所」や「警備員」のような仕組みのことです。

家で例えると：
- **ファイアウォール**は「玄関の鍵とドア」
- **IDS/IPS**は「警備会社の監視センサーと自動ロック」
- **VPN**は「専用の地下トンネル」
- **DMZ**は「来客用の応接室（金庫などの重要物は置かない）」

試験では、これらの技術が「どこで」「何を」「どのように」守るのか、その**違い**を正確に理解しているかが問われます。

---

## 2. ファイアウォール (Firewall)

### ひとことで言うと？
**「ネットワークの関所」**
通行手形（IPアドレスやポート番号）を見て、「お前は通ってよし」「お前は怪しいからダメ」と判断する門番です。

### 仕組みの解説
ファイアウォール（FW）は、内部ネットワークと外部ネットワーク（インターネット）の境界に設置されます。流れてくるパケット（データの小包）の「ヘッダ情報」を見て、通過させるか遮断するかを決めます。

#### 主なフィルタリング方式
1. **パケットフィルタリング（静的）**
   - あらかじめ登録したルール（「IPアドレスAからの通信は通す」など）だけを見て判断します。単純ですが、設定が面倒です。
2. **ステートフルインスペクション（動的パケットフィルタリング）**
   - **試験頻出！**
   - 通信の「状態（ステート）」を記憶します。「内部からウェブサイトを見に行った（リクエストした）」という状態を覚えておき、その「戻り値（レスポンス）」となる通信は自動的に許可します。
   - いちいち戻りの通信許可設定を書かなくて良いため、管理が楽でセキュリティも高くなります。
3. **アプリケーションゲートウェイ（プロキシ型）**
   - 代理人（プロキシ）として振る舞い、データの中身（アプリケーション層）まで詳細にチェックします。安全ですが、処理が遅くなります。

### 【重要】試験に出るポイント
- **動作層:** 基本はOSI参照モデルの**ネットワーク層（L3）**と**トランスポート層（L4）**で動作します（IPアドレスとポート番号を見るため）。
- **デフォルト拒否（Deny All）の原則:** 「許可するものだけ明示的に書き、それ以外はすべて拒否する」のがセキュリティの基本設定です。

### 【注意】ここが狙われる！引っかけポイント
> [!WARNING]
> **「WAF（Web Application Firewall）」との混同に注意！**
> - **ファイアウォール:** 「IPアドレス」や「ポート番号」を見て判断します。**SQLインジェクション**のような、Webアプリへの攻撃は防げないことが多いです（正常なポート80番の通信として通過してしまうため）。
> - **WAF:** 通信の「中身（データ部）」を見て、SQLインジェクションなどを防ぎます。

> [!WARNING]
> **「ダイナミックパケットフィルタリング」と「NAT」は別物！**
> - NATはIPアドレスを変換する技術。ダイナミックパケットフィルタリングは、戻りパケットを動的に通す技術。混同しないようにしましょう。

---

## 3. IDS / IPS (Intrusion Detection/Prevention System)

### ひとことで言うと？
- **IDS**: **「監視カメラと警報機」**（泥棒を見つけたらベルを鳴らすが、捕まえはしない）
- **IPS**: **「自動迎撃システム」**（泥棒を見つけたら、その場で網を発射して止める）

### 仕組みの解説
ファイアウォールが「宛先」を見て判断するのに対し、IDS/IPSはパケットの「中身」や「振る舞い」を検査して、攻撃の特徴（シグネチャ）がないかを探します。

#### 検知方式
1. **シグネチャ型（Signature-based）**
   - 「既知の攻撃パターン（ブラックリスト）」と照らし合わせます。
   - **メリット:** 既知の攻撃は正確に検知。
   - **デメリット:** 新種の攻撃（ゼロデイ攻撃）は検知できません。
2. **アノマリ型（Anomaly-based）**
   - 「いつもの正常な通信」と違う動きを検知します。
   - **メリット:** 未知の攻撃も見つけられる可能性があります。
   - **デメリット:** 誤検知（False Positive）が多いです。

### 【重要】試験に出るポイント
- **IDS（Instruction Detection System）:** 検知（Detection）のみ。管理者にメール通知したりログを残したりします。通信は遮断しません。
- **IPS（Intrusion Prevention System）:** 防止（Prevention）。検知したら即座に通信を**遮断（ドロップ）**します。
- **配置:** IPSは通信経路上に**インライン（直列）**で設置する必要があります（通り道を塞ぐため）。IDSは**プロミスキャスモード（傍受）**で、回線を分岐させてコピーを見ることが多いです。

### 【注意】ここが狙われる！引っかけポイント
> [!CAUTION]
> **「誤検知」と「見逃し」の用語定義**
> - **フォルスポジティブ (False Positive):** **誤検知**。「オオカミ少年」。正常な通信を「攻撃だ！」と間違えて止めてしまうこと。IPSでこれが起きると業務が止まるので危険です。
> - **フォルスネガティブ (False Negative):** **見逃し**。攻撃なのに「正常です」とスルーしてしまうこと。セキュリティ侵害に直結します。
> **試験での覚え方:** 「Positive＝陽性反応が出た（けど嘘）」「Negative＝無反応（だけど実は病気）」と医療検査になぞらえると覚えやすいです。

---

## 4. VPN (Virtual Private Network)

### ひとことで言うと？
**「インターネットの中に作る、自分たち専用の『透明な地下トンネル』」**
公衆回線（誰でも通れる道）を使っているのに、暗号化によってあたかも専用線（自分だけしか通れない道）のように安全に通信する技術です。

### 仕組みの解説
カプセル化（パケットを別のパケットで包む）と暗号化を使って、盗聴や改ざんを防ぎます。
代表的なプロトコルは**IPsec**と**SSL-VPN**です。

#### 1. IPsec (Security Architecture for Internet Protocol)
OSI参照モデルの**ネットワーク層（L3）**で動作します。あらゆるIP通信を暗号化できます。

- **2つのプロトコル:**
    - **AH (Authentication Header):** 改ざん検知と認証のみ。**暗号化はしない**。
    - **ESP (Encapsulating Security Payload):** **暗号化**、改ざん検知、認証を行う。通常はこちらを使います。
- **2つのモード:**
    - **トンネルモード:** パケット全体（ヘッダ含む）を暗号化し、新しいヘッダを付ける。拠点間VPN（本社-支社間）でよく使われます。
    - **トランスポートモード:** データ部分（ペイロード）のみ暗号化する。端末間（End-to-End）通信で使われます。
- **鍵交換:** **IKE (Internet Key Exchange)** というプロトコルを使って、暗号鍵を自動交換します。

#### 2. SSL-VPN (TLS-VPN)
OSI参照モデルの**セッション層〜アプリケーション層**で動作します。
- **特徴:** 専用ソフトが不要で、**Webブラウザ**さえあれば使えることが多いです。
- **用途:** テレワークで自宅PCから社内Webメールを見る、などの用途に便利です。

### 【重要】試験に出るポイント
- **IPsec:** 「ネットワーク層」「拠点間接続」「専用ソフト/ルータ設定が必要」「L3レベルで全通信を通せる」。
- **SSL-VPN:** 「Webブラウザで手軽」「アプリケーション層」「特定アプリのみ利用可（方式による）」。

### 【注意】ここが狙われる！引っかけポイント
> [!WARNING]
> **IPsecのAHは暗号化しない！**
> 試験で「AHを使って通信内容を秘匿した」という選択肢が出たら**間違い**です。AHは「改ざんされていないこと」の保証だけで、中身は丸見えです。暗号化したいなら**ESP**を使います。

> [!WARNING]
> **IPsecのSA (Security Association) は片方向！**
> 行きと帰りで別のSA（契約のようなもの）を作ります。つまり、双方向通信するには**2つのSA**が必要です。

---

## 5. プロキシサーバ (Proxy Server)

### ひとことで言うと？
**「身代わり地蔵（代理人）」**
あなたの代わりにWebサイトにアクセスしてくれる、「ネット上の代理人」です。

### 仕組みの解説
プロキシには主に2種類あり、**誰の代理をするか**が違います。

#### 1. フォワードプロキシ (Forward Proxy)
- **クライアント（社員のPC）の代理**をします。
- 社員がインターネットを見に行くとき、「プロキシさん、代わりにこのサイト取ってきて」と頼みます。
- **メリット:**
    - **キャッシュ機能:** 一度見たサイトを保存して、表示を速くする。
    - **フィルタリング:** 「業務に関係ないサイトは見せない」などの制限が可能。
    - **匿名性:** Webサーバ側にはプロキシのIPアドレスしか見えないので、社内の情報を隠せる。

#### 2. リバースプロキシ (Reverse Proxy)
- **Webサーバ（会社のHP）の代理**をします。
- 外部からのアクセスを一旦すべて引き受け、後ろにいる本物のWebサーバに流します。
- **メリット:**
    - **負荷分散（ロードバランサ）:** 複数のサーバに仕事を割り振れる。
    - **セキュリティ:** 本物のWebサーバを直接インターネットに晒さなくて済む。
    - **SSLオフロード:** 暗号化・復号の重い処理を肩代わりする。

### 【重要】試験に出るポイント
- **フォワード:** 社内から社外へ。「社員を守る・管理する」。
- **リバース:** 社外から社内へ。「サーバを守る・負荷を減らす」。

### 【注意】ここが狙われる！引っかけポイント
> [!WARNING]
> **「CONNECTメソッド」によるHTTPS通信**
> プロキシ経由でhttpsサイトを見る場合、プロキシは暗号化された中身を見ることができません。そのため、**CONNECTメソッド**を使って「右から左へデータを流す土管」になります。中身が見えない＝ウイルスチェック等ができない場合がある点に注意が必要です。

---

## 6. DMZ構成 (DeMilitarized Zone)

### ひとことで言うと？
**「会社の受付ロビー（非武装地帯）」**
「誰でも入れる場所（DMZ）」と「社員しか入れない場所（社内LAN）」を明確に分ける区域設定です。

### 仕組みの解説
外部（インターネット）と内部（社内LAN）の中間に作る、緩衝地帯です。
**Webサーバやメールサーバ**など、「外部向けに公開しなければならないサーバ」はここに置きます。

#### 基本的な通信ルール
1. **インターネット → DMZ:** 許可（Web閲覧など）
2. **DMZ → インターネット:** 許可（応答など）
3. **DMZ → 内部LAN:** **拒否**（ここが最重要！DMZが乗っ取られても社内は守る）
4. **内部LAN → DMZ:** 許可（サーバのメンテナンスなど）
5. **内部LAN → インターネット:** 許可（およびプロキシ経由）

### 【重要】試験に出るポイント
- **WebサーバとDBサーバの配置（超頻出！）**
    - **Webサーバ:** **DMZ**に置く（外からアクセスさせるため）。
    - **DBサーバ:** **内部LAN**（または専用のセキュアなセグメント）に置く。**絶対にDMZに置いてはいけません！**
    - Webサーバが乗っ取られても、DB（個人情報）を守るための「多層防御」です。

### 【注意】ここが狙われる！引っかけポイント
> [!CAUTION]
> **「DMZから内部LANへの通信」**
> 試験で「DMZにあるWebサーバから、内部LANにある管理用PCへデータをバックアップする」等の記述があったら、それは**セキュリティ設計ミス**です。原則としてDMZから内部への新規通信（Initiate）はすべて禁止すべきです。

---

## 7. VLAN (Virtual Local Area Network)

### ひとことで言うと？
**「ハブやケーブルをつなぎ変えずに、論理的にグループ分けする技術」**
物理的には同じスイッチにつながっていても、設定だけで「営業部ネットワーク」と「技術部ネットワーク」を切り離せます。

### 仕組みの解説
- **ポートVLAN:** ポートごとにグループを決める（ポート1〜3は営業部、など）。
- **タグVLAN (IEEE 802.1Q):** **試験頻出！**
  パケット自体に「お前は営業部用」という**タグ（名札）**を貼り付けます。これにより、1本のケーブルの中に、営業部用のデータと技術部用のデータを重ねて流すことができます（トランク接続）。

### 【重要】試験に出るポイント
- **セキュリティ効果:** 直接的な暗号化技術ではありませんが、ネットワークを分けることで、ウイルス感染時の**被害拡散防止**や、不要な通信（ブロードキャスト）の抑制になります。

### 【注意】ここが狙われる！引っかけポイント
> [!WARNING]
> **VLANホッピング攻撃**
> 悪意のあるユーザーが勝手に「タグ」をつけたパケットを送りつけ、本来入れないはずの別VLANへアクセスする攻撃です。対策として、**使用していないポートは無効化**する、**ネイティブVLAN（タグなしVLAN）**の扱いに注意する、などが問われます。

---

## 8. 無線LANセキュリティ (WPA2 / WPA3)

### ひとことで言うと？
**「透明な電波を守る暗号化の進化」**
誰でも傍受できる電波だからこそ、解読されないための暗号化規格が進化してきました。

### 仕組みと規格
- **WEP:** 初期の規格。すぐ解読できるため**使用禁止**。
- **WPA2:** 長らく標準だった規格。
  - **暗号化:** AES (CCMP) を採用し強力。
  - **弱点:** KRACKsという脆弱性が見つかったり、短いパスワードだと辞書攻撃に弱い。
- **WPA3:** 最新規格。**試験ではここが出る！**
  - **SAE (Simultaneous Authentication of Equals):** 「対等な認証」。パスワードが簡単でも、辞書攻撃で破られない仕組み（ドラゴンフライ鍵交換など）を導入。
  - **完全性:** 管理フレームも暗号化・保護される（PMF）。

### 認証モードの違い
1. **パーソナル (PSK: Pre-Shared Key)**
   - 家庭用。全員同じパスワード（合言葉）を使う。
2. **エンタープライズ (EAP: Extensible Authentication Protocol)**
   - 企業用。**RADIUSサーバ**（認証サーバ）を使い、一人ひとり別々のID/パスワードや電子証明書で認証する。

### 【重要】試験に出るポイント
- **EAPの種類（覚えよう！）**
  - **EAP-TLS:** **最強**。クライアントとサーバの**両方**に電子証明書が必要。一番安全だが管理が大変。
  - **PEAP:** サーバだけ証明書が必要。クライアントはID/パスワードでOK。よく使われる。

### 【注意】ここが狙われる！引っかけポイント
> [!WARNING]
> **「ステルスSSID」は万全ではない！**
> SSID（Wi-Fiの名前）を隠す「ステルス機能」は、気休め程度です。アクセスツールを使えば簡単に見つけられるため、セキュリティ対策としては不十分とみなされます。

---

## 9. DNSセキュリティ (DNSSEC)

### ひとことで言うと？
**「ネットの住所案内が正しいことを証明する『実印』」**
「google.comに行きたい」と聞いたとき、嘘の住所（偽サイトのIP）を教えられないようにするための技術です。

### 仕組みの解説
DNSキャッシュポイズニング攻撃（偽の情報をDNSサーバに覚え込ませる攻撃）を防ぎます。
- 正規のDNSサーバが、レコード（IPアドレス情報など）に**デジタル署名**を付けます。
- 受信側は、その署名を検証して「確かに本物のDNSサーバが書いた情報だ」と確認します。
- この信頼を、ルートDNS（親玉）から順に鎖のようにつなげていくのが「**信頼の連鎖 (Chain of Trust)**」です。

### 【重要】試験に出るポイント
- **防御対象:** **DNSキャッシュポイズニング**を防ぐためのものです。
- **守れる要素:** 真正性（本物であること）と完全性（改ざんされていないこと）。
- **仕組み:** 公開鍵暗号方式のデジタル署名を使います。

### 【注意】ここが狙われる！引っかけポイント
> [!CAUTION]
> **DNSSECは通信を暗号化しない！**
> これが最大の引っかけです。DNSSECは「署名」をつけるだけで、問い合わせ内容（「どのサイトを見ようとしているか」）は平文のままです。盗聴は防げません。**盗聴を防ぐのは「DNS over HTTPS (DoH)」**などの技術です。

---

## 10. メールセキュリティ (SPF, DKIM, DMARC)

### ひとことで言うと？
**「なりすましメールを見破るための３段構え」**

### 仕組みの解説
差出人を偽った詐欺メールを防ぐための「送信ドメイン認証」技術です。

#### 1. SPF (Sender Policy Framework)
- **「IPアドレス」でチェック**。
- 送信側：「ウチのメールは、このIPアドレスから送るよ」とDNSに宣言しておく。
- 受信側：「届いたメールのIPアドレスは、宣言通りかな？」と確認する。
- **弱点:** 転送されるとIPが変わって認証失敗することがある。

#### 2. DKIM (DomainKeys Identified Mail)
- **「電子署名」でチェック**。
- 送信側：メールに電子署名を付ける。
- 受信側：署名を検証して、「改ざんされてないか」「本当にそのドメインから来たか」を確認する。

#### 3. DMARC (Domain-based Message Authentication, Reporting, and Conformance)
- **「どう処分するか」を決める司令塔**。
- 上記のSPFやDKIMで「失敗」したメールをどうするか（受信拒否するのか、隔離するのか、そのまま通すのか）というポリシーを宣言する仕組み。
- 認証結果のレポートを受け取ることもできます。

### 【重要】試験に出るポイント
- DNSサーバの**TXTレコード**に情報を登録して運用します。
- **SPF = IPアドレス**、**DKIM = 電子署名**、**DMARC = ポリシー・処分**。

### 【注意】ここが狙われる！引っかけポイント
> [!WARNING]
> **エンベロープFromとヘッダFrom**
> - **SPF**がチェックするのは「エンベロープFrom（郵便封筒の差出人欄）」です。
> - メールソフトに表示される「ヘッダFrom（便箋の署名）」はチェックしません（これを悪用したなりすましは防げない）。DMARCは、この両者が一致しているか（アライメント）もチェックできます。

---

## まとめ：合格へのアドバイス
情報処理安全確保支援士のネットワーク分野は、暗記だけでなく「**通信の流れ**」と「**誰が何を守っているか**」をイメージすることが重要です。

1. **図を描く:** Webサーバ、DBサーバ、FW、DMZの位置関係を自分で描けるようにしましょう。
2. **比較する:** 「WAFとFW」「IDSとIPS」「共通鍵と公開鍵」など、似て非なるものの違いを明確にしましょう。
3. **目的を問う:** 「なぜその技術が必要なのか？（例：なぜDBを内部に置くのか？）」を常に自問自答しましょう。

皆様の合格を心より応援しております！



# Source: RISS_Security_Management_Guide.md


# 情報処理安全確保支援士（セキスペ）試験対策：情報セキュリティ管理 完全ガイド

## はじめに

この資料は、**情報処理安全確保支援士（登録セキスペ）** 試験の出題範囲である「**情報セキュリティ管理**」分野について、非技術者の方でも理解できるようにわかりやすく、かつ試験合格に必要な知識を網羅的に解説するものです。

情報セキュリティ管理は、技術的な知識（ファイアウォールの設定や暗号化アルゴリズムなど）だけでなく、「組織としてどのようにセキュリティを守るか」という**マネジメント（管理）** の視点が問われる非常に重要な分野です。午後試験の記述問題でも頻出のテーマであり、ここを得点源にできるかどうかが合否を分けます。

本資料では、単なる用語の解説にとどまらず、**「なぜその対策が必要なのか？」「試験ではどこが問われるのか？」「間違いやすい落とし穴はどこか？」** を重点的に解説します。

---

# 第1章：情報セキュリティ管理の基礎とポリシー

セキュリティ対策は、闇雲にツールを入れたりパスワードを複雑にするだけでは不十分です。組織全体として「何を守り、どのように守るか」というルール（方針）が必要です。これが第1章のテーマである**情報セキュリティポリシー**です。

## 1. 情報セキュリティポリシーとは？

**情報セキュリティポリシー**とは、組織が情報セキュリティを確保するために定めた**「意図、方針、規定、手順の総称」**です。
簡単に言えば、「我が社はセキュリティをこのように考え、こうやって守っていきますよ」という宣言とルールのセットです。

### 1.1 ポリシーの3層構造（超重要）

情報セキュリティポリシーは、一般的に**3つの階層**で構成されます。この構造は試験で頻出ですので、必ず暗記してください。

| 階層 | 名称 | 内容 | 策定・決定者 | 公開範囲 |
| :--- | :--- | :--- | :--- | :--- |
| **第1階層** | **基本方針**<br>(Policy) | 組織としての情報セキュリティへの取り組み姿勢、目的、責任範囲などを宣言したもの。 | **経営陣**<br>（社長、取締役会） | **社内外**に公開<br>（HP等で宣言） |
| **第2階層** | **対策基準**<br>(Standard) | 基本方針を実現するために、具体的に「何を守るべきか」「何をすべきか」を定めた規定。 | 全社的な管理責任者<br>（CISO等） | 原則**社内**のみ<br>（関係者限り） |
| **第3階層** | **実施手順**<br>(Procedure) | 対策基準を守るための詳細な手順、マニュアル、設定値など。「どのように行うか」を示す。 | 部門責任者<br>（現場リーダー） | **担当部門**のみ<br>（極秘扱いの場合も） |

> [!IMPORTANT]
> **試験でのポイント**
> *   **「基本方針」は経営者の責任**です。現場の担当者が勝手に決めるものではありません。経営トップがコミットメント（関与）を示すことが重要です。
> *   **公開範囲の違い**に注意。「基本方針」は対外的な信頼を得るために公表することが多いですが、「実施手順」や「対策基準」は攻撃者のヒントになるため、外部には公開しません。

### 1.2 各階層の詳細解説

#### ① 情報セキュリティ基本方針 (Information Security Policy)
企業のトップが「我々はセキュリティを重要視している」と宣言する憲法のようなものです。
*   **記述内容の例**:
    *   情報セキュリティの目的と重要性
    *   法令や契約の順守（コンプライアンス）
    *   教育・訓練の実施
    *   違反時の罰則
    *   継続的な改善へのコミットメント

#### ② 情報セキュリティ対策基準 (Information Security Standards)
基本方針を受けて、全社員が守るべき具体的なルールです。
*   **記述内容の例**:
    *   パスワードは8文字以上設定すること
    *   私物USBメモリの使用禁止
    *   ウイルス対策ソフトの導入義務
    *   アクセス権限の付与基準
*   **ガイドライン**:
    *   経済産業省「情報セキュリティ管理基準」や、IPA（情報処理推進機構）の資料を参考に策定されることが多いです。

#### ③ 情報セキュリティ実施手順 (Information Security Procedures)
対策基準を実際の業務でどう実行するか記したマニュアルです。
*   **記述内容の例**:
    *   Windows 10でのパスワード変更手順
    *   入退室管理システムの操作方法
    *   ルーターのConfig設定例
    *   ウイルス検知時の具体的な連絡フロー

---

## 2. ポリシーの策定と運用プロセス

ポリシーは作って終わりではありません。「作ったが誰も守っていない（形骸化）」が一番の失敗例として試験に出ます。

### 2.1 策定体制 (Organization)

ポリシー策定には、以下のような体制が必要です。

*   **CISO (Chief Information Security Officer)**: 最高情報セキュリティ責任者。経営陣の一人であり、全社的な責任を持ちます。
*   **情報セキュリティ委員会**: 各部門の代表者や専門家で構成され、ポリシーの審議や見直しを行います。

> [!WARNING]
> **間違いやすいポイント**
> 情報セキュリティポリシーの策定主体は**経営陣**です。「情報システム部」だけで勝手に作ってはいけません。全社的なルールなので、全部門が関わる必要があります。

### 2.2 PDCAサイクルによる運用

情報セキュリティマネジメントは、**PDCAサイクル**（Plan-Do-Check-Act）を回し続けることが大前提です。

1.  **Plan (計画)**: リスクを洗い出し、ポリシーを策定する。
2.  **Do (実施)**: ポリシーに従って対策を導入・運用し、教育を行う。
3.  **Check (点検・監査)**: ルールが守られているか、対策が有効かを確認（監査）する。
4.  **Act (処置・改善)**: 問題点を見直し、ポリシーや対策を修正する。

> [!TIP]
> **試験頻出の「見直し」タイミング**
> ポリシーは定期的に見直す必要がありますが、それ以外にも見直しが必要なタイミングがあります。
> *   **業務内容や組織の大幅な変更**があった時
> *   **新たな脅威**（新型ウイルスの流行など）が出現した時
> *   **重大なセキュリティ事故**が発生した時
> *   **法律やガイドラインが改正**された時

---

# 第2章：リスクマネジメント（リスク分析編）

「全ての情報を完璧に守る」ことは、コストと手間がかかりすぎて不可能です。
そのため、「**どの情報が重要で、どんな危険があるのか**」を分析し、優先順位をつけて対策する必要があります。これが**リスクマネジメント**です。

## 1. リスクアセスメントとは？

**リスクアセスメント**とは、リスクを見つけ、大きさを測り、対策が必要か判断する一連のプロセスのことです。JIS Q 31000 や ISO/IEC 27000 シリーズで定義されています。

リスクアセスメントは以下の3つのステップで行われます。試験ではこの**順番**が問われることがあります。

1.  **リスク特定 (Risk Identification)**
    *   「何が（情報資産）」「どうなると（脅威）」「なぜ（脆弱性）」困るのかを見つける。
    *   例：「顧客リスト」が、「内部不正」によって、「アクセス権管理の不備」をつかれて漏洩する。

2.  **リスク分析 (Risk Analysis)**
    *   特定したリスクが**どれくらい危険か**（リスクレベル）を算定する。
    *   一般的に **「リスクの大きさ ＝ 発生確率 × 影響度（損害額）」** で計算します。

3.  **リスク評価 (Risk Evaluation)**
    *   分析したリスクレベルを、組織の基準（**受容基準**）と比較し、対策すべき優先順位を決める。
    *   「このリスクは許容できないので対策しよう」「これは軽微だから様子を見よう」と判断する。

> [!IMPORTANT]
> **ここは絶対暗記！ 用語の定義**
> *   **資産 (Asset)**: 守るべき価値のある情報（顧客データ、設計図、信用など）。
> *   **脅威 (Threat)**: 資産を脅かす原因（ハッカー、ウイルス、地震、従業員のミスなど）。
> *   **脆弱性 (Vulnerability)**: 脅威を許してしまう弱点（OSのバグ、戸締まり忘れ、教育不足など）。
> *   **リスク (Risk)**: 脅威が脆弱性につけ込み、資産に損害を与える可能性。

## 2. リスク分析の手法

リスクを具体的に分析する方法にはいくつか種類があります。

### 2.1 定性的分析 vs 定量的分析

| 分析手法 | 特徴 | メリット | デメリット | 適用例 |
| :--- | :--- | :--- | :--- | :--- |
| **定量的分析**<br>(Quantitative) | 損失額や発生確率を**「金額」や「数値」**で表す方法。 | 費用対効果（ROI）が判断しやすい。経営層への説得材料になる。 | 正確なデータ収集が難しい（信用の失墜を金額換算するのは困難）。手間がかかる。 | 顧客個人情報（賠償額が計算可能）など。ALE（年間予想損失額）を用いる。 |
| **定性的分析**<br>(Qualitative) | 影響度を**「大・中・小」**といった**ランク**で評価する方法。 | 手間が少なく、数値化しにくい心理的・社会的影響も評価しやすい。 | 評価者の主観が入りやすい。客観性に欠ける場合がある。 | 一般的な社内文書、開発プロジェクトのリスクなど。 |

> [!TIP]
> 試験では、**「定量的分析は客観的だが手間がかかる」「定性的分析は主観が入りやすいが容易」**という対比がよく出ます。

### 2.2 リスク分析のアプローチ手法

分析をどのように進めるかのアプローチにも種類があります。これを混同させる問題が出るので注意してください。

| アプローチ | 内容 | 向いている対象 |
| :--- | :--- | :--- |
| **ベースラインアプローチ** | 既存の標準やガイドライン（ベースライン）と自社の現状を比較し、適合していない部分をリスクとする方法。 | 小規模組織、定型的な業務システム。<br>コストを抑えて一定レベルのセキュリティを確保したい場合。 |
| **詳細リスク分析** | 資産一つひとつに対して、詳細に脅威と脆弱性を分析し、リスク値を算出する方法。 | **最重要システム**、個人情報データベースなど。<br>時間とコストがかかるが、精密な対策が可能。 |
| **組み合わせアプローチ** | 全体はベースラインでチェックし、重要な部分だけ詳細分析を行うハイブリッド方式。 | 一般的な企業全般。<br>効率と精度のバランスが良い。 |
| **非公式アプローチ** | 管理者の知識や経験に基づいて判断する方法。 | 極めて小規模な組織。<br>体系的でないため、見落としのリスクが高い。 |

> [!WARNING]
> **引っ掛けポイント**
> *   **「詳細リスク分析」**は最も精度が高いですが、全資産に行うのは現実的ではありません（コストがかかりすぎる）。「全ての資産に詳細リスク分析を行う」という選択肢は**間違い**であることが多いです。
> *   最初はベースラインアプローチで全体の底上げを図るのが一般的です。

## 3. JIS Q 31000 (ISO 31000) におけるリスクマネジメント

近年の試験では、JIS Q 31000 の用語や概念が出題される傾向があります。特に、リスクマネジメントプロセスの中の「**協議及び伝達**」と「**モニタリング及びレビュー**」が重要です。

*   **協議及び伝達**: リスクマネジメントの全段階において、関係者（ステークホルダー）と情報を共有し意見交換すること。一方的な決定は失敗のもとです。
*   **モニタリング及びレビュー**: リスクの状況は常に変化するため、継続的に監視し、プロセス自体の有効性を見直すこと。

---

# 第3章：リスクマネジメント（リスク対応編）

リスク分析によって「どのリスクが危険か」が分かったら、次は「**どう対処するか**」を決めます。これが**リスク対応 (Risk Treatment)** です。

## 1. リスク対応の4つの選択肢

リスクへの対応は、大きく分けて「コントロール（制御）」と「ファイナンシング（財務的対応）」の2軸、さらに4つの分類に分けられます。この**4分類の振り分け問題**は試験の鉄板です。

| 分類 | 別名 | 内容 |具体例 |
| :--- | :--- | :--- | :--- |
| **① リスク低減**<br>(Mitigation) | **修正** | リスクの発生確率を下げる、または被害を小さくする対策を行うこと。**最も一般的**な対応。 | ・ウイルス対策ソフトを入れる<br>・パスワードを長くする<br>・入退室ゲートを設置する<br>・データのバックアップを取る |
| **② リスク回避**<br>(Avoidance) | **回避** | リスクの原因そのものを取り除くこと。リスクが大きすぎて対策しきれない場合に選ぶ。 | ・個人情報の収集をやめる<br>・Web公開サーバを閉鎖する<br>・危険なイベントへの出展を見合わせる |
| **③ リスク移転**<br>(Transfer) | **共有** | リスクを他者に肩代わりしてもらうこと。被害額を金銭でカバーする目的が多い。 | ・**サイバー保険**に加入する<br>・サーバ管理を専門業者に**アウトソーシング**する（責任の一部を移す） |
| **④ リスク保有**<br>(Acceptance) | **受容** | 対策コストが被害額を上回る場合や、発生確率が極めて低い場合に、**「あえて何もしない」**と決めること。 | ・自然災害等の発生確率が極めて低いリスク<br>・対策費用が膨大すぎるため、起きたら諦める（損金として処理する） |

> [!TIP]
> **試験対策のキーワード**
> *   **「保険」**ときたら → **「リスク移転（共有）」**
> *   **「やめる・中止する」**ときたら → **「リスク回避」**
> *   **「監視する・現状維持」**ときたら → **「リスク保有（受容）」**

## 2. 残留リスクとリスク受容

リスク対応を行っても、リスクをゼロにすることはできません。対策後にも残っているリスクを**残留リスク (Residual Risk)** と呼びます。

*   **リスク受容基準**: 組織が「ここまでのリスクなら許容できる」と定めたライン。
*   残留リスクがこの基準を下回っていればOK、上回っていれば追加の対策が必要です。
*   リスク保有（受容）を選択する場合、**経営陣の承認**が不可欠です。「現場の判断で放置した」はNGです。

> [!WARNING]
> **引っ掛けポイント**
> 「リスク対応を行えばリスクは消滅する」という記述は**誤り**です。必ず**残留リスク**は残ります。これを経営層が認識し、管理し続けることが情報のマネジメントです。

---

# 第4章：組織的なセキュリティ体制 (ISMS)

ここでは、組織全体で体系的にセキュリティ管理を行う仕組みである **ISMS (Information Security Management System)** について解説します。国際規格 **ISO/IEC 27001 (JIS Q 27001)** がベースとなります。

## 1. ISMSの概要とPDCA

ISMSは、「一度対策して終わり」ではなく、「**PDCAサイクルを回して継続的に改善する**」ことが最大のポイントです。

*   **Plan (計画)**: ISMSの確立。適用範囲を決め、リスクアセスメントを行い、管理策を選定する。
*   **Do (実施)**: ISMSの導入と運用。選定した管理策を導入し、教育を行う。
*   **Check (監視・レビュー)**: ISMSの監視と見直し。内部監査を行い、有効性を評価する。
*   **Act (維持・改善)**: 改善処置。不適合（ルール違反や不備）を修正し、是正処置を行う。

> [!IMPORTANT]
> **用語の使い分け**
> *   **是正処置**: 発生した問題の原因を除去すること（再発防止）。
> *   **予防処置**: 起こりそうな問題を未然に防ぐこと（※ISO/IEC 27001:2013改訂で用語としては消えましたが概念はリスク対応に含まれます）。
> *   試験では**「内部監査はCheckフェーズ」「是正処置はActフェーズ」**といった対応関係が問われます。

## 2. リーダーシップと適用宣言書

### 2.1 トップマネジメント（経営陣）の責任
ISMS認証を取得・維持するためには、経営陣の**リーダーシップ**が必須条件です。
*   情報セキュリティ方針の確立
*   組織の役割と責任の割り当て（CISO等の任命）
*   資源（予算、人員、設備）の提供

### 2.2 適用宣言書 (Statement of Applicability: SoA)
リスク対応の一環として、JIS Q 27001の附属書Aにある管理策（100個近くあります）の中から、**「自社はどれを採用するか（あるいは除外するか）」**を一覧にした文書が**適用宣言書**です。
*   これがISMS認証審査の際の最も重要なドキュメントの一つになります。

## 3. 附属書A（管理策）のポイント

附属書Aには具体的な対策メニューが並んでいます。全てを覚える必要はありませんが、代表的なカテゴリを知っておくと便利です。（※2022年版では4つのテーマに再編されました）

1.  **組織的管理策**: ポリシー、役割分担、資産管理など。
2.  **人的管理策**: 雇用時のスクリーニング、教育・訓練、退職時の手続き。
3.  **物理的管理策**: 入退室管理、画面ロック（クリアスクリーン）、機器の処分。
4.  **技術的管理策**: アクセス制御、マルウェア対策、ログ監視、バックアップ。

> [!TIP]
> **試験でよく出る管理策**
> *   **クリアスクリーン・クリアデスク**: 離席時にPC画面をロックし、机の上に重要書類を放置しないこと。物理的セキュリティの基本。
> *   **職務の分離**: 不正を防ぐため、申請者と承認者、開発者と運用者を別の人が担当すること。

---

# 第5章：インシデント管理体制とCSIRT

「セキュリティ対策をしても、事故（インシデント）は必ず起こる」という前提に立ち、事故が起きた時にどう動くかを決めておくのが第5章のテーマです。

## 1. CSIRT（シーサート）とは？

**CSIRT** (Computer Security Incident Response Team) は、セキュリティインシデントが発生した際に、専門的な知見から対応を行う組織内のチームです。

### 1.1 CSIRTとSOCの違い
試験でよく出るのが、**SOC** (Security Operation Center) との違いです。

| 組織 | フルネーム | 主な役割 | 時間軸 |
| :--- | :--- | :--- | :--- |
| **SOC** | Security Operation Center | **監視・検知**。ログを24時間監視し、攻撃の予兆を見つける。 | 平常時〜インシデント発生直前 |
| **CSIRT** | Computer Security Incident Response Team | **対応・連絡**。SOCからの通知や社員からの通報を受け、被害を食い止め、復旧させる。 | インシデント発生時〜事後 |

> [!TIP]
> **試験対策**
> SOCは「アラートを上げる人」、CSIRTは「現場に駆けつけて消火活動をする人」とイメージすると分かりやすいです。
> ※実際には組織により役割が重なることもありますが、試験では明確に役割分担されることが多いです。

### 1.2 外部組織との連携
社内のCSIRT（内部Web等）だけでなく、外部の組織と連携することも重要です。
*   **JPCERT/CC**: 日本国内の調整機関。インシデント報告の窓口。
*   **IPA**: 情報処理推進機構。届出の受付。
*   **FIRST**: 国際的なCSIRTの連合体。

## 2. インシデント対応フロー

インシデント対応は、以下の流れで行われます。特に**「トリアージ」**と**「証拠保全」**が重要です。

1.  **検知・連絡 (Detection)**: SOCのアラートや利用者からの「PCが重い」等の通報を受ける。
2.  **トリアージ (Triage)**: **優先順位付け**。
    *   全てに対応するのは無理なので、「緊急度」と「影響度」で優先順位を決める。
    *   例：「Webサイト改ざん」は対外的な影響が大きいので最優先、「社内PC1台のマルウェア感染（オフライン）」は後回し、など。
3.  **インシデントレスポンス (Response)**:
    *   **封じ込め**: 被害拡大を防ぐ。例：**LANケーブルを抜く**、サーバをネットワークから切り離す。
    *   **根絶**: 原因を取り除く。例：マルウェア駆除、OS再インストール。
    *   **復旧**: 業務を再開する。例：バックアップからのリストア。
4.  **報告・公表 (Reporting)**: 経営陣や、場合によっては公的機関・マスコミへ報告する。
5.  **事後対応・学習 (Leaning)**: 原因分析を行い、再発防止策を策定する。

> [!IMPORTANT]
> **試験頻出：証拠保全（デジタルフォレンジック）**
> インシデント発生時、慌てて電源を切ったり再起動したりしてはいけません。
> **メモリ上のデータ（揮発性情報）が消えてしまい、原因究明ができなくなる**からです。
> 「まずネットワークから切り離すが、**電源は入れたまま**にしてメモリダンプを取得する」が正解となるケースが多いです。

---

# 第6章：事業継続と監査

## 1. 事業継続計画 (BCP/BCM)

大規模なシステム障害や災害が起きても、重要な業務を止めない（または早期復旧する）ための計画が **BCP (Business Continuity Plan)** です。

### 1.1 BIA (ビジネスインパクト分析)と重要指標
BCPを作る際、「どの業務が止まるとヤバいか」を分析することを **BIA (Business Impact Analysis)** と言います。
ここで必ず覚えるべき2つの指標があります。

| 指標 | 意味 | 問いかけ | 対策例 |
| :--- | :--- | :--- | :--- |
| **RTO**<br>(Recovery Time Objective) | **目標復旧時間** | 「**いつまでに**復旧しなければならないか？」 | 中断時間を短くするため、予備機（ホットスタンバイ）を用意する。 |
| **RPO**<br>(Recovery Point Objective) | **目標復旧時点** | 「**どの時点の**データまで戻れば許されるか？」 | データ消失を減らすため、バックアップの頻度を上げる（1日1回→リアルタイム同期）。 |

> [!WARNING]
> **引っ掛けポイント**
> *   **RTO**を短くするには「復旧速度」が必要です（高速な回線、代替機）。
> *   **RPO**を短くするには「更新頻度」が必要です（頻繁なバックアップ）。
> *   この2つはコストとのトレードオフになります。「RTO=0、RPO=0」を目指すと莫大な費用がかかります。

## 2. セキュリティ監査

セキュリティ対策がルール通りに行われているかをチェックするのが**監査**です。

### 2.1 監査人とシステム管理者の違い
*   **被監査部門**: チェックされる側（システム運用部など）。
*   **監査部門**: チェックする側（内部監査室など）。
*   **独立性の原則**: 監査人は、被監査部門から独立していなければなりません。「自分の仕事を自分で監査する」のはNGです。

### 2.2 助言であって修正ではない
監査人の仕事は、問題点を指摘し、改善を**「勧告（助言）」**することです。
システムの設定を**直接修正したり、命令したりしてはいけません**。修正するのはあくまで被監査部門の責任です。

> [!TIP]
> **監査証跡 (Audit Trail)**
> 監査人がチェックするための証拠となるログのこと。「いつ、誰が、何をしたか」が記録されていなければ、監査はできません。
> 「ログを取得すること」は監査の前提条件です。

---

# 第7章：情報資産の管理

セキュリティとは、結局のところ「重要な情報資産を守ること」です。
何が重要で、どこにあるかを知らなければ守りようがありません。

## 1. 情報資産の分類

情報セキュリティの3要素（機密性・完全性・可用性）の観点から、各資産の重要度を分類（格付け）します。

*   **極秘 (Confidential)**: 漏洩すると会社の存続に関わるレベル（未発表の新製品情報など）。
*   **社外秘 (Internal Use Only)**: 関係者のみ。漏洩すると信用失墜につながる（顧客名簿、人事情報）。
*   **公開 (Public)**: 誰でも見られる（Webサイトのプレスリリース）。

> [!IMPORTANT]
> **試験でのポイント**
> 全てを「極秘」にしてはいけません。極秘扱いにすると、持ち出し不可や暗号化必須など運用コストが跳ね上がります。
> **「業務効率とセキュリティのバランス」**を考えて適切な分類を行うことが問われます。

## 2. 媒体の廃棄・データ消去

HDDやUSBメモリ、紙媒体を廃棄する際、データが残ったまま捨ててしまい情報漏洩する事故が後を絶ちません。
試験では**「どうすればデータを完全に消せるか」**が出題されます。

### 2.1 データ消去の確実な方法

| 手法 | 具体的なやり方 | 確実性 | 再利用 |
| :--- | :--- | :--- | :--- |
| **物理破壊** | ドリルで穴を開ける、破砕機（シュレッダー）ですり潰す。 | **極めて高い** | 不可 |
| **磁気破壊** | 強力な磁気を浴びせて記録内容を破壊する（消磁）。 | 高い | 不可（HDDとして使えなくなる） |
| **上書き消去** | 意味のないデータ（00やランダムデータ）でHDD全体を上書きする。 | 高い | **可** |
| **論理フォーマット** | OSの機能で「初期化」や「ゴミ箱を空にする」。 | **低い**（復元ソフトで戻せる） | 可 |

> [!WARNING]
> **引っ掛けポイント**
> *   **「フォーマット（初期化）した」**は不正解です。管理情報が消えただけで、データの実体は残っています。
> *   **「ごみ箱に入れて消去した」**も当然NGです。
> *   SSDはHDDと構造が違うため、従来の上書き消去（1回上書き）ではデータが消え切らない場合があります（ウェアレベリング機能のため）。**「Secure Erase」**コマンドなどの専用機能を使う必要があります。

---

# おわりに：合格へのアドバイス

ここまで「情報セキュリティ管理」の重要ポイントを解説してきました。
この分野は、技術的な計算問題こそ少ないものの、**「経営視点」「管理者視点」**が強く求められます。

試験問題を解く際は、以下のスタンスを常に意識してください。

1.  **「ルールは絶対」**: 個人の判断でルールを破ってはいけない（例外処理は必ず承認が必要）。
2.  **「継続的改善」**: 一度作って終わりではなく、常に見直し続ける（PDCA）。
3.  **「経営責任」**: 最終責任は担当者ではなくトップにある。

この資料が、あなたの情報処理安全確保支援士合格の一助となれば幸いです。応援しています！

---
*(解説作成完了: 2026年1月)*






# Source: RISS_System_Security_Guide.md


# 情報処理安全確保支援士（システムセキュリティ）徹底解説ガイド

## 目次

1.  **はじめに**
    *   本資料の目的と活用方法
    *   システムセキュリティの重要性
    *   試験での位置づけと学習のポイント
2.  **アクセス制御（認証・認可）**
    *   【超重要】認証と認可の違い（キホン中のキホン！）
    *   認証技術の深掘り（パスワード、生体、多要素、FIDOなど）
    *   認可とアクセス制御モデル（DAC, MAC, RBAC）
    *   高度な認証連携（SSO, SAML, OAuth, OIDC）
3.  **アカウント管理**
    *   アカウントのライフサイクル
    *   【最重要】特権ID管理（PAM）のリスクと対策
    *   IDaaS (Identity as a Service) と現代のID管理
4.  **ログ管理・監視**
    *   なぜログが必要なのか？（ログの3大目的）
    *   取得すべきログの種類と保管要件
    *   SIEM (Security Information and Event Management) の仕組み
    *   セキュリティオペレーション（SOC, CSIRT）
5.  **パッチマネジメントと脆弱性管理**
    *   脆弱性とは？（CVE, CVSS, CWEの完全理解）
    *   脆弱性管理のプロセス（PDCA）
    *   パッチ適用の現実と課題（WSUS, 資産管理）
6.  **マルウェア対策**
    *   マルウェアの進化と脅威
    *   エンドポイントセキュリティの変遷（パターンマッチングから振る舞い検知へ）
    *   サンドボックス技術の仕組みと限界
    *   EDR (Endpoint Detection and Response) の役割
7.  **セキュアOS**
    *   OSレベルでのセキュリティ強化
    *   最小権限の原則（Least Privilege）
    *   強制アクセス制御（MAC）とSELinux
8.  **仮想化セキュリティ**
    *   仮想化の基礎（ハイパーバイザ型 vs コンテナ型）
    *   ハイパーバイザ攻撃（VMエスケープ）
    *   コンテナセキュリティ（Docker, Kubernetesのリスクと対策）
9.  **おわりに**
    *   まとめと合格へのロードマップ

---

## 1. はじめに

### 本資料の目的と活用方法
この資料は、国家資格「情報処理安全確保支援士（通称：登録セキスペ）」試験における**「セキュリティ技術（システム）」**分野を、IT初心者や非エンジニアの方でも直感的に理解できるように解説した「徹底攻略ガイド」です。

教科書的な無味乾燥な説明ではなく、「**なぜその技術が必要なのか？**」「**試験ではどこが狙われるのか？**」という視点を重視しています。特に、間違えやすい**「引っ掛けポイント」**や、実務でも役立つ**「勘所」**を重点的に解説します。

### 試験での位置づけ
システムセキュリティ分野（サーバー、クライアント、OS、仮想化など）は、午前問題・午後問題問わず、**極めて高い頻度で出題**されます。特に午後問題では、クラウドサービスの利用やテレワークの普及に伴い、「認証・認可」や「マルウェア対策（EDRなど）」に関する長文問題が頻出しています。

ここの理解が曖昧だと、用語の意味を取り違えて解答してしまい、大きく失点する原因となります。逆に言えば、**ここを固めれば合格に大きく近づきます。**

---

## 2. アクセス制御（認証・認可）

情報セキュリティにおいて、最も基礎的かつ重要なのが「**誰が（認証）**」「**何をしてよいか（認可）**」を決めるアクセス制御です。
ここをおろそかにすると、どんなに頑丈な扉（ファイアウォール）を作っても、鍵（アクセス権）がガバガバであれば意味がありません。

### 【超重要】認証と認可の違い（認証 VS 認可）

試験対策として、まず最初に**絶対に**覚えなければならないのが、「**認証 (Authentication)**」と「**認可 (Authorization)**」の違いです。この2つは似ていますが、全く別の概念です。試験では、この言葉の定義を混同させるような問題がよく出ます。

> [!IMPORTANT]
> **⚠️ ここが試験の「超」頻出引っ掛けポイント！**
>
> *   **認証 (Authentication)** = **「あなたは誰ですか？」** (Who are you?)
>     *   相手が本人であることを確認する手続き。
>     *   例：パスワード入力、指紋スキャン、社員証の提示。
> *   **認可 (Authorization)** = **「あなたは何をしていいですか？」** (What can you do?)
>     *   認証された人に対して、権限を与える（アクセスを許可する）こと。
>     *   例：ファイルの「読み取り」許可、部屋への「入室」許可、管理画面への「アクセス」権限。

#### わかりやすい例え：コンサート会場

*   **認証**: 入場ゲートで「**チケットを見せる**」行為。
    *   チケットを持っていれば、「あなたはチケット購入者（正規の客）ですね」と確認されます。これが認証です。
*   **認可**: 会場内で「**座席に座る**」または「**バックステージに入る**」行為。
    *   一般客は「アリーナ席には行ける」が「関係者席には入れない」。
    *   スタッフは「関係者席に入れる」。
    *   このように、「どこに入っていいか」を決めるのが認可です。

**試験でのミスパターン：**
× 「ユーザーがファイルにアクセスする際、パスワードを入力して**認可**を受けた。」
○ 「ユーザーがファイルにアクセスする際、パスワードを入力して**認証**を受けた。」

（※パスワード入力は「本人確認」なので「認証」です！）

### 認証技術の深掘り

#### 1. 認証の3要素

認証を行うための手段は、大きく3つの要素に分類されます。これを**「認証の3要素」**と呼びます。

| 要素 | 説明 | 具体例 | メリット | デメリット |
| :--- | :--- | :--- | :--- | :--- |
| **記憶** (Knowledge) | **「知っていること」**<br>本人のみが知っている情報 | パスワード、PINコード、秘密の質問 | 導入コストが低い | 忘れる、推測される、漏洩のリスク |
| **所持** (Possession) | **「持っていること」**<br>本人のみが持っている物 | ICカード、ハードウェアトークン、スマホ、物理鍵 | 盗まれない限り安全 | 紛失・破損のリスク、配布コスト |
| **生体** (Biometrics) | **「その人自身」**<br>本人の身体的特徴 | 指紋、顔、静脈、虹彩、声紋 | 忘れない、紛失しない、偽造が難しい | 変更できない（一度漏れると一生危険）、怪我で使えない場合がある |

#### 2. 多要素認証 (MFA) での注意点

> [!WARNING]
> **⚠️ 試験での引っ掛けポイント：MFAの定義**
>
> 「パスワード」と「秘密の質問」の組み合わせは、多要素認証でしょうか？
>
> **答え：違います。**
> どちらも「記憶（知っていること）」の要素です。これは「**二段階認証**」ではありますが、「多要素認証」ではありません。
> 多要素認証と呼ぶには、「パスワード（記憶）」＋「スマホアプリのコード（所持）」や、「パスワード（記憶）」＋「指紋（生体）」のように、**種類の違う要素**を混ぜる必要があります。

#### 3. パスワードに対する攻撃手法（必出！）

パスワード認証は最も一般的ですが、攻撃の手法も多様化しています。以下の用語は確実に覚えましょう。

*   **リスト型攻撃 (Credential Stuffing)**:
    *   別のサービスから流出したIDとパスワードのリストを使って、手当たり次第にログインを試みる攻撃。「パスワードの使い回し」をしていると餌食になります。
    *   *対策*: パスワードの使い回し禁止、多要素認証、WAFによる検知。
*   **パスワードスプレー攻撃**:
    *   「少数のパスワード（例: Password123, 2024password）」を、「多数のアカウント」に対して試す攻撃。
    *   特定のアカウントに対して何度も失敗するとロックがかかるため、それを回避するために「広く浅く」攻撃します。
    *   *対策*: 推測されやすいパスワードの禁止、多要素認証。
*   **辞書攻撃 / ブルートフォース攻撃**:
    *   辞書攻撃はよく使われる単語を試すもの。ブルートフォース（総当たり）は全ての組み合わせを試すもの。
    *   *対策*: パスワードの複雑化（長さ、文字種）、アカウントロック機能。

#### 4. 生体認証の精度評価（FRRとFAR）

生体認証にはエラーがつきものです。この制度を表す指標として、以下の2つが出題されます。

*   **FRR (False Rejection Rate: 本人拒否率)**: 本人を誤って「他人だ！」と弾いてしまう確率。「あー、また指紋認証失敗した（イライラ）」という状況。
*   **FAR (False Acceptance Rate: 他人受入率)**: 他人を誤って「本人だ！」と通してしまう確率。**セキュリティ上、最も危険。**

> [!NOTE]
> **トレードオフの関係**
> FRR（利便性に関係）を下げようとして判定を甘くすると、FAR（安全性に関係）が上がってしまいます。この2つの曲線が交わる点を**CER (Crossover Error Rate)** と呼び、低いほど優秀な装置とされます。

#### 5. 次世代認証規格 FIDO (Fast Identity Online)

最近の試験で非常に重要なのが**FIDO（ファイド）**です。「パスワードレス認証」の標準規格として注目されています。

*   **仕組み**: 公開鍵暗号方式を利用します。
    1.  スマホなどのデバイス内で生体認証（またはPIN）を行い、本人確認をする。
    2.  デバイス内で秘密鍵を使って署名データを作成し、サーバーに送る。
    3.  サーバーは公開鍵で署名を検証してログイン完了。
*   **最大のメリット**:
    *   **生体情報はサーバーに送られない！**（デバイス内に留まる）。これにより、サーバーから生体情報が漏洩するリスクがありません。
*   **FIDO2**: WebブラウザでもFIDOを使えるようにした拡張規格。WebAuthnなどのAPIを使用します。

---

### 認可とアクセス制御モデル

認証が終わった後、「誰がどのファイルを見れるか」を制御するモデルには、主に3つの方式があります。

| 名称 | 日本語訳 | 特徴・覚え方 | 適した環境 |
| :--- | :--- | :--- | :--- |
| **DAC**<br>(Discretionary Access Control) | **任意アクセス制御** | **「所有者」**がアクセス権を決める。<br>例：Windowsのエクスプローラーで「右クリック→プロパティ」で権限設定するのはこれ。 | 一般的なPC、小規模環境 |
| **MAC**<br>(Mandatory Access Control) | **強制アクセス制御** | **「管理者（とシステム）」**が強制的に決める。<br>ユーザーは勝手に権限を変えられない。各データに「機密ラベル（Top Secretなど）」を貼り、ユーザーの「クリアランス（権限レベル）」と比較する。 | 軍事システム、高セキュリティOS (SELinuxなど) |
| **RBAC**<br>(Role-Based Access Control) | **ロールベースアクセス制御** | **「役割（ロール）」**に権限を紐付ける。<br>「営業部員」ロールには顧客データの閲覧権限を、「田中さん」に「営業部員」ロールを割り当てる。人事異動があってもロールの付け替えだけで済むので楽。 | 企業・組織のシステム |

> [!TIP]
> **試験でのポイント**
> 企業の情報システム部門の事例問題では、**RBAC**を採用するメリット（管理工数の削減、人事異動への対応）を答えさせる問題がよく出ます。

---

### 高度な認証連携（ID管理のトレンド）

クラウドサービスの普及により、複数のサービスでIDを共通化する**SSO (Single Sign-On)** や、認証連携が必須知識となっています。

#### 1. シングルサインオン (SSO)

*   **メリット**:
    *   ユーザー：ID/パスワードを1セット覚えるだけで済む。利便性向上。
    *   管理者：パスワードリセット等の管理の手間が減る。
*   **デメリット**:
    *   マスターキー（最初のID/パスワード）が盗まれると、連携している全サービスに不正アクセスされる（**一点突破のリスク**）。

#### 2. さまざまな認証プロトコル

SSOやID連携を実現するためのプロトコル（約束事）も試験に出ます。アルファベットの羅列ですが、**「何に使うものか」**を一言で覚えるのがコツです。

*   **SAML (Security Assertion Markup Language)**
    *   **用途**: **企業向け**のクラウドサービスへのSSO（例: 社内PCからOffice 365へログイン）。
    *   **特徴**: **XMLベース**でデータをやり取りする。「IdP（認証する側）」と「SP（サービス提供側）」が登場する。
*   **OAuth 2.0 (オーオース)**
    *   **用途**: **「認可」**の委譲。
    *   **イメージ**: 「合鍵」を渡す仕組み。例えば、新しいスケジュールアプリに、Googleカレンダーの**「予定の読み込み権限だけ」**を与える場合などに使う。「ID/パスワードそのもの」は渡さないので安全。
*   **OpenID Connect (OIDC)**
    *   **用途**: **「認証」**への利用。OAuth 2.0を拡張して、本人確認（認証）にも使えるようにしたもの。
    *   **特徴**: **JSON (JWT: JSON Web Token)** ベース。「Googleでログイン」「Facebookでログイン」といったソーシャルログインの裏側はこれ。
*   **Kerberos (ケルベロス)**
    *   **用途**: **WindowsのActive Directory**など、社内オンプレミス環境での認証。
    *   **特徴**: 「チケット」と呼ばれるデータを使って認証する。時刻同期が重要。

> [!IMPORTANT]
> **SAMLとOIDCの違い**
> *   **SAML**: XMLベース、エンタープライズ（企業）寄り、歴史が長い。
> *   **OIDC**: JSONベース、Webアプリ・スマホアプリ寄り、モダン。
>
> どちらもSSOに使われますが、データの形式（XML vs JSON）が決定的に違います。これは試験でよく問われます。

---

## 3. アカウント管理

不正アクセスを防ぐには、「誰に鍵を渡したか」を厳密に管理する必要があります。これがアカウント管理です。

### アカウントのライフサイクル

アカウントにも「一生」があります。試験では、特に**退職時・異動時**の処理が問われます。

1.  **登録 (Registration)**: 本人確認を厳格に行い、IDを発行する。
    *   *注意点*: 承認フローを経ること。勝手に作らせない。
2.  **利用 (Usage)**: 日々の業務での利用。
3.  **棚卸し (Review)**: 定期的に「このIDはまだ必要か？」を確認する。
    *   *試験対策*: 「年に一回、部門長が所属メンバーのID一覧と権限を確認し、承認する」というプロセスが模範解答です。
4.  **変更・停止 (Change/Suspend)**: 異動の際は権限を変更し、休職時は一時停止する。
5.  **削除 (De-provisioning)**: **ここが最重要！**
    *   退職や契約終了から**速やかに**アカウントを削除または無効化する必要があります。
    *   「退職者のIDが残っていて、そこからVPNで不正侵入された」という事例は、午後問題の鉄板シナリオです。

### 【最重要】特権ID管理（PAM: Privileged Access Management）

「Administrator」や「root」などの強力な権限を持つID（特権ID）は、攻撃者の最大の標的です。これをどう守るかが、試験の合否を分けます。

#### 特権IDのリスク
*   何でもできてしまう（ログの消去、セキュリティ設定の無効化）。
*   影響範囲がシステム全体に及ぶ。

#### 試験で問われる「特権ID管理のルール」

> [!IMPORTANT]
> **試験で記述させる対策のテンプレート**
>
> 1.  **通常業務での使用禁止**: 「メールチェックやWeb閲覧などの作業は、一般ユーザーIDで行う」。特権IDを使っていいのは、管理作業時のみ。
> 2.  **使い回しの禁止**: 「root」や「Administrator」という共通IDを複数人で共有しない。
>     *   *なぜ？*: 誰がコマンドを実行したか、ログから特定できなくなるため（責任追跡可能性の欠如）。
> 3.  **申請・承認ベースの利用**: 特権IDを使う前に、「いつ、誰が、何のために使うか」を申請し、上長の承認を得てからパスワードを払い出す（貸し出し方式）。
> 4.  **操作ログの全取得**: 特権IDで行った操作は全て記録し、後で点検する（場合によっては動画で記録）。

---

## 4. ログ管理・監視

「ログ（記録）」は、事件が起きた時の**証拠**になります。また、リアルタイムで監視することで、攻撃を早期に発見できます。

### ログの3つの目的

1.  **不正の予防 (Deterrence)**: 「見られている」と意識させることで、内部不正を思いとどまらせる。
2.  **異常の検知 (Detection)**: サイバー攻撃やシステム障害をいち早く見つける。
3.  **原因の特定 (Forensics)**: 事件後に「何が起きたのか」を追跡し、証拠とする。

### 取得すべきログの種類

試験では、具体的なログの種類と、そこから何がわかるかを問われます。

*   **アクセスログ**: 「誰がいつログインしたか」「どのファイルを開いたか」。
    *   *Webサーバー*: Apache/Nginxログ。SQLインジェクション等の攻撃痕跡が残る。
    *   *プロキシサーバー*: 社員が「どのWebサイトを見たか」。Web媒介型マルウェア感染の調査に必須。
    *   *入退室ログ*: 物理的なセキュリティ。サーバー室への出入り記録。
*   **操作ログ**: 「どのコマンドを実行したか」。特権IDの操作監視に重要。

### 時刻同期 (NTP) の重要性

> [!WARNING]
> **試験のツボ：NTP**
>
> 複数のサーバーのログを突き合わせて調査する際、**時刻がズレていると因果関係が掴めません**。
> 「Webサーバーへの攻撃ログ」と「DBサーバーからの情報漏洩ログ」の時刻がずれていたら、関連付けられないのです。
> そのため、**「NTP (Network Time Protocol) を使って全機器の時刻を正確に同期させる」**ことが必須要件として出題されます。

### SIEM (Security Information and Event Management)

ログの量は膨大で、人間が目で見てチェックするのは不可能です。そこで登場するのが**SIEM（シーム）**です。

*   **機能**: 複数の機器（ファイアウォール、サーバー、IDS/IPSなど）からログを集約し、**相関分析**を行う。
*   **相関分析の例**:
    *   「入退室ログで『外出中』になっている社員のIDで、社内PCへの『ログイン』があった」
    *   → 単独のログではわからないが、組み合わせると「なりすまし」だとわかる！
*   **役割**: 異常を検知し、管理者にアラート（警告）を飛ばす。

---

## 5. パッチマネジメントと脆弱性管理

システムには必ずバグ（脆弱性）があります。これを見つけ、直す（パッチを当てる）サイクルを回すことが重要です。

### 脆弱性の「3大指標」（CVE, CVSS, CWE）

この3つの英略語は、試験で**必ず**出ます。それぞれの役割を明確に区別して覚えましょう。

1.  **CVE (Common Vulnerabilities and Exposures)**
    *   役割：**脆弱性の「IDカード」**。
    *   形式：`CVE-2024-12345` のように、「年号」＋「連番」で管理される。世界共通の番号。
2.  **CWE (Common Weakness Enumeration)**
    *   役割：**脆弱性の「種類」**。
    *   例：「バッファオーバーフロー」「SQLインジェクション」といったタイプ別に分類したもの。
3.  **CVSS (Common Vulnerability Scoring System)**
    *   役割：**脆弱性の「深刻度（スコア）」**。0.0〜10.0の点数で表す。
    *   **3つの基準（ここが試験に出る！）**:
        *   **基本評価基準 (Base Metrics)**: **ベンダーが公開**。脆弱性そのものの性質（攻撃のしやすさ、破壊力）。**時間は経っても変わらない**。
        *   **現状評価基準 (Temporal Metrics)**: **時間とともに変化**。「攻撃コードが出回っているか」「パッチが出ているか」など。
        *   **環境評価基準 (Environmental Metrics)**: **ユーザー環境によって変わる**。「そのサーバーはネットに繋がっているか？」「重要データが入っているか？」など。

> [!IMPORTANT]
> **試験対策：CVSS**
> 「A社のサーバーで見つかった脆弱性の『基本評価基準』のスコアは、B社のサーバーでも**同じ**である（脆弱性そのものは変わらないから）。」
> 一方、「『環境評価基準』のスコアは、A社とB社の環境の違いによって**異なる**。」
> この理屈を理解しているかが問われます。

### パッチマネジメント

「パッチが出たらすぐ適用する」のが理想ですが、現実はそう簡単ではありません。

*   **適用テスト**: パッチを当てたら業務アプリが動かなくなった、という事故を防ぐため、検証環境でテストを行う。
*   **資産管理**: 社内にPCが何台あり、どのバージョンのソフトが入っているかを把握していないと、パッチの当て漏れが発生する。
*   **ワークアラウンド（回避策）**: パッチがまだ出ていない、あるいはすぐには当てられない場合の応急処置。
    *   例：WAFで攻撃通信を遮断する、該当機能を一時的にオフにする。

---

## 6. マルウェア対策

### マルウェアの進化

*   昔：愉快犯、自己顕示欲。
*   今：**金銭目的、組織的犯罪**。ランサムウェア（身代金要求型）や標的型攻撃が主流。

### エンドポイントセキュリティの進化

PCやサーバー（エンドポイント）を守る技術も進化しています。

#### 1. パターンマッチング（従来型アンチウイルス）
*   **仕組み**: 既知のウイルスファイルの特徴（指名手配写真）と照合する。
*   **限界**: 新種・亜種のウイルス（写真がない犯人）は検知できない。

#### 2. サンドボックス (Sandbox)
*   **仕組み**: 「隔離された仮想環境（砂場）」の中で、怪しいファイルを実際に動かしてみる。
*   **メリット**: 未知のウイルスでも、挙動（勝手に通信する、ファイルを書き換えるなど）から検知できる。
*   **弱点**: 「仮想環境だとバレたらおとなしくする」という回避機能を持つマルウェアもいる。

#### 3. EDR (Endpoint Detection and Response)

今、最もホットな技術が**EDR**です。

*   **コンセプト**: 「**侵入されることを前提とする**」。
*   **役割**: エンドポイント（PC）内部の操作や通信をすべて記録しておき、**侵入後の対応**を支援する。
    *   飛行機の「フライトレコーダー」兼「自動消火装置」のようなもの。
*   **機能**:
    *   **検知**: 挙動分析により、不審な動作（PowerShellの悪用など）を見つける。
    *   **封じ込め**: 管理画面から、感染したPCをネットワークから隔離する。
    *   **調査**: 「どのファイルから感染し、どこへ拡散したか」を追跡する。

> [!TIP]
> **EPPとEDRの違い**
> *   **EPP (Endpoint Protection Platform)**: 従来型アンチウイルス。「**感染を防ぐ**」のが目的。（盾）
> *   **EDR**: 「**感染後の被害を最小限にする**」のが目的。（監視カメラ＆特殊部隊）
>
> 現代のセキュリティでは、EPPとEDRを両方導入するのが標準的です（これを統合した製品もあります）。

---

## 7. セキュアOS

### セキュアOSとは

通常のOS（LinuxやWindows）の上に、セキュリティ機能を後付け（または機能強化）したものです。
最大の目的は、**「root権限（特権ID）を奪われても被害が出ないようにすること」**です。

### 最小権限の原則 (Least Privilege)

「必要な人に、必要なときだけ、必要なだけの権限を与える」。これがセキュリティの大原則です。
セキュアOSは、この原則をシステムレベルで強制的に実現します。

### 強制アクセス制御 (MAC)

第2章で触れた「MAC」がここで再登場します。

*   **従来のアクセス制御 (DAC)**:
    *   rootユーザーは何でもできる（ファイルの読み書き、プロセスの強制終了）。
    *   もし攻撃者にrootパスワードを奪われたら、**ゲームオーバー（全滅）**。
*   **セキュアOSのアクセス制御 (MAC)**:
    *   **rootユーザーであっても**、「Webサーバーの設定ファイル」は書き換えられない、「ログファイル」は削除できない、といった細かい制限をかけられる。
    *   攻撃者がrootを奪っても、できることは限られるため、被害を最小限に抑えられる。

#### 代表的な実装：SELinux (Security-Enhanced Linux)
LinuxカーネルにMAC機能を追加するモジュール。設定が難解なことで有名ですが、試験では「SELinux = MACを実現するもの」と覚えておけばOKです。

---

## 8. 仮想化セキュリティ

クラウド時代の今、サーバーの実体は「仮想化」されています。ここ独自のセキュリティリスクも出題されます。

### ハイパーバイザ型 vs コンテナ型

| タイプ | 説明 | 代表例 | メリット | デメリット |
| :--- | :--- | :--- | :--- | :--- |
| **ハイパーバイザ型** | ハードウェア上に「ハイパーバイザ」ソフトを置き、その上で**OSごと**仮想化する。 | VMware, Hyper-V | 完全に独立したOSが動くため、隔離性が高い。 | リソース（メモリなど）を多く食う。起動が遅い。 |
| **コンテナ型** | ホストOSのカーネルを**共有**し、アプリ実行環境だけを隔離する。 | Docker, Kubernetes | 非常に軽量・高速。 | カーネルを共有しているため、**もしカーネルに脆弱性があると全コンテナが危険になる**。 |

### 仮想化特有の攻撃手法

#### 1. VMエスケープ (VM Escape)
*   **内容**: 仮想マシン（ゲストOS）の中にいる攻撃者が、壁を突き破って**ホストOS（管理側）**へ侵入すること。
*   **インパクト**: ホストOSを乗っ取られると、そこで動いている他の全ての仮想マシンも支配されてしまう。

#### 2. コンテナブレイクアウト
*   **内容**: コンテナの中から外へ脱出すること。コンテナはハイパーバイザ型よりも壁が薄いため、リスクが高いとされる。
*   **対策**:
    *   コンテナを実行するユーザーをrootにしない。
    *   コンテナイメージ（設計図）の脆弱性スキャンを行う。

---

## 9. おわりに：合格へのロードマップ

ここまで「システムセキュリティ」の主要技術を一通り解説してきました。
情報処理安全確保支援士の試験は範囲が広いですが、システム系の問題は**「パターン」**が決まっています。

1.  **用語を正しく理解する**: 認証と認可、SAMLとOIDC、EPPとEDRなど、似た用語の違いを明確にする。
2.  **「なぜ？」を説明できるようにする**: 「なぜ特権IDを使い回してはいけないのか？（責任追跡可能性）」「なぜNTPが必要なのか？（ログ分析の整合性）」といった理由を、自分の言葉で書けるようにする。
3.  **過去問で実践する**: 知識を入れたら、実際の午後問題（長文）を読んでみてください。「あ、これ解説にあった『特権IDの管理不備』だ！」と気づけるようになっているはずです。

この資料が、あなたの合格の一助となることを心から願っています。
**頑張ってください！**



# Source: Security_Design_Study_Guide.md


# 第1章：セキュアシステム設計 〜最初から安全に作る〜

## 1.1 なぜ「設計」が重要なのか？

情報セキュリティにおいて、「後で直せばいい」という考え方は通用しません。家を建てる時を想像してください。完成した家の壁に後から断熱材を入れたり、基礎を補強したりするのは大変なコストと手間がかかります。最悪の場合、一度解体しなければならないかもしれません。

システム開発も同じです。設計・実装段階でセキュリティを考慮することを **「セキュリティ・バイ・デザイン (Security by Design)」** と呼びます。

> [!IMPORTANT]
> **試験でのポイント**
> 情報処理安全確保支援士試験では、「企画・要件定義」の段階からセキュリティ要件を盛り込むことの重要性が問われます。
> 「開発が終わってから脆弱性診断をして修正する」というアプローチは、手戻りコストが膨大になり、リリース遅延の原因となるため、推奨されないパターン（Bad Practice）として出題されます。

### シフトレフト (Shift Left) という考え方
開発プロセスの時間の流れを左から右（要件定義 → 設計 → 実装 → テスト → 運用）と見立てたとき、セキュリティ対策をより早い段階（左側）実施することを「シフトレフト」と呼びます。

```mermaid
graph LR
    A[要件定義] --> B[設計]
    B --> C[実装]
    C --> D[テスト]
    D --> E[運用]
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#ffa,stroke:#333,stroke-width:2px
    
    Note over A,B: ここでセキュリティを作り込む！(シフトレフト)
```

## 1.2 3大脆弱性を完全理解する

試験で必ずと言っていいほど出題される、Webシステムの3つの主要な脆弱性があります。これらは「知っている」レベルではなく、「攻撃の仕組み」と「根本的な対策」をコードレベルで理解している必要があります。

### ① SQLインジェクション (SQL Injection)

データベースに対する命令文（SQL）を、攻撃者が外部から不正に操作してしまう攻撃です。

**【アナロジー：レストランでの注文】**
あなたがレストランで「オムライス（ユーザー入力）」を注文するとします。店員（システム）は厨房へのオーダー票（SQL文）に「オムライスを作る」と書きます。
しかし、もし悪意ある客が「オムライス、**あと店のお金全部と**」と注文したらどうなるでしょうか？
店員がそのままオーダー票に「オムライス、あと店のお金全部とを作る」と書いて厨房に渡してしまったら、店のお金が盗まれてしまいます。

**【技術的な仕組み】**
悪い実装（文字列連結）をしている場合：
```sql
-- 開発者が意図したSQL（ユーザー入力をそのままくっつけている）
SELECT * FROM users WHERE name = 'user_input';

-- 攻撃者が ' OR '1'='1 と入力した場合
SELECT * FROM users WHERE name = '' OR '1'='1';
```
`'1'='1'` は常に「真 (True)」なので、`WHERE` 句の条件がすべて無効化され、**すべてのユーザー情報が表示されてしまいます**。

**【根本的対策：プレースホルダ（Placeholder）】**
SQLインジェクションの根本対策は、**「プレースホルダ（バインド機構）」** を使うことです。
これは、注文内容を「料理名」という専用の枠（プレースホルダ）に入れて渡す仕組みです。

*   SQL文の雛形： `SELECT * FROM users WHERE name = ?`
*   ユーザー入力：「オムライス、あと店のお金全部と」
*   処理結果： `name` が 「オムライス、あと店のお金全部と」 という名前のユーザーを探す（当然いない）。

命令文として解釈されず、単なる「文字」として扱われるため、安全です。

> [!WARNING]
> **引っ掛けポイント**
> *   **× エスケープ処理**: 入力文字から特殊文字（'や;など）を無害化する処理。対策の一つですが、抜け漏れが発生しやすいため、**根本的対策ではありません**。試験で「最も適切な対策」を問われたら「プレースホルダ」を選んでください。
> *   **× WAF (Web Application Firewall)**: WAFは攻撃を検知・遮断する「保険」であり、脆弱性そのものを直すわけではありません。

---

### ② クロスサイトスクリプティング (XSS)

悪意のあるスクリプト（JavaScriptなど）が、被害者のブラウザ上で実行されてしまう脆弱性です。

**【攻撃の影響】**
*   **Cookie（セッションID）の窃取**: 被害者のなりすましが可能になる。
*   **偽の入力画面表示**: フィッシング詐欺に利用される。
*   **マルウェアダウンロード**: 強制的にウイルスをダウンロードさせる。

**【種類】**
1.  **反射型XSS**: 攻撃用URLをクリックすると、そのリクエストに含まれるスクリプトもろともレスポンスとして返ってきて実行される。メール上のリンクなどを踏ませる手口。
2.  **格納型（蓄積型）XSS**: 掲示板などに悪意あるスクリプトが書き込まれ（データベースに保存され）、そのページを見た全員が被害に遭う。被害範囲が広くなりやすい。
3.  **DOM Based XSS**: クライアントサイドのJavaScriptだけで完結して発生するXSS。サーバに通信が行かない場合もあるため、WAFですり抜けやすい。

**【根本的対策：適切な出力処理（エスケープ）】**
XSSの対策は、**「出力時にHTMLの特殊文字をエスケープする」** ことです。
具体的には、`<` を `&lt;` に、`>` を `&gt;` に変換します。これにより、ブラウザはそれを「タグ（命令）」ではなく「単なる文字」として表示します。

> [!TIP]
> **ReactやVue.jsなどの現代的フレームワーク**
> 現代のフロントエンドフレームワークは、デフォルトでエスケープ処理を行うため、XSSには強くなっています。しかし、`dangerouslySetInnerHTML`（React）や `v-html`（Vue）のように、意図的に生のHTMLを埋め込む機能を使う場合は脆弱になります。

---

### ③ クロスサイトリクエストフォージェリ (CSRF)

ユーザーが**意図しない操作**（パスワード変更、送金、商品購入など）を、攻撃者が用意した罠サイトを経由して勝手に行わせる攻撃です。XSSと似ていますが、スクリプトを実行させるのではなく、「正規の（ログイン中の）ユーザー権限を使って、裏で勝手にリクエストを送らせる」点が異なります。

**【アナロジー：偽の宅配依頼】**
あなたが宅配便の会員サイトにログインしている状態で、悪いサイトを閲覧しました。その悪いサイトには、見えないところで「私の住所宛に、高級時計を代引きで送ってくれ」という依頼書（リクエスト）を宅配業者に投げる仕組みが仕込まれていました。
宅配業者は、あなたからの正規の依頼書（ログイン済みCookieつき）に見えるため、それを受理してしまいます。

**【根本的対策：CSRFトークン】**
リクエストが「本当にそのユーザーが意図して送信した画面から来たものか」を確認するための合言葉（トークン）を使います。

1.  **サーバー**: 入力画面を表示する際、ランダムな文字列（トークン）を発行し、画面の隠しフィールド（hidden）に埋め込む。同時にサーバー側でもその値を覚えておく。
2.  **ユーザー**: 入力して送信ボタンを押す。
3.  **サーバー**: 送られてきたトークンと、覚えていたトークンが一致するか確認する。

攻撃者のサイトからは、この「その場限りのランダムなトークン」を知ることができないため、偽のリクエストを作ってもサーバーに拒否されます。

## 1.3 設計段階でのその他の重要事項

### HTTPヘッダーによるセキュリティ強化
試験では、HTTPレスポンスヘッダーの設定によるセキュリティ対策も問われます。

| ヘッダー名 | 説明 | 対策する脆弱性 |
| :--- | :--- | :--- |
| **Strict-Transport-Security (HSTS)** | ブラウザに「次は絶対にHTTPSでアクセスしてね」と強制する。 | 中間者攻撃、SSLストリップ |
| **X-Frame-Options** | 自分のサイトを `iframe` 内に表示することを許可するか制御する。 | クリックジャッキング |
| **X-Content-Type-Options: nosniff** | ファイルのContent-Typeをブラウザが勝手に推測するのを防ぐ。 | コンテンツタイプスニッフィングを利用したXSS |
| **Content-Security-Policy (CSP)** | 読み込みを許可するリソース（画像、スクリプト等）の送信元をホワイトリスト化する。 | XSS等の緩和策 |

> [!CAUTION]
> **クリックジャッキング (Clickjacking)**
> 透明なボタン（iframe）を通常のボタンの上に被せてクリックさせる攻撃。「X-Frame-Options: DENY」または「SAMEORIGIN」を設定することで防げます。

第1章では、システムを作る段階（設計・実装）で埋め込むべきセキュリティ対策を見てきました。次は、システムが万が一故障したときや、攻撃を受けたときにどう振る舞うべきかという「設計思想」について解説します。
# 第2章：信頼性と故障時の設計 〜壊れたときの振る舞い〜

システムや機械は、どんなに完璧に設計しても、いつかは必ず故障します。また、人間は必ずミスをします。
第2章では、「壊れたとき」「間違ったとき」に、システムがどう振る舞うべきかという 4つの重要なコンセプト（設計思想） を解説します。
これらは試験で非常に紛らわしい選択肢として出題されるため、違いを明確に理解することが重要です。

## 2.1 4つの設計思想：概要と比較

まずは、それぞれの言葉の定義とイメージを掴みましょう。

| 用語 | 英語 | 核心となる考え方 | 優先するもの | 具体例（イメージ） |
| :--- | :--- | :--- | :--- | :--- |
| **フェイルセキュア** | Fail Secure | 故障したら、**安全な状態（閉じる・止める）** になる。 | **セキュリティ** (機密性) | 電子錠が壊れたら、鍵がかかったままにする（泥棒に入られない）。 |
| **フェイルソフト** | Fail Soft | 故障したら、**機能を落としてでも動かし続ける**。 | **継続性** (可用性) | 飛行機のエンジンが1つ止まっても、残りだけで飛び続ける。 |
| **フェイルセーフ** | Fail Safe | 故障したら、**人命や財産に害がない安全な状態** になる。 | **安全性** (Safety) | 信号機が壊れたら、全方向赤にする（事故らせない）。踏切の遮断機が降りる。 |
| **フールプルーフ** | Fool Proof | 人間が **バカな真似（誤操作）をしても、事故にならない** ようにする。 | **誤操作防止** | 電子レンジのドアを開けたままでは温められない。 |

---

## 2.2 それぞれの詳細解説と試験対策

### ① フェイルセキュア (Fail Secure)
**「壊れたら、漏らさない・通さない」**

情報セキュリティ（特に**機密性**）を重視する場合の設計です。システムが異常状態になったとき、**システムを停止**させたり、**アクセスを遮断**したりして、情報を守ります。

*   **具体例**:
    *   ファイアウォールが故障した場合、すべての通信を遮断（Block）する設定にする。
        *   （もし通信を通す＝Allow設定にしてしまうと、攻撃通信も通してしまうかもしれないから）
    *   入退室管理システムの認証サーバーがダウンした場合、ドアをロックしたままにする。
        *   （開錠してしまうと、誰でも入れてしまうから）

> [!WARNING]
> **デメリット**
> システムが使えなくなる（可用性が損なわれる）ため、業務がストップします。入退室管理の場合、部屋の中に人が閉じ込められるリスクがあるため、**非常時解錠ボタン（物理的なフェイルセーフ）** とセットで運用されることが多いです。

### ② フェイルソフト (Fail Soft)
**「壊れても、あきらめない。粘り強く動く」**

サービスの**継続性（可用性）**を重視する場合の設計です。「縮退運転（Degradation）」とも呼ばれます。

*   **具体例**:
    *   **RAID構成のHDD**: 1台のディスクが壊れても、データの読み書きは継続できる。
    *   **Webサーバーのロードバランサ**: 複数台あるサーバーのうち1台がダウンしても、そのサーバーを切り離して、残りのサーバーだけでサービスを提供し続ける。
        *   （処理能力は落ちて遅くなるかもしれないが、サービスは止まらない）
    *   **航空機**: エンジンが複数あり、1つが停止しても飛行継続可能になっている。

> [!IMPORTANT]
> **試験でのポイント**
> 「一部の機能を提供し続ける」「性能を低下させても稼働を維持する」「縮退運転」というキーワードが出たら、**フェイルソフト**を選んでください。

### ③ フェイルセーフ (Fail Safe)
**「壊れたら、とにかく誰も傷つけない」**

**物理的な安全性（Safety）** を最優先する設計です。工場、鉄道、交通システムなどの制御システム（OT: Operational Technology）で特に重要視されます。

*   **具体例**:
    *   **踏切**: 停電や故障が発生したら、遮断機は自重で降りてくる設計になっている。
        *   （開いたままだと車が侵入して電車と衝突するかもしれないから、通れなくする方がマシ）
    *   **信号機**: 故障したら、全方向を赤点滅にする。
        *   （全方向青になってしまったら大事故になるから）
    *   **石油ストーブ**: 地震で倒れたら、自動的に消化する。

> [!TIP]
> **フェイルセキュアとの違い**
> 「安全側に倒す」という意味では似ていますが、
> *   **フェイルセキュア**: 「情報の秘密」を守る（泥棒を入れない）イメージ。
> *   **フェイルセーフ**: 「人の命」を守る（怪我させない）イメージ。
> 試験では、文脈が「情報セキュリティ（機密情報）」ならフェイルセキュア、「制御システム（事故防止）」ならフェイルセーフが正解になることが多いです。

### ④ フールプルーフ (Fool Proof)
**「人間は間違える生き物だ、という前提」**

意図的でない誤操作（フール＝愚か者）をしても、システムが誤動作しない、あるいは事故にならないようにする仕組みです。

*   **具体例**:
    *   **GUIの入力制限**: 数字しか入らない入力欄に、全角文字を入力できないようにする。
    *   **必須入力チェック**: 必須項目が空のままでは「送信」ボタンが押せないようにする。
    *   **コネクタの形状**: USBケーブルや電池など、逆向きには物理的に刺さらないようにする。
    *   **確認ダイアログ**: 「本当に削除していいですか？」と聞いて、うっかりクリックを防ぐ。

---

## 2.3 応用シナリオ：全部入り？

実際のシステムでは、これらの概念を組み合わせて設計します。

**例：銀行のATMシステム**

1.  **フールプルーフ**: 暗証番号を3回間違えたらロックがかかる（総当たり攻撃防止もあるが、操作ミスの線引きでもある）。カードを挿入する向きが決まっている。
2.  **フェイルソフト**: メンテナンス中や一部サーバー障害時でも、残高照会だけはできるようにする。
3.  **フェイルセキュア**: 内部エラーが発生して処理が完了しなかった場合、お金を引き出したことにはせず（取引不成立）、残高を減らさない。お金を多く出してしまうくらいなら、取引を止める。

## 2.4 試験で狙われる「フォールトトレラント」

もう一つ、覚えておくべき重要単語があります。

### フォールトトレラント (Fault Tolerant)
システムの一部に障害が発生しても、**システム全体としては停止することなく、正常に動き続ける能力** のことです。
フェイルソフトと似ていますが、フェイルソフトが「性能が落ちてもいいから粘る」のに対し、フォールトトレラントは「**予備機に切り替えるなどして、正常な状態を維持する**」という、より強い完全性のニュアンスがあります。

*   **手段**: 二重化（Redundancy）、クラスタリングなど。

> [!NOTE]
> **用語の整理**
> *   **フォールトトレラント**: 目標とする「性質・能力」。
> *   **フェイルセキュア / フェイルソフト**: 障害発生時の具体的な「挙動・振る舞い」。
>
> 「フォールトトレラントなシステムを実現するために、フェイルソフトな設計を取り入れた」という文脈になります。

第2章では、障害時の挙動について学びました。
「止める勇気（フェイルセキュア）」と「続ける執念（フェイルソフト）」の使い分けがポイントです。
次は、システムを多重に守る「多層防御」と、権限管理の基本「最小権限の原則」について解説します。
# 第3章：防御の階層と権限管理 〜城壁と鍵の管理〜

一つの対策だけで完璧に守り切ることは不可能です。「攻撃者はいつか必ず侵入してくる」という前提に立ち、システムを何重にも守る設計と、内部に入られたとしても被害を拡大させない権限管理が不可欠です。

## 3.1 多層防御 (Defense in Depth)

セキュリティ対策を「卵」のように「殻（ファイアウォール）」一枚だけで守るのではなく、「玉ねぎ」のように何層もの防御壁で中心（データ）を守る考え方です。

### 3つの防衛ライン
試験では、攻撃のフェーズに応じた3つの対策場所が問われます。

| 防衛ライン | 目的 | 具体的な対策技術（試験頻出） | アナロジー（城） |
| :--- | :--- | :--- | :--- |
| **入口対策** | 侵入させない | ・**Firewall**: ポート制御<br>・**IPS (侵入防御システム)**: 攻撃パターンの検知・遮断<br>・**SPF/DKIM/DMARC**: 迷惑メール・なりすましメール対策 | 城門・門番<br>怪しい奴を入れない |
| **内部対策** | 広げない、検知する | ・**WAF**: Webアプリへの攻撃検知<br>・**ネットワーク分離 (VLAN)**: 部署ごとに部屋を分ける<br>・**EDR**: 端末内での不審な挙動検知<br>・**パッチ管理**: 脆弱性を塞ぐ | 城内の見回り・区画<br>侵入者を見つける、隣の部屋に行かせない |
| **出口対策** | 持ち出させない | ・**プロキシサーバー (URLフィルタリング)**: 怪しいサイトへの接続ブロック<br>・**DLP (Data Loss Prevention)**: 機密情報の送信ブロック | 出口の荷物検査<br>宝物を持ち出させない |

> [!IMPORTANT]
> **試験のツボ：出口対策**
> 情報処理安全確保支援士では、「PCがマルウェアに感染してしまった後」の対策である **出口対策** がよく問われます。
> *   **C&Cサーバー通信の検知**: マルウェアは外部の司令塔（C&Cサーバー）と通信しようとします。プロキシログで「不審なドメインへの定期的な通信（ビーコン通信）」を見つけて遮断することが対策になります。

---

## 3.2 最小権限の原則 (Principle of Least Privilege)

**「業務遂行に必要な『最小限』の権限だけを与え、それ以外は一切与えない」** という鉄則です。
これは、もしそのアカウントが乗っ取られたとしても、被害を最小限に抑えるためです。

### 基本的な考え方
1.  **Need-to-Know (知る必要性)**: 業務に必要な情報だけが見えるようにする。
    *   例：営業部は顧客名簿を見れるが、人事評価ファイルは見れない。
2.  **Need-to-Do (行う必要性)**: 業務に必要な操作だけができるようにする。
    *   例：経理担当は振込処理ができるが、システム設定の変更はできない。

### 実装テクニックと試験用語

#### ① RBAC (Role-Based Access Control)
「人」に直接権限をつけるのではなく、「**役割（ロール）**」に権限をつけ、人をその役割に割り当てる方式です。
*   管理が楽になります（人が異動しても、ロールの割当を変えるだけ）。
*   試験では「ACL（アクセスコントロールリスト）の管理負荷を減らす手法」として正解になることが多いです。

#### ② 特権ID管理 (PAM: Privileged Access Management)
システム管理者（Administrator/root）のような強力な権限を持つID（特権ID）は、最も厳重に管理する必要があります。

*   **悪い運用**: 管理者パスワードを紙に書いて金庫に入れる、数人で使い回す。
*   **良い運用 (PAM導入)**:
    1.  **申請ベースの利用**: 作業するときだけ、上長の承認を得て特権IDを貸し出す。
    2.  **ワンタイムパスワード**: その時しか使えないパスワードを発行する。
    3.  **操作の録画**: 管理者が何をしたか（コマンド操作、画面操作）をすべて記録・録画する。

#### ③ 職務分掌 (Separation of Duties)
**「申請者」と「承認者」を別の人が行う** ことです。
権限を一人に集中させないことで、内部不正（自分でお金を振り込んで自分で承認するなど）を防ぎます。
*   **試験パターン**: 「開発担当者が本番環境への変更権限も持っている」状態は脆弱性とみなされます（本番データを見られたり、勝手に修正できたりするため）。

---

## 3.3 ケーススタディ：多層防御と最小権限の合わせ技

試験の午後問題でよくあるシナリオを見てみましょう。

**【シナリオ】**
> A社では、Webサーバーが外部から攻撃を受け、データベース内の個人情報が漏洩する事故が発生した。
> 調査の結果、WebアプリケーションにSQLインジェクションの脆弱性があったことが判明した。
> また、Webサーバーのアカウントでデータベースサーバーに接続できるようになっており、そのアカウントはデータベース管理者権限（全データの読み書き削除が可能）を持っていた。

**【問題点と対策】**
1.  **脆弱性 (入口/内部)**: SQLインジェクションがあった。
    *   → **対策**: プレースホルダを使う（セキュアシステム設計）。WAFを導入する（多層防御）。
2.  **権限管理の不備**: Webサーバーが「管理者権限」を持っていた。
    *   Webアプリがやるべきことは「当日の注文データの読み書き」程度のはずです。
    *   → **対策 (最小権限)**: Webアプリ用のDBユーザーを作成し、必要なテーブルへの `SELECT`, `INSERT` 権限だけを付与する。`DROP TABLE`（削除）などの権限は与えない。

もし最小権限が守られていれば、SQLインジェクション攻撃を受けても、テーブルごと削除されたり、関係ないテーブルを盗まれたりする被害は防げたかもしれません。
これが「**多層防御**」の効果です。1つ（アプリの修正）が漏れても、次（DBの権限）が食い止めるのです。

第3章では、防御の層を厚くすることと、権限を最小限に絞ることの重要性を学びました。
次はいよいよ、最新のセキュリティトレンドであり、試験でも最重要キーワードとなりつつある「ゼロトラスト」について解説します。
# 第4章：ゼロトラスト 〜「信頼」を捨てることから始まる安全〜

これまでのセキュリティは「社内（内側）は安全、社外（外側・インターネット）は危険」という前提で、境界線に壁（ファイアウォール）を作る「**境界型防御**」が主流でした。
しかし、クラウドサービスの利用拡大やテレワークの普及により、「社内・社外」の境界が曖昧に、あるいは消滅してしまいました。

そこで登場したのが、**「何も信頼しない（Zero Trust）」** という新しい考え方です。

## 4.1 ゼロトラストの基本概念

**"Never Trust, Always Verify"（決して信頼せず、常に検証せよ）**

これがゼロトラストの全てです。「社内ネットワークからのアクセスだから安全だろう」「一度パスワードでログインしたから本人だろう」という**暗黙の信頼**を一切排除します。

### 境界型防御との違い
| 特徴 | 境界型防御 (従来) | ゼロトラスト (現代) |
| :--- | :--- | :--- |
| **守る場所** | ネットワークの境界線 (GW) | 情報資産（データ）そのもの |
| **信頼の前提** | 内部ネットワークは信頼する | **内部も外部も信頼しない** |
| **検証のタイミング** | 最初のログイン時 (VPN接続時) | **アクセスするたび毎回 (Per Request)** |
| **悪用リスク** | 一度侵入されるとし放題 (ラテラルムーブメント容易) | 被害は最小限に抑えられる |

> [!NOTE]
> **ラテラルムーブメント (横展開)**
> 攻撃者が内部ネットワークに侵入した後、他のサーバーや端末へ次々と感染を広げていく行為。境界型防御では、内部通信はノーチェックであることが多いため、これを許しやすいという弱点がありました。

---

## 4.2 NIST SP 800-207 の7つの原則（超訳）

米国の国立標準技術研究所 (NIST) が定義した、ゼロトラストアーキテクチャの7つの原則があります。試験で問われる概念の根幹なので、噛み砕いて理解しましょう。

1.  **守るべきものは全て「リソース」だ**
    *   PCやサーバーだけでなく、クラウド上のデータも、SaaSもすべて守る対象です。
2.  **どこから繋いでも保護される**
    *   「会社のデスクからだからセキュリティチェックなし」はダメ。カフェからでも社内からでも同じ厳格なルールで守ります。
3.  **アクセス許可は「1回1回」行う**
    *   「さっき許可したから」は通用しません。ファイルAを開くときに許可し、次にファイルBを開くときにも再評価します。
4.  **「ポリシー」に従って動的にアクセス可否を決める**
    *   「誰が(UserID)」「どの端末で(Device)」「いつ・どこから(Context)」アクセスしているかを見て、その都度判断します。
    *   例：「経理部のAさんが」「会社支給の健全なPCから」「平日の昼間に」アクセスしているからOK。「深夜に」「海外から」「パッチが当たっていない個人のスマホで」アクセスしてきたらNG。
5.  **全ての資産の状態を監視・測定する**
    *   PCにウイルス対策ソフトが入っているか？OSは最新か？を常にチェックします。
6.  **認証と認可は常に動的に厳格に行う**
    *   多要素認証 (MFA) を前提とし、状況が変われば即座に再認証を求めます。
    *   試験キーワード：**FIDO**（パスワードレス認証）、**IDaaS**（クラウドでのID管理）。
7.  **情報をたくさん集めて、セキュリティを改善し続ける**
    *   ネットワークログやアクセス履歴を収集・分析し、ポリシーの精度を高めます。

---

## 4.3 ゼロトラストを実現する技術 (Alphabet Soup)

ゼロトラストは「概念」ですが、実現するには具体的なツールが必要です。略語のオンパレードですが、役割で覚えましょう。

### 1. 司令塔（認証・認可）
*   **IDaaS (Identity as a Service)**: クラウド上のID管理センター。Azure AD (Entra ID) や Oktaなど。ここで「誰か」「どんな権限か」を一元管理します。
*   **MFA (Multi-Factor Authentication)**: 多要素認証。ID/パスワードだけでなく、スマホアプリや生体認証を組み合わせる。

### 2. 端末のチェック（健全性確認）
*   **EDR (Endpoint Detection and Response)**: PC（エンドポイント）の中での不審な挙動を検知・対処する。従来型のアンチウイルスソフトが「侵入を防ぐ」のに対し、EDRは「侵入後の検知と対応」に特化しています。
*   **MDM (Mobile Device Management)**: モバイル端末管理。紛失時のロックや、OSバージョンの強制などを行う。

### 3. 通信の制御（ゲートウェイ）
*   **SWG (Secure Web Gateway)**: クラウド型のプロキシ。Webアクセスのフィルタリングを行う。
*   **CASB (Cloud Access Security Broker)**: 社員が勝手にクラウドサービス（シャドーIT）を使っていないか監視したり、SaaSへのアクセス制御を行ったりする。
*   **ZTNA (Zero Trust Network Access)**: VPNの進化版。ネットワーク全体への接続ではなく、特定のアプリケーションへの接続のみを許可する（Software Defined Perimeter）。

### 4. 統合管理
*   **SIEM (Security Information and Event Management)**: 色々な機器のログを集めて分析し、脅威を見つける基盤。
*   **SASE (Secure Access Service Edge)**: ネットワーク機能(SD-WAN)とセキュリティ機能(SWG, CASB, ZTNA等)をクラウド上で統合して提供するモデル。Gartnerが提唱。「ゼロトラストを実現するための現実的なプラットフォーム」と考えればOKです。

> [!CAUTION]
> **試験のツボ：VPN vs ZTNA**
> *   **VPN**: 穴を掘ってネットワークごと繋ぐ。「境界防御」の延長。一度入れば横移動しやすい。
> *   **ZTNA**: アプリごとに専用のトンネルを作る。他のアプリは見えない。ゼロトラストの原則「セッション単位の許可」を実現する技術。

## まとめ：セキュリティ設計のゴール

ここまで、以下の重要項目を学習しました。

1.  **セキュアシステム設計**: 最初から安全に作る（SQLi, XSS対策）。
2.  **フェイル設計**: 壊れたら安全に止まるか(Secure)、粘って動くか(Soft)。
3.  **多層防御と最小権限**: 何重にも守り、権限は絞る。
4.  **ゼロトラスト**: 何も信頼せず、常に検証する。

情報処理安全確保支援士の試験では、これらの知識を組み合わせて、**「提示されたシステムの現状（脆弱な状態）」から「あるべき姿（セキュアな設計）」への移行プランを描けるか** が問われます。
単語の暗記だけでなく、「なぜそれが必要なのか？」「導入するとどうなるのか？」というストーリー（文脈）を大切にして、学習を進めてください。

応援しています！


